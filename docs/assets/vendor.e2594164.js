/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var T9=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),N9=Object.prototype.hasOwnProperty;function h1(e,t){return N9.call(e,t)}function g1(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)h1(e,i)&&n.push(i);return n}function Jn(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function p1(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function Xo(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function uS(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function m1(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(m1(e[t]))return!0}else if(typeof e=="object"){for(var i=g1(e),r=i.length,t=0;t<r;t++)if(m1(e[i[t]]))return!0}}return!1}function lS(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r!="undefined"&&n.push(i+": "+r)}return n.join(`
`)}var cS=function(e){T9(t,e);function t(n,i,r,s,o){var a=this.constructor,u=e.call(this,lS(n,{name:i,index:r,operation:s,tree:o}))||this;return u.name=i,u.index=r,u.operation=s,u.tree=o,Object.setPrototypeOf(u,a.prototype),u.message=lS(n,{name:i,index:r,operation:s,tree:o}),u}return t}(Error),rt=cS,R9=Jn,mu={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Zd(n,this.path);i&&(i=Jn(i));var r=Qo(n,{op:"remove",path:this.from}).removed;return Qo(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Zd(n,this.from);return Qo(n,{op:"add",path:this.path,value:Jn(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:tc(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},P9={add:function(e,t,n){return p1(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:mu.move,copy:mu.copy,test:mu.test,_get:mu._get};function Zd(e,t){if(t=="")return e;var n={op:"_get",path:t};return Qo(e,n),n.value}function Qo(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):th(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=Zd(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=tc(e,t.value),o.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new rt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=Jn(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,h=void 0,g=void 0,p=void 0;for(typeof n=="function"?p=n:p=th;;){if(g=u[c],g&&g.indexOf("~")!=-1&&(g=uS(g)),r&&g=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(l[g]===void 0?h=u.slice(0,c).join("/"):c==f-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),c++,Array.isArray(l)){if(g==="-")g=l.length;else{if(n&&!p1(g))throw new rt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);p1(g)&&(g=~~g)}if(c>=f){if(n&&t.op==="add"&&g>l.length)throw new rt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=P9[t.op].call(t,l,g,e);if(o.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){var o=mu[t.op].call(t,l,g,e);if(o.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[g],n&&c<f&&(!l||typeof l!="object"))throw new rt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function eh(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new rt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Jn(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Qo(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function L9(e,t,n){var i=Qo(e,t);if(i.test===!1)throw new rt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function th(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new rt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(mu[e.op]){if(typeof e.path!="string")throw new rt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new rt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new rt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new rt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&m1(e.value))throw new rt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new rt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new rt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=fS([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new rt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new rt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function fS(e,t,n){try{if(!Array.isArray(e))throw new rt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)eh(Jn(t),Jn(e),n||!0);else{n=n||th;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof rt)return r;throw r}}function tc(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!=0;)if(!tc(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!=0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!=0;)if(o=a[r],!tc(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var I9=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:rt,deepClone:R9,getValueByPointer:Zd,applyOperation:Qo,applyPatch:eh,applyReducer:L9,validator:th,validate:fS,_areEquals:tc});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var y1=new WeakMap,B9=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),U9=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function z9(e){return y1.get(e)}function q9(e,t){return e.observers.get(t)}function H9(e,t){e.observers.delete(t.callback)}function W9(e,t){t.unobserve()}function G9(e,t){var n=[],i,r=z9(e);if(!r)r=new B9(e),y1.set(e,r);else{var s=q9(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=Jn(e),t){i.callback=t,i.next=null;var o=function(){b1(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){b1(i),clearTimeout(i.next),H9(r,i),typeof window!="undefined"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new U9(t,i)),i}function b1(e,t){t===void 0&&(t=!1);var n=y1.get(e.object);v1(n.value,e.object,e.patches,"",t),e.patches.length&&eh(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function v1(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=g1(t),o=g1(e),a=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(h1(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?v1(c,f,n,i+"/"+Xo(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+Xo(l),value:Jn(c)}),n.push({op:"replace",path:i+"/"+Xo(l),value:Jn(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Xo(l),value:Jn(c)}),n.push({op:"remove",path:i+"/"+Xo(l)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var u=0;u<s.length;u++){var l=s[u];!h1(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+Xo(l),value:Jn(t[l])})}}}function Y9(e,t,n){n===void 0&&(n=!1);var i=[];return v1(e,t,i,"",n),i}var V9=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:W9,observe:G9,generate:b1,compare:Y9});Object.assign({},I9,V9,{JsonPatchError:cS,deepClone:Jn,escapePathComponent:Xo,unescapePathComponent:uS});var X9=/("(?:[^\\"]|\\.)*")|[:,]/g,x1=function(t,n){var i,r,s;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function o(a,u,l){var c,f,h,g,p,m,y,x,w,E,A,S;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),A=JSON.stringify(a,s),A===void 0)return A;if(y=r-u.length-l,A.length<=y&&(w=A.replace(X9,function(O,_){return _||O+" "}),w.length<=y))return w;if(s!=null&&(a=JSON.parse(A),s=void 0),typeof a=="object"&&a!==null){if(x=u+i,h=[],f=0,Array.isArray(a))for(E="[",c="]",y=a.length;f<y;f++)h.push(o(a[f],x,f===y-1?0:1)||"null");else for(E="{",c="}",m=Object.keys(a),y=m.length;f<y;f++)g=m[f],p=JSON.stringify(g)+": ",S=o(a[g],x,p.length+(f===y-1?0:1)),S!==void 0&&h.push(p+S);if(h.length>0)return[E,i+h.join(`,
`+x),c].join(`
`+u)}return A}(t,"",0)},Ts={exports:{}};const Q9="2.0.0",K9=256,J9=Number.MAX_SAFE_INTEGER||9007199254740991,Z9=16;var nh={SEMVER_SPEC_VERSION:Q9,MAX_LENGTH:K9,MAX_SAFE_INTEGER:J9,MAX_SAFE_COMPONENT_LENGTH:Z9};const e7=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var ih=e7;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=nh,i=ih;t=e.exports={};const r=t.re=[],s=t.src=[],o=t.t={};let a=0;const u=(l,c,f)=>{const h=a++;i(h,c),o[l]=h,s[h]=c,r[h]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),u("FULL",`^${s[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),u("LOOSE",`^${s[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),u("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",s[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Ts,Ts.exports);const t7=["includePrerelease","loose","rtl"],n7=e=>e?typeof e!="object"?{loose:!0}:t7.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var rh=n7;const dS=/^[0-9]+$/,hS=(e,t)=>{const n=dS.test(e),i=dS.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1},i7=(e,t)=>hS(t,e);var w1={compareIdentifiers:hS,rcompareIdentifiers:i7};const sh=ih,{MAX_LENGTH:gS,MAX_SAFE_INTEGER:oh}=nh,{re:pS,t:mS}=Ts.exports,r7=rh,{compareIdentifiers:nc}=w1;class Mi{constructor(t,n){if(n=r7(n),t instanceof Mi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>gS)throw new TypeError(`version is longer than ${gS} characters`);sh("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const i=t.trim().match(n.loose?pS[mS.LOOSE]:pS[mS.FULL]);if(!i)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>oh||this.major<0)throw new TypeError("Invalid major version");if(this.minor>oh||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>oh||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const s=+r;if(s>=0&&s<oh)return s}return r}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(sh("SemVer.compare",this.version,this.options,t),!(t instanceof Mi)){if(typeof t=="string"&&t===this.version)return 0;t=new Mi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Mi||(t=new Mi(t,this.options)),nc(this.major,t.major)||nc(this.minor,t.minor)||nc(this.patch,t.patch)}comparePre(t){if(t instanceof Mi||(t=new Mi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const i=this.prerelease[n],r=t.prerelease[n];if(sh("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return nc(i,r)}while(++n)}compareBuild(t){t instanceof Mi||(t=new Mi(t,this.options));let n=0;do{const i=this.build[n],r=t.build[n];if(sh("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return nc(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var fn=Mi;const{MAX_LENGTH:s7}=nh,{re:yS,t:bS}=Ts.exports,vS=fn,o7=rh,a7=(e,t)=>{if(t=o7(t),e instanceof vS)return e;if(typeof e!="string"||e.length>s7||!(t.loose?yS[bS.LOOSE]:yS[bS.FULL]).test(e))return null;try{return new vS(e,t)}catch{return null}};var yu=a7;const u7=yu,l7=(e,t)=>{const n=u7(e,t);return n?n.version:null};var c7=l7;const f7=yu,d7=(e,t)=>{const n=f7(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var h7=d7;const g7=fn,p7=(e,t,n,i)=>{typeof n=="string"&&(i=n,n=void 0);try{return new g7(e,n).inc(t,i).version}catch{return null}};var m7=p7;const xS=fn,y7=(e,t,n)=>new xS(e,n).compare(new xS(t,n));var Ti=y7;const b7=Ti,v7=(e,t,n)=>b7(e,t,n)===0;var E1=v7;const wS=yu,x7=E1,w7=(e,t)=>{if(x7(e,t))return null;{const n=wS(e),i=wS(t),r=n.prerelease.length||i.prerelease.length,s=r?"pre":"",o=r?"prerelease":"";for(const a in n)if((a==="major"||a==="minor"||a==="patch")&&n[a]!==i[a])return s+a;return o}};var E7=w7;const A7=fn,_7=(e,t)=>new A7(e,t).major;var S7=_7;const O7=fn,C7=(e,t)=>new O7(e,t).minor;var $7=C7;const j7=fn,k7=(e,t)=>new j7(e,t).patch;var F7=k7;const D7=yu,M7=(e,t)=>{const n=D7(e,t);return n&&n.prerelease.length?n.prerelease:null};var T7=M7;const N7=Ti,R7=(e,t,n)=>N7(t,e,n);var P7=R7;const L7=Ti,I7=(e,t)=>L7(e,t,!0);var B7=I7;const ES=fn,U7=(e,t,n)=>{const i=new ES(e,n),r=new ES(t,n);return i.compare(r)||i.compareBuild(r)};var A1=U7;const z7=A1,q7=(e,t)=>e.sort((n,i)=>z7(n,i,t));var H7=q7;const W7=A1,G7=(e,t)=>e.sort((n,i)=>W7(i,n,t));var Y7=G7;const V7=Ti,X7=(e,t,n)=>V7(e,t,n)>0;var ah=X7;const Q7=Ti,K7=(e,t,n)=>Q7(e,t,n)<0;var _1=K7;const J7=Ti,Z7=(e,t,n)=>J7(e,t,n)!==0;var AS=Z7;const eP=Ti,tP=(e,t,n)=>eP(e,t,n)>=0;var S1=tP;const nP=Ti,iP=(e,t,n)=>nP(e,t,n)<=0;var O1=iP;const rP=E1,sP=AS,oP=ah,aP=S1,uP=_1,lP=O1,cP=(e,t,n,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return rP(e,n,i);case"!=":return sP(e,n,i);case">":return oP(e,n,i);case">=":return aP(e,n,i);case"<":return uP(e,n,i);case"<=":return lP(e,n,i);default:throw new TypeError(`Invalid operator: ${t}`)}};var _S=cP;const fP=fn,dP=yu,{re:uh,t:lh}=Ts.exports,hP=(e,t)=>{if(e instanceof fP)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(uh[lh.COERCE]);else{let i;for(;(i=uh[lh.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||i.index+i[0].length!==n.index+n[0].length)&&(n=i),uh[lh.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;uh[lh.COERCERTL].lastIndex=-1}return n===null?null:dP(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var gP=hP,pP=je;je.Node=Ko;je.create=je;function je(e){var t=this;if(t instanceof je||(t=new je),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}je.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};je.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};je.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};je.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)yP(this,arguments[e]);return this.length};je.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)bP(this,arguments[e]);return this.length};je.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};je.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};je.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;n!==null;i++)e.call(t,n.value,i,this),n=n.next};je.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;n!==null;i--)e.call(t,n.value,i,this),n=n.prev};je.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};je.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};je.prototype.map=function(e,t){t=t||this;for(var n=new je,i=this.head;i!==null;)n.push(e.call(t,i.value,this)),i=i.next;return n};je.prototype.mapReverse=function(e,t){t=t||this;for(var n=new je,i=this.tail;i!==null;)n.push(e.call(t,i.value,this)),i=i.prev;return n};je.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else if(this.head)i=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=0;i!==null;r++)n=e(n,i.value,r),i=i.next;return n};je.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else if(this.tail)i=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;i!==null;r--)n=e(n,i.value,r),i=i.prev;return n};je.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};je.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};je.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new je;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(;r!==null&&i<t;i++,r=r.next)n.push(r.value);return n};je.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new je;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;r!==null&&i>t;i--)r=r.prev;for(;r!==null&&i>e;i--,r=r.prev)n.push(r.value);return n};je.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(var s=[],i=0;r&&i<t;i++)s.push(r.value),r=this.removeNode(r);r===null&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(var i=0;i<n.length;i++)r=mP(this,r,n[i]);return s};je.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};function mP(e,t,n){var i=t===e.head?new Ko(n,null,t,e):new Ko(n,t,t.next,e);return i.next===null&&(e.tail=i),i.prev===null&&(e.head=i),e.length++,i}function yP(e,t){e.tail=new Ko(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function bP(e,t){e.head=new Ko(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ko(e,t,n,i){if(!(this instanceof Ko))return new Ko(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{require("./iterator.js")(je)}catch{}const vP=pP,Jo=Symbol("max"),Jr=Symbol("length"),bu=Symbol("lengthCalculator"),ic=Symbol("allowStale"),Zo=Symbol("maxAge"),Zr=Symbol("dispose"),SS=Symbol("noDisposeOnSet"),Ct=Symbol("lruList"),Ni=Symbol("cache"),OS=Symbol("updateAgeOnGet"),C1=()=>1;class xP{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Jo]=t.max||1/0;const n=t.length||C1;if(this[bu]=typeof n!="function"?C1:n,this[ic]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Zo]=t.maxAge||0,this[Zr]=t.dispose,this[SS]=t.noDisposeOnSet||!1,this[OS]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Jo]=t||1/0,rc(this)}get max(){return this[Jo]}set allowStale(t){this[ic]=!!t}get allowStale(){return this[ic]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Zo]=t,rc(this)}get maxAge(){return this[Zo]}set lengthCalculator(t){typeof t!="function"&&(t=C1),t!==this[bu]&&(this[bu]=t,this[Jr]=0,this[Ct].forEach(n=>{n.length=this[bu](n.value,n.key),this[Jr]+=n.length})),rc(this)}get lengthCalculator(){return this[bu]}get length(){return this[Jr]}get itemCount(){return this[Ct].length}rforEach(t,n){n=n||this;for(let i=this[Ct].tail;i!==null;){const r=i.prev;CS(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(let i=this[Ct].head;i!==null;){const r=i.next;CS(this,t,i,n),i=r}}keys(){return this[Ct].toArray().map(t=>t.key)}values(){return this[Ct].toArray().map(t=>t.value)}reset(){this[Zr]&&this[Ct]&&this[Ct].length&&this[Ct].forEach(t=>this[Zr](t.key,t.value)),this[Ni]=new Map,this[Ct]=new vP,this[Jr]=0}dump(){return this[Ct].map(t=>ch(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Ct]}set(t,n,i){if(i=i||this[Zo],i&&typeof i!="number")throw new TypeError("maxAge must be a number");const r=i?Date.now():0,s=this[bu](n,t);if(this[Ni].has(t)){if(s>this[Jo])return vu(this,this[Ni].get(t)),!1;const u=this[Ni].get(t).value;return this[Zr]&&(this[SS]||this[Zr](t,u.value)),u.now=r,u.maxAge=i,u.value=n,this[Jr]+=s-u.length,u.length=s,this.get(t),rc(this),!0}const o=new wP(t,n,s,r,i);return o.length>this[Jo]?(this[Zr]&&this[Zr](t,n),!1):(this[Jr]+=o.length,this[Ct].unshift(o),this[Ni].set(t,this[Ct].head),rc(this),!0)}has(t){if(!this[Ni].has(t))return!1;const n=this[Ni].get(t).value;return!ch(this,n)}get(t){return $1(this,t,!0)}peek(t){return $1(this,t,!1)}pop(){const t=this[Ct].tail;return t?(vu(this,t),t.value):null}del(t){vu(this,this[Ni].get(t))}load(t){this.reset();const n=Date.now();for(let i=t.length-1;i>=0;i--){const r=t[i],s=r.e||0;if(s===0)this.set(r.k,r.v);else{const o=s-n;o>0&&this.set(r.k,r.v,o)}}}prune(){this[Ni].forEach((t,n)=>$1(this,n,!1))}}const $1=(e,t,n)=>{const i=e[Ni].get(t);if(i){const r=i.value;if(ch(e,r)){if(vu(e,i),!e[ic])return}else n&&(e[OS]&&(i.value.now=Date.now()),e[Ct].unshiftNode(i));return r.value}},ch=(e,t)=>{if(!t||!t.maxAge&&!e[Zo])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Zo]&&n>e[Zo]},rc=e=>{if(e[Jr]>e[Jo])for(let t=e[Ct].tail;e[Jr]>e[Jo]&&t!==null;){const n=t.prev;vu(e,t),t=n}},vu=(e,t)=>{if(t){const n=t.value;e[Zr]&&e[Zr](n.key,n.value),e[Jr]-=n.length,e[Ni].delete(n.key),e[Ct].removeNode(t)}};class wP{constructor(t,n,i,r,s){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=s||0}}const CS=(e,t,n,i)=>{let r=n.value;ch(e,r)&&(vu(e,n),e[ic]||(r=void 0)),r&&t.call(i,r.value,r.key,e)};var EP=xP;class sc{constructor(t,n){if(n=_P(n),t instanceof sc)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new sc(t.raw,n);if(t instanceof j1)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const i=this.set[0];if(this.set=this.set.filter(r=>!jS(r[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(const r of this.set)if(r.length===1&&jP(r[0])){this.set=[r];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const i=`parseRange:${Object.keys(this.options).join(",")}:${t}`,r=$S.get(i);if(r)return r;const s=this.options.loose,o=s?Ht[Rt.HYPHENRANGELOOSE]:Ht[Rt.HYPHENRANGE];t=t.replace(o,IP(this.options.includePrerelease)),ft("hyphen replace",t),t=t.replace(Ht[Rt.COMPARATORTRIM],OP),ft("comparator trim",t,Ht[Rt.COMPARATORTRIM]),t=t.replace(Ht[Rt.TILDETRIM],CP),t=t.replace(Ht[Rt.CARETTRIM],$P),t=t.split(/\s+/).join(" ");const a=s?Ht[Rt.COMPARATORLOOSE]:Ht[Rt.COMPARATOR],u=t.split(" ").map(f=>kP(f,this.options)).join(" ").split(/\s+/).map(f=>LP(f,this.options)).filter(this.options.loose?f=>!!f.match(a):()=>!0).map(f=>new j1(f,this.options));u.length;const l=new Map;for(const f of u){if(jS(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return $S.set(i,c),c}intersects(t,n){if(!(t instanceof sc))throw new TypeError("a Range is required");return this.set.some(i=>kS(i,n)&&t.set.some(r=>kS(r,n)&&i.every(s=>r.every(o=>s.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new SP(t,this.options)}catch{return!1}for(let n=0;n<this.set.length;n++)if(BP(this.set[n],t,this.options))return!0;return!1}}var Ri=sc;const AP=EP,$S=new AP({max:1e3}),_P=rh,j1=dh,ft=ih,SP=fn,{re:Ht,t:Rt,comparatorTrimReplace:OP,tildeTrimReplace:CP,caretTrimReplace:$P}=Ts.exports,jS=e=>e.value==="<0.0.0-0",jP=e=>e.value==="",kS=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every(s=>r.intersects(s,t)),r=i.pop();return n},kP=(e,t)=>(ft("comp",e,t),e=MP(e,t),ft("caret",e),e=FP(e,t),ft("tildes",e),e=NP(e,t),ft("xrange",e),e=PP(e,t),ft("stars",e),e),dn=e=>!e||e.toLowerCase()==="x"||e==="*",FP=(e,t)=>e.trim().split(/\s+/).map(n=>DP(n,t)).join(" "),DP=(e,t)=>{const n=t.loose?Ht[Rt.TILDELOOSE]:Ht[Rt.TILDE];return e.replace(n,(i,r,s,o,a)=>{ft("tilde",e,i,r,s,o,a);let u;return dn(r)?u="":dn(s)?u=`>=${r}.0.0 <${+r+1}.0.0-0`:dn(o)?u=`>=${r}.${s}.0 <${r}.${+s+1}.0-0`:a?(ft("replaceTilde pr",a),u=`>=${r}.${s}.${o}-${a} <${r}.${+s+1}.0-0`):u=`>=${r}.${s}.${o} <${r}.${+s+1}.0-0`,ft("tilde return",u),u})},MP=(e,t)=>e.trim().split(/\s+/).map(n=>TP(n,t)).join(" "),TP=(e,t)=>{ft("caret",e,t);const n=t.loose?Ht[Rt.CARETLOOSE]:Ht[Rt.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(r,s,o,a,u)=>{ft("caret",e,r,s,o,a,u);let l;return dn(s)?l="":dn(o)?l=`>=${s}.0.0${i} <${+s+1}.0.0-0`:dn(a)?s==="0"?l=`>=${s}.${o}.0${i} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.0${i} <${+s+1}.0.0-0`:u?(ft("replaceCaret pr",u),s==="0"?o==="0"?l=`>=${s}.${o}.${a}-${u} <${s}.${o}.${+a+1}-0`:l=`>=${s}.${o}.${a}-${u} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.${a}-${u} <${+s+1}.0.0-0`):(ft("no pr"),s==="0"?o==="0"?l=`>=${s}.${o}.${a}${i} <${s}.${o}.${+a+1}-0`:l=`>=${s}.${o}.${a}${i} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),ft("caret return",l),l})},NP=(e,t)=>(ft("replaceXRanges",e,t),e.split(/\s+/).map(n=>RP(n,t)).join(" ")),RP=(e,t)=>{e=e.trim();const n=t.loose?Ht[Rt.XRANGELOOSE]:Ht[Rt.XRANGE];return e.replace(n,(i,r,s,o,a,u)=>{ft("xRange",e,i,r,s,o,a,u);const l=dn(s),c=l||dn(o),f=c||dn(a),h=f;return r==="="&&h&&(r=""),u=t.includePrerelease?"-0":"",l?r===">"||r==="<"?i="<0.0.0-0":i="*":r&&h?(c&&(o=0),a=0,r===">"?(r=">=",c?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):r==="<="&&(r="<",c?s=+s+1:o=+o+1),r==="<"&&(u="-0"),i=`${r+s}.${o}.${a}${u}`):c?i=`>=${s}.0.0${u} <${+s+1}.0.0-0`:f&&(i=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),ft("xRange return",i),i})},PP=(e,t)=>(ft("replaceStars",e,t),e.trim().replace(Ht[Rt.STAR],"")),LP=(e,t)=>(ft("replaceGTE0",e,t),e.trim().replace(Ht[t.includePrerelease?Rt.GTE0PRE:Rt.GTE0],"")),IP=e=>(t,n,i,r,s,o,a,u,l,c,f,h,g)=>(dn(i)?n="":dn(r)?n=`>=${i}.0.0${e?"-0":""}`:dn(s)?n=`>=${i}.${r}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,dn(l)?u="":dn(c)?u=`<${+l+1}.0.0-0`:dn(f)?u=`<${l}.${+c+1}.0-0`:h?u=`<=${l}.${c}.${f}-${h}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),BP=(e,t,n)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let i=0;i<e.length;i++)if(ft(e[i].semver),e[i].semver!==j1.ANY&&e[i].semver.prerelease.length>0){const r=e[i].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0},oc=Symbol("SemVer ANY");class fh{static get ANY(){return oc}constructor(t,n){if(n=UP(n),t instanceof fh){if(t.loose===!!n.loose)return t;t=t.value}F1("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===oc?this.value="":this.value=this.operator+this.semver.version,F1("comp",this)}parse(t){const n=this.options.loose?FS[DS.COMPARATORLOOSE]:FS[DS.COMPARATOR],i=t.match(n);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new MS(i[2],this.options.loose):this.semver=oc}toString(){return this.value}test(t){if(F1("Comparator.test",t,this.options.loose),this.semver===oc||t===oc)return!0;if(typeof t=="string")try{t=new MS(t,this.options)}catch{return!1}return k1(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof fh))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new TS(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new TS(this.value,n).test(t.semver);const i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),r=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),a=k1(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=k1(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return i||r||s&&o||a||u}}var dh=fh;const UP=rh,{re:FS,t:DS}=Ts.exports,k1=_S,F1=ih,MS=fn,TS=Ri,zP=Ri,qP=(e,t,n)=>{try{t=new zP(t,n)}catch{return!1}return t.test(e)};var hh=qP;const HP=Ri,WP=(e,t)=>new HP(e,t).set.map(n=>n.map(i=>i.value).join(" ").trim().split(" "));var GP=WP;const YP=fn,VP=Ri,XP=(e,t,n)=>{let i=null,r=null,s=null;try{s=new VP(t,n)}catch{return null}return e.forEach(o=>{s.test(o)&&(!i||r.compare(o)===-1)&&(i=o,r=new YP(i,n))}),i};var QP=XP;const KP=fn,JP=Ri,ZP=(e,t,n)=>{let i=null,r=null,s=null;try{s=new JP(t,n)}catch{return null}return e.forEach(o=>{s.test(o)&&(!i||r.compare(o)===1)&&(i=o,r=new KP(i,n))}),i};var eL=ZP;const D1=fn,tL=Ri,NS=ah,nL=(e,t)=>{e=new tL(e,t);let n=new D1("0.0.0");if(e.test(n)||(n=new D1("0.0.0-0"),e.test(n)))return n;n=null;for(let i=0;i<e.set.length;++i){const r=e.set[i];let s=null;r.forEach(o=>{const a=new D1(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||NS(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!n||NS(n,s))&&(n=s)}return n&&e.test(n)?n:null};var iL=nL;const rL=Ri,sL=(e,t)=>{try{return new rL(e,t).range||"*"}catch{return null}};var oL=sL;const aL=fn,RS=dh,{ANY:uL}=RS,lL=Ri,cL=hh,PS=ah,LS=_1,fL=O1,dL=S1,hL=(e,t,n,i)=>{e=new aL(e,i),t=new lL(t,i);let r,s,o,a,u;switch(n){case">":r=PS,s=fL,o=LS,a=">",u=">=";break;case"<":r=LS,s=dL,o=PS,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(cL(e,t,i))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,h=null;if(c.forEach(g=>{g.semver===uL&&(g=new RS(">=0.0.0")),f=f||g,h=h||g,r(g.semver,f.semver,i)?f=g:o(g.semver,h.semver,i)&&(h=g)}),f.operator===a||f.operator===u||(!h.operator||h.operator===a)&&s(e,h.semver))return!1;if(h.operator===u&&o(e,h.semver))return!1}return!0};var M1=hL;const gL=M1,pL=(e,t,n)=>gL(e,t,">",n);var mL=pL;const yL=M1,bL=(e,t,n)=>yL(e,t,"<",n);var vL=bL;const IS=Ri,xL=(e,t,n)=>(e=new IS(e,n),t=new IS(t,n),e.intersects(t));var wL=xL;const EL=hh,AL=Ti;var _L=(e,t,n)=>{const i=[];let r=null,s=null;const o=e.sort((c,f)=>AL(c,f,n));for(const c of o)EL(c,t,n)?(s=c,r||(r=c)):(s&&i.push([r,s]),s=null,r=null);r&&i.push([r,null]);const a=[];for(const[c,f]of i)c===f?a.push(c):!f&&c===o[0]?a.push("*"):f?c===o[0]?a.push(`<=${f}`):a.push(`${c} - ${f}`):a.push(`>=${c}`);const u=a.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const BS=Ri,gh=dh,{ANY:T1}=gh,ac=hh,N1=Ti,SL=(e,t,n={})=>{if(e===t)return!0;e=new BS(e,n),t=new BS(t,n);let i=!1;e:for(const r of e.set){for(const s of t.set){const o=OL(r,s,n);if(i=i||o!==null,o)continue e}if(i)return!1}return!0},OL=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===T1){if(t.length===1&&t[0].semver===T1)return!0;n.includePrerelease?e=[new gh(">=0.0.0-0")]:e=[new gh(">=0.0.0")]}if(t.length===1&&t[0].semver===T1){if(n.includePrerelease)return!0;t=[new gh(">=0.0.0")]}const i=new Set;let r,s;for(const g of e)g.operator===">"||g.operator===">="?r=US(r,g,n):g.operator==="<"||g.operator==="<="?s=zS(s,g,n):i.add(g.semver);if(i.size>1)return null;let o;if(r&&s){if(o=N1(r.semver,s.semver,n),o>0)return null;if(o===0&&(r.operator!==">="||s.operator!=="<="))return null}for(const g of i){if(r&&!ac(g,String(r),n)||s&&!ac(g,String(s),n))return null;for(const p of t)if(!ac(g,String(p),n))return!1;return!0}let a,u,l,c,f=s&&!n.includePrerelease&&s.semver.prerelease.length?s.semver:!1,h=r&&!n.includePrerelease&&r.semver.prerelease.length?r.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const g of t){if(c=c||g.operator===">"||g.operator===">=",l=l||g.operator==="<"||g.operator==="<=",r){if(h&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===h.major&&g.semver.minor===h.minor&&g.semver.patch===h.patch&&(h=!1),g.operator===">"||g.operator===">="){if(a=US(r,g,n),a===g&&a!==r)return!1}else if(r.operator===">="&&!ac(r.semver,String(g),n))return!1}if(s){if(f&&g.semver.prerelease&&g.semver.prerelease.length&&g.semver.major===f.major&&g.semver.minor===f.minor&&g.semver.patch===f.patch&&(f=!1),g.operator==="<"||g.operator==="<="){if(u=zS(s,g,n),u===g&&u!==s)return!1}else if(s.operator==="<="&&!ac(s.semver,String(g),n))return!1}if(!g.operator&&(s||r)&&o!==0)return!1}return!(r&&l&&!s&&o!==0||s&&c&&!r&&o!==0||h||f)},US=(e,t,n)=>{if(!e)return t;const i=N1(e.semver,t.semver,n);return i>0?e:i<0||t.operator===">"&&e.operator===">="?t:e},zS=(e,t,n)=>{if(!e)return t;const i=N1(e.semver,t.semver,n);return i<0?e:i>0||t.operator==="<"&&e.operator==="<="?t:e};var CL=SL;const R1=Ts.exports;var qS={re:R1.re,src:R1.src,tokens:R1.t,SEMVER_SPEC_VERSION:nh.SEMVER_SPEC_VERSION,SemVer:fn,compareIdentifiers:w1.compareIdentifiers,rcompareIdentifiers:w1.rcompareIdentifiers,parse:yu,valid:c7,clean:h7,inc:m7,diff:E7,major:S7,minor:$7,patch:F7,prerelease:T7,compare:Ti,rcompare:P7,compareLoose:B7,compareBuild:A1,sort:H7,rsort:Y7,gt:ah,lt:_1,eq:E1,neq:AS,gte:S1,lte:O1,cmp:_S,coerce:gP,Comparator:dh,Range:Ri,satisfies:hh,toComparators:GP,maxSatisfying:QP,minSatisfying:eL,minVersion:iL,validRange:oL,outside:M1,gtr:mL,ltr:vL,intersects:wL,simplifyRange:_L,subset:CL};function Fn(e,t,n){return e.fields=t||[],e.fname=n,e}function st(e){return e==null?null:e.fname}function Wt(e){return e==null?null:e.fields}function HS(e){return e.length===1?$L(e[0]):jL(e)}const $L=e=>function(t){return t[e]},jL=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function P(e){throw Error(e)}function ph(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||P("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&P("Access path missing closing bracket: "+e),i&&P("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Dn(e,t,n){const i=ph(e);return e=i.length===1?i[0]:e,Fn((n&&n.get||HS)(i),[e],t||e)}const uc=Dn("id"),hn=Fn(e=>e,[],"identity"),Ns=Fn(()=>0,[],"zero"),xu=Fn(()=>1,[],"one"),di=Fn(()=>!0,[],"true"),Rs=Fn(()=>!1,[],"false");function kL(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const WS=0,P1=1,GS=2,YS=3,VS=4;function XS(e,t,n=kL){let i=e||WS;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=P1&&n(t||"error","ERROR",arguments),this},warn(){return i>=GS&&n(t||"warn","WARN",arguments),this},info(){return i>=YS&&n(t||"log","INFO",arguments),this},debug(){return i>=VS&&n(t||"log","DEBUG",arguments),this}}}var Z=Array.isArray;function fe(e){return e===Object(e)}const QS=e=>e!=="__proto__";function mh(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=FL(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;lc(t,i,n[i],r)}return t},{})}function lc(e,t,n,i){if(!QS(t))return;let r,s;if(fe(n)&&!Z(n)){s=fe(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?lc(s,r,n[r]):QS(r)&&(s[r]=n[r])}else e[t]=n}function FL(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function Ee(e){return e[e.length-1]}function Gt(e){return e==null||e===""?null:+e}const KS=e=>t=>e*Math.exp(t),JS=e=>t=>Math.log(e*t),ZS=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),eO=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,yh=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function bh(e,t,n,i){const r=n(e[0]),s=n(Ee(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function tO(e,t){return bh(e,t,Gt,hn)}function nO(e,t){var n=Math.sign(e[0]);return bh(e,t,JS(n),KS(n))}function iO(e,t,n){return bh(e,t,yh(n),yh(1/n))}function rO(e,t,n){return bh(e,t,ZS(n),eO(n))}function vh(e,t,n,i,r){const s=i(e[0]),o=i(Ee(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function L1(e,t,n){return vh(e,t,n,Gt,hn)}function I1(e,t,n){const i=Math.sign(e[0]);return vh(e,t,n,JS(i),KS(i))}function xh(e,t,n,i){return vh(e,t,n,yh(i),yh(1/i))}function B1(e,t,n,i){return vh(e,t,n,ZS(i),eO(i))}function sO(e){return 1+~~(new Date(e).getMonth()/3)}function oO(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ae(e){return e!=null?Z(e)?e:[e]:[]}function aO(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function ye(e){return typeof e=="function"}const DL="descending";function U1(e,t,n){n=n||{},t=ae(t)||[];const i=[],r=[],s={},o=n.comparator||ML;return ae(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===DL?-1:1),r.push(a=ye(a)?a:Dn(a,null,n)),(Wt(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:Fn(o(r,i),Object.keys(s))}const wh=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),ML=(e,t)=>e.length===1?TL(e[0],t[0]):NL(e,t,e.length),TL=(e,t)=>function(n,i){return wh(e(n),e(i))*t},NL=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=wh(s(i),s(r));return o*t[a]});function Yt(e){return ye(e)?e:()=>e}function z1(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function pe(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function cr(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function uO(e,t){const n=e.length;let i=-1,r,s,o,a,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}return[a,u]}const RL=Object.prototype.hasOwnProperty;function ue(e,t){return RL.call(e,t)}const Eh={};function wu(e){let t={},n;function i(s){return ue(t,s)&&t[s]!==Eh}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===Eh&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=Eh),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==Eh&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function lO(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=Ee(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?i:c<=o?r:s}function H(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),pe(i,n)}function Eu(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function q1(e){return typeof e=="boolean"}function Ps(e){return Object.prototype.toString.call(e)==="[object Date]"}function cO(e){return e&&ye(e[Symbol.iterator])}function Ls(e){return typeof e=="number"}function fO(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Oe(e){return typeof e=="string"}function H1(e,t,n){e&&(e=t?ae(e).map(a=>a.replace(/\\(.)/g,"$1")):ae(e));const i=e&&e.length,r=n&&n.get||HS,s=a=>r(t?[a]:ph(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return Fn(o,e,"key")}function dO(e,t){const n=e[0],i=Ee(e),r=+t;return r?r===1?i:n+r*(i-n):n}const PL=1e4;function hO(e){e=+e||PL;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>ue(t,o)||ue(n,o),get:o=>ue(t,o)?t[o]:ue(n,o)?s(o,n[o]):void 0,set:(o,a)=>ue(t,o)?t[o]=a:s(o,a)}}function gO(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,u=0,l=0;for(;a<r&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function cc(e,t){let n="";for(;--t>=0;)n+=e;return n}function pO(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?cc(r,o)+s:i==="center"?cc(r,~~(o/2))+s+cc(r,Math.ceil(o/2)):s+cc(r,o)}function fc(e){return e&&Ee(e)-e[0]||0}function ie(e){return Z(e)?"["+e.map(ie)+"]":fe(e)||Oe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function W1(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const LL=e=>Ls(e)||Ps(e)?e:Date.parse(e);function G1(e,t){return t=t||LL,e==null||e===""?null:t(e)}function Y1(e){return e==null||e===""?null:e+""}function Pi(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function mO(e,t,n,i){const r=i!=null?i:"\u2026",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function Is(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}var yO={},V1={},X1=34,dc=10,Q1=13;function bO(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function IL(e,t){var n=bO(e);return function(i,r){return t(n(i),r,e)}}function vO(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Mn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function BL(e){return e<0?"-"+Mn(-e,6):e>9999?"+"+Mn(e,6):Mn(e,4)}function UL(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":BL(e.getUTCFullYear())+"-"+Mn(e.getUTCMonth()+1,2)+"-"+Mn(e.getUTCDate(),2)+(r?"T"+Mn(t,2)+":"+Mn(n,2)+":"+Mn(i,2)+"."+Mn(r,3)+"Z":i?"T"+Mn(t,2)+":"+Mn(n,2)+":"+Mn(i,2)+"Z":n||t?"T"+Mn(t,2)+":"+Mn(n,2)+"Z":"")}function zL(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,h){var g,p,m=r(f,function(y,x){if(g)return g(y,x-1);p=y,g=h?IL(y,h):bO(y)});return m.columns=p||[],m}function r(f,h){var g=[],p=f.length,m=0,y=0,x,w=p<=0,E=!1;f.charCodeAt(p-1)===dc&&--p,f.charCodeAt(p-1)===Q1&&--p;function A(){if(w)return V1;if(E)return E=!1,yO;var O,_=m,C;if(f.charCodeAt(_)===X1){for(;m++<p&&f.charCodeAt(m)!==X1||f.charCodeAt(++m)===X1;);return(O=m)>=p?w=!0:(C=f.charCodeAt(m++))===dc?E=!0:C===Q1&&(E=!0,f.charCodeAt(m)===dc&&++m),f.slice(_+1,O-1).replace(/""/g,'"')}for(;m<p;){if((C=f.charCodeAt(O=m++))===dc)E=!0;else if(C===Q1)E=!0,f.charCodeAt(m)===dc&&++m;else if(C!==n)continue;return f.slice(_,O)}return w=!0,f.slice(_,p)}for(;(x=A())!==V1;){for(var S=[];x!==yO&&x!==V1;)S.push(x),x=A();h&&(S=h(S,y++))==null||g.push(S)}return g}function s(f,h){return f.map(function(g){return h.map(function(p){return c(g[p])}).join(e)})}function o(f,h){return h==null&&(h=vO(f)),[h.map(c).join(e)].concat(s(f,h)).join(`
`)}function a(f,h){return h==null&&(h=vO(f)),s(f,h).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?UL(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function qL(e){return e}function HL(e){if(e==null)return qL;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+s,f[1]=(n+=a[1])*r+o;l<c;)f[l]=a[l],++l;return f}}function WL(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function GL(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return xO(e,n)})}:xO(e,t)}function xO(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=wO(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function wO(e,t){var n=HL(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var h=i[c<0?~c:c],g=0,p=h.length;g<p;++g)f.push(n(h[g],g));c<0&&WL(f,p)}function s(c){return n(c)}function o(c){for(var f=[],h=0,g=c.length;h<g;++h)r(c[h],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,h;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":h=s(c.coordinates);break;case"MultiPoint":h=c.coordinates.map(s);break;case"LineString":h=o(c.arcs);break;case"MultiLineString":h=c.arcs.map(o);break;case"Polygon":h=u(c.arcs);break;case"MultiPolygon":h=c.arcs.map(u);break;default:return null}return{type:f,coordinates:h}}return l(t)}function YL(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],h;f.length<3&&!f[1][0]&&!f[1][1]&&(h=t[++o],t[o]=l,t[c]=h)}),t.forEach(function(l){var c=a(l),f=c[0],h=c[1],g,p;if(g=r[f])if(delete r[g.end],g.push(l),g.end=h,p=i[h]){delete i[p.start];var m=p===g?g:g.concat(p);i[m.start=g.start]=r[m.end=p.end]=m}else i[g.start]=r[g.end]=g;else if(g=i[h])if(delete i[g.start],g.unshift(l),g.start=f,p=r[f]){delete r[p.end];var y=p===g?g:p.concat(g);i[y.start=p.start]=r[y.end=g.end]=y}else i[g.start]=r[g.end]=g;else g=[l],i[g.start=f]=r[g.end=h]=g});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],h;return e.transform?(h=[0,0],c.forEach(function(g){h[0]+=g[0],h[1]+=g[1]})):h=c[c.length-1],l<0?[h,f]:[f,h]}function u(l,c){for(var f in l){var h=l[f];delete c[h.start],delete h.start,delete h.end,h.forEach(function(g){n[g<0?~g:g]=1}),s.push(h)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function VL(e){return wO(e,XL.apply(this,arguments))}function XL(e,t,n){var i,r,s;if(arguments.length>1)i=QL(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:YL(e,i)}}function QL(e,t,n){var i=[],r=[],s;function o(f){var h=f<0?~f:f;(r[h]||(r[h]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function Au(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function hc(e){let t=e,n=e;e.length===1&&(t=(o,a)=>e(o)-a,n=KL(e));function i(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)<0?u=c+1:l=c}return u}function r(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)>0?l=c:u=c+1}return u}function s(o,a,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=i(o,a,u,l-1);return c>u&&t(o[c-1],a)>-t(o[c],a)?c-1:c}return{left:i,center:s,right:r}}function KL(e){return(t,n)=>Au(e(t),n)}function EO(e){return e===null?NaN:+e}function*JL(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const AO=hc(Au),Ah=AO.right,ZL=AO.left;hc(EO).center;var gc=Ah;function eI(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function tI(e,t){const n=eI(e,t);return n&&Math.sqrt(n)}class gn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}function nI(e,t){return Array.from(t,n=>e[n])}var K1=Math.sqrt(50),J1=Math.sqrt(10),Z1=Math.sqrt(2);function ey(e,t,n){var i,r=-1,s,o,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(s=e,e=t,t=s),(a=_O(e,t,n))===0||!isFinite(a))return[];if(a>0){let u=Math.round(e/a),l=Math.round(t/a);for(u*a<e&&++u,l*a>t&&--l,o=new Array(s=l-u+1);++r<s;)o[r]=(u+r)*a}else{a=-a;let u=Math.round(e*a),l=Math.round(t*a);for(u/a<e&&++u,l/a>t&&--l,o=new Array(s=l-u+1);++r<s;)o[r]=(u+r)/a}return i&&o.reverse(),o}function _O(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=K1?10:s>=J1?5:s>=Z1?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=K1?10:s>=J1?5:s>=Z1?2:1)}function Bs(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=K1?r*=10:s>=J1?r*=5:s>=Z1&&(r*=2),t<e?-r:r}function ea(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function ty(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function SO(e,t,n=0,i=e.length-1,r=Au){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),g=Math.max(n,Math.floor(t-l*f/u+h)),p=Math.min(i,Math.floor(t+(u-l)*f/u+h));SO(e,t,g,p,r)}const s=e[t];let o=n,a=i;for(pc(e,n,t),r(e[i],s)>0&&pc(e,n,i);o<a;){for(pc(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?pc(e,n,a):(++a,pc(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function pc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function ny(e,t,n){if(e=Float64Array.from(JL(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return ty(e);if(t>=1)return ea(e);var i,r=(i-1)*t,s=Math.floor(r),o=ea(SO(e,s).subarray(0,s+1)),a=ty(e.subarray(s+1));return o+(a-o)*(r-s)}}function OO(e,t,n=EO){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function iI(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function CO(e,t){return ny(e,.5,t)}function*rI(e){for(const t of e)yield*t}function $O(e){return Array.from(rI(e))}function Zn(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function jO(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function sI(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function _h(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function _u(e){return e=_h(Math.abs(e)),e?e[1]:NaN}function oI(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function aI(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var uI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Su(e){if(!(t=uI.exec(e)))throw new Error("invalid format: "+e);var t;return new iy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Su.prototype=iy.prototype;function iy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}iy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lI(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var kO;function cI(e,t){var n=_h(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(kO=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+_h(e,Math.max(0,t+s-1))[0]}function FO(e,t){var n=_h(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var DO={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:sI,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>FO(e*100,t),r:FO,s:cI,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function MO(e){return e}var TO=Array.prototype.map,NO=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function RO(e){var t=e.grouping===void 0||e.thousands===void 0?MO:oI(TO.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?MO:aI(TO.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=Su(f);var h=f.fill,g=f.align,p=f.sign,m=f.symbol,y=f.zero,x=f.width,w=f.comma,E=f.precision,A=f.trim,S=f.type;S==="n"?(w=!0,S="g"):DO[S]||(E===void 0&&(E=12),A=!0,S="g"),(y||h==="0"&&g==="=")&&(y=!0,h="0",g="=");var O=m==="$"?n:m==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",_=m==="$"?i:/[%p]/.test(S)?o:"",C=DO[S],j=/[defgprs%]/.test(S);E=E===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function $(k){var M=O,D=_,I,F,L;if(S==="c")D=C(k)+D,k="";else{k=+k;var B=k<0||1/k<0;if(k=isNaN(k)?u:C(Math.abs(k),E),A&&(k=lI(k)),B&&+k==0&&p!=="+"&&(B=!1),M=(B?p==="("?p:a:p==="-"||p==="("?"":p)+M,D=(S==="s"?NO[8+kO/3]:"")+D+(B&&p==="("?")":""),j){for(I=-1,F=k.length;++I<F;)if(L=k.charCodeAt(I),48>L||L>57){D=(L===46?r+k.slice(I+1):k.slice(I))+D,k=k.slice(0,I);break}}}w&&!y&&(k=t(k,1/0));var W=M.length+k.length+D.length,X=W<x?new Array(x-W+1).join(h):"";switch(w&&y&&(k=t(X+k,X.length?x-D.length:1/0),X=""),g){case"<":k=M+k+D+X;break;case"=":k=M+X+k+D;break;case"^":k=X.slice(0,W=X.length>>1)+M+k+D+X.slice(W);break;default:k=X+M+k+D;break}return s(k)}return $.toString=function(){return f+""},$}function c(f,h){var g=l((f=Su(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(_u(h)/3)))*3,m=Math.pow(10,-p),y=NO[8+p/3];return function(x){return g(m*x)+y}}return{format:l,formatPrefix:c}}var Sh,Oh,ry;fI({thousands:",",grouping:[3],currency:["$",""]});function fI(e){return Sh=RO(e),Oh=Sh.format,ry=Sh.formatPrefix,Sh}function PO(e){return Math.max(0,-_u(Math.abs(e)))}function LO(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_u(t)/3)))*3-_u(Math.abs(e)))}function IO(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_u(t)-_u(e))+1}var sy=new Date,oy=new Date;function $t(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=function(s){return e(s=new Date(+s)),s},r.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},r.round=function(s){var o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=function(s,o){return t(s=new Date(+s),o==null?1:Math.floor(o)),s},r.range=function(s,o,a){var u=[],l;if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},r.filter=function(s){return $t(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(r.count=function(s,o){return sy.setTime(+s),oy.setTime(+o),e(sy),e(oy),Math.floor(n(sy,oy))},r.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?function(o){return i(o)%s==0}:function(o){return r.count(0,o)%s==0}):r}),r}var ay=$t(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});ay.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?$t(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):ay};var uy=ay;const es=1e3,hi=es*60,ts=hi*60,ta=ts*24,ly=ta*7,BO=ta*30,cy=ta*365;var dI=$t(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*es)},function(e,t){return(t-e)/es},function(e){return e.getUTCSeconds()}),Us=dI,hI=$t(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*es)},function(e,t){e.setTime(+e+t*hi)},function(e,t){return(t-e)/hi},function(e){return e.getMinutes()}),fy=hI,gI=$t(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*es-e.getMinutes()*hi)},function(e,t){e.setTime(+e+t*ts)},function(e,t){return(t-e)/ts},function(e){return e.getHours()}),dy=gI,pI=$t(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*hi)/ta,e=>e.getDate()-1),zs=pI;function na(e){return $t(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*hi)/ly})}var mc=na(0),hy=na(1);na(2);na(3);var yc=na(4);na(5);na(6);var mI=$t(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),Ch=mI,UO=$t(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});UO.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:$t(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var qs=UO,yI=$t(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*hi)},function(e,t){return(t-e)/hi},function(e){return e.getUTCMinutes()}),gy=yI,bI=$t(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*ts)},function(e,t){return(t-e)/ts},function(e){return e.getUTCHours()}),py=bI,vI=$t(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/ta},function(e){return e.getUTCDate()-1}),Hs=vI;function ia(e){return $t(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/ly})}var bc=ia(0),my=ia(1);ia(2);ia(3);var vc=ia(4);ia(5);ia(6);var xI=$t(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),$h=xI,zO=$t(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});zO.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:$t(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Ws=zO;function qO(e,t,n,i,r,s){const o=[[Us,1,es],[Us,5,5*es],[Us,15,15*es],[Us,30,30*es],[s,1,hi],[s,5,5*hi],[s,15,15*hi],[s,30,30*hi],[r,1,ts],[r,3,3*ts],[r,6,6*ts],[r,12,12*ts],[i,1,ta],[i,2,2*ta],[n,1,ly],[t,1,BO],[t,3,3*BO],[e,1,cy]];function a(l,c,f){const h=c<l;h&&([l,c]=[c,l]);const g=f&&typeof f.range=="function"?f:u(l,c,f),p=g?g.range(l,+c+1):[];return h?p.reverse():p}function u(l,c,f){const h=Math.abs(c-l)/f,g=hc(([,,y])=>y).right(o,h);if(g===o.length)return e.every(Bs(l/cy,c/cy,f));if(g===0)return uy.every(Math.max(Bs(l,c,f),1));const[p,m]=o[h/o[g-1][2]<o[g][2]/h?g-1:g];return p.every(m)}return[a,u]}const[wI,EI]=qO(Ws,$h,bc,Hs,py,gy),[AI,_I]=qO(qs,Ch,mc,zs,dy,fy),Pt="year",Tn="quarter",Vt="month",vt="week",Nn="date",Xt="day",fr="dayofyear",ei="hours",ti="minutes",gi="seconds",Li="milliseconds",yy=[Pt,Tn,Vt,vt,Nn,Xt,fr,ei,ti,gi,Li],by=yy.reduce((e,t,n)=>(e[t]=1+n,e),{});function vy(e){const t=ae(e).slice(),n={};return t.length||P("Missing time unit."),t.forEach(r=>{ue(by,r)?n[r]=1:P("Invalid time unit: ".concat(r,"."))}),(n[vt]||n[Xt]?1:0)+(n[Tn]||n[Vt]||n[Nn]?1:0)+(n[fr]?1:0)>1&&P("Incompatible time units: ".concat(e)),t.sort((r,s)=>by[r]-by[s]),t}const SI={[Pt]:"%Y ",[Tn]:"Q%q ",[Vt]:"%b ",[Nn]:"%d ",[vt]:"W%U ",[Xt]:"%a ",[fr]:"%j ",[ei]:"%H:00",[ti]:"00:%M",[gi]:":%S",[Li]:".%L",["".concat(Pt,"-").concat(Vt)]:"%Y-%m ",["".concat(Pt,"-").concat(Vt,"-").concat(Nn)]:"%Y-%m-%d ",["".concat(ei,"-").concat(ti)]:"%H:%M"};function HO(e,t){const n=pe({},SI,t),i=vy(e),r=i.length;let s="",o=0,a,u;for(o=0;o<r;)for(a=i.length;a>o;--a)if(u=i.slice(o,a).join("-"),n[u]!=null){s+=n[u],o=a;break}return s.trim()}const ra=new Date;function xy(e){return ra.setFullYear(e),ra.setMonth(0),ra.setDate(1),ra.setHours(0,0,0,0),ra}function WO(e){return YO(new Date(e))}function GO(e){return wy(new Date(e))}function YO(e){return zs.count(xy(e.getFullYear())-1,e)}function wy(e){return mc.count(xy(e.getFullYear())-1,e)}function Ey(e){return xy(e).getDay()}function OI(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function VO(e){return QO(new Date(e))}function XO(e){return Ay(new Date(e))}function QO(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Hs.count(t-1,e)}function Ay(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return bc.count(t-1,e)}function _y(e){return ra.setTime(Date.UTC(e,0,1)),ra.getUTCDay()}function CI(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function KO(e,t,n,i,r){const s=t||1,o=Ee(e),a=(x,w,E)=>(E=E||x,$I(n[E],i[E],x===o&&s,w)),u=new Date,l=Pi(e),c=l[Pt]?a(Pt):Yt(2012),f=l[Vt]?a(Vt):l[Tn]?a(Tn):Ns,h=l[vt]&&l[Xt]?a(Xt,1,vt+Xt):l[vt]?a(vt,1):l[Xt]?a(Xt,1):l[Nn]?a(Nn,1):l[fr]?a(fr,1):xu,g=l[ei]?a(ei):Ns,p=l[ti]?a(ti):Ns,m=l[gi]?a(gi):Ns,y=l[Li]?a(Li):Ns;return function(x){u.setTime(+x);const w=c(u);return r(w,f(u),h(u,w),g(u),p(u),m(u),y(u))}}function $I(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function Ou(e,t,n){return t+e*7-(n+6)%7}const jI={[Pt]:e=>e.getFullYear(),[Tn]:e=>Math.floor(e.getMonth()/3),[Vt]:e=>e.getMonth(),[Nn]:e=>e.getDate(),[ei]:e=>e.getHours(),[ti]:e=>e.getMinutes(),[gi]:e=>e.getSeconds(),[Li]:e=>e.getMilliseconds(),[fr]:e=>YO(e),[vt]:e=>wy(e),[vt+Xt]:(e,t)=>Ou(wy(e),e.getDay(),Ey(t)),[Xt]:(e,t)=>Ou(1,e.getDay(),Ey(t))},kI={[Tn]:e=>3*e,[vt]:(e,t)=>Ou(e,0,Ey(t))};function JO(e,t){return KO(e,t||1,jI,kI,OI)}const FI={[Pt]:e=>e.getUTCFullYear(),[Tn]:e=>Math.floor(e.getUTCMonth()/3),[Vt]:e=>e.getUTCMonth(),[Nn]:e=>e.getUTCDate(),[ei]:e=>e.getUTCHours(),[ti]:e=>e.getUTCMinutes(),[gi]:e=>e.getUTCSeconds(),[Li]:e=>e.getUTCMilliseconds(),[fr]:e=>QO(e),[vt]:e=>Ay(e),[Xt]:(e,t)=>Ou(1,e.getUTCDay(),_y(t)),[vt+Xt]:(e,t)=>Ou(Ay(e),e.getUTCDay(),_y(t))},DI={[Tn]:e=>3*e,[vt]:(e,t)=>Ou(e,0,_y(t))};function ZO(e,t){return KO(e,t||1,FI,DI,CI)}const MI={[Pt]:qs,[Tn]:Ch.every(3),[Vt]:Ch,[vt]:mc,[Nn]:zs,[Xt]:zs,[fr]:zs,[ei]:dy,[ti]:fy,[gi]:Us,[Li]:uy},TI={[Pt]:Ws,[Tn]:$h.every(3),[Vt]:$h,[vt]:bc,[Nn]:Hs,[Xt]:Hs,[fr]:Hs,[ei]:py,[ti]:gy,[gi]:Us,[Li]:uy};function Cu(e){return MI[e]}function $u(e){return TI[e]}function eC(e,t,n){return e?e.offset(t,n):void 0}function tC(e,t,n){return eC(Cu(e),t,n)}function nC(e,t,n){return eC($u(e),t,n)}function iC(e,t,n,i){return e?e.range(t,n,i):void 0}function rC(e,t,n,i){return iC(Cu(e),t,n,i)}function sC(e,t,n,i){return iC($u(e),t,n,i)}const xc=1e3,wc=xc*60,Ec=wc*60,jh=Ec*24,NI=jh*7,oC=jh*30,Sy=jh*365,aC=[Pt,Vt,Nn,ei,ti,gi,Li],Ac=aC.slice(0,-1),_c=Ac.slice(0,-1),Sc=_c.slice(0,-1),RI=Sc.slice(0,-1),PI=[Pt,vt],uC=[Pt,Vt],lC=[Pt],Oc=[[Ac,1,xc],[Ac,5,5*xc],[Ac,15,15*xc],[Ac,30,30*xc],[_c,1,wc],[_c,5,5*wc],[_c,15,15*wc],[_c,30,30*wc],[Sc,1,Ec],[Sc,3,3*Ec],[Sc,6,6*Ec],[Sc,12,12*Ec],[RI,1,jh],[PI,1,NI],[uC,1,oC],[uC,3,3*oC],[lC,1,Sy]];function cC(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(fc(t))/n;let r=hc(a=>a[2]).right(Oc,i),s,o;return r===Oc.length?(s=lC,o=Bs(t[0]/Sy,t[1]/Sy,n)):r?(r=Oc[i/Oc[r-1][2]<Oc[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=aC,o=Math.max(Bs(t[0],t[1],n),1)),{units:s,step:o}}function Oy(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Cy(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Cc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function fC(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=$c(r),c=jc(r),f=$c(s),h=jc(s),g=$c(o),p=jc(o),m=$c(a),y=jc(a),x=$c(u),w=jc(u),E={a:B,A:W,b:X,B:ce,c:null,d:yC,e:yC,f:oB,g:mB,G:bB,H:iB,I:rB,j:sB,L:bC,m:aB,M:uB,p:Te,q:$e,Q:_C,s:SC,S:lB,u:cB,U:fB,V:dB,w:hB,W:gB,x:null,X:null,y:pB,Y:yB,Z:vB,"%":AC},A={a:it,A:He,b:lt,B:cn,c:null,d:xC,e:xC,f:AB,g:MB,G:NB,H:xB,I:wB,j:EB,L:wC,m:_B,M:SB,p:Di,q:fi,Q:_C,s:SC,S:OB,u:CB,U:$B,V:jB,w:kB,W:FB,x:null,X:null,y:DB,Y:TB,Z:RB,"%":AC},S={a:$,A:k,b:M,B:D,c:I,d:pC,e:pC,f:ZI,g:gC,G:hC,H:mC,I:mC,j:XI,L:JI,m:VI,M:QI,p:j,q:YI,Q:tB,s:nB,S:KI,u:zI,U:qI,V:HI,w:UI,W:WI,x:F,X:L,y:gC,Y:hC,Z:GI,"%":eB};E.x=O(n,E),E.X=O(i,E),E.c=O(t,E),A.x=O(n,A),A.X=O(i,A),A.c=O(t,A);function O(V,le){return function(me){var z=[],ht=-1,we=0,bt=V.length,ct,Ms,Kr;for(me instanceof Date||(me=new Date(+me));++ht<bt;)V.charCodeAt(ht)===37&&(z.push(V.slice(we,ht)),(Ms=dC[ct=V.charAt(++ht)])!=null?ct=V.charAt(++ht):Ms=ct==="e"?" ":"0",(Kr=le[ct])&&(ct=Kr(me,Ms)),z.push(ct),we=ht+1);return z.push(V.slice(we,ht)),z.join("")}}function _(V,le){return function(me){var z=Cc(1900,void 0,1),ht=C(z,V,me+="",0),we,bt;if(ht!=me.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(le&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(we=Cy(Cc(z.y,0,1)),bt=we.getUTCDay(),we=bt>4||bt===0?my.ceil(we):my(we),we=Hs.offset(we,(z.V-1)*7),z.y=we.getUTCFullYear(),z.m=we.getUTCMonth(),z.d=we.getUTCDate()+(z.w+6)%7):(we=Oy(Cc(z.y,0,1)),bt=we.getDay(),we=bt>4||bt===0?hy.ceil(we):hy(we),we=zs.offset(we,(z.V-1)*7),z.y=we.getFullYear(),z.m=we.getMonth(),z.d=we.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),bt="Z"in z?Cy(Cc(z.y,0,1)).getUTCDay():Oy(Cc(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(bt+5)%7:z.w+z.U*7-(bt+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,Cy(z)):Oy(z)}}function C(V,le,me,z){for(var ht=0,we=le.length,bt=me.length,ct,Ms;ht<we;){if(z>=bt)return-1;if(ct=le.charCodeAt(ht++),ct===37){if(ct=le.charAt(ht++),Ms=S[ct in dC?le.charAt(ht++):ct],!Ms||(z=Ms(V,me,z))<0)return-1}else if(ct!=me.charCodeAt(z++))return-1}return z}function j(V,le,me){var z=l.exec(le.slice(me));return z?(V.p=c.get(z[0].toLowerCase()),me+z[0].length):-1}function $(V,le,me){var z=g.exec(le.slice(me));return z?(V.w=p.get(z[0].toLowerCase()),me+z[0].length):-1}function k(V,le,me){var z=f.exec(le.slice(me));return z?(V.w=h.get(z[0].toLowerCase()),me+z[0].length):-1}function M(V,le,me){var z=x.exec(le.slice(me));return z?(V.m=w.get(z[0].toLowerCase()),me+z[0].length):-1}function D(V,le,me){var z=m.exec(le.slice(me));return z?(V.m=y.get(z[0].toLowerCase()),me+z[0].length):-1}function I(V,le,me){return C(V,t,le,me)}function F(V,le,me){return C(V,n,le,me)}function L(V,le,me){return C(V,i,le,me)}function B(V){return o[V.getDay()]}function W(V){return s[V.getDay()]}function X(V){return u[V.getMonth()]}function ce(V){return a[V.getMonth()]}function Te(V){return r[+(V.getHours()>=12)]}function $e(V){return 1+~~(V.getMonth()/3)}function it(V){return o[V.getUTCDay()]}function He(V){return s[V.getUTCDay()]}function lt(V){return u[V.getUTCMonth()]}function cn(V){return a[V.getUTCMonth()]}function Di(V){return r[+(V.getUTCHours()>=12)]}function fi(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var le=O(V+="",E);return le.toString=function(){return V},le},parse:function(V){var le=_(V+="",!1);return le.toString=function(){return V},le},utcFormat:function(V){var le=O(V+="",A);return le.toString=function(){return V},le},utcParse:function(V){var le=_(V+="",!0);return le.toString=function(){return V},le}}}var dC={"-":"",_:" ","0":"0"},jt=/^\s*\d+/,LI=/^%/,II=/[\\^$*+?|[\]().{}]/g;function ke(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function BI(e){return e.replace(II,"\\$&")}function $c(e){return new RegExp("^(?:"+e.map(BI).join("|")+")","i")}function jc(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function UI(e,t,n){var i=jt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function zI(e,t,n){var i=jt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function qI(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function HI(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function WI(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function hC(e,t,n){var i=jt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function gC(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function GI(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function YI(e,t,n){var i=jt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function VI(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function pC(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function XI(e,t,n){var i=jt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function mC(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function QI(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function KI(e,t,n){var i=jt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function JI(e,t,n){var i=jt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function ZI(e,t,n){var i=jt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function eB(e,t,n){var i=LI.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function tB(e,t,n){var i=jt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function nB(e,t,n){var i=jt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function yC(e,t){return ke(e.getDate(),t,2)}function iB(e,t){return ke(e.getHours(),t,2)}function rB(e,t){return ke(e.getHours()%12||12,t,2)}function sB(e,t){return ke(1+zs.count(qs(e),e),t,3)}function bC(e,t){return ke(e.getMilliseconds(),t,3)}function oB(e,t){return bC(e,t)+"000"}function aB(e,t){return ke(e.getMonth()+1,t,2)}function uB(e,t){return ke(e.getMinutes(),t,2)}function lB(e,t){return ke(e.getSeconds(),t,2)}function cB(e){var t=e.getDay();return t===0?7:t}function fB(e,t){return ke(mc.count(qs(e)-1,e),t,2)}function vC(e){var t=e.getDay();return t>=4||t===0?yc(e):yc.ceil(e)}function dB(e,t){return e=vC(e),ke(yc.count(qs(e),e)+(qs(e).getDay()===4),t,2)}function hB(e){return e.getDay()}function gB(e,t){return ke(hy.count(qs(e)-1,e),t,2)}function pB(e,t){return ke(e.getFullYear()%100,t,2)}function mB(e,t){return e=vC(e),ke(e.getFullYear()%100,t,2)}function yB(e,t){return ke(e.getFullYear()%1e4,t,4)}function bB(e,t){var n=e.getDay();return e=n>=4||n===0?yc(e):yc.ceil(e),ke(e.getFullYear()%1e4,t,4)}function vB(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ke(t/60|0,"0",2)+ke(t%60,"0",2)}function xC(e,t){return ke(e.getUTCDate(),t,2)}function xB(e,t){return ke(e.getUTCHours(),t,2)}function wB(e,t){return ke(e.getUTCHours()%12||12,t,2)}function EB(e,t){return ke(1+Hs.count(Ws(e),e),t,3)}function wC(e,t){return ke(e.getUTCMilliseconds(),t,3)}function AB(e,t){return wC(e,t)+"000"}function _B(e,t){return ke(e.getUTCMonth()+1,t,2)}function SB(e,t){return ke(e.getUTCMinutes(),t,2)}function OB(e,t){return ke(e.getUTCSeconds(),t,2)}function CB(e){var t=e.getUTCDay();return t===0?7:t}function $B(e,t){return ke(bc.count(Ws(e)-1,e),t,2)}function EC(e){var t=e.getUTCDay();return t>=4||t===0?vc(e):vc.ceil(e)}function jB(e,t){return e=EC(e),ke(vc.count(Ws(e),e)+(Ws(e).getUTCDay()===4),t,2)}function kB(e){return e.getUTCDay()}function FB(e,t){return ke(my.count(Ws(e)-1,e),t,2)}function DB(e,t){return ke(e.getUTCFullYear()%100,t,2)}function MB(e,t){return e=EC(e),ke(e.getUTCFullYear()%100,t,2)}function TB(e,t){return ke(e.getUTCFullYear()%1e4,t,4)}function NB(e,t){var n=e.getUTCDay();return e=n>=4||n===0?vc(e):vc.ceil(e),ke(e.getUTCFullYear()%1e4,t,4)}function RB(){return"+0000"}function AC(){return"%"}function _C(e){return+e}function SC(e){return Math.floor(+e/1e3)}var ju,$y,OC,jy,CC;PB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function PB(e){return ju=fC(e),$y=ju.format,OC=ju.parse,jy=ju.utcFormat,CC=ju.utcParse,ju}function kc(e){const t={};return n=>t[n]||(t[n]=e(n))}function LB(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=IB(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function IB(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function $C(e){const t=kc(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Su(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return LB(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=Su(o==null?",f":o);const a=Bs(i,r,s),u=Math.max(Math.abs(i),Math.abs(r));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=LO(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=IO(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=PO(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let ky;jC();function jC(){return ky=$C({format:Oh,formatPrefix:ry})}function kC(e){return $C(RO(e))}function kh(e){return arguments.length?ky=kC(e):ky}function FC(e,t,n){n=n||{},fe(n)||P("Invalid time multi-format specifier: ".concat(n));const i=t(gi),r=t(ti),s=t(ei),o=t(Nn),a=t(vt),u=t(Vt),l=t(Tn),c=t(Pt),f=e(n[Li]||".%L"),h=e(n[gi]||":%S"),g=e(n[ti]||"%I:%M"),p=e(n[ei]||"%I %p"),m=e(n[Nn]||n[Xt]||"%a %d"),y=e(n[vt]||"%b %d"),x=e(n[Vt]||"%B"),w=e(n[Tn]||"%B"),E=e(n[Pt]||"%Y");return A=>(i(A)<A?f:r(A)<A?h:s(A)<A?g:o(A)<A?p:u(A)<A?a(A)<A?m:y:c(A)<A?l(A)<A?x:w:E)(A)}function DC(e){const t=kc(e.format),n=kc(e.utcFormat);return{timeFormat:i=>Oe(i)?t(i):FC(t,Cu,i),utcFormat:i=>Oe(i)?n(i):FC(n,$u,i),timeParse:kc(e.parse),utcParse:kc(e.utcParse)}}let Fy;MC();function MC(){return Fy=DC({format:$y,parse:OC,utcFormat:jy,utcParse:CC})}function TC(e){return DC(fC(e))}function Fc(e){return arguments.length?Fy=TC(e):Fy}const Dy=(e,t)=>pe({},e,t);function NC(e,t){const n=e?kC(e):kh(),i=t?TC(t):Fc();return Dy(n,i)}function My(e,t){const n=arguments.length;return n&&n!==2&&P("defaultLocale expects either zero or two arguments."),n?Dy(kh(e),Fc(t)):Dy(kh(),Fc())}function BB(){return jC(),MC(),My()}const UB=/^(data:|([A-Za-z]+:)?\/\/)/,zB=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,qB=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,RC="file://";function HB(e,t){return n=>({options:n||{},sanitize:GB,load:WB,fileAccess:!!t,file:YB(t),http:XB(e)})}async function WB(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function GB(e,t){t=pe({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=zB.test(e.replace(qB,""));(e==null||typeof e!="string"||!a)&&P("Sanitize failure, invalid URI: "+ie(e));const u=UB.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(RC))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(RC.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function YB(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):VB}async function VB(){P("No file system access.")}function XB(e){return e?async function(t,n){const i=pe({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?ye(s[r])?s[r]():s.text():P(s.status+""+s.statusText)}:QB}async function QB(){P("No HTTP fetch method available.")}const KB=e=>e!=null&&e===e,JB=e=>e==="true"||e==="false"||e===!0||e===!1,ZB=e=>!Number.isNaN(Date.parse(e)),PC=e=>!Number.isNaN(+e)&&!(e instanceof Date),eU=e=>PC(e)&&Number.isInteger(+e),Ty={boolean:W1,integer:Gt,number:Gt,date:G1,string:Y1,unknown:hn},Fh=[JB,eU,PC,ZB],tU=["boolean","integer","number","date"];function LC(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=Fh.length,r=Fh.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&KB(u)&&!Fh[a](u)&&(r[a]=0,++o,o===Fh.length))return"string";return tU[r.reduce((s,o)=>s===0?o:s,0)-1]}function IC(e,t){return t.reduce((n,i)=>(n[i]=LC(e,i),n),{})}function BC(e){const t=function(n,i){const r={delimiter:e};return Ny(n,i?pe(i,r):r)};return t.responseType="text",t}function Ny(e,t){return t.header&&(e=t.header.map(ie).join(t.delimiter)+`
`+e),zL(t.delimiter).parse(e+"")}Ny.responseType="text";function nU(e){return typeof Buffer=="function"&&ye(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Ry(e,t){const n=t&&t.property?Dn(t.property):hn;return fe(e)&&!nU(e)?iU(n(e),t):n(JSON.parse(e))}Ry.responseType="json";function iU(e,t){return!Z(e)&&cO(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const rU={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function UC(e,t){let n,i,r,s;return e=Ry(e,t),t&&t.feature?(n=GL,r=t.feature):t&&t.mesh?(n=VL,r=t.mesh,s=rU[t.filter]):P("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):P("Invalid TopoJSON object: "+r),i&&i.features||[i]}UC.responseType="json";const Dh={dsv:Ny,csv:BC(","),tsv:BC("	"),json:Ry,topojson:UC};function Py(e,t){return arguments.length>1?(Dh[e]=t,this):ue(Dh,e)?Dh[e]:null}function zC(e){const t=Py(e);return t&&t.responseType||"text"}function qC(e,t,n,i){t=t||{};const r=Py(t.type||"json");return r||P("Unknown data format type: "+t.type),e=r(e,t),t.parse&&sU(e,t.parse,n,i),ue(e,"columns")&&delete e.columns,e}function sU(e,t,n,i){if(!e.length)return;const r=Fc();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=IC(e,s)),s=Object.keys(t);const h=s.map(g=>{const p=t[g];let m,y;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return m=p.split(/:(.+)?/,2),y=m[1],(y[0]==="'"&&y[y.length-1]==="'"||y[0]==='"'&&y[y.length-1]==='"')&&(y=y.slice(1,-1)),(m[0]==="utc"?i:n)(y);if(!Ty[p])throw Error("Illegal format pattern: "+g+":"+p);return Ty[p]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=h[l](o[a])}const Mh=HB(typeof fetch!="undefined"&&fetch,null);function Th(e){const t=e||hn,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function Nh(e,t){try{await t(e)}catch(n){e.error(n)}}const HC=Symbol("vega_id");let oU=1;function Rh(e){return!!(e&&ee(e))}function ee(e){return e[HC]}function WC(e,t){return e[HC]=t,e}function Ne(e){const t=e===Object(e)?e:{data:e};return ee(t)?t:WC(t,oU++)}function Ly(e){return Ph(e,Ne({}))}function Ph(e,t){for(const n in e)t[n]=e[n];return t}function GC(e,t){return WC(t,ee(e))}function sa(e,t){return e?t?(n,i)=>e(n,i)||ee(t(n))-ee(t(i)):(n,i)=>e(n,i)||ee(n)-ee(i):null}function YC(e){return e&&e.constructor===oa}function oa(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:oa,insert(a){const u=ae(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=ye(a)?i:t,l=ae(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:Yt(l)};return ye(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return ye(a)?r.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,u){const l={},c={};let f,h,g,p,m,y;for(f=0,h=u.length;f<h;++f)l[ee(u[f])]=1;for(f=0,h=t.length;f<h;++f)m=t[f],l[ee(m)]=-1;for(f=0,h=i.length;f<h;++f)p=i[f],u.forEach(w=>{p(w)&&(l[ee(w)]=-1)});for(f=0,h=e.length;f<h;++f)m=e[f],y=ee(m),l[y]?l[y]=1:a.add.push(Ne(e[f]));for(f=0,h=u.length;f<h;++f)m=u[f],l[ee(m)]<0&&a.rem.push(m);function x(w,E,A){A?w[E]=A(w):a.encode=E,o||(c[ee(w)]=w)}for(f=0,h=n.length;f<h;++f)g=n[f],m=g.tuple,p=g.field,y=l[ee(m)],y>0&&(x(m,p,g.value),a.modifies(p));for(f=0,h=r.length;f<h;++f)g=r[f],p=g.filter,u.forEach(w=>{p(w)&&l[ee(w)]>0&&x(w,g.field,g.value)}),a.modifies(g.field);if(o)a.mod=t.length||i.length?u.filter(w=>l[ee(w)]>0):u.slice();else for(y in c)a.mod.push(c[y]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const Lh="_:mod:_";function Ih(){Object.defineProperty(this,Lh,{writable:!0,value:{}})}Ih.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[Lh];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=Z(n)?1+n.length:-1),r},modified(e,t){const n=this[Lh];if(arguments.length){if(Z(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Lh]={},this}};let aU=0;const uU="pulse",lU=new Ih,cU=1,fU=2;function We(e,t,n,i){this.id=++aU,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function VC(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}We.prototype={targets(){return this._targets||(this._targets=Th(uc))},set(e){return this.value!==e?(this.value=e,1):0},skip:VC(cU),modified:VC(fU),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Ih,r=this._argops=this._argops||[],s=[];let o,a,u,l;const c=(f,h,g)=>{g instanceof We?(g!==this&&(t&&g.targets().add(this),s.push(g)),r.push({op:g,name:f,index:h})):i.set(f,h,g)};for(o in e)if(a=e[o],o===uU)ae(a).forEach(f=>{f instanceof We?f!==this&&(f.targets().add(this),s.push(f)):P("Pulse parameters must be operator instances.")}),this.source=a;else if(Z(a))for(i.set(o,-1,Array(u=a.length)),l=0;l<u;++l)c(o,l,a[l]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||lU,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function dU(e,t,n,i){let r=1,s;return e instanceof We?s=e:e&&e.prototype instanceof We?s=new e:ye(e)?s=new We(null,e):(r=0,s=new We(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function hU(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let gU=0;function Bh(e,t,n){this.id=++gU,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Gs(e,t,n){return new Bh(e,t,n)}Bh.prototype={_filter:di,_apply:hn,targets(){return this._targets||(this._targets=Th(uc))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Gs(e);return this.targets().add(t),t},apply(e){const t=Gs(null,e);return this.targets().add(t),t},merge(){const e=Gs();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Gs();return this.targets().add(Gs(null,null,z1(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(Gs(null,null,()=>n=!0)),t.targets().add(Gs(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=di,this._targets=null}};function pU(e,t,n,i){const r=this,s=Gs(n,i),o=function(l){l.dataflow=r;try{s.receive(l)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document!="undefined"?a=document.querySelectorAll(e):a=ae(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,o);return s}function mU(e,t){const n=this.locale();return qC(e,t,n.timeParse,n.utcParse)}function yU(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function bU(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:zC(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function vU(e,t,n){const i=this,r=i._pending||xU(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(di).insert(s.data||[])),r.done(),s}function xU(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const wU={skip:!0};function EU(e,t,n,i,r){return(e instanceof We?_U:AU)(this,e,t,n,i,r),this}function AU(e,t,n,i,r,s){const o=pe({},s,wU);let a,u;ye(n)||(n=Yt(n)),i===void 0?a=l=>e.touch(n(l)):ye(i)?(u=new We(null,i,r,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;YC(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=l=>e.update(n(l),i,o),t.apply(a)}function _U(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new We(null,SU(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function SU(e,t){return t=ye(t)?t:Yt(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function OU(e){e.rank=++this._rank}function CU(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&P("Cycle detected in dataflow graph.")}const Uh={},dr=1<<0,Ys=1<<1,ns=1<<2,$U=dr|Ys,XC=dr|ns,ku=dr|Ys|ns,QC=1<<3,Dc=1<<4,KC=1<<5,JC=1<<6;function Vs(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Iy(e,t){const n=[];return Is(e,t,i=>n.push(i)),n}function ZC(e,t){const n={};return e.visit(t,i=>{n[ee(i)]=1}),i=>n[ee(i)]?null:i}function zh(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}Vs.prototype={StopPropagation:Uh,ADD:dr,REM:Ys,MOD:ns,ADD_REM:$U,ADD_MOD:XC,ALL:ku,REFLOW:QC,SOURCE:Dc,NO_SOURCE:KC,NO_FIELDS:JC,fork(e){return new Vs(this.dataflow).init(this,e)},clone(){const e=this.fork(ku);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(ku|Dc)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Vs(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&JC)&&(n.fields=e.fields),t&dr?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Ys?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&ns?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&KC?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||ku;return t&dr&&this.add.length||t&Ys&&this.rem.length||t&ns&&this.mod.length},reflow(e){if(e)return this.fork(ku).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(ns,ZC(this,dr))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Z(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Z(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&dr&&(n.addF=zh(n.addF,t)),e&Ys&&(n.remF=zh(n.remF,t)),e&ns&&(n.modF=zh(n.modF,t)),e&Dc&&(n.srcF=zh(n.srcF,t)),n},materialize(e){e=e||ku;const t=this;return e&dr&&t.addF&&(t.add=Iy(t.add,t.addF),t.addF=null),e&Ys&&t.remF&&(t.rem=Iy(t.rem,t.remF),t.remF=null),e&ns&&t.modF&&(t.mod=Iy(t.mod,t.modF),t.modF=null),e&Dc&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&Dc)return Is(n.source,n.srcF,i),n;e&dr&&Is(n.add,n.addF,i),e&Ys&&Is(n.rem,n.remF,i),e&ns&&Is(n.mod,n.modF,i);const r=n.source;if(e&QC&&r){const s=n.add.length+n.mod.length;s===r.length||(s?Is(r,ZC(n,XC),i):Is(r,n.srcF,i))}return n}};function By(e,t,n,i){const r=this,s=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let a=0;a<s;++a){const u=n[a];if(u.stamp===t){if(u.fields){const l=r.fields||(r.fields={});for(const c in u.fields)l[c]=1}u.changed(r.ADD)&&(o|=r.ADD),u.changed(r.REM)&&(o|=r.REM),u.changed(r.MOD)&&(o|=r.MOD)}}this.changes=o}H(By,Vs,{fork(e){const t=new Vs(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Z(e)?e.some(i=>n[i]):n[e]:0},filter(){P("MultiPulse does not support filtering.")},materialize(){P("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function jU(e,t,n){const i=this,r=[];if(i._pulse)return e$(i);if(i._pending&&await i._pending,t&&await Nh(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new Vs(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=Th(uc);let o=0,a,u,l;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}u=a.run(i._getPulse(a,e)),u.then?u=await u:u.async&&(r.push(u.async),u=Uh),u!==Uh&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,h)=>h.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Nh(i,c[f].callback)}return n&&await Nh(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(h){i.error(h)}})})),i}async function kU(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function FU(e,t,n){return this._pulse?e$(this):(this.evaluate(e,t,n),this)}function DU(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function e$(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function MU(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function TU(e,t){const n=e.source,i=this._clock;return n&&Z(n)?new By(this,i,n.map(r=>r.pulse),t):this._input[e.id]||NU(this._pulse,n&&n.pulse)}function NU(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Uh&&(e.source=t.source),e)}const Uy={skip:!1,force:!1};function RU(e,t){const n=t||Uy;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function PU(e,t,n){const i=n||Uy;return(e.set(t)||i.force)&&this.touch(e,i),this}function LU(e,t,n){this.touch(e,n||Uy);const i=new Vs(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function IU(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),t$(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,BU(t,0,e)):i=n,i}}}function t$(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function BU(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,t$(e,i,t,n)}function Fu(){this.logger(XS()),this.logLevel(P1),this._clock=0,this._rank=0,this._locale=My();try{this._loader=Mh()}catch{}this._touched=Th(uc),this._input={},this._pulse=null,this._heap=IU((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Mc(e){return function(){return this._log[e].apply(this,arguments)}}Fu.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Mc("error"),warn:Mc("warn"),info:Mc("info"),debug:Mc("debug"),logLevel:Mc("level"),cleanThreshold:1e4,add:dU,connect:hU,rank:OU,rerank:CU,pulse:LU,touch:RU,update:PU,changeset:oa,ingest:yU,parse:mU,preload:vU,request:bU,events:pU,on:EU,evaluate:jU,run:FU,runAsync:kU,runAfter:DU,_enqueue:MU,_getPulse:TU};function T(e,t){We.call(this,e,null,t)}H(T,We,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Du={};function n$(e){const t=i$(e);return t&&t.Definition||null}function i$(e){return e=e&&e.toLowerCase(),ue(Du,e)?Du[e]:null}function*r$(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function zy(e,t,n){const i=Float64Array.from(r$(e,n));return i.sort(Au),t.map(r=>OO(i,r))}function qy(e,t){return zy(e,[.25,.5,.75],t)}function Hy(e,t){const n=e.length,i=tI(e,t),r=qy(e,t),s=(r[2]-r[0])/1.34,o=Math.min(i,s)||i||Math.abs(r[0])||1;return 1.06*o*Math.pow(n,-.2)}function s$(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,h;const g=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=g/t,f=0,h=e.steps.length;f<h&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(g)/i)-u));Math.ceil(g/a)>t;)a*=n;for(f=0,h=r.length;f<h;++f)c=a/r[f],c>=l&&g/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/i)+1,m=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+m)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var pi=Math.random;function UU(e){pi=e}function o$(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(r$(e,i)),s=r.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=r[~~(pi()*s)];c[l]=a/s}return c.sort(Au),[ny(c,n/2),ny(c,1-n/2)]}function a$(e,t,n,i){i=i||(h=>h);const r=e.length,s=new Float64Array(r);let o=0,a=1,u=i(e[0]),l=u,c=u+t,f;for(;a<r;++a){if(f=i(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?zU(s,t+t/4):s}function zU(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}function qU(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function HU(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample(){return n+Math.floor(r*pi())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return s.min(e).max(t)}const u$=Math.sqrt(2*Math.PI),WU=Math.SQRT2;let Tc=NaN;function qh(e,t){e=e||0,t=t==null?1:t;let n=0,i=0,r,s;if(Tc===Tc)n=Tc,Tc=NaN;else{do n=pi()*2-1,i=pi()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,Tc=i*s}return e+n*t}function Wy(e,t,n){n=n==null?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*u$)}function Hh(e,t,n){t=t||0,n=n==null?1:n;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function Wh(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*WU*GU(2*e-1)}function GU(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Gy(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s==null?1:s,r):i},sample:()=>qh(n,i),pdf:s=>Wy(s,n,i),cdf:s=>Hh(s,n,i),icdf:s=>Wh(s,n,i)};return r.mean(e).stdev(t)}function Yy(e,t){const n=Gy();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=Hy(e)),r):t},sample(){return e[~~(pi()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function Vy(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+qh()*t)}function Xy(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*u$*e)}function Qy(e,t,n){return Hh(Math.log(e),t,n)}function Ky(e,t,n){return Math.exp(Wh(e,t,n))}function l$(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s==null?1:s,r):i},sample:()=>Vy(n,i),pdf:s=>Xy(s,n,i),cdf:s=>Qy(s,n,i),icdf:s=>Ky(s,n,i)};return r.mean(e).stdev(t)}function c$(e,t){let n=0,i;function r(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=pi();let a=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function Jy(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*pi()}function Zy(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function eb(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function tb(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function f$(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s==null?1:s,r):i},sample:()=>Jy(n,i),pdf:s=>Zy(s,n,i),cdf:s=>eb(s,n,i),icdf:s=>tb(s,n,i)};return t==null&&(t=e==null?1:e,e=0),r.min(e).max(t)}function Nc(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function Gh(e,t,n,i){e=e.filter(g=>{let p=t(g),m=n(g);return p!=null&&(p=+p)>=p&&m!=null&&(m=+m)>=m}),i&&e.sort((g,p)=>t(g)-t(p));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,u=0,l=0,c,f,h;for(h of e)s[a]=c=+t(h),o[a]=f=+n(h),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<r;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function Rc(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function Mu(e,t,n,i,r){let s=0,o=0;return Rc(e,t,n,(a,u)=>{const l=u-r(a),c=u-i;s+=l*l,o+=c*c}),1-s/o}function nb(e,t,n){let i=0,r=0,s=0,o=0,a=0;Rc(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=Nc(i,r,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Mu(e,t,n,r,l)}}function d$(e,t,n){let i=0,r=0,s=0,o=0,a=0;Rc(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=Nc(i,r,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Mu(e,t,n,r,l)}}function h$(e,t,n){const[i,r,s,o]=Gh(e,t,n);let a=0,u=0,l=0,c=0,f=0,h,g,p;Rc(e,t,n,(w,E)=>{h=i[f++],g=Math.log(E),p=h*E,a+=(E*g-a)/f,u+=(p-u)/f,l+=(p*g-l)/f,c+=(h*p-c)/f});const[m,y]=Nc(u/o,a/o,l/o,c/o),x=w=>Math.exp(m+y*(w-s));return{coef:[Math.exp(m-y*s),y],predict:x,rSquared:Mu(e,t,n,o,x)}}function g$(e,t,n){let i=0,r=0,s=0,o=0,a=0,u=0;Rc(e,t,n,(f,h)=>{const g=Math.log(f),p=Math.log(h);++u,i+=(g-i)/u,r+=(p-r)/u,s+=(g*p-s)/u,o+=(g*g-o)/u,a+=(h-a)/u});const l=Nc(i,r,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Mu(e,t,n,a,c)}}function ib(e,t,n){const[i,r,s,o]=Gh(e,t,n),a=i.length;let u=0,l=0,c=0,f=0,h=0,g,p,m,y;for(g=0;g<a;)p=i[g],m=r[g++],y=p*p,u+=(y-u)/g,l+=(y*p-l)/g,c+=(y*y-c)/g,f+=(p*m-f)/g,h+=(y*m-h)/g;const x=c-u*u,w=u*x-l*l,E=(h*u-f*l)/w,A=(f*x-h*l)/w,S=-E*u,O=_=>(_=_-s,E*_*_+A*_+S+o);return{coef:[S-A*s+E*s*s+o,A-2*E*s,E],predict:O,rSquared:Mu(e,t,n,o,O)}}function p$(e,t,n,i){if(i===1)return nb(e,t,n);if(i===2)return ib(e,t,n);const[r,s,o,a]=Gh(e,t,n),u=r.length,l=[],c=[],f=i+1;let h,g,p,m,y;for(h=0;h<f;++h){for(p=0,m=0;p<u;++p)m+=Math.pow(r[p],h)*s[p];for(l.push(m),y=new Float64Array(f),g=0;g<f;++g){for(p=0,m=0;p<u;++p)m+=Math.pow(r[p],h+g);y[g]=m}c.push(y)}c.push(l);const x=VU(c),w=E=>{E-=o;let A=a+x[0]+x[1]*E+x[2]*E*E;for(h=3;h<f;++h)A+=x[h]*Math.pow(E,h);return A};return{coef:YU(f,x,-o,a),predict:w,rSquared:Mu(e,t,n,a,w)}}function YU(e,t,n,i){const r=Array(e);let s,o,a,u;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,r[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*u;return r[0]+=i,r}function VU(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const m$=2,y$=1e-12;function b$(e,t,n,i){const[r,s,o,a]=Gh(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),h=new Float64Array(u).fill(1);for(let g=-1;++g<=m$;){const p=[0,l-1];for(let y=0;y<u;++y){const x=r[y],w=p[0],E=p[1],A=x-r[w]>r[E]-x?w:E;let S=0,O=0,_=0,C=0,j=0;const $=1/Math.abs(r[A]-x||1);for(let D=w;D<=E;++D){const I=r[D],F=s[D],L=XU(Math.abs(x-I)*$)*h[D],B=I*L;S+=L,O+=B,_+=F*L,C+=F*B,j+=I*B}const[k,M]=Nc(O/S,_/S,C/S,j/S);c[y]=k+M*x,f[y]=Math.abs(s[y]-c[y]),QU(r,y+1,p)}if(g===m$)break;const m=CO(f);if(Math.abs(m)<y$)break;for(let y=0,x,w;y<u;++y)x=f[y]/(6*m),h[y]=x>=1?y$:(w=1-x*x)*w}return KU(r,c,o,a)}function XU(e){return(e=1-e*e*e)*e*e}function QU(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function KU(e,t,n,i){const r=e.length,s=[];let o=0,a=0,u=[],l;for(;o<r;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=i,u=[l,t[o]],s.push(u));return u[1]+=i,s}const JU=.5*Math.PI/180;function Yh(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=m=>[m,e(m)],s=t[0],o=t[1],a=o-s,u=a/i,l=[r(s)],c=[];if(n===i){for(let m=1;m<i;++m)l.push(r(s+m/n*a));return l.push(r(o)),l}else{c.push(r(o));for(let m=n;--m>0;)c.push(r(s+m/n*a))}let f=l[0],h=c[c.length-1];const g=1/a,p=ZU(f[1],c);for(;h;){const m=r((f[0]+h[0])/2);m[0]-f[0]>=u&&ez(f,m,h,g,p)>JU?c.push(m):(f=h,l.push(h),c.pop()),h=c[c.length-1]}return l}function ZU(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function ez(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function tz(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function rb(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:tz(e)}function v$(e,t,n){return n||e+(t?"_"+t:"")}const sb=()=>{},nz={init:sb,add:sb,rem:sb,idx:0},Pc={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Lc=Object.keys(Pc);function iz(e,t){return n=>pe({name:e,out:n||e},nz,t)}Lc.forEach(e=>{Pc[e]=iz(e,Pc[e])});function x$(e,t){return Pc[e](t)}function w$(e,t){return e.idx-t.idx}function rz(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=Pc[r]())})};return e.forEach(n),Object.values(t).sort(w$)}function sz(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function oz(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function az(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function uz(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function E$(e,t){const n=t||hn,i=rz(e),r=e.slice().sort(w$);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=sz,s.prototype.add=oz,s.prototype.rem=az,s.prototype.set=uz,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function ob(e){this._key=e?Dn(e):ee,this.reset()}const Lt=ob.prototype;Lt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Lt.add=function(e){this._add.push(e)};Lt.rem=function(e){this._rem.push(e)};Lt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,u,l;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,u=0;a<i;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};Lt.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",ue(n,s)||(n[s]=1,++r);return r};Lt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=uO(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Lt.argmin=function(e){return this.extent(e)[0]||{}};Lt.argmax=function(e){return this.extent(e)[1]||{}};Lt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Lt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Lt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=qy(this.values(),e),this._get=e),this._q};Lt.q1=function(e){return this.quartile(e)[0]};Lt.q2=function(e){return this.quartile(e)[1]};Lt.q3=function(e){return this.quartile(e)[2]};Lt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=o$(this.values(),1e3,.05,e),this._get=e),this._ci};Lt.ci0=function(e){return this.ci(e)[0]};Lt.ci1=function(e){return this.ci(e)[1]};function Xs(e){T.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Xs.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Lc},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};H(Xs,T,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){const c=n[l],f=i[l++];for(const h in f){const g=a?a+"|"+h:h;u[c]=f[h],l<r?o(g,u,l):t[g]||e.cell(g,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(y){const x=ae(Wt(y)),w=x.length;let E=0,A;for(;E<w;++E)i[A=x[E]]||(i[A]=1,t.push(A))}this._dims=ae(e.groupby),this._dnames=this._dims.map(y=>{const x=st(y);return r(y),n.push(x),x}),this.cellkey=e.key?e.key:rb(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],u=s.length,l={};let c,f,h,g,p,m;for(u!==o.length&&P("Unmatched number of fields and aggregate ops."),m=0;m<u;++m){if(c=s[m],f=o[m],c==null&&f!=="count"&&P("Null aggregate field specified."),g=st(c),p=v$(f,g,a[m]),n.push(p),f==="count"){this._counts.push(p);continue}h=l[g],h||(r(c),h=l[g]=[],h.field=c,this._measures.push(h)),f!=="count"&&(this._countOnly=!1),h.push(x$(f,p))}return this._measures=this._measures.map(y=>E$(y,y.field)),{}},cellkey:rb(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new ob),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?GC(t.tuple,s):Ne(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const lz=1e-14;function ab(e){T.call(this,null,e)}ab.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};H(ab,T,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Wt(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[a]=f,c[u]=f==null?null:r+s*(1+(f-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=s$(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const u=function(l){let c=Gt(t(l));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(lz+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=Fn(u,Wt(t),e.name||"bin_"+st(t))}});function A$(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:u=>s.push(u),remove:u=>o[i(u)]=++a,size:()=>r.length,data:(u,l)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),l&&u&&r.sort(u),s.length&&(r=u?gO(u,r,s.sort(u)):r.concat(s),s=[]),r)}}function ub(e){T.call(this,[],e)}ub.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};H(ub,T,{transform(e,t){const n=t.fork(t.ALL),i=A$(ee,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(sa(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function _$(e){We.call(this,null,cz,e)}H(_$,We);function cz(e){return this.value&&!e.modified()?this.value:U1(e.fields,e.orders)}function lb(e){T.call(this,null,e)}lb.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function fz(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}H(lb,T,{transform(e,t){const n=f=>h=>{for(var g=fz(a(h),e.case,s)||[],p,m=0,y=g.length;m<y;++m)o.test(p=g[m])||f(p)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=i[a],l=n[a]||0,!u&&l?(i[a]=u=Ne({}),u[r]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,i[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)}});function cb(e){T.call(this,null,e)}cb.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};H(cb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=dz(a,r,s,e.filter||di)):n.mod=a,n.source=this.value,n.modifies(i)}});function dz(e,t,n,i){for(var r=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],i(s)&&(r.push(Ne(s)),s={},s[t]=l);return r}const S$={kde:Yy,mixture:c$,normal:Gy,lognormal:l$,uniform:f$},hz="distributions",O$="function",gz="field";function C$(e,t){const n=e[O$];ue(S$,n)||P("Unknown distribution function: "+n);const i=S$[n]();for(const r in e)r===gz?i.data((e.from||t()).map(e[r])):r===hz?i[r](e[r].map(s=>C$(s,t))):typeof i[r]===O$&&i[r](e[r]);return i}function fb(e){T.call(this,null,e)}const $$=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],pz={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:$$},{name:"weights",type:"number",array:!0}]};fb.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:$$.concat(pz)},{name:"as",type:"string",array:!0,default:["value","density"]}]};H(fb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=C$(e.distribution,mz(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&P("Invalid density method: "+o),!e.extent&&!i.data&&P("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=e.extent||cr(i.data()),l=Yh(o,u,r,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],Ne(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function mz(e){return()=>e.materialize(e.SOURCE).source}function j$(e,t){return e?e.map((n,i)=>t[i]||st(n)):null}function db(e,t,n){const i=[],r=f=>f(u);let s,o,a,u,l,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)u=e[o],l=t.map(r),c=s[l],c||(s[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const k$="bin";function hb(e){T.call(this,null,e)}hb.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:k$}]};const yz=(e,t)=>fc(cr(e,t))/30;H(hb,T,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=db(t.source,e.groupby,hn),r=e.smooth||!1,s=e.field,o=e.step||yz(n,s),a=sa((p,m)=>s(p)-s(m)),u=e.as||k$,l=i.length;let c=1/0,f=-1/0,h=0,g;for(;h<l;++h){const p=i[h].sort(a);g=-1;for(const m of a$(p,o,r,s))m<c&&(c=m),m>f&&(f=m),p[++g][u]=m}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function F$(e){We.call(this,null,bz,e),this.modified(!0)}H(F$,We);function bz(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Fn(n=>t(n,e),Wt(t),st(t))}function gb(e){T.call(this,[void 0,void 0],e)}gb.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};H(gb,T,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const u=Gt(i(a));u!=null&&(u<s&&(s=u),u>o&&(o=u))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=st(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function pb(e,t){We.call(this,e),this.parent=t,this.count=0}H(pb,We,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Vh(e){T.call(this,{},e),this._keys=wu();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}H(Vh,T,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=ue(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new pb(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ee(u),c=s.get(l);c!==void 0&&(s.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);s.set(ee(u),l),a(l).add(u)}),o||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ee(u),c=s.get(l),f=i(u);c===f?a(f).mod(u):(s.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(s.get(ee(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=ee(u),c=s.get(l),f=i(u);c!==f&&(s.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function D$(e){We.call(this,null,vz,e)}H(D$,We);function vz(e){return this.value&&!e.modified()?this.value:Z(e.name)?ae(e.name).map(t=>Dn(t)):Dn(e.name,e.as)}function mb(e){T.call(this,wu(),e)}mb.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};H(mb,T,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const h=ee(f);i.has(h)?i.delete(h):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):i.set(ee(f),1)});function c(f){const h=ee(f),g=u(f,e),p=i.get(h);g&&p?(i.delete(h),s.push(f)):!g&&!p?(i.set(h,1),o.push(f)):l&&g&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function yb(e){T.call(this,[],e)}yb.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};H(yb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=j$(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=i.map(p=>p(a)),l=u.reduce((p,m)=>Math.max(p,m.length),0);let c=0,f,h,g;for(;c<l;++c){for(h=Ly(a),f=0;f<o;++f)h[r[f]]=(g=u[f][c])==null?null:g;s&&(h[s]=c),n.add.push(h)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function bb(e){T.call(this,[],e)}bb.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};H(bb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(st),s=e.as||["key","value"],o=s[0],a=s[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Ly(l),f[o]=r[c],f[a]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function vb(e){T.call(this,null,e)}vb.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};H(vb,T,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function M$(e){T.call(this,[],e)}H(M$,T,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,u;if(s>0){for(o=[];--s>=0;)o.push(u=Ne(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const Xh={value:"value",median:CO,mean:iI,min:ty,max:ea},xz=[];function xb(e){T.call(this,[],e)}xb.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function wz(e){var t=e.method||Xh.value,n;if(Xh[t]==null)P("Unrecognized imputation method: "+t);else return t===Xh.value?(n=e.value!==void 0?e.value:0,()=>n):Xh[t]}function Ez(e){const t=e.field;return n=>n?t(n):NaN}H(xb,T,{transform(e,t){var n=t.fork(t.ALL),i=wz(e),r=Ez(e),s=st(e.field),o=st(e.key),a=(e.groupby||[]).map(st),u=Az(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,h,g,p,m,y,x,w,E,A,S;for(y=0,E=u.length;y<E;++y)for(h=u[y],p=h.values,g=NaN,w=0;w<f;++w)if(h[w]==null){for(m=u.domain[w],S={_impute:!0},x=0,A=p.length;x<A;++x)S[a[x]]=p[x];S[o]=m,S[s]=Number.isNaN(g)?g=i(h,r):g,l.push(Ne(S))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function Az(e,t,n,i){var r=x=>x(y),s=[],o=i?i.slice():[],a={},u={},l,c,f,h,g,p,m,y;for(o.forEach((x,w)=>a[x]=w+1),h=0,m=e.length;h<m;++h)y=e[h],p=n(y),g=a[p]||(a[p]=o.push(p)),c=(l=t?t.map(r):xz)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[g-1]=y;return s.domain=o,s}function wb(e){Xs.call(this,e)}wb.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Lc},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};H(wb,Xs,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{pe(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Eb(e){T.call(this,null,e)}Eb.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};H(Eb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=db(i,e.groupby,e.field),s=(e.groupby||[]).map(st),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,h=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&P("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=cr(i,e.field)),f=h=e.steps||h),r.forEach(g=>{const p=Yy(g,o)[a],m=e.counts?g.length:1,y=c||cr(g);Yh(p,y,f,h).forEach(x=>{const w={};for(let E=0;E<s.length;++E)w[s[E]]=g.dims[E];w[u[0]]=x[0],w[u[1]]=x[1]*m,l.push(Ne(w))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function T$(e){We.call(this,null,_z,e)}H(T$,We);function _z(e){return this.value&&!e.modified()?this.value:H1(e.fields,e.flat)}function N$(e){T.call(this,[],e),this._pending=null}H(N$,T,{transform(e,t){const n=t.dataflow;return this._pending?Ab(this,t,this._pending):Sz(e)?t.StopPropagation:e.values?Ab(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=ae(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>Ab(this,t,ae(i.data)))}});function Sz(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Ab(e,t,n){n.forEach(Ne);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function _b(e){T.call(this,{},e)}_b.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};H(_b,T,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,h,g;return r?(h=r.length,a>1&&!c&&P('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*h&&P('The "as" parameter has too few output field names.'),c=c||r.map(st),f=function(p){for(var m=0,y=0,x,w;m<a;++m)if(w=i.get(n[m](p)),w==null)for(x=0;x<h;++x,++y)p[c[y]]=s;else for(x=0;x<h;++x,++y)p[c[y]]=r[x](w)}):(c||P("Missing output field names."),f=function(p){for(var m=0,y;m<a;++m)y=i.get(n[m](p)),p[c[m]]=y==null?s:y}),o?l=t.reflow(!0):(g=n.some(p=>t.modified(p.fields)),u|=g?t.MOD:0),t.visit(u,f),l.modifies(c)}});function R$(e){We.call(this,null,Oz,e)}H(R$,We);function Oz(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function P$(e){We.call(this,null,Cz,e)}H(P$,We);function Cz(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function L$(e){T.call(this,null,e)}H(L$,T,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Sb(e){Xs.call(this,e)}Sb.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Lc,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};H(Sb,Xs,{_transform:Xs.prototype.transform,transform(e,t){return this._transform($z(e,t),t)}});function $z(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=Wt(n).concat(Wt(i)),o=kz(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>jz(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function jz(e,t,n,i){return Fn(r=>t(r)===e?n(r):NaN,i,e+"")}function kz(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(wh),t?r.slice(0,t):r}function I$(e){Vh.call(this,e)}H(I$,Vh,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(ee(s),n,t,s);return(e.modified("field")||i&&t.modified(Wt(i)))&&P("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(Ne(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Ob(e){T.call(this,null,e)}Ob.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};H(Ob,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=j$(e.fields,e.as||[]),s=i?(a,u)=>Fz(a,u,i,r):Ph;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const u=ee(a);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,a=>{const u=s(a,Ne({}));o[ee(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[ee(a)]))}),n}});function Fz(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function B$(e){T.call(this,null,e)}H(B$,T,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Cb(e){T.call(this,null,e)}Cb.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const Dz=1e-14;H(Cb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=db(r,e.groupby,e.field),o=(e.groupby||[]).map(st),a=[],u=e.step||.01,l=e.probs||Zn(u/2,1-Dz,u),c=l.length;return s.forEach(f=>{const h=zy(f,l);for(let g=0;g<c;++g){const p={};for(let m=0;m<o.length;++m)p[o[m]]=f.dims[m];p[i[0]]=l[g],p[i[1]]=h[g],a.push(Ne(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function U$(e){T.call(this,null,e)}H(U$,T,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=ee(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=Ly(r);i[ee(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[ee(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function $b(e){T.call(this,[],e),this.count=0}$b.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};H($b,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[ee(f)]=1,c),{});let o=this.value,a=this.count,u=0;function l(c){let f,h;o.length<r?o.push(c):(h=~~((a+1)*pi()),h<o.length&&h>=u&&(f=o[h],s[ee(f)]&&n.rem.push(f),o[h]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ee(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[ee(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(u=a=o.length,t.visit(t.SOURCE,c=>{s[ee(c)]||l(c)}),u=-1),i&&o.length>r){const c=o.length-r;for(let f=0;f<c;++f)s[ee(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[ee(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!s[ee(c)])),this.count=a,this.value=n.source=o,n}});function jb(e){T.call(this,null,e)}jb.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};H(jb,T,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Zn(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,Ne(s)}),n.add=t.add.concat(this.value),n}});function z$(e){T.call(this,null,e),this.modified(!0)}H(z$,T,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function kb(e){T.call(this,null,e)}const q$=["unit0","unit1"];kb.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:yy,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:q$}]};H(kb,T,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?$u:Cu)(s.unit).offset,a=e.as||q$,u=a[0],l=a[1],c=s.step;let f=s.start||1/0,h=s.stop||-1/0,g=t.ADD;return(e.modified()||t.modified(Wt(n)))&&(t=t.reflow(!0),g=t.SOURCE,f=1/0,h=-1/0),t.visit(g,p=>{const m=n(p);let y,x;m==null?(p[u]=null,i&&(p[l]=null)):(p[u]=y=x=s(m),i&&(p[l]=x=o(y,c)),y<f&&(f=y),x>h&&(h=x))}),s.start=f,s.stop=h,t.modifies(i?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:cC({extent:e.extent||cr(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=vy(i),o=this.value||{},a=(n?ZO:JO)(s,r);return a.unit=Ee(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function H$(e){T.call(this,wu(),e)}H(H$,T,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function W$(e){T.call(this,null,e)}H(W$,T,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(sa(e.sort)):t.source).map(e.field))}});function Mz(e,t,n,i){const r=Ic[e](t,n);return{init:r.init||Ns,update:function(s,o){o[i]=r.next(s)}}}const Ic={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Ic.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||P("ntile num must be greater than zero.");const n=Ic.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||P("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=Tz(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function Tz(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const Nz=Object.keys(Ic);function G$(e){const t=ae(e.ops),n=ae(e.fields),i=ae(e.params),r=ae(e.as),s=this.outputs=[],o=this.windows=[],a={},u={},l=[],c=[];let f=!0;function h(g){ae(Wt(g)).forEach(p=>a[p]=1)}h(e.sort),t.forEach((g,p)=>{const m=n[p],y=st(m),x=v$(g,y,r[p]);if(h(m),s.push(x),ue(Ic,g))o.push(Mz(g,n[p],i[p],x));else{if(m==null&&g!=="count"&&P("Null aggregate field specified."),g==="count"){l.push(x);return}f=!1;let w=u[y];w||(w=u[y]=[],w.field=m,c.push(w)),w.push(x$(g,x))}}),(l.length||c.length)&&(this.cell=Rz(c,l,f)),this.inputs=Object.keys(a)}const Y$=G$.prototype;Y$.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};Y$.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function Rz(e,t,n){e=e.map(u=>E$(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new ob;return i.add=function(u){if(i.num+=1,!n){a&&a.add(u);for(let l=0;l<r;++l)s[l].add(s[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){a&&a.rem(u);for(let l=0;l<r;++l)s[l].rem(s[l].get(u),u)}},i.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},i.init=function(){i.num=0,a&&a.reset();for(let u=0;u<r;++u)s[u].init()},i}function Fb(e){T.call(this,{},e),this._mlen=0,this._mods=[]}Fb.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Nz.concat(Lc)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};H(Fb,T,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=sa(e.sort),r=rb(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new G$(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)Pz(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=A$(ee),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function Pz(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),u=a.length,l=s?hc(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||Yt(-1)};t.init();for(let f=0;f<u;++f)Lz(c,o,f,u),s&&Iz(c,l),t.update(c,a[f])}function Lz(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function Iz(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}var Bz=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Xs,bin:ab,collect:ub,compare:_$,countpattern:lb,cross:cb,density:fb,dotbin:hb,expression:F$,extent:gb,facet:Vh,field:D$,filter:mb,flatten:yb,fold:bb,formula:vb,generate:M$,impute:xb,joinaggregate:wb,kde:Eb,key:T$,load:N$,lookup:_b,multiextent:R$,multivalues:P$,params:L$,pivot:Sb,prefacet:I$,project:Ob,proxy:B$,quantile:Cb,relay:U$,sample:$b,sequence:jb,sieve:z$,subflow:pb,timeunit:kb,tupleindex:H$,values:W$,window:Fb});const Db=Math.PI,Mb=2*Db,aa=1e-6,Uz=Mb-aa;function Tb(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ua(){return new Tb}Tb.prototype=ua.prototype={constructor:Tb,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var s=this._x1,o=this._y1,a=n-e,u=i-t,l=s-e,c=o-t,f=l*l+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>aa)if(!(Math.abs(c*a-u*l)>aa)||!r)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var h=n-s,g=i-o,p=a*a+u*u,m=h*h+g*g,y=Math.sqrt(p),x=Math.sqrt(f),w=r*Math.tan((Db-Math.acos((p+f-m)/(2*y*x)))/2),E=w/x,A=w/y;Math.abs(E-1)>aa&&(this._+="L"+(e+E*l)+","+(t+E*c)),this._+="A"+r+","+r+",0,0,"+ +(c*h>l*g)+","+(this._x1=e+A*a)+","+(this._y1=t+A*u)}},arc:function(e,t,n,i,r,s){e=+e,t=+t,n=+n,s=!!s;var o=n*Math.cos(i),a=n*Math.sin(i),u=e+o,l=t+a,c=1^s,f=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>aa||Math.abs(this._y1-l)>aa)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Mb+Mb),f>Uz?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>aa&&(this._+="A"+n+","+n+",0,"+ +(f>=Db)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Re(e){return function(){return e}}var V$=Math.abs,Qt=Math.atan2,la=Math.cos,zz=Math.max,Nb=Math.min,hr=Math.sin,Tu=Math.sqrt,Kt=1e-12,Nu=Math.PI,Qh=Nu/2,X$=2*Nu;function qz(e){return e>1?0:e<-1?Nu:Math.acos(e)}function Q$(e){return e>=1?Qh:e<=-1?-Qh:Math.asin(e)}function Hz(e){return e.innerRadius}function Wz(e){return e.outerRadius}function Gz(e){return e.startAngle}function Yz(e){return e.endAngle}function Vz(e){return e&&e.padAngle}function Xz(e,t,n,i,r,s,o,a){var u=n-e,l=i-t,c=o-r,f=a-s,h=f*u-c*l;if(!(h*h<Kt))return h=(c*(t-s)-f*(e-r))/h,[e+h*u,t+h*l]}function Kh(e,t,n,i,r,s,o){var a=e-n,u=t-i,l=(o?s:-s)/Tu(a*a+u*u),c=l*u,f=-l*a,h=e+c,g=t+f,p=n+c,m=i+f,y=(h+p)/2,x=(g+m)/2,w=p-h,E=m-g,A=w*w+E*E,S=r-s,O=h*m-p*g,_=(E<0?-1:1)*Tu(zz(0,S*S*A-O*O)),C=(O*E-w*_)/A,j=(-O*w-E*_)/A,$=(O*E+w*_)/A,k=(-O*w+E*_)/A,M=C-y,D=j-x,I=$-y,F=k-x;return M*M+D*D>I*I+F*F&&(C=$,j=k),{cx:C,cy:j,x01:-c,y01:-f,x11:C*(r/S-1),y11:j*(r/S-1)}}function Qz(){var e=Hz,t=Wz,n=Re(0),i=null,r=Gz,s=Yz,o=Vz,a=null;function u(){var l,c,f=+e.apply(this,arguments),h=+t.apply(this,arguments),g=r.apply(this,arguments)-Qh,p=s.apply(this,arguments)-Qh,m=V$(p-g),y=p>g;if(a||(a=l=ua()),h<f&&(c=h,h=f,f=c),!(h>Kt))a.moveTo(0,0);else if(m>X$-Kt)a.moveTo(h*la(g),h*hr(g)),a.arc(0,0,h,g,p,!y),f>Kt&&(a.moveTo(f*la(p),f*hr(p)),a.arc(0,0,f,p,g,y));else{var x=g,w=p,E=g,A=p,S=m,O=m,_=o.apply(this,arguments)/2,C=_>Kt&&(i?+i.apply(this,arguments):Tu(f*f+h*h)),j=Nb(V$(h-f)/2,+n.apply(this,arguments)),$=j,k=j,M,D;if(C>Kt){var I=Q$(C/f*hr(_)),F=Q$(C/h*hr(_));(S-=I*2)>Kt?(I*=y?1:-1,E+=I,A-=I):(S=0,E=A=(g+p)/2),(O-=F*2)>Kt?(F*=y?1:-1,x+=F,w-=F):(O=0,x=w=(g+p)/2)}var L=h*la(x),B=h*hr(x),W=f*la(A),X=f*hr(A);if(j>Kt){var ce=h*la(w),Te=h*hr(w),$e=f*la(E),it=f*hr(E),He;if(m<Nu&&(He=Xz(L,B,$e,it,ce,Te,W,X))){var lt=L-He[0],cn=B-He[1],Di=ce-He[0],fi=Te-He[1],V=1/hr(qz((lt*Di+cn*fi)/(Tu(lt*lt+cn*cn)*Tu(Di*Di+fi*fi)))/2),le=Tu(He[0]*He[0]+He[1]*He[1]);$=Nb(j,(f-le)/(V-1)),k=Nb(j,(h-le)/(V+1))}}O>Kt?k>Kt?(M=Kh($e,it,L,B,h,k,y),D=Kh(ce,Te,W,X,h,k,y),a.moveTo(M.cx+M.x01,M.cy+M.y01),k<j?a.arc(M.cx,M.cy,k,Qt(M.y01,M.x01),Qt(D.y01,D.x01),!y):(a.arc(M.cx,M.cy,k,Qt(M.y01,M.x01),Qt(M.y11,M.x11),!y),a.arc(0,0,h,Qt(M.cy+M.y11,M.cx+M.x11),Qt(D.cy+D.y11,D.cx+D.x11),!y),a.arc(D.cx,D.cy,k,Qt(D.y11,D.x11),Qt(D.y01,D.x01),!y))):(a.moveTo(L,B),a.arc(0,0,h,x,w,!y)):a.moveTo(L,B),!(f>Kt)||!(S>Kt)?a.lineTo(W,X):$>Kt?(M=Kh(W,X,ce,Te,f,-$,y),D=Kh(L,B,$e,it,f,-$,y),a.lineTo(M.cx+M.x01,M.cy+M.y01),$<j?a.arc(M.cx,M.cy,$,Qt(M.y01,M.x01),Qt(D.y01,D.x01),!y):(a.arc(M.cx,M.cy,$,Qt(M.y01,M.x01),Qt(M.y11,M.x11),!y),a.arc(0,0,f,Qt(M.cy+M.y11,M.cx+M.x11),Qt(D.cy+D.y11,D.cx+D.x11),y),a.arc(D.cx,D.cy,$,Qt(D.y11,D.x11),Qt(D.y01,D.x01),!y))):a.arc(0,0,f,A,E,y)}if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Nu/2;return[la(c)*l,hr(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Re(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Re(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Re(+l),u):n},u.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:Re(+l),u):i},u.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:Re(+l),u):r},u.endAngle=function(l){return arguments.length?(s=typeof l=="function"?l:Re(+l),u):s},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Re(+l),u):o},u.context=function(l){return arguments.length?(a=l==null?null:l,u):a},u}function K$(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function J$(e){this._context=e}J$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Rb(e){return new J$(e)}function Z$(e){return e[0]}function ej(e){return e[1]}function tj(e,t){var n=Re(!0),i=null,r=Rb,s=null;e=typeof e=="function"?e:e===void 0?Z$:Re(e),t=typeof t=="function"?t:t===void 0?ej:Re(t);function o(a){var u,l=(a=K$(a)).length,c,f=!1,h;for(i==null&&(s=r(h=ua())),u=0;u<=l;++u)!(u<l&&n(c=a[u],u,a))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,u,a),+t(c,u,a));if(h)return s=null,h+""||null}return o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Re(+a),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:Re(+a),o):t},o.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Re(!!a),o):n},o.curve=function(a){return arguments.length?(r=a,i!=null&&(s=r(i)),o):r},o.context=function(a){return arguments.length?(a==null?i=s=null:s=r(i=a),o):i},o}function nj(e,t,n){var i=null,r=Re(!0),s=null,o=Rb,a=null;e=typeof e=="function"?e:e===void 0?Z$:Re(+e),t=typeof t=="function"?t:Re(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?ej:Re(+n);function u(c){var f,h,g,p=(c=K$(c)).length,m,y=!1,x,w=new Array(p),E=new Array(p);for(s==null&&(a=o(x=ua())),f=0;f<=p;++f){if(!(f<p&&r(m=c[f],f,c))===y)if(y=!y)h=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),g=f-1;g>=h;--g)a.point(w[g],E[g]);a.lineEnd(),a.areaEnd()}y&&(w[f]=+e(m,f,c),E[f]=+t(m,f,c),a.point(i?+i(m,f,c):w[f],n?+n(m,f,c):E[f]))}if(x)return a=null,x+""||null}function l(){return tj().defined(r).curve(o).context(s)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Re(+c),i=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Re(+c),u):e},u.x1=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Re(+c),u):i},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Re(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Re(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Re(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(i).y(t)},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Re(!!c),u):r},u.curve=function(c){return arguments.length?(o=c,s!=null&&(a=o(s)),u):o},u.context=function(c){return arguments.length?(c==null?s=a=null:a=o(s=c),u):s},u}var Kz={draw:function(e,t){var n=Math.sqrt(t/Nu);e.moveTo(n,0),e.arc(0,0,n,0,X$)}};function Jz(e,t){var n=null;e=typeof e=="function"?e:Re(e||Kz),t=typeof t=="function"?t:Re(t===void 0?64:+t);function i(){var r;if(n||(n=r=ua()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(e=typeof r=="function"?r:Re(r),i):e},i.size=function(r){return arguments.length?(t=typeof r=="function"?r:Re(+r),i):t},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function Qs(){}function Jh(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Zh(e){this._context=e}Zh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Jh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Jh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Zz(e){return new Zh(e)}function ij(e){this._context=e}ij.prototype={areaStart:Qs,areaEnd:Qs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eq(e){return new ij(e)}function rj(e){this._context=e}rj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tq(e){return new rj(e)}function sj(e,t){this._basis=new Zh(e),this._beta=t}sj.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+u*s),this._beta*t[a]+(1-this._beta)*(r+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var nq=function e(t){function n(i){return t===1?new Zh(i):new sj(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function eg(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Pb(e,t){this._context=e,this._k=(1-t)/6}Pb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:eg(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:eg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var iq=function e(t){function n(i){return new Pb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Lb(e,t){this._context=e,this._k=(1-t)/6}Lb.prototype={areaStart:Qs,areaEnd:Qs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:eg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rq=function e(t){function n(i){return new Lb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Ib(e,t){this._context=e,this._k=(1-t)/6}Ib.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:eg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sq=function e(t){function n(i){return new Ib(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Bb(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>Kt){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Kt){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function oj(e,t){this._context=e,this._alpha=t}oj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Bb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oq=function e(t){function n(i){return t?new oj(i,t):new Pb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function aj(e,t){this._context=e,this._alpha=t}aj.prototype={areaStart:Qs,areaEnd:Qs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Bb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var aq=function e(t){function n(i){return t?new aj(i,t):new Lb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function uj(e,t){this._context=e,this._alpha=t}uj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Bb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var uq=function e(t){function n(i){return t?new uj(i,t):new Ib(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function lj(e){this._context=e}lj.prototype={areaStart:Qs,areaEnd:Qs,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function lq(e){return new lj(e)}function cj(e){return e<0?-1:1}function fj(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(cj(s)+cj(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function dj(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Ub(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function tg(e){this._context=e}tg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ub(this,this._t0,dj(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ub(this,dj(this,n=fj(this,e,t)),n);break;default:Ub(this,this._t0,n=fj(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function hj(e){this._context=new gj(e)}(hj.prototype=Object.create(tg.prototype)).point=function(e,t){tg.prototype.point.call(this,t,e)};function gj(e){this._context=e}gj.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function cq(e){return new tg(e)}function fq(e){return new hj(e)}function pj(e){this._context=e}pj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=mj(e),r=mj(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function mj(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function dq(e){return new pj(e)}function ng(e,t){this._context=e,this._t=t}ng.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function hq(e){return new ng(e,.5)}function gq(e){return new ng(e,0)}function pq(e){return new ng(e,1)}function Ru(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const mq=()=>typeof Image!="undefined"?Image:null;function gr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ks(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const zb=Symbol("implicit");function qb(){var e=new Map,t=[],n=[],i=zb;function r(s){var o=s+"",a=e.get(o);if(!a){if(i!==zb)return i;e.set(o,a=t.push(s))}return n[(a-1)%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of s){const a=o+"";e.has(a)||e.set(a,t.push(o))}return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return qb(t,n).unknown(i)},gr.apply(r,arguments),r}function Pu(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Bc(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Js(){}var ca=.7,Lu=1/ca,Iu="\\s*([+-]?\\d+)\\s*",Uc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",pr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yq=/^#([0-9a-f]{3,8})$/,bq=new RegExp("^rgb\\("+[Iu,Iu,Iu]+"\\)$"),vq=new RegExp("^rgb\\("+[pr,pr,pr]+"\\)$"),xq=new RegExp("^rgba\\("+[Iu,Iu,Iu,Uc]+"\\)$"),wq=new RegExp("^rgba\\("+[pr,pr,pr,Uc]+"\\)$"),Eq=new RegExp("^hsl\\("+[Uc,pr,pr]+"\\)$"),Aq=new RegExp("^hsla\\("+[Uc,pr,pr,Uc]+"\\)$"),yj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Pu(Js,zc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:bj,formatHex:bj,formatHsl:_q,formatRgb:vj,toString:vj});function bj(){return this.rgb().formatHex()}function _q(){return _j(this).formatHsl()}function vj(){return this.rgb().formatRgb()}function zc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=yq.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?xj(t):n===3?new It(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ig(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ig(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=bq.exec(e))?new It(t[1],t[2],t[3],1):(t=vq.exec(e))?new It(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xq.exec(e))?ig(t[1],t[2],t[3],t[4]):(t=wq.exec(e))?ig(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Eq.exec(e))?Aj(t[1],t[2]/100,t[3]/100,1):(t=Aq.exec(e))?Aj(t[1],t[2]/100,t[3]/100,t[4]):yj.hasOwnProperty(e)?xj(yj[e]):e==="transparent"?new It(NaN,NaN,NaN,0):null}function xj(e){return new It(e>>16&255,e>>8&255,e&255,1)}function ig(e,t,n,i){return i<=0&&(e=t=n=NaN),new It(e,t,n,i)}function Hb(e){return e instanceof Js||(e=zc(e)),e?(e=e.rgb(),new It(e.r,e.g,e.b,e.opacity)):new It}function Zs(e,t,n,i){return arguments.length===1?Hb(e):new It(e,t,n,i==null?1:i)}function It(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Pu(It,Zs,Bc(Js,{brighter:function(e){return e=e==null?Lu:Math.pow(Lu,e),new It(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?ca:Math.pow(ca,e),new It(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wj,formatHex:wj,formatRgb:Ej,toString:Ej}));function wj(){return"#"+Wb(this.r)+Wb(this.g)+Wb(this.b)}function Ej(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Wb(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Aj(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new mr(e,t,n,i)}function _j(e){if(e instanceof mr)return new mr(e.h,e.s,e.l,e.opacity);if(e instanceof Js||(e=zc(e)),!e)return new mr;if(e instanceof mr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,u=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+r:2-s-r,o*=60):a=u>0&&u<1?0:o,new mr(o,a,u,e.opacity)}function rg(e,t,n,i){return arguments.length===1?_j(e):new mr(e,t,n,i==null?1:i)}function mr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Pu(mr,rg,Bc(Js,{brighter:function(e){return e=e==null?Lu:Math.pow(Lu,e),new mr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ca:Math.pow(ca,e),new mr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new It(Gb(e>=240?e-240:e+120,r,i),Gb(e,r,i),Gb(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Gb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Sj=Math.PI/180,Oj=180/Math.PI,sg=18,Cj=.96422,$j=1,jj=.82521,kj=4/29,Bu=6/29,Fj=3*Bu*Bu,Sq=Bu*Bu*Bu;function Dj(e){if(e instanceof yr)return new yr(e.l,e.a,e.b,e.opacity);if(e instanceof is)return Mj(e);e instanceof It||(e=Hb(e));var t=Qb(e.r),n=Qb(e.g),i=Qb(e.b),r=Yb((.2225045*t+.7168786*n+.0606169*i)/$j),s,o;return t===n&&n===i?s=o=r:(s=Yb((.4360747*t+.3850649*n+.1430804*i)/Cj),o=Yb((.0139322*t+.0971045*n+.7141733*i)/jj)),new yr(116*r-16,500*(s-r),200*(r-o),e.opacity)}function og(e,t,n,i){return arguments.length===1?Dj(e):new yr(e,t,n,i==null?1:i)}function yr(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Pu(yr,og,Bc(Js,{brighter:function(e){return new yr(this.l+sg*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new yr(this.l-sg*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Cj*Vb(t),e=$j*Vb(e),n=jj*Vb(n),new It(Xb(3.1338561*t-1.6168667*e-.4906146*n),Xb(-.9787684*t+1.9161415*e+.033454*n),Xb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Yb(e){return e>Sq?Math.pow(e,1/3):e/Fj+kj}function Vb(e){return e>Bu?e*e*e:Fj*(e-kj)}function Xb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Qb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Oq(e){if(e instanceof is)return new is(e.h,e.c,e.l,e.opacity);if(e instanceof yr||(e=Dj(e)),e.a===0&&e.b===0)return new is(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Oj;return new is(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ag(e,t,n,i){return arguments.length===1?Oq(e):new is(e,t,n,i==null?1:i)}function is(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function Mj(e){if(isNaN(e.h))return new yr(e.l,0,0,e.opacity);var t=e.h*Sj;return new yr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Pu(is,ag,Bc(Js,{brighter:function(e){return new is(this.h,this.c,this.l+sg*(e==null?1:e),this.opacity)},darker:function(e){return new is(this.h,this.c,this.l-sg*(e==null?1:e),this.opacity)},rgb:function(){return Mj(this).rgb()}}));var Tj=-.14861,Kb=1.78277,Jb=-.29227,ug=-.90649,qc=1.97294,Nj=qc*ug,Rj=qc*Kb,Pj=Kb*Jb-ug*Tj;function Cq(e){if(e instanceof fa)return new fa(e.h,e.s,e.l,e.opacity);e instanceof It||(e=Hb(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(Pj*i+Nj*t-Rj*n)/(Pj+Nj-Rj),s=i-r,o=(qc*(n-r)-Jb*s)/ug,a=Math.sqrt(o*o+s*s)/(qc*r*(1-r)),u=a?Math.atan2(o,s)*Oj-120:NaN;return new fa(u<0?u+360:u,a,r,e.opacity)}function Zb(e,t,n,i){return arguments.length===1?Cq(e):new fa(e,t,n,i==null?1:i)}function fa(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Pu(fa,Zb,Bc(Js,{brighter:function(e){return e=e==null?Lu:Math.pow(Lu,e),new fa(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ca:Math.pow(ca,e),new fa(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Sj,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new It(255*(t+n*(Tj*i+Kb*r)),255*(t+n*(Jb*i+ug*r)),255*(t+n*(qc*i)),this.opacity)}}));function Lj(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function Ij(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return Lj((n-i/t)*t,o,r,s,a)}}function Bj(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return Lj((n-i/t)*t,r,s,o,a)}}var lg=e=>()=>e;function Uj(e,t){return function(n){return e+n*t}}function $q(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function cg(e,t){var n=t-e;return n?Uj(e,n>180||n<-180?n-360*Math.round(n/360):n):lg(isNaN(e)?t:e)}function jq(e){return(e=+e)==1?kt:function(t,n){return n-t?$q(t,n,e):lg(isNaN(t)?n:t)}}function kt(e,t){var n=t-e;return n?Uj(e,n):lg(isNaN(e)?t:e)}var ev=function e(t){var n=jq(t);function i(r,s){var o=n((r=Zs(r)).r,(s=Zs(s)).r),a=n(r.g,s.g),u=n(r.b,s.b),l=kt(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function zj(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Zs(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(u){return a.r=i(u),a.g=r(u),a.b=s(u),a+""}}}var kq=zj(Ij),Fq=zj(Bj);function tv(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function qj(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Dq(e,t){return(qj(t)?tv:Hj)(e,t)}function Hj(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=eo(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function Wj(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function Ii(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Gj(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=eo(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var nv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iv=new RegExp(nv.source,"g");function Mq(e){return function(){return e}}function Tq(e){return function(t){return e(t)+""}}function Yj(e,t){var n=nv.lastIndex=iv.lastIndex=0,i,r,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(i=nv.exec(e))&&(r=iv.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,u.push({i:o,x:Ii(i,r)})),n=iv.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?Tq(u[0].x):Mq(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function eo(e,t){var n=typeof t,i;return t==null||n==="boolean"?lg(t):(n==="number"?Ii:n==="string"?(i=zc(t))?(t=i,ev):Yj:t instanceof zc?ev:t instanceof Date?Wj:qj(t)?tv:Array.isArray(t)?Hj:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Gj:Ii)(e,t)}function Nq(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Rq(e,t){var n=cg(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function Hc(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Vj=180/Math.PI,rv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Xj(e,t,n,i,r,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*Vj,skewX:Math.atan(u)*Vj,scaleX:o,scaleY:a}}var fg;function Pq(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?rv:Xj(t.a,t.b,t.c,t.d,t.e,t.f)}function Lq(e){return e==null||(fg||(fg=document.createElementNS("http://www.w3.org/2000/svg","g")),fg.setAttribute("transform",e),!(e=fg.transform.baseVal.consolidate()))?rv:(e=e.matrix,Xj(e.a,e.b,e.c,e.d,e.e,e.f))}function Qj(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,c,f,h,g,p){if(l!==f||c!==h){var m=g.push("translate(",null,t,null,n);p.push({i:m-4,x:Ii(l,f)},{i:m-2,x:Ii(c,h)})}else(f||h)&&g.push("translate("+f+t+h+n)}function o(l,c,f,h){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),h.push({i:f.push(r(f)+"rotate(",null,i)-2,x:Ii(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,h){l!==c?h.push({i:f.push(r(f)+"skewX(",null,i)-2,x:Ii(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,h,g,p){if(l!==f||c!==h){var m=g.push(r(g)+"scale(",null,",",null,")");p.push({i:m-4,x:Ii(l,f)},{i:m-2,x:Ii(c,h)})}else(f!==1||h!==1)&&g.push(r(g)+"scale("+f+","+h+")")}return function(l,c){var f=[],h=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,h),o(l.rotate,c.rotate,f,h),a(l.skewX,c.skewX,f,h),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,h),l=c=null,function(g){for(var p=-1,m=h.length,y;++p<m;)f[(y=h[p]).i]=y.x(g);return f.join("")}}}var Iq=Qj(Pq,"px, ","px)","deg)"),Bq=Qj(Lq,", ",")",")"),Uq=1e-12;function Kj(e){return((e=Math.exp(e))+1/e)/2}function zq(e){return((e=Math.exp(e))-1/e)/2}function qq(e){return((e=Math.exp(2*e))-1)/(e+1)}var Hq=function e(t,n,i){function r(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],h=o[2],g=c-a,p=f-u,m=g*g+p*p,y,x;if(m<Uq)x=Math.log(h/l)/t,y=function(_){return[a+_*g,u+_*p,l*Math.exp(t*_*x)]};else{var w=Math.sqrt(m),E=(h*h-l*l+i*m)/(2*l*n*w),A=(h*h-l*l-i*m)/(2*h*n*w),S=Math.log(Math.sqrt(E*E+1)-E),O=Math.log(Math.sqrt(A*A+1)-A);x=(O-S)/t,y=function(_){var C=_*x,j=Kj(S),$=l/(n*w)*(j*qq(t*C+S)-zq(S));return[a+$*g,u+$*p,l*j/Kj(t*C+S)]}}return y.duration=x*1e3*t/Math.SQRT2,y}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},r}(Math.SQRT2,2,4);function Jj(e){return function(t,n){var i=e((t=rg(t)).h,(n=rg(n)).h),r=kt(t.s,n.s),s=kt(t.l,n.l),o=kt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}var Wq=Jj(cg),Gq=Jj(kt);function Yq(e,t){var n=kt((e=og(e)).l,(t=og(t)).l),i=kt(e.a,t.a),r=kt(e.b,t.b),s=kt(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function Zj(e){return function(t,n){var i=e((t=ag(t)).h,(n=ag(n)).h),r=kt(t.c,n.c),s=kt(t.l,n.l),o=kt(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}var Vq=Zj(cg),Xq=Zj(kt);function ek(e){return function t(n){n=+n;function i(r,s){var o=e((r=Zb(r)).h,(s=Zb(s)).h),a=kt(r.s,s.s),u=kt(r.l,s.l),l=kt(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}var Qq=ek(cg),Kq=ek(kt);function sv(e,t){t===void 0&&(t=e,e=eo);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function Jq(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var Zq=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:eo,interpolateArray:Dq,interpolateBasis:Ij,interpolateBasisClosed:Bj,interpolateDate:Wj,interpolateDiscrete:Nq,interpolateHue:Rq,interpolateNumber:Ii,interpolateNumberArray:tv,interpolateObject:Gj,interpolateRound:Hc,interpolateString:Yj,interpolateTransformCss:Iq,interpolateTransformSvg:Bq,interpolateZoom:Hq,interpolateRgb:ev,interpolateRgbBasis:kq,interpolateRgbBasisClosed:Fq,interpolateHsl:Wq,interpolateHslLong:Gq,interpolateLab:Yq,interpolateHcl:Vq,interpolateHclLong:Xq,interpolateCubehelix:Qq,interpolateCubehelixLong:Kq,piecewise:sv,quantize:Jq});function eH(e){return function(){return e}}function ov(e){return+e}var tk=[0,1];function Rn(e){return e}function av(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:eH(isNaN(t)?NaN:.5)}function tH(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function nH(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=av(r,i),s=n(o,s)):(i=av(i,r),s=n(s,o)),function(a){return s(i(a))}}function iH(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=av(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=gc(e,a,1,i)-1;return s[u](r[u](a))}}function Wc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function dg(){var e=tk,t=tk,n=eo,i,r,s,o=Rn,a,u,l;function c(){var h=Math.min(e.length,t.length);return o!==Rn&&(o=tH(e[0],e[h-1])),a=h>2?iH:nH,u=l=null,f}function f(h){return h==null||isNaN(h=+h)?s:(u||(u=a(e.map(i),t,n)))(i(o(h)))}return f.invert=function(h){return o(r((l||(l=a(t,e.map(i),Ii)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,ov),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=Hc,c()},f.clamp=function(h){return arguments.length?(o=h?!0:Rn,c()):o!==Rn},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,g){return i=h,r=g,c()}}function nk(){return dg()(Rn,Rn)}function ik(e,t,n,i){var r=Bs(e,t,n),s;switch(i=Su(i==null?",f":i),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=LO(r,o))&&(i.precision=s),ry(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=IO(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=PO(r))&&(i.precision=s-(i.type==="%")*2);break}}return Oh(i)}function da(e){var t=e.domain;return e.ticks=function(n){var i=t();return ey(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var r=t();return ik(r[0],r[r.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=r,r=s,s=l);c-- >0;){if(l=_O(o,a,n),l===u)return i[r]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function rk(){var e=nk();return e.copy=function(){return Wc(e,rk())},gr.apply(e,arguments),da(e)}function sk(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,ov),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return sk(e).unknown(t)},e=arguments.length?Array.from(e,ov):[0,1],da(n)}function ok(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function ak(e){return Math.log(e)}function uk(e){return Math.exp(e)}function rH(e){return-Math.log(-e)}function sH(e){return-Math.exp(-e)}function oH(e){return isFinite(e)?+("1e"+e):e<0?0:e}function aH(e){return e===10?oH:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function uH(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function lk(e){return function(t){return-e(-t)}}function uv(e){var t=e(ak,uk),n=t.domain,i=10,r,s;function o(){return r=uH(i),s=aH(i),n()[0]<0?(r=lk(r),s=lk(s),e(rH,sH)):e(ak,uk),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=function(a){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(h=l,l=c,c=h);var h=r(l),g=r(c),p,m,y,x=a==null?10:+a,w=[];if(!(i%1)&&g-h<x){if(h=Math.floor(h),g=Math.ceil(g),l>0){for(;h<=g;++h)for(m=1,p=s(h);m<i;++m)if(y=p*m,!(y<l)){if(y>c)break;w.push(y)}}else for(;h<=g;++h)for(m=i-1,p=s(h);m>=1;--m)if(y=p*m,!(y<l)){if(y>c)break;w.push(y)}w.length*2<x&&(w=ey(l,c,x))}else w=ey(h,g,Math.min(g-h,x)).map(s);return f?w.reverse():w},t.tickFormat=function(a,u){if(u==null&&(u=i===10?".0e":","),typeof u!="function"&&(u=Oh(u)),a===1/0)return u;a==null&&(a=10);var l=Math.max(1,i*a/t.ticks().length);return function(c){var f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=function(){return n(ok(n(),{floor:function(a){return s(Math.floor(r(a)))},ceil:function(a){return s(Math.ceil(r(a)))}}))},t}function ck(){var e=uv(dg()).domain([1,10]);return e.copy=function(){return Wc(e,ck()).base(e.base())},gr.apply(e,arguments),e}function fk(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function dk(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function lv(e){var t=1,n=e(fk(t),dk(t));return n.constant=function(i){return arguments.length?e(fk(t=+i),dk(t)):t},da(n)}function hk(){var e=lv(dg());return e.copy=function(){return Wc(e,hk()).constant(e.constant())},gr.apply(e,arguments)}function gk(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function lH(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function cH(e){return e<0?-e*e:e*e}function cv(e){var t=e(Rn,Rn),n=1;function i(){return n===1?e(Rn,Rn):n===.5?e(lH,cH):e(gk(n),gk(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},da(t)}function fv(){var e=cv(dg());return e.copy=function(){return Wc(e,fv()).exponent(e.exponent())},gr.apply(e,arguments),e}function fH(){return fv.apply(null,arguments).exponent(.5)}function pk(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=OO(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[gc(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Au),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return pk().domain(e).range(t).unknown(i)},gr.apply(s,arguments)}function mk(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(u){return u!=null&&u<=u?r[gc(i,u,0,n)]:s}function a(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,a()):r.slice()},o.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return i.slice()},o.copy=function(){return mk().domain([e,t]).range(r).unknown(s)},gr.apply(da(o),arguments)}function yk(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[gc(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return yk().domain(e).range(t).unknown(n)},gr.apply(r,arguments)}function dH(e){return new Date(e)}function hH(e){return e instanceof Date?+e:+new Date(+e)}function dv(e,t,n,i,r,s,o,a,u,l){var c=nk(),f=c.invert,h=c.domain,g=l(".%L"),p=l(":%S"),m=l("%I:%M"),y=l("%I %p"),x=l("%a %d"),w=l("%b %d"),E=l("%B"),A=l("%Y");function S(O){return(u(O)<O?g:a(O)<O?p:o(O)<O?m:s(O)<O?y:i(O)<O?r(O)<O?x:w:n(O)<O?E:A)(O)}return c.invert=function(O){return new Date(f(O))},c.domain=function(O){return arguments.length?h(Array.from(O,hH)):h().map(dH)},c.ticks=function(O){var _=h();return e(_[0],_[_.length-1],O==null?10:O)},c.tickFormat=function(O,_){return _==null?S:l(_)},c.nice=function(O){var _=h();return(!O||typeof O.range!="function")&&(O=t(_[0],_[_.length-1],O==null?10:O)),O?h(ok(_,O)):c},c.copy=function(){return Wc(c,dv(e,t,n,i,r,s,o,a,u,l))},c}function gH(){return gr.apply(dv(AI,_I,qs,Ch,mc,zs,dy,fy,Us,$y).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function pH(){return gr.apply(dv(wI,EI,Ws,$h,bc,Hs,py,gy,Us,jy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function hg(){var e=0,t=1,n,i,r,s,o=Rn,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(r===0?.5:(f=(s(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(h){var g,p;return arguments.length?([g,p]=h,o=f(g,p),l):[o(0),o(1)]}}return l.range=c(eo),l.rangeRound=c(Hc),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function to(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function hv(){var e=da(hg()(Rn));return e.copy=function(){return to(e,hv())},Ks.apply(e,arguments)}function bk(){var e=uv(hg()).domain([1,10]);return e.copy=function(){return to(e,bk()).base(e.base())},Ks.apply(e,arguments)}function vk(){var e=lv(hg());return e.copy=function(){return to(e,vk()).constant(e.constant())},Ks.apply(e,arguments)}function gv(){var e=cv(hg());return e.copy=function(){return to(e,gv()).exponent(e.exponent())},Ks.apply(e,arguments)}function mH(){return gv.apply(null,arguments).exponent(.5)}function gg(){var e=0,t=.5,n=1,i=1,r,s,o,a,u,l=Rn,c,f=!1,h;function g(m){return isNaN(m=+m)?h:(m=.5+((m=+c(m))-s)*(i*m<i*s?a:u),l(f?Math.max(0,Math.min(1,m)):m))}g.domain=function(m){return arguments.length?([e,t,n]=m,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,g):[e,t,n]},g.clamp=function(m){return arguments.length?(f=!!m,g):f},g.interpolator=function(m){return arguments.length?(l=m,g):l};function p(m){return function(y){var x,w,E;return arguments.length?([x,w,E]=y,l=sv(m,[x,w,E]),g):[l(0),l(.5),l(1)]}}return g.range=p(eo),g.rangeRound=p(Hc),g.unknown=function(m){return arguments.length?(h=m,g):h},function(m){return c=m,r=m(e),s=m(t),o=m(n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,g}}function xk(){var e=da(gg()(Rn));return e.copy=function(){return to(e,xk())},Ks.apply(e,arguments)}function wk(){var e=uv(gg()).domain([.1,1,10]);return e.copy=function(){return to(e,wk()).base(e.base())},Ks.apply(e,arguments)}function Ek(){var e=lv(gg());return e.copy=function(){return to(e,Ek()).constant(e.constant())},Ks.apply(e,arguments)}function pv(){var e=cv(gg());return e.copy=function(){return to(e,pv()).exponent(e.exponent())},Ks.apply(e,arguments)}function yH(){return pv.apply(null,arguments).exponent(.5)}function mv(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const bH="identity",Uu="linear",rs="log",Gc="pow",Yc="sqrt",pg="symlog",ha="time",ga="utc",br="sequential",zu="diverging",qu="quantile",mg="quantize",yg="threshold",yv="ordinal",bv="point",Ak="band",vv="bin-ordinal",xt="continuous",Vc="discrete",Xc="discretizing",mi="interpolating",xv="temporal";function vH(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function xH(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,u,l;for(r<i&&(a=i,i=r,r=a),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(s<0&&(s=u),o=u);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function wv(){const e=qb().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,h=i[1]<i[0],g=i[1-h],p=mv(f,a,u);let m=i[h-0];r=(g-m)/(p||1),o&&(r=Math.floor(r)),m+=(g-m-r*(f-a))*l,s=r*(1-a),o&&(m=Math.round(m),s=Math.round(s));const y=Zn(f).map(x=>m+r*x);return n(h?y.reverse():y)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const h=i[1]<i[0],g=h?n().reverse():n(),p=g.length-1;let m=+f[0],y=+f[1],x,w,E;if(!(m!==m||y!==y)&&(y<m&&(E=m,m=y,y=E),!(y<g[0]||m>i[1-h])))return x=Math.max(0,Ah(g,m)-1),w=m===y?x:Ah(g,y)-1,m-g[x]>s+1e-10&&++x,h&&(E=x,x=p-w,w=p-E),x>w?void 0:t().slice(x,w+1)},e.invert=function(f){const h=e.invertRange([f,f]);return h&&h[0]},e.copy=function(){return wv().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function _k(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return _k(t())},e}function wH(){return _k(wv().paddingInner(1))}var EH=Array.prototype.map;function AH(e){return EH.call(e,Gt)}const _H=Array.prototype.slice;function Sk(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(gc(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=AH(i),n):e.slice()},n.range=function(i){return arguments.length?(t=_H.call(i),n):t.slice()},n.tickFormat=function(i,r){return ik(e[0],Ee(e),i==null?10:i,r)},n.copy=function(){return Sk().domain(n.domain()).range(n.range())},n}const bg={};function SH(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?vH(s):s.invertExtent?xH(s):void 0),s.type=e,s};return i.metadata=Pi(ae(n)),i}function Fe(e,t,n){return arguments.length>1?(bg[e]=SH(e,t,n),this):Ok(e)?bg[e]:void 0}Fe(bH,sk);Fe(Uu,rk,xt);Fe(rs,ck,[xt,rs]);Fe(Gc,fv,xt);Fe(Yc,fH,xt);Fe(pg,hk,xt);Fe(ha,gH,[xt,xv]);Fe(ga,pH,[xt,xv]);Fe(br,hv,[xt,mi]);Fe("".concat(br,"-").concat(Uu),hv,[xt,mi]);Fe("".concat(br,"-").concat(rs),bk,[xt,mi,rs]);Fe("".concat(br,"-").concat(Gc),gv,[xt,mi]);Fe("".concat(br,"-").concat(Yc),mH,[xt,mi]);Fe("".concat(br,"-").concat(pg),vk,[xt,mi]);Fe("".concat(zu,"-").concat(Uu),xk,[xt,mi]);Fe("".concat(zu,"-").concat(rs),wk,[xt,mi,rs]);Fe("".concat(zu,"-").concat(Gc),pv,[xt,mi]);Fe("".concat(zu,"-").concat(Yc),yH,[xt,mi]);Fe("".concat(zu,"-").concat(pg),Ek,[xt,mi]);Fe(qu,pk,[Xc,qu]);Fe(mg,mk,Xc);Fe(yg,yk,Xc);Fe(vv,Sk,[Vc,Xc]);Fe(yv,qb,Vc);Fe(Ak,wv,Vc);Fe(bv,wH,Vc);function Ok(e){return ue(bg,e)}function pa(e,t){const n=bg[e];return n&&n.metadata[t]}function Ev(e){return pa(e,xt)}function Hu(e){return pa(e,Vc)}function Av(e){return pa(e,Xc)}function Ck(e){return pa(e,rs)}function OH(e){return pa(e,xv)}function $k(e){return pa(e,mi)}function jk(e){return pa(e,qu)}const CH=["clamp","base","constant","exponent"];function kk(e,t){const n=t[0],i=Ee(t)-n;return function(r){return e(n+r*i)}}function vg(e,t,n){return sv(_v(t||"rgb",n),e)}function Fk(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function Dk(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?Yt(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=Fe(s)().domain([t,n]).range([0,1]),CH.forEach(a=>e[a]?o[a](e[a]()):0),o)}function _v(e,t){const n=Zq[$H(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function $H(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const jH={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},kH={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Mk(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function Tk(e,t){for(const n in e)Sv(n,t(e[n]))}const Nk={};Tk(kH,Mk);Tk(jH,e=>vg(Mk(e)));function Sv(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Nk[e]=t,this):Nk[e]}const xg="symbol",FH="discrete",DH="gradient",MH=e=>Z(e)?e.map(t=>String(t)):String(e),TH=(e,t)=>e[1]-t[1],NH=(e,t)=>t[1]-e[1];function Ov(e,t,n){let i;return Ls(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(fc(e.domain())/n||1)))),fe(t)&&(i=t.step,t=t.interval),Oe(t)&&(t=e.type===ha?Cu(t):e.type==ga?$u(t):P("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function Rk(e,t,n){let i=e.range(),r=i[0],s=Ee(i),o=TH;if(r>s&&(i=s,s=r,r=i,o=NH),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],Ee(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function Cv(e,t){return e.bins?Rk(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Pk(e,t,n,i,r,s){const o=t.type;let a=MH;if(o===ha||r===ha)a=e.timeFormat(i);else if(o===ga||r===ga)a=e.utcFormat(i);else if(Ck(o)){const u=e.formatFloat(i);if(s||t.bins)a=u;else{const l=Lk(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(a=e.format(i));return a}function Lk(e,t,n){const i=Cv(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/s));return l*r<r-.5&&(l*=r),l<=o};return n?i.filter(a):a}const $v={[qu]:"quantiles",[mg]:"thresholds",[yg]:"domain"},Ik={[qu]:"quantiles",[mg]:"domain"};function Bk(e,t){return e.bins?LH(e.bins):e.type===rs?Lk(e,t,!0):$v[e.type]?PH(e[$v[e.type]]()):Cv(e,t)}function RH(e,t,n){const i=t[Ik[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,3*10,n)}function PH(e){const t=[-1/0].concat(e);return t.max=1/0,t}function LH(e){const t=e.slice(0,-1);return t.max=Ee(e),t}const IH=e=>$v[e.type]||e.bins;function Uk(e,t,n,i,r,s,o){const a=Ik[t.type]&&s!==ha&&s!==ga?RH(e,t,r):Pk(e,t,n,r,s,o);return i===xg&&IH(t)?BH(a):i===FH?UH(a):zH(a)}const BH=e=>(t,n,i)=>{const r=zk(i[n+1],zk(i.max,1/0)),s=qk(t,e),o=qk(r,e);return s&&o?s+" \u2013 "+o:o?"< "+o:"\u2265 "+s},zk=(e,t)=>e!=null?e:t,UH=e=>(t,n)=>n?e(t):null,zH=e=>t=>e(t),qk=(e,t)=>Number.isFinite(e)?t(e):null;function qH(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Ee(t),s=r-i;if(e.type===yg){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function HH(e,t,n,i){const r=i||t.type;return Oe(n)&&OH(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===ha?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===ga?e.utcFormat("%A, %d %B %Y, %X UTC"):Uk(e,t,5,null,n,i,!0)}function Hk(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=HH(e,t,n.format,n.formatType);if(Av(t.type)){const s=Bk(t).slice(1).map(r),o=s.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(s.join(", "))}else if(Hu(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(a)}else{const s=t.domain();return"values from ".concat(r(s[0])," to ").concat(r(Ee(s)))}}let Wk=0;function WH(){Wk=0}const wg="p_";function jv(e){return e&&e.gradient}function Gk(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?wg:"";return r||(r=e.id="gradient_"+Wk++,i==="radial"?(e.x1=vr(e.x1,.5),e.y1=vr(e.y1,.5),e.r1=vr(e.r1,0),e.x2=vr(e.x2,.5),e.y2=vr(e.y2,.5),e.r2=vr(e.r2,.5),s=wg):(e.x1=vr(e.x1,0),e.y1=vr(e.y1,0),e.x2=vr(e.x2,1),e.y2=vr(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function vr(e,t){return e!=null?e:t}function Yk(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const Vk={basis:{curve:Zz},"basis-closed":{curve:eq},"basis-open":{curve:tq},bundle:{curve:nq,tension:"beta",value:.85},cardinal:{curve:iq,tension:"tension",value:0},"cardinal-open":{curve:sq,tension:"tension",value:0},"cardinal-closed":{curve:rq,tension:"tension",value:0},"catmull-rom":{curve:oq,tension:"alpha",value:.5},"catmull-rom-closed":{curve:aq,tension:"alpha",value:.5},"catmull-rom-open":{curve:uq,tension:"alpha",value:.5},linear:{curve:Rb},"linear-closed":{curve:lq},monotone:{horizontal:fq,vertical:cq},natural:{curve:dq},step:{curve:hq},"step-after":{curve:pq},"step-before":{curve:gq}};function kv(e,t,n){var i=ue(Vk,e)&&Vk[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const GH={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Qc=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Wu(e){const t=[];let n,i,r,s,o,a,u,l,c,f;const h=e.slice().replace(Qc[0],"###$1").split(Qc[1]).slice(1);for(u=0,c=h.length;u<c;++u){for(n=h[u],i=n.slice(1).trim().replace(Qc[2],"$1###$2").replace(Qc[3],"$1###$2").split(Qc[4]),o=n.charAt(0),r=[o],l=0,f=i.length;l<f;++l)(s=+i[l])===s&&r.push(s);if(a=GH[o.toLowerCase()],r.length-1>a){const g=r.length;for(l=1,t.push([o].concat(r.slice(l,l+=a))),o=o==="M"?"L":o==="m"?"l":o;l<g;l+=a)t.push([o].concat(r.slice(l,l+a)))}else t.push(r)}return t}const no=Math.PI/180,YH=1e-14,ma=Math.PI/2,xr=Math.PI*2,Gu=Math.sqrt(3)/2;var Fv={},Dv={},Xk=[].join;function VH(e,t,n,i,r,s,o,a,u){const l=Xk.call(arguments);if(Fv[l])return Fv[l];const c=o*no,f=Math.sin(c),h=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const g=h*(a-e)*.5+f*(u-t)*.5,p=h*(u-t)*.5-f*(a-e)*.5;let m=g*g/(n*n)+p*p/(i*i);m>1&&(m=Math.sqrt(m),n*=m,i*=m);const y=h/n,x=f/n,w=-f/i,E=h/i,A=y*a+x*u,S=w*a+E*u,O=y*e+x*t,_=w*e+E*t,C=(O-A)*(O-A)+(_-S)*(_-S);let j=1/C-.25;j<0&&(j=0);let $=Math.sqrt(j);s==r&&($=-$);const k=.5*(A+O)-$*(_-S),M=.5*(S+_)+$*(O-A),D=Math.atan2(S-M,A-k);let F=Math.atan2(_-M,O-k)-D;F<0&&s===1?F+=xr:F>0&&s===0&&(F-=xr);const L=Math.ceil(Math.abs(F/(ma+.001))),B=[];for(let W=0;W<L;++W){const X=D+W*F/L,ce=D+(W+1)*F/L;B[W]=[k,M,X,ce,n,i,f,h]}return Fv[l]=B}function XH(e){const t=Xk.call(e);if(Dv[t])return Dv[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,h=u*o,g=l*a,p=Math.cos(r),m=Math.sin(r),y=Math.cos(s),x=Math.sin(s),w=.5*(s-r),E=Math.sin(w*.5),A=8/3*E*E/Math.sin(w),S=n+p-A*m,O=i+m+A*p,_=n+y,C=i+x,j=_+A*x,$=C-A*y;return Dv[t]=[c*S+f*O,h*S+g*O,c*j+f*$,h*j+g*$,c*_+f*C,h*_+g*C]}const yi=["l",0,0,0,0,0,0,0];function QH(e,t,n){const i=yi[0]=e[0];if(i==="a"||i==="A")yi[1]=t*e[1],yi[2]=n*e[2],yi[3]=e[3],yi[4]=e[4],yi[5]=e[5],yi[6]=t*e[6],yi[7]=n*e[7];else if(i==="h"||i==="H")yi[1]=t*e[1];else if(i==="v"||i==="V")yi[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)yi[r]=(r%2==1?t:n)*e[r];return yi}function Kc(e,t,n,i,r,s){var o,a=null,u=0,l=0,c=0,f=0,h,g,p,m;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var y=0,x=t.length;y<x;++y){switch(o=t[y],(r!==1||s!==1)&&(o=QH(o,r,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+i);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+i);break;case"h":u+=o[1],e.lineTo(u+n,l+i);break;case"H":u=o[1],e.lineTo(u+n,l+i);break;case"v":l+=o[1],e.lineTo(u+n,l+i);break;case"V":l=o[1],e.lineTo(u+n,l+i);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+i);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+i);break;case"c":h=u+o[5],g=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+i,c+n,f+i,h+n,g+i),u=h,l=g;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,f+i,u+n,l+i);break;case"s":h=u+o[3],g=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+o[1]+n,l+o[2]+i,h+n,g+i),c=u+o[1],f=l+o[2],u=h,l=g;break;case"S":h=o[3],g=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,o[1]+n,o[2]+i,h+n,g+i),u=h,l=g,c=o[1],f=o[2];break;case"q":h=u+o[3],g=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+i,h+n,g+i),u=h,l=g;break;case"Q":h=o[3],g=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,h+n,g+i),u=h,l=g,c=o[1],f=o[2];break;case"t":h=u+o[1],g=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-m):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,m=f,e.quadraticCurveTo(c+n,f+i,h+n,g+i),u=h,l=g,c=u+o[1],f=l+o[2];break;case"T":h=o[1],g=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,h+n,g+i),u=h,l=g;break;case"a":Qk(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+i]),u+=o[6],l+=o[7];break;case"A":Qk(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}a=o}}function Qk(e,t,n,i){const r=VH(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=XH(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Kk=.5773502691896257,Jk={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,xr)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Gu*n,r=i-n*Kk,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Gu*n,r=i-n*Kk;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Gu*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Gu*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Gu*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Gu*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Zk(e){return ue(Jk,e)?Jk[e]:KH(e)}var Mv={};function KH(e){if(!ue(Mv,e)){const t=Wu(e);Mv[e]={draw:function(n,i){Kc(n,t,0,0,Math.sqrt(i)/2)}}}return Mv[e]}const io=.448084975506;function JH(e){return e.x}function ZH(e){return e.y}function eW(e){return e.width}function tW(e){return e.height}function ss(e){return typeof e=="function"?e:()=>+e}function Eg(e,t,n){return Math.max(t,Math.min(e,n))}function eF(){var e=JH,t=ZH,n=eW,i=tW,r=ss(0),s=r,o=r,a=r,u=null;function l(c,f,h){var g,p=f!=null?f:+e.call(this,c),m=h!=null?h:+t.call(this,c),y=+n.call(this,c),x=+i.call(this,c),w=Math.min(y,x)/2,E=Eg(+r.call(this,c),0,w),A=Eg(+s.call(this,c),0,w),S=Eg(+o.call(this,c),0,w),O=Eg(+a.call(this,c),0,w);if(u||(u=g=ua()),E<=0&&A<=0&&S<=0&&O<=0)u.rect(p,m,y,x);else{var _=p+y,C=m+x;u.moveTo(p+E,m),u.lineTo(_-A,m),u.bezierCurveTo(_-io*A,m,_,m+io*A,_,m+A),u.lineTo(_,C-O),u.bezierCurveTo(_,C-io*O,_-io*O,C,_-O,C),u.lineTo(p+S,C),u.bezierCurveTo(p+io*S,C,p,C-io*S,p,C-S),u.lineTo(p,m+E),u.bezierCurveTo(p,m+io*E,p+io*E,m,p+E,m),u.closePath()}if(g)return u=null,g+""||null}return l.x=function(c){return arguments.length?(e=ss(c),l):e},l.y=function(c){return arguments.length?(t=ss(c),l):t},l.width=function(c){return arguments.length?(n=ss(c),l):n},l.height=function(c){return arguments.length?(i=ss(c),l):i},l.cornerRadius=function(c,f,h,g){return arguments.length?(r=ss(c),s=f!=null?ss(f):r,a=h!=null?ss(h):r,o=g!=null?ss(g):s,l):r},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function tF(){var e,t,n,i,r=null,s,o,a,u;function l(f,h,g){const p=g/2;if(s){var m=a-h,y=f-o;if(m||y){var x=Math.sqrt(m*m+y*y),w=(m/=x)*u,E=(y/=x)*u,A=Math.atan2(y,m);r.moveTo(o-w,a-E),r.lineTo(f-m*p,h-y*p),r.arc(f,h,p,A-Math.PI,A),r.lineTo(o+w,a+E),r.arc(o,a,u,A,A+Math.PI)}else r.arc(f,h,p,0,xr);r.closePath()}else s=1;o=f,a=h,u=p}function c(f){var h,g=f.length,p,m=!1,y;for(r==null&&(r=y=ua()),h=0;h<=g;++h)!(h<g&&i(p=f[h],h,f))===m&&(m=!m)&&(s=0),m&&l(+e(p,h,f),+t(p,h,f),+n(p,h,f));if(y)return r=null,y+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function Jc(e,t){return e!=null?e:t}const Zc=e=>e.x||0,ef=e=>e.y||0,nW=e=>e.width||0,iW=e=>e.height||0,rW=e=>(e.x||0)+(e.width||0),sW=e=>(e.y||0)+(e.height||0),oW=e=>e.startAngle||0,aW=e=>e.endAngle||0,uW=e=>e.padAngle||0,lW=e=>e.innerRadius||0,cW=e=>e.outerRadius||0,fW=e=>e.cornerRadius||0,dW=e=>Jc(e.cornerRadiusTopLeft,e.cornerRadius)||0,hW=e=>Jc(e.cornerRadiusTopRight,e.cornerRadius)||0,gW=e=>Jc(e.cornerRadiusBottomRight,e.cornerRadius)||0,pW=e=>Jc(e.cornerRadiusBottomLeft,e.cornerRadius)||0,mW=e=>Jc(e.size,64),yW=e=>e.size||1,Ag=e=>e.defined!==!1,bW=e=>Zk(e.shape||"circle"),vW=Qz().startAngle(oW).endAngle(aW).padAngle(uW).innerRadius(lW).outerRadius(cW).cornerRadius(fW),xW=nj().x(Zc).y1(ef).y0(sW).defined(Ag),wW=nj().y(ef).x1(Zc).x0(rW).defined(Ag),EW=tj().x(Zc).y(ef).defined(Ag),AW=eF().x(Zc).y(ef).width(nW).height(iW).cornerRadius(dW,hW,gW,pW),_W=Jz().type(bW).size(mW),SW=tF().x(Zc).y(ef).defined(Ag).size(yW);function Tv(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function OW(e,t){return vW.context(e)(t)}function CW(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?wW:xW).curve(kv(i,n.orient,n.tension)).context(e)(t)}function $W(e,t){const n=t[0],i=n.interpolate||"linear";return EW.curve(kv(i,n.orient,n.tension)).context(e)(t)}function Yu(e,t,n,i){return AW.context(e)(t,n,i)}function jW(e,t){return(t.mark.shape||t.shape).context(e)(t)}function kW(e,t){return _W.context(e)(t)}function FW(e,t){return SW.context(e)(t)}var nF=1;function iF(){nF=1}function Nv(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+nF++),o=r.clipping[s]||(r.clipping[s]={id:s});return ye(i)?o.path=i(null):Tv(n)?o.path=Yu(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function wt(e){this.clear(),e&&this.union(e)}wt.prototype={clone(){return new wt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*i-u*r+l,u*i+a*r+c,a*i-u*o+l,u*i+a*o+c,a*s-u*r+l,u*s+a*r+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function _g(e){this.mark=e,this.bounds=this.bounds||new wt}function Sg(e){_g.call(this,e),this.items=this.items||[]}H(Sg,_g);function Rv(e){this._pending=0,this._loader=e||Mh()}function rF(e){e._pending+=1}function tf(e){e._pending-=1}Rv.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return rF(t),t._loader.sanitize(e,{context:"href"}).then(n=>(tf(t),n)).catch(()=>(tf(t),null))},loadImage(e){const t=this,n=mq();return rF(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=ue(i,"crossOrigin")?i.crossOrigin:"anonymous";return o!=null&&(s.crossOrigin=o),s.onload=()=>tf(t),s.onerror=()=>tf(t),s.src=r,s}).catch(i=>(tf(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function os(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?DW(t,i):0))}return e}function DW(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const MW=xr-1e-8;let Og,Cg,$g,ya,Pv,jg,Lv,Iv;const ro=(e,t)=>Og.add(e,t),kg=(e,t)=>ro(Cg=e,$g=t),sF=e=>ro(e,Og.y1),oF=e=>ro(Og.x1,e),ba=(e,t)=>Pv*e+Lv*t,va=(e,t)=>jg*e+Iv*t,Bv=(e,t)=>ro(ba(e,t),va(e,t)),Uv=(e,t)=>kg(ba(e,t),va(e,t));function nf(e,t){return Og=e,t?(ya=t*no,Pv=Iv=Math.cos(ya),jg=Math.sin(ya),Lv=-jg):(Pv=Iv=1,ya=jg=Lv=0),TW}const TW={beginPath(){},closePath(){},moveTo:Uv,lineTo:Uv,rect(e,t,n,i){ya?(Bv(e+n,t),Bv(e+n,t+i),Bv(e,t+i),Uv(e,t)):(ro(e+n,t+i),kg(e,t))},quadraticCurveTo(e,t,n,i){const r=ba(e,t),s=va(e,t),o=ba(n,i),a=va(n,i);aF(Cg,r,o,sF),aF($g,s,a,oF),kg(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=ba(e,t),a=va(e,t),u=ba(n,i),l=va(n,i),c=ba(r,s),f=va(r,s);uF(Cg,o,u,c,sF),uF($g,a,l,f,oF),kg(c,f)},arc(e,t,n,i,r,s){if(i+=ya,r+=ya,Cg=n*Math.cos(r)+e,$g=n*Math.sin(r)+t,Math.abs(r-i)>MW)ro(e-n,t-n),ro(e+n,t+n);else{const o=l=>ro(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(i),o(r),r!==i)if(i=i%xr,i<0&&(i+=xr),r=r%xr,r<0&&(r+=xr),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=xr,a=i-i%ma,u=0;u<4&&a>r;++u,a-=ma)o(a);else for(a=i-i%ma+ma,u=0;u<4&&a<r;++u,a=a+ma)o(a)}}};function aF(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function uF(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>YH?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&r(lF(u,e,t,n,i)),0<l&&l<1&&r(lF(l,e,t,n,i))}function lF(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var so=(so=Ru(1,1))?so.getContext("2d"):null;const zv=new wt;function qv(e){return function(t,n){if(!so)return!0;e(so,t),zv.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=zv;for(let a=r;a<=o;++a)for(let u=i;u<=s;++u)if(so.isPointInPath(u,a))return!0;return!1}}function Hv(e,t){return t.contains(e.x||0,e.y||0)}function cF(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(zv.set(n,i,n+r,i+s))}function fF(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return Vu(t,n,i,r,s)}function Vu(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:u}=e,l=i-t,c=r-n;let f=0,h=1,g,p,m,y;for(y=0;y<4;++y){if(y===0&&(g=-l,p=-(s-t)),y===1&&(g=l,p=a-t),y===2&&(g=-c,p=-(o-n)),y===3&&(g=c,p=u-n),Math.abs(g)<1e-10&&p<0)return!1;if(m=p/g,g<0){if(m>h)return!1;m>f&&(f=m)}else if(g>0){if(m<f)return!1;m<h&&(h=m)}}return!0}function Xu(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Bi(e,t){return e==null?t:e}function dF(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function NW(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+Bi(t.x1,.5)*i,n.y1+Bi(t.y1,.5)*r,Math.max(i,r)*Bi(t.r1,0),n.x1+Bi(t.x2,.5)*i,n.y1+Bi(t.y2,.5)*r,Math.max(i,r)*Bi(t.r2,.5));else{const o=Bi(t.x1,0),a=Bi(t.y1,0),u=Bi(t.x2,1),l=Bi(t.y2,0);if(o===u||a===l||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+u*i,n.y1+l*r);else{const c=Ru(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=dF(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return dF(s,t.stops)}function hF(e,t,n){return jv(n)?NW(e,n,t.bounds):n}function Fg(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=hF(e,t,t.fill),!0):!1}var RW=[];function Qu(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=hF(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||RW),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function PW(e,t){return e.zindex-t.zindex||e.index-t.index}function Wv(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(PW)}function Ui(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=Wv(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function Dg(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=Wv(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function Gv(e){return function(t,n,i){Ui(n,r=>{(!i||i.intersects(r.bounds))&&gF(e,t,r,r)})}}function LW(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&gF(e,t,n.items[0],n.items)}}function gF(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Xu(t,n),n.fill&&Fg(t,n,r)&&t.fill(),n.stroke&&Qu(t,n,r)&&t.stroke()))}function Mg(e){return e=e||di,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,Dg(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,i,r,s,o))return a})}}function rf(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t==null?o.fill:t,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||u&&n.isPointInStroke(r,s)}}function Yv(e){return Mg(rf(e))}function xa(e,t){return"translate("+e+","+t+")"}function Vv(e){return"rotate("+e+")"}function IW(e,t){return"scale("+e+","+t+")"}function pF(e){return xa(e.x||0,e.y||0)}function BW(e){return xa(e.x||0,e.y||0)+(e.angle?" "+Vv(e.angle):"")}function UW(e){return xa(e.x||0,e.y||0)+(e.angle?" "+Vv(e.angle):"")+(e.scaleX||e.scaleY?" "+IW(e.scaleX||1,e.scaleY||1):"")}function Xv(e,t,n){function i(o,a){o("transform",BW(a)),o("d",t(null,a))}function r(o,a){return t(nf(o,a.angle),a),os(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=no),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:Gv(s),pick:Yv(s),isect:n||qv(s)}}var zW=Xv("arc",OW);function qW(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function HW(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function WW(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function Qv(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(nf(u),c),os(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=rf(s);function a(u,l,c,f,h,g){var p=l.items,m=l.bounds;return!p||!p.length||m&&!m.contains(h,g)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:LW(s),pick:a,isect:Hv,tip:n}}var GW=Qv("area",CW,qW);function YW(e,t){var n=t.clip;e.save(),ye(n)?(e.beginPath(),n(e),e.clip()):mF(e,t.group)}function mF(e,t){e.beginPath(),Tv(t)?Yu(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function yF(e){const t=Bi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function VW(e,t){e("transform",pF(t))}function bF(e,t){const n=yF(t);e("d",Yu(null,t,n,n))}function XW(e,t){e("class","background"),e("aria-hidden",!0),bF(e,t)}function QW(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?bF(e,t):e("d","")}function KW(e,t,n){const i=t.clip?Nv(n,t,t):null;e("clip-path",i)}function JW(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),os(e,t),e.translate(t.x||0,t.y||0)}function sf(e,t,n,i){const r=yF(t);e.beginPath(),Yu(e,t,(n||0)+r,(i||0)+r)}const ZW=rf(sf),eG=rf(sf,!1),tG=rf(sf,!0);function nG(e,t,n){Ui(t,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,a=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&a&&(sf(e,i,r,s),Xu(e,i),i.fill&&Fg(e,i,a)&&e.fill(),i.stroke&&!o&&Qu(e,i,a)&&e.stroke()),e.save(),e.translate(r,s),i.clip&&mF(e,i),n&&n.translate(-r,-s),Ui(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,s),e.restore(),o&&i.stroke&&a&&(sf(e,i,r,s),Xu(e,i),Qu(e,i,a)&&e.stroke())})}function iG(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return Dg(t,u=>{let l,c,f;const h=u.bounds;if(h&&!h.contains(r,s))return;c=u.x||0,f=u.y||0;const g=c+(u.width||0),p=f+(u.height||0),m=u.clip;if(m&&(r<c||r>g||s<f||s>p))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,m&&Tv(u)&&!tG(e,u,o,a))return e.restore(),null;const y=u.strokeForeground,x=t.interactive!==!1;return x&&y&&u.stroke&&eG(e,u,o,a)?(e.restore(),u):(l=Dg(u,w=>rG(w,c,f)?this.pick(w,n,i,c,f):null),!l&&x&&(u.fill||!y&&u.stroke)&&ZW(e,u,o,a)&&(l=u),e.restore(),l||null)})}function rG(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var sG={type:"group",tag:"g",nested:!1,attr:VW,bound:JW,draw:nG,pick:iG,isect:cF,content:KW,background:XW,foreground:QW},of={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Kv(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function Jv(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Zv(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Tg(e,t){return e==="center"?t/2:e==="right"?t:0}function Ng(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function oG(e,t,n){const i=Kv(t,n),r=Jv(t,i),s=Zv(t,i),o=(t.x||0)-Tg(t.align,r),a=(t.y||0)-Ng(t.baseline,s),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,of["xmlns:xlink"],"xlink:href"),e("transform",xa(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function aG(e,t){const n=t.image,i=Jv(t,n),r=Zv(t,n),s=(t.x||0)-Tg(t.align,i),o=(t.y||0)-Ng(t.baseline,r);return e.set(s,o,s+i,o+r)}function uG(e,t,n){Ui(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=Kv(i,this);let s=Jv(i,r),o=Zv(i,r);if(s===0||o===0)return;let a=(i.x||0)-Tg(i.align,s),u=(i.y||0)-Ng(i.baseline,o),l,c,f,h;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(h=s/c,u+=(o-h)/2,o=h):(h=o*c,a+=(s-h)/2,s=h))),(r.complete||r.toDataURL)&&(Xu(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,u,s,o))})}var lG={type:"image",tag:"image",nested:!1,attr:oG,bound:aG,draw:uG,pick:Mg(),isect:di,get:Kv,xOffset:Tg,yOffset:Ng},cG=Qv("line",$W,HW);function fG(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",UW(t)),e("d",t.path)}function Rg(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*no,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Wu(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Kc(e,u,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Kc(e,u,i,r,s,o)}function dG(e,t){return Rg(nf(e,t.angle),t)?e.set(0,0,0,0):os(e,t,!0)}var hG={type:"path",tag:"path",nested:!1,attr:fG,bound:dG,draw:Gv(Rg),pick:Yv(Rg),isect:qv(Rg)};function gG(e,t){e("d",Yu(null,t))}function pG(e,t){var n,i;return os(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function vF(e,t){e.beginPath(),Yu(e,t)}var mG={type:"rect",tag:"path",nested:!1,attr:gG,bound:pG,draw:Gv(vF),pick:Yv(vF),isect:cF};function yG(e,t){e("transform",pF(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function bG(e,t){var n,i;return os(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function xF(e,t,n){var i,r,s,o;return t.stroke&&Qu(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function vG(e,t,n){Ui(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&xF(e,i,r)&&(Xu(e,i),e.stroke())}})}function xG(e,t,n,i){return e.isPointInStroke?xF(e,t,1)&&e.isPointInStroke(n,i):!1}var wG={type:"rule",tag:"line",nested:!1,attr:yG,bound:bG,draw:vG,pick:Mg(xG),isect:fF},EG=Xv("shape",jW),AG=Xv("symbol",kW,Hv);const wF=hO();var wr={height:Er,measureWidth:tx,estimateWidth:ex,width:ex,canvas:EF};EF(!0);function EF(e){wr.width=e&&so?tx:ex}function ex(e,t){return AF(ao(e,t),Er(e))}function AF(e,t){return~~(.8*e.length*t)}function tx(e,t){return Er(e)<=0||!(t=ao(e,t))?0:_F(t,Pg(e))}function _F(e,t){const n=`(${t}) ${e}`;let i=wF.get(n);return i===void 0&&(so.font=t,i=so.measureText(e).width,wF.set(n,i)),i}function Er(e){return e.fontSize!=null?+e.fontSize||0:11}function oo(e){return e.lineHeight!=null?e.lineHeight:Er(e)+2}function _G(e){return Z(e)?e.length>1?e:e[0]:e}function af(e){return _G(e.lineBreak&&e.text&&!Z(e.text)?e.text.split(e.lineBreak):e.text)}function nx(e){const t=af(e);return(Z(t)?t.length-1:0)*oo(e)}function ao(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?OG(e,n):n}function SG(e){if(wr.width===tx){const t=Pg(e);return n=>_F(n,t)}else{const t=Er(e);return n=>AF(n,t)}}function OG(e,t){var n=+e.limit,i=SG(e);if(i(t)<n)return t;var r=e.ellipsis||"\u2026",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=i(r),s){for(;o<a;)u=o+a>>>1,i(t.slice(u))>n?o=u+1:a=u;return r+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),i(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+r}}function uf(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Pg(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Er(e)+"px "+uf(e,t)}function ix(e){var t=e.baseline,n=Er(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*oo(e):t==="line-bottom"?.29*n-.5*oo(e):0)}const CG={left:"start",center:"middle",right:"end"},lf=new wt;function Lg(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-ma,t+=i*Math.cos(r),n+=i*Math.sin(r)),lf.x1=t,lf.y1=n,lf}function $G(e,t){var n=t.dx||0,i=(t.dy||0)+ix(t),r=Lg(t),s=r.x1,o=r.y1,a=t.angle||0,u;e("text-anchor",CG[t.align]||"start"),a?(u=xa(s,o)+" "+Vv(a),(n||i)&&(u+=" "+xa(n,i))):u=xa(s+n,o+i),e("transform",u)}function rx(e,t,n){var i=wr.height(t),r=t.align,s=Lg(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+ix(t)-Math.round(.8*i),c=af(t),f;if(Z(c)?(i+=oo(t)*(c.length-1),f=c.reduce((h,g)=>Math.max(h,wr.width(t,g)),0)):f=wr.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+i),t.angle&&!n)e.rotate(t.angle*no,o,a);else if(n===2)return e.rotatedPoints(t.angle*no,o,a);return e}function jG(e,t,n){Ui(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Pg(i),e.textAlign=i.align||"left",s=Lg(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*no),o=a=0),o+=i.dx||0,a+=(i.dy||0)+ix(i),c=af(i),Xu(e,i),Z(c))for(l=oo(i),u=0;u<c.length;++u)f=ao(i,c[u]),i.fill&&Fg(e,i,r)&&e.fillText(f,o,a),i.stroke&&Qu(e,i,r)&&e.strokeText(f,o,a),a+=l;else f=ao(i,c),i.fill&&Fg(e,i,r)&&e.fillText(f,o,a),i.stroke&&Qu(e,i,r)&&e.strokeText(f,o,a);i.angle&&e.restore()}})}function kG(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Lg(t),a=o.x1,u=o.y1,l=rx(lf,t,1),c=-t.angle*no,f=Math.cos(c),h=Math.sin(c),g=f*r-h*s+(a-f*a+h*u),p=h*r+f*s+(u-h*a-f*u);return l.contains(g,p)}function FG(e,t){const n=rx(lf,e,2);return Vu(t,n[0],n[1],n[2],n[3])||Vu(t,n[0],n[1],n[4],n[5])||Vu(t,n[4],n[5],n[6],n[7])||Vu(t,n[2],n[3],n[6],n[7])}var DG={type:"text",tag:"text",nested:!1,attr:$G,bound:rx,draw:jG,pick:Mg(kG),isect:FG},MG=Qv("trail",FW,WW),ni={arc:zW,area:GW,group:sG,image:lG,line:cG,path:hG,rect:mG,rule:wG,shape:EG,symbol:AG,text:DG,trail:MG};function sx(e,t,n){var i=ni[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new wt),e,n)}var SF={mark:null};function OF(e,t,n){var i=ni[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,u,l,c;if(i.nested)return o?l=s[0]:(SF.mark=e,l=SF),c=sx(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new wt,o)for(a=0,u=s.length;a<u;++a)t.union(sx(s[a],r,n));return e.bounds=t}const TG=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function CF(e,t){return JSON.stringify(e,TG,t)}function $F(e){const t=typeof e=="string"?JSON.parse(e):e;return jF(t)}function jF(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&jF(n[r]);return t&&OF(e),e}function ox(e){arguments.length?this.root=$F(e):(this.root=kF({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Sg(this.root)])}ox.prototype={toJSON(e){return CF(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=kF(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function kF(e,t){const n={bounds:new wt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function uo(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function ax(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Pn(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=uo(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function zi(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function FF(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ig(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function NG(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=ni[r.marktype]).tip){for(o=Ig(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}function lo(e,t){this._active=null,this._handlers={},this._loader=e||Mh(),this._tooltip=t||RG}function RG(e,t,n,i){e.element().setAttribute("title",i||"")}lo.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),s=uo(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=NG(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:s,height:o,left:a,top:u,right:a+s,bottom:u+o}}};function Ar(e){this._el=null,this._bgcolor=null,this._loader=new Rv(e)}Ar.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const PG="keydown",LG="keypress",IG="keyup",DF="dragenter",Bg="dragleave",MF="dragover",ux="mousedown",BG="mouseup",Ug="mousemove",cf="mouseout",TF="mouseover",zg="click",UG="dblclick",zG="wheel",NF="mousewheel",qg="touchstart",Hg="touchmove",Wg="touchend",qG=[PG,LG,IG,DF,Bg,MF,ux,BG,Ug,cf,TF,zg,UG,zG,NF,qg,Hg,Wg],lx=Ug,ff=cf,cx=zg;function df(e,t){lo.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const HG=e=>e===qg||e===Hg||e===Wg?[qg,Hg,Wg]:[e];function RF(e,t){HG(t).forEach(n=>WG(e,n))}function WG(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function PF(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(t,i),this.fire(e,i))}}function LF(e){return function(t){this.fire(e,t),this._active=null}}H(df,lo,{initialize(e,t,n){return this._canvas=e&&ax(e,"canvas"),[zg,ux,Ug,cf,Bg].forEach(i=>RF(this,i)),lo.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:qG,DOMMouseScroll(e){this.fire(NF,e)},mousemove:PF(Ug,TF,cf),dragover:PF(MF,DF,Bg),mouseout:LF(cf),dragleave:LF(Bg),mousedown(e){this._down=this._active,this.fire(ux,e)},click(e){this._down===this._active&&(this.fire(zg,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(qg,e,!0)},touchmove(e){this.fire(Hg,e,!0)},touchend(e){this.fire(Wg,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===cx&&i&&i.href?this.handleHref(t,i,i.href):(e===lx||e===ff)&&this.handleTooltip(t,i,e!==ff),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(RF(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=Ig(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const s=this.context();return ni[e.marktype].pick.call(this,s,e,t,n,i,r)}});function GG(){return typeof window!="undefined"&&window.devicePixelRatio||1}var YG=GG();function VG(e,t,n,i,r,s){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=o?YG:r;e.width=t*u,e.height=n*u;for(const l in s)a[l]=s[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function Gg(e){Ar.call(this,e),this._options={},this._redraw=!1,this._dirty=new wt,this._tempb=new wt}const IF=Ar.prototype,XG=(e,t,n)=>new wt().set(0,0,t,n).translate(-e[0],-e[1]);function QG(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}H(Gg,Ar,{initialize(e,t,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Ru(1,1,this._options.type),e&&this._canvas&&(zi(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),IF.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(IF.resize.call(this,e,t,n,i),this._canvas)VG(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||P("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=XG(n,i,r);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):QG(t,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const i=ni[t.marktype];t.clip&&YW(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,s=this.context();r.type!=="pdf"&&!r.externalContext&&s.clearRect(e,t,n,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,i))}});function fx(e,t){lo.call(this,e,t);const n=this;n._hrefHandler=dx(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=dx(n,(i,r)=>{n.handleTooltip(i,r,i.type!==ff)})}const dx=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};H(fx,lo,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(cx,this._hrefHandler),i.removeEventListener(lx,this._tooltipHandler),i.removeEventListener(ff,this._tooltipHandler)),this._svg=i=e&&ax(e,"svg"),i&&(i.addEventListener(cx,this._hrefHandler),i.addEventListener(lx,this._tooltipHandler),i.addEventListener(ff,this._tooltipHandler)),lo.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const s={type:e,handler:t,listener:dx(this,t)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const BF="aria-hidden",hx="aria-label",gx="role",px="aria-roledescription",UF="graphics-object",mx="graphics-symbol",zF=(e,t,n)=>({[gx]:e,[px]:t,[hx]:n||void 0}),KG=Pi(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),qF={axis:{desc:"axis",caption:eY},legend:{desc:"legend",caption:tY},"title-text":{desc:"title",caption:e=>`Title text '${YF(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${YF(e)}'`}},HF={ariaRole:gx,ariaRoleDescription:px,description:hx};function WF(e,t){const n=t.aria===!1;if(e(BF,n||void 0),n||t.description==null)for(const i in HF)e(HF[i],void 0);else{const i=t.mark.marktype;e(hx,t.description),e(gx,t.ariaRole||(i==="group"?UF:mx)),e(px,t.ariaRoleDescription||`${i} mark`)}}function GF(e){return e.aria===!1?{[BF]:!0}:KG[e.role]?null:qF[e.role]?ZG(e,qF[e.role]):JG(e)}function JG(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return zF(n?UF:mx,`${t} mark container`,e.description)}function ZG(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return zF(t.role||mx,t.desc,n.description||i(n))}catch{return null}}function YF(e){return ae(e.text).join(" ")}function eY(e){const t=e.datum,n=e.orient,i=t.title?VF(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Hu(a)?"discrete":a} scale with ${Hk(o,s,e)}`}function tY(e){const t=e.datum,n=t.title?VF(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,u=o.dataflow.locale();return iY(i)+(n?` titled '${n}'`:"")+` for ${nY(s)} with ${Hk(u,a,e)}`}function VF(e){try{return ae(Ee(e.items).items[0].text).join(" ")}catch{return null}}function nY(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Ee(e)}function iY(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const XF=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),rY=e=>XF(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function yx(){let e="",t="",n="";const i=[],r=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${rY(l)}"`),a),a={open(u,...l){s(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return a},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),a},attr:o,text:u=>(n+=XF(u),a),toString:()=>e};return a}const QF=e=>KF(yx(),e)+"";function KF(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes,i=n.length;for(let r=0;r<i;r++){const s=n[r];s.nodeType===3?e.text(s.nodeValue):KF(e,s)}}return e.close()}const Yg={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},JF={fill:"none","stroke-miterlimit":10},hf=0,ZF="http://www.w3.org/2000/xmlns/",Et=of.xmlns;function bx(e){Ar.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const vx=Ar.prototype;H(bx,Ar,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=Pn(e,0,"svg",Et),this._svg.setAttributeNS(ZF,"xmlns",Et),this._svg.setAttributeNS(ZF,"xmlns:xlink",of["xmlns:xlink"]),this._svg.setAttribute("version",of.version),this._svg.setAttribute("class","marks"),zi(e,1),this._root=Pn(this._svg,hf,"g",Et),co(this._root,JF),zi(this._svg,hf+1)),this.background(this._bgcolor),vx.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),vx.background.apply(this,arguments)},resize(e,t,n,i){return vx.resize.call(this,e,t,n,i),this._svg&&(co(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Pn(e,hf,"rect",Et),co(n,{width:this._width,height:this._height,fill:t}));const i=QF(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),zi(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,s,o,a,u;for(o=0,a=e.length;o<a;++o)if(n=e[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=ni[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,eD(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){s.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(s,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=s.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,eD(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=ni[t.marktype],s=t.interactive===!1?"none":null,o=r.tag==="g";let a=null,u=0;const l=tD(t,e,n,"g",i);l.setAttribute("class",FF(t));const c=GF(t);for(const h in c)pn(l,h,c[h]);o||pn(l,"pointer-events",s),pn(l,"clip-path",t.clip?Nv(this,t,t.group):null);const f=h=>{const g=this.isDirty(h),p=tD(h,l,a,r.tag,i);g&&(this._update(r,p,h),o&&aY(this,p,h)),a=p,++u};return r.nested?t.items.length&&f(t.items[0]):Ui(t,f),zi(l,u),l},_update(e,t,n){as=t,Jt=t.__values__,WF(gf,n),e.attr(gf,n,this);const i=lY[e.type];i&&i.call(this,e,t,n),as&&this.style(as,n)},style(e,t){if(t!=null)for(const n in Yg){let i=n==="font"?uf(t):t[n];if(i===Jt[n])continue;const r=Yg[n];i==null?e.removeAttribute(r):(jv(i)&&(i=Gk(i,this._defs.gradient,nD())),e.setAttribute(r,i+"")),Jt[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=Pn(e,hf+1,"defs",Et)),i=sY(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=Pn(e,hf+1,"defs",Et)),i=oY(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):zi(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function eD(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function sY(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=Pn(e,n++,"pattern",Et);co(o,{id:wg+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=Pn(o,0,"rect",Et),co(o,{width:1,height:1,fill:`url(${nD()}#${t.id})`}),e=Pn(e,n++,"radialGradient",Et),co(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Pn(e,n++,"linearGradient",Et),co(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=Pn(e,i,"stop",Et),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return zi(e,i),n}function oY(e,t,n){let i;return e=Pn(e,n,"clipPath",Et),e.setAttribute("id",t.id),t.path?(i=Pn(e,0,"path",Et),i.setAttribute("d",t.path)):(i=Pn(e,0,"rect",Et),co(i,{x:0,y:0,width:t.width,height:t.height})),zi(e,1),n+1}function aY(e,t,n){t=t.lastChild.previousSibling;let i,r=0;Ui(n,s=>{i=e.mark(t,s,i),++r}),zi(t,1+r)}function tD(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=uo(o,i,Et),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=uo(o,"path",Et);s.appendChild(a),a.__data__=e;const u=uo(o,"g",Et);s.appendChild(u),u.__data__=e;const l=uo(o,"path",Et);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==r||uY(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function uY(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let as=null,Jt=null;const lY={group(e,t,n){const i=as=t.childNodes[2];Jt=i.__values__,e.foreground(gf,n,this),Jt=t.__values__,as=t.childNodes[1],e.content(gf,n,this);const r=as=t.childNodes[0];e.background(gf,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==Jt.events&&(pn(i,"pointer-events",s),pn(r,"pointer-events",s),Jt.events=s),n.strokeForeground&&n.stroke){const o=n.fill;pn(i,"display",null),this.style(r,n),pn(r,"stroke",null),o&&(n.fill=null),Jt=i.__values__,this.style(i,n),o&&(n.fill=o),as=null}else pn(i,"display","none")},image(e,t,n){n.smooth===!1?(xx(t,"image-rendering","optimizeSpeed"),xx(t,"image-rendering","pixelated")):xx(t,"image-rendering",null)},text(e,t,n){const i=af(n);let r,s,o,a;Z(i)?(s=i.map(u=>ao(n,u)),r=s.join(`
`),r!==Jt.text&&(zi(t,0),o=t.ownerDocument,a=oo(n),s.forEach((u,l)=>{const c=uo(o,"tspan",Et);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Jt.text=r)):(s=ao(n,i),s!==Jt.text&&(t.textContent=s,Jt.text=s)),pn(t,"font-family",uf(n)),pn(t,"font-size",Er(n)+"px"),pn(t,"font-style",n.fontStyle),pn(t,"font-variant",n.fontVariant),pn(t,"font-weight",n.fontWeight)}};function gf(e,t,n){t!==Jt[e]&&(n?cY(as,e,t,n):pn(as,e,t),Jt[e]=t)}function xx(e,t,n){n!==Jt[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Jt[t]=n)}function co(e,t){for(const n in t)pn(e,n,t[n])}function pn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function cY(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function nD(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function wx(e){Ar.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}H(wx,Ar,{svg(){return this._text},_render(e){const t=yx();t.open("svg",pe({},of,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",JF,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=ni[t.marktype],i=n.tag,r=[WF,n.attr];e.open("g",{class:FF(t),"clip-path":t.clip?Nv(this,t,t.group):null},GF(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(i,this.attr(t,o,r,i!=="g"?i:null)),i==="text"){const u=af(o);if(Z(u)){const l={x:0,dy:oo(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(ao(o,u[c])).close()}else e.text(ao(o,u))}else if(i==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Ui(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Ui(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},s=(o,a,u,l)=>{r[l||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),i&&fY(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const s=t[r],o=s.stops;s.gradient==="radial"?(e.open("pattern",{id:wg+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const r in n){const s=n[r];e.open("clipPath",{id:r}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function fY(e,t,n,i,r){if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(e["font-family"]=uf(t),e["font-size"]=Er(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in Yg){let o=t[s];const a=Yg[s];o==="transparent"&&(a==="fill"||a==="stroke")||o!=null&&(jv(o)&&(o=Gk(o,r.gradient,"")),e[a]=o)}return e}const iD="canvas",rD="png",sD="svg",oD="none",fo={Canvas:iD,PNG:rD,SVG:sD,None:oD},Ku={};Ku[iD]=Ku[rD]={renderer:Gg,headless:Gg,handler:df};Ku[sD]={renderer:bx,headless:wx,handler:fx};Ku[oD]={};function Vg(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Ku[e]=t,this):Ku[e]}function aD(e,t,n){const i=[],r=new wt().union(t),s=e.marktype;return s?uD(e,r,n,i):s==="group"?lD(e,r,n,i):P("Intersect scene must be mark node or group item.")}function uD(e,t,n,i){if(dY(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)lD(r[a],t,n,i);else for(const u=ni[s].isect;a<o;++a){const l=r[a];cD(l,t,u)&&i.push(l)}}return i}function dY(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function lD(e,t,n,i){n&&n(e.mark)&&cD(e,t,ni.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let u=0;u<s;++u)uD(r[u],t,n,i);t.translate(o,a)}return i}function cD(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const Ex=new wt;function fD(e){const t=e.clip;if(ye(t))t(nf(Ex.clear()));else if(t)Ex.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(Ex)}const hY=1e-9;function Ax(e,t,n){return e===t?!0:n==="path"?dD(e,t):e instanceof Date&&t instanceof Date?+e==+t:Ls(e)&&Ls(t)?Math.abs(e-t)<=hY:!e||!t||!fe(e)&&!fe(t)?e==t:gY(e,t)}function dD(e,t){return Ax(Wu(e),Wu(t))}function gY(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!Ax(e[r],t[r],r))return!1;return typeof e==typeof t}function pY(){iF(),WH()}const Ju="top",qi="left",Hi="right",ho="bottom",mY="top-left",yY="top-right",bY="bottom-left",vY="bottom-right",_x="start",Sx="middle",mn="end",xY="x",wY="y",Xg="group",Ox="axis",Cx="title",EY="frame",AY="scope",$x="legend",hD="row-header",gD="row-footer",pD="row-title",mD="column-header",yD="column-footer",bD="column-title",_Y="padding",SY="symbol",vD="fit",OY="fit-x",CY="fit-y",$Y="pad",jx="none",Qg="all",kx="each",Fx="flush",go="column",po="row";function xD(e){T.call(this,null,e)}H(xD,T,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=ni[r],o=s.bound;let a=i.bounds,u;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=Kg(i,o),i.items.forEach(l=>{l.bounds.clear().union(a)});else if(r===Xg||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),i.items.forEach(l=>a.union(Kg(l,o))),i.role){case Ox:case $x:case Cx:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(Kg(l,o))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(Kg(l,o))}),u&&(a.clear(),i.items.forEach(l=>a.union(l.bounds)));return fD(i),t.modifies("bounds")}});function Kg(e,t,n){return t(e.bounds.clear(),e,n)}const wD=":vega_identifier:";function Dx(e){T.call(this,0,e)}Dx.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};H(Dx,T,{transform(e,t){const n=jY(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function jY(e){return e._signals[wD]||(e._signals[wD]=e.add(0))}function ED(e){T.call(this,null,e)}H(ED,T,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,kY(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Xg?Sg:_g;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function kY(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function AD(e){T.call(this,null,e)}const _D={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!SD(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},SD=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),OD=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(SD(r,s=e[n].bounds,t))return!0},FY=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},DY=(e,t,n)=>{var i=e.range(),r=new wt;return t===Ju||t===ho?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},CD=e=>(e.forEach(t=>t.opacity=1),e),$D=(e,t)=>e.reflow(t.modified()).modifies("opacity");H(AD,T,{transform(e,t){const n=_D[e.method]||_D.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(CD(r),t=$D(t,e)),t;if(r=r.filter(FY),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=CD(r),t=$D(t,e),s.length>=3&&OD(s,i)){do s=n(s,i);while(s.length>=3&&OD(s,i));s.length<3&&!Ee(r).opacity&&(s.length>1&&(Ee(s).opacity=0),Ee(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=DY(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{o(u)||(u.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function jD(e){T.call(this,null,e)}H(jD,T,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Zt=new wt;function Zu(e,t,n){return e[t]===n?0:(e[t]=n,1)}function MY(e){var t=e.items[0].orient;return t===qi||t===Hi}function TY(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function NY(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,u=TY(s),l=r.range,c=r.offset,f=r.position,h=r.minExtent,g=r.maxExtent,p=s.title&&r.items[u[2]].items[0],m=r.titlePadding,y=r.bounds,x=p&&nx(p),w=0,E=0,A,S;switch(Zt.clear().union(y),y.clear(),(A=u[0])>-1&&y.union(r.items[A].bounds),(A=u[1])>-1&&y.union(r.items[A].bounds),a){case Ju:w=f||0,E=-c,S=Math.max(h,Math.min(g,-y.y1)),y.add(0,-S).add(l,0),p&&Jg(e,p,S,m,x,0,-1,y);break;case qi:w=-c,E=f||0,S=Math.max(h,Math.min(g,-y.x1)),y.add(-S,0).add(0,l),p&&Jg(e,p,S,m,x,1,-1,y);break;case Hi:w=n+c,E=f||0,S=Math.max(h,Math.min(g,y.x2)),y.add(0,0).add(S,l),p&&Jg(e,p,S,m,x,1,1,y);break;case ho:w=f||0,E=i+c,S=Math.max(h,Math.min(g,y.y2)),y.add(0,0).add(l,S),p&&Jg(e,p,S,m,0,0,1,y);break;default:w=r.x,E=r.y}return os(y.translate(w,E),r),Zu(r,"x",w+o)|Zu(r,"y",E+o)&&(r.bounds=Zt,e.dirty(r),r.bounds=y,e.dirty(r)),r.mark.bounds.clear().union(y)}function Jg(e,t,n,i,r,s,o,a){const u=t.bounds;if(t.auto){const l=o*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const kD=(e,t)=>Math.floor(Math.min(e,t)),FD=(e,t)=>Math.ceil(Math.max(e,t));function RY(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===Xg)switch(r.role){case Ox:case $x:case Cx:break;case hD:o.rowheaders.push(...s);break;case gD:o.rowfooters.push(...s);break;case mD:o.colheaders.push(...s);break;case yD:o.colfooters.push(...s);break;case pD:o.rowtitle=s[0];break;case bD:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function PY(e){return new wt().set(0,0,e.width||0,e.height||0)}function LY(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Je(e,t,n){const i=fe(e)?e[t]:e;return i!=null?i:n!==void 0?n:0}function DD(e){return e<0?Math.ceil(-e):0}function MD(e,t,n){var i=!n.nodirty,r=n.bounds===Fx?PY:LY,s=Zt.set(0,0,0,0),o=Je(n.align,go),a=Je(n.align,po),u=Je(n.padding,go),l=Je(n.padding,po),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),h=t.length,g=Array(h),p=Array(c),m=0,y=Array(h),x=Array(f),w=0,E=Array(h),A=Array(h),S=Array(h),O,_,C,j,$,k,M,D,I,F,L;for(_=0;_<c;++_)p[_]=0;for(_=0;_<f;++_)x[_]=0;for(_=0;_<h;++_)k=t[_],$=S[_]=r(k),k.x=k.x||0,E[_]=0,k.y=k.y||0,A[_]=0,C=_%c,j=~~(_/c),m=Math.max(m,M=Math.ceil($.x2)),w=Math.max(w,D=Math.ceil($.y2)),p[C]=Math.max(p[C],M),x[j]=Math.max(x[j],D),g[_]=u+DD($.x1),y[_]=l+DD($.y1),i&&e.dirty(t[_]);for(_=0;_<h;++_)_%c==0&&(g[_]=0),_<c&&(y[_]=0);if(o===kx)for(C=1;C<c;++C){for(L=0,_=C;_<h;_+=c)L<g[_]&&(L=g[_]);for(_=C;_<h;_+=c)g[_]=L+p[C-1]}else if(o===Qg){for(L=0,_=0;_<h;++_)_%c&&L<g[_]&&(L=g[_]);for(_=0;_<h;++_)_%c&&(g[_]=L+m)}else for(o=!1,C=1;C<c;++C)for(_=C;_<h;_+=c)g[_]+=p[C-1];if(a===kx)for(j=1;j<f;++j){for(L=0,_=j*c,O=_+c;_<O;++_)L<y[_]&&(L=y[_]);for(_=j*c;_<O;++_)y[_]=L+x[j-1]}else if(a===Qg){for(L=0,_=c;_<h;++_)L<y[_]&&(L=y[_]);for(_=c;_<h;++_)y[_]=L+w}else for(a=!1,j=1;j<f;++j)for(_=j*c,O=_+c;_<O;++_)y[_]+=x[j-1];for(I=0,_=0;_<h;++_)I=g[_]+(_%c?I:0),E[_]+=I-t[_].x;for(C=0;C<c;++C)for(F=0,_=C;_<h;_+=c)F+=y[_],A[_]+=F-t[_].y;if(o&&Je(n.center,go)&&f>1)for(_=0;_<h;++_)$=o===Qg?m:p[_%c],I=$-S[_].x2-t[_].x-E[_],I>0&&(E[_]+=I/2);if(a&&Je(n.center,po)&&c!==1)for(_=0;_<h;++_)$=a===Qg?w:x[~~(_/c)],F=$-S[_].y2-t[_].y-A[_],F>0&&(A[_]+=F/2);for(_=0;_<h;++_)s.union(S[_].translate(E[_],A[_]));switch(I=Je(n.anchor,xY),F=Je(n.anchor,wY),Je(n.anchor,go)){case mn:I-=s.width();break;case Sx:I-=s.width()/2}switch(Je(n.anchor,po)){case mn:F-=s.height();break;case Sx:F-=s.height()/2}for(I=Math.round(I),F=Math.round(F),s.clear(),_=0;_<h;++_)t[_].mark.bounds.clear();for(_=0;_<h;++_)k=t[_],k.x+=E[_]+=I,k.y+=A[_]+=F,s.union(k.mark.bounds.union(k.bounds.translate(E[_],A[_]))),i&&e.dirty(k);return s}function IY(e,t,n){var i=RY(t),r=i.marks,s=n.bounds===Fx?BY:UY,o=n.offset,a=n.columns||r.length,u=a<=0?1:Math.ceil(r.length/a),l=u*a,c,f,h,g,p,m,y;const x=MD(e,r,n);x.empty()&&x.set(0,0,0,0),i.rowheaders&&(m=Je(n.headerBand,po,null),c=Zg(e,i.rowheaders,r,a,u,-Je(o,"rowHeader"),kD,0,s,"x1",0,a,1,m)),i.colheaders&&(m=Je(n.headerBand,go,null),f=Zg(e,i.colheaders,r,a,a,-Je(o,"columnHeader"),kD,1,s,"y1",0,1,a,m)),i.rowfooters&&(m=Je(n.footerBand,po,null),h=Zg(e,i.rowfooters,r,a,u,Je(o,"rowFooter"),FD,0,s,"x2",a-1,a,1,m)),i.colfooters&&(m=Je(n.footerBand,go,null),g=Zg(e,i.colfooters,r,a,a,Je(o,"columnFooter"),FD,1,s,"y2",l-a,1,a,m)),i.rowtitle&&(p=Je(n.titleAnchor,po),y=Je(o,"rowTitle"),y=p===mn?h+y:c-y,m=Je(n.titleBand,po,.5),TD(e,i.rowtitle,y,0,x,m)),i.coltitle&&(p=Je(n.titleAnchor,go),y=Je(o,"columnTitle"),y=p===mn?g+y:f-y,m=Je(n.titleBand,go,.5),TD(e,i.coltitle,y,1,x,m))}function BY(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function UY(e,t){return e.bounds[t]}function Zg(e,t,n,i,r,s,o,a,u,l,c,f,h,g){var p=n.length,m=0,y=0,x,w,E,A,S,O,_,C,j;if(!p)return m;for(x=c;x<p;x+=f)n[x]&&(m=o(m,u(n[x],l)));if(!t.length)return m;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),m+=s,w=0,A=t.length;w<A;++w)e.dirty(t[w]),t[w].mark.bounds.clear();for(x=c,w=0,A=t.length;w<A;++w,x+=f){for(O=t[w],S=O.mark.bounds,E=x;E>=0&&(_=n[E])==null;E-=h);a?(C=g==null?_.x:Math.round(_.bounds.x1+g*_.bounds.width()),j=m):(C=m,j=g==null?_.y:Math.round(_.bounds.y1+g*_.bounds.height())),S.union(O.bounds.translate(C-(O.x||0),j-(O.y||0))),O.x=C,O.y=j,e.dirty(O),y=o(y,S[l])}return y}function TD(e,t,n,i,r,s){if(!!t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function zY(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function qY(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function HY(e,t,n,i,r,s,o){const a=zY(n,t),u=qY(e,a("offset",0)),l=a("anchor",_x),c=l===mn?1:l===Sx?.5:0,f={align:kx,bounds:a("bounds",Fx),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case qi:f.anchor={x:Math.floor(i.x1)-u,column:mn,y:c*(o||i.height()+2*i.y1),row:l};break;case Hi:f.anchor={x:Math.ceil(i.x2)+u,y:c*(o||i.height()+2*i.y1),row:l};break;case Ju:f.anchor={y:Math.floor(r.y1)-u,row:mn,x:c*(s||r.width()+2*r.x1),column:l};break;case ho:f.anchor={y:Math.ceil(r.y2)+u,x:c*(s||r.width()+2*r.x1),column:l};break;case mY:f.anchor={x:u,y:u};break;case yY:f.anchor={x:s-u,y:u,column:mn};break;case bY:f.anchor={x:u,y:o-u,row:mn};break;case vY:f.anchor={x:s-u,y:o-u,column:mn,row:mn};break}return f}function WY(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),YY(e,n,n.items[0].items[0]),s=GY(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),i.type===SY&&VY(n.items[0].items[0].items[0].items),r!==jx&&(n.x=o=0,n.y=a=0),n.width=u,n.height=l,os(s.set(o,a,o+u,a+l),n),n.mark.bounds.clear().union(s),n}function GY(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function YY(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&pf(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,u=t.titlePadding||0,l=i-o.x,c=i-o.y;switch(o.orient){case qi:r+=Math.ceil(o.bounds.width())+u;break;case Hi:case ho:break;default:s+=o.bounds.height()+u}switch((r||s)&&pf(e,n,r,s),o.orient){case qi:c+=el(t,n,o,a,1,1);break;case Hi:l+=el(t,n,o,mn,0,0)+u,c+=el(t,n,o,a,1,1);break;case ho:l+=el(t,n,o,a,0,0),c+=el(t,n,o,mn,-1,0,1)+u;break;default:l+=el(t,n,o,a,0,0)}(l||c)&&pf(e,o,l,c),(l=Math.round(o.bounds.x1-i))<0&&(pf(e,n,-l,0),pf(e,o,-l,0))}}function el(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(s||!u)&&!o?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&s?c:0,h=u&&s?0:c,g=r<=0?0:nx(n);return Math.round(i===_x?f:i===mn?h-g:.5*(c-g))}function pf(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function VY(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function XY(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],h=s.items[1]&&s.items[1].items[0],g=a===qi||a===Hi?i:n,p=0,m=0,y=0,x=0,w=0,E;if(o!==Xg?a===qi?(p=r.y2,g=r.y1):a===Hi?(p=r.y1,g=r.y2):(p=r.x1,g=r.x2):a===qi&&(p=i,g=0),E=u===_x?p:u===mn?g:(p+g)/2,h&&h.text){switch(a){case Ju:case ho:w=f.bounds.height()+c;break;case qi:x=f.bounds.width()+c;break;case Hi:x=-f.bounds.width()-c;break}Zt.clear().union(h.bounds),Zt.translate(x-(h.x||0),w-(h.y||0)),Zu(h,"x",x)|Zu(h,"y",w)&&(e.dirty(h),h.bounds.clear().union(Zt),h.mark.bounds.clear().union(Zt),e.dirty(h)),Zt.clear().union(h.bounds)}else Zt.clear();switch(Zt.union(f.bounds),a){case Ju:m=E,y=r.y1-Zt.height()-l;break;case qi:m=r.x1-Zt.width()-l,y=E;break;case Hi:m=r.x2+Zt.width()+l,y=E;break;case ho:m=E,y=r.y2+l;break;default:m=s.x,y=s.y}return Zu(s,"x",m)|Zu(s,"y",y)&&(Zt.translate(m,y),e.dirty(s),s.bounds.clear().union(Zt),t.bounds.clear().union(Zt),e.dirty(s)),s.bounds}function ND(e){T.call(this,null,e)}H(ND,T,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&IY(n,i,e.layout),KY(n,i,e)}),QY(e.mark.group)?t.reflow():t}});function QY(e){return e&&e.mark.role!=="legend-entry"}function KY(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new wt().set(0,0,r,s),a=o.clone(),u=o.clone(),l=[],c,f,h,g,p,m;for(p=0,m=i.length;p<m;++p)switch(f=i[p],f.role){case Ox:g=MY(f)?a:u,g.union(NY(e,f,r,s));break;case Cx:c=f;break;case $x:l.push(WY(e,f));break;case EY:case AY:case hD:case gD:case pD:case mD:case yD:case bD:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const y={};l.forEach(x=>{h=x.orient||Hi,h!==jx&&(y[h]||(y[h]=[])).push(x)});for(const x in y){const w=y[x];MD(e,w,HY(w,x,n.legends,a,u,r,s))}l.forEach(x=>{const w=x.bounds;if(w.equals(x._bounds)||(x.bounds=x._bounds,e.dirty(x),x.bounds=w,e.dirty(x)),n.autosize&&n.autosize.type===vD)switch(x.orient){case qi:case Hi:o.add(w.x1,0).add(w.x2,0);break;case Ju:case ho:o.add(0,w.y1).add(0,w.y2)}else o.union(w)})}o.union(a).union(u),c&&o.union(XY(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),JY(e,t,o,n)}function JY(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-u)),g=Math.max(0,Math.ceil(n.y2-c));if(r.contains===_Y){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===jx?(l=0,f=0,u=o,c=a):s===vD?(u=Math.max(0,o-l-h),c=Math.max(0,a-f-g)):s===OY?(u=Math.max(0,o-l-h),a=c+f+g):s===CY?(o=u+l+h,c=Math.max(0,a-f-g)):s===$Y&&(o=u+l+h,a=c+f+g),e._resizeView(o,a,u,c,[l,f],r.resize)}var ZY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:xD,identifier:Dx,mark:ED,overlap:AD,render:jD,viewlayout:ND});function RD(e){T.call(this,null,e)}H(RD,T,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=Ov(s,o,e.minstep),u=e.format||Pk(n,s,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?Rk(s,e.values,a):Cv(s,a);return r&&(i.rem=r),r=l.map((c,f)=>Ne({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Ne({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function PD(e){T.call(this,null,e)}function eV(){return Ne({})}function tV(e){const t=wu().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}H(PD,T,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||eV,s=e.key||ee,o=this.value;return Z(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&P("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=tV(s)),t.visit(t.ADD,a=>{const u=s(a);let l=o.get(u);l?l.exit?(o.empty--,i.add.push(l)):i.mod.push(l):(l=r(a),o.set(u,l),i.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=s(a),l=o.get(u);l&&(l.datum=a,i.mod.push(l))}),t.visit(t.REM,a=>{const u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function LD(e){T.call(this,null,e)}H(LD,T,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(Z(s))if(n.changed()||s.every(f=>r[f]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||Rs,u=r.enter||Rs,l=r.exit||Rs,c=(s&&!o?r[s]:a)||Rs;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==Rs&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Rs&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Rs){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,h=>{const g=u(h,e)||i;(c(h,e)||g)&&n.mod.push(h)}),n.mod.length&&n.modifies(u.output)):t.visit(f,h=>{(c(h,e)||i)&&n.mod.push(h)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function ID(e){T.call(this,[],e)}H(ID,T,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||xg,o=e.scale,a=+e.limit,u=Ov(o,e.count==null?5:e.count,e.minstep),l=!!e.values||s===xg,c=e.format||Uk(n,o,u,s,e.formatSpecifier,e.formatType,l),f=e.values||Bk(o,u),h,g,p,m,y;return r&&(i.rem=r),s===xg?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),y=!0):r=f,ye(p=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),m=r.reduce((x,w)=>Math.max(x,p(w,e)),0)):p=Yt(m=p||8),r=r.map((x,w)=>Ne({index:w,label:c(x,w,r),value:x,offset:m,size:p(x,e)})),y&&(y=f[r.length],r.push(Ne({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:y,offset:m,size:p(y,e)})))):s===DH?(h=o.domain(),g=Dk(o,h[0],Ee(h)),f.length<3&&!e.values&&h[0]!==Ee(h)&&(f=[h[0],Ee(h)]),r=f.map((x,w)=>Ne({index:w,label:c(x,w,f),value:x,perc:g(x)}))):(p=f.length-1,g=qH(o),r=f.map((x,w)=>Ne({index:w,label:c(x,w,f),value:x,perc:w?g(x):0,perc2:w===p?1:g(f[w+1])}))),i.source=r,i.add=r,this.value=r,i}});const nV=e=>e.source.x,iV=e=>e.source.y,rV=e=>e.target.x,sV=e=>e.target.y;function Mx(e){T.call(this,{},e)}Mx.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};H(Mx,T,{transform(e,t){var n=e.sourceX||nV,i=e.sourceY||iV,r=e.targetX||rV,s=e.targetY||sV,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=qD.get(u+"-"+a)||qD.get(u);return l||P("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const BD=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,oV=(e,t,n,i)=>BD(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),UD=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.sqrt(r*r+s*s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},aV=(e,t,n,i)=>UD(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),zD=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},uV=(e,t,n,i)=>zD(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),lV=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,cV=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,fV=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},dV=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},hV=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},gV=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*s+"C"+u*r+","+u*s+" "+u*o+","+u*a+" "+i*o+","+i*a},qD=wu({line:BD,"line-radial":oV,arc:UD,"arc-radial":aV,curve:zD,"curve-radial":uV,"orthogonal-horizontal":lV,"orthogonal-vertical":cV,"orthogonal-radial":fV,"diagonal-horizontal":dV,"diagonal-vertical":hV,"diagonal-radial":gV});function Tx(e){T.call(this,null,e)}Tx.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};H(Tx,T,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||xu,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,h=(a-o)/jO(l),g=Zn(c),p,m,y;for(e.sort&&g.sort((x,w)=>l[x]-l[w]),p=0;p<c;++p)y=l[g[p]],m=u[g[p]],m[i]=f,m[r]=f+=y*h;return this.value=l,t.reflow(e.modified()).modifies(n)}});const pV=5;function mV(e){const t=e.type;return!e.bins&&(t===Uu||t===Gc||t===Yc)}function HD(e){return Ev(e)&&e!==br}const yV=Pi(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function WD(e){T.call(this,null,e),this.modified(!0)}H(WD,T,{transform(e,t){var n=t.dataflow,i=this.value,r=bV(e);(!i||r!==i.type)&&(this.value=i=Fe(r)());for(r in e)if(!yV[r]){if(r==="padding"&&HD(i.type))continue;ye(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return _V(i,e,AV(i,e,xV(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function bV(e){var t=e.type,n="",i;return t===br?br+"-"+Uu:(vV(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?br+"-":i===3?zu+"-":""),(n+t||Uu).toLowerCase())}function vV(e){const t=e.type;return Ev(t)&&t!==ha&&t!==ga&&(e.scheme||e.range&&e.range.length&&e.range.every(Oe))}function xV(e,t,n){const i=wV(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&mV(e),a,u;if(!r)return 0;if(HD(s)&&t.padding&&r[0]!==Ee(r)&&(r=EV(s,r,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[a]?a+1:u<r[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain(GD(s,r,n)),s===yv&&e.unknown(t.domainImplicit?zb:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&Ov(e,t.nice)||null),r.length}function wV(e,t,n){return t?(e.domain(GD(e.type,t,n)),t.length):-1}function EV(e,t,n,i,r,s){var o=Math.abs(Ee(n)-n[0]),a=o/(o-2*i),u=e===rs?I1(t,null,a):e===Yc?xh(t,null,a,.5):e===Gc?xh(t,null,a,r||1):e===pg?B1(t,null,a,s||1):L1(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function GD(e,t,n){if(Ck(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+ie(t))}return t}function AV(e,t,n){let i=t.bins;if(i&&!Z(i)){const r=e.domain(),s=r[0],o=Ee(r),a=i.step;let u=i.start==null?s:i.start,l=i.stop==null?o:i.stop;a||P("Scale bins parameter missing step property."),u<s&&(u=a*Math.ceil(s/a)),l>o&&(l=a*Math.floor(o/a)),i=Zn(u,l+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===vv&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function _V(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=SV(i,t,n);else if(t.scheme&&(s=OV(i,t,n),ye(s))){if(e.interpolator)return e.interpolator(s);P("Scale type ".concat(i," does not support interpolating color schemes."))}if(s&&$k(i))return e.interpolator(vg(Nx(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(_v(t.interpolate,t.interpolateGamma)):ye(e.round)?e.round(r):ye(e.rangeRound)&&e.interpolate(r?Hc:eo),s&&e.range(Nx(s,t.reverse))}function SV(e,t,n){e!==Ak&&e!==bv&&P("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===bv?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*mv(n,r,i)]}function OV(e,t,n){var i=t.schemeExtent,r,s;return Z(t.scheme)?s=vg(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=Sv(r),s||P("Unrecognized scheme name: ".concat(t.scheme))),n=e===yg?n+1:e===vv?n-1:e===qu||e===mg?+t.schemeCount||pV:n,$k(e)?YD(s,i,t.reverse):ye(s)?Fk(YD(s,i),n):e===yv?s:s.slice(0,n)}function YD(e,t,n){return ye(e)&&(t||n)?kk(e,Nx(t||[0,1],n)):e}function Nx(e,t){return t?e.slice().reverse():e}function VD(e){T.call(this,null,e)}H(VD,T,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(sa(e.sort)),this.modified(n),t}});const XD="zero",QD="center",KD="normalize",JD=["y0","y1"];function Rx(e){T.call(this,null,e)}Rx.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:XD,values:[XD,QD,KD]},{name:"as",type:"string",array:!0,length:2,default:JD}]};H(Rx,T,{transform(e,t){var n=e.as||JD,i=n[0],r=n[1],s=sa(e.sort),o=e.field||xu,a=e.offset===QD?CV:e.offset===KD?$V:jV,u,l,c,f;for(u=kV(t.source,e.groupby,s,o),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,o,i,r);return t.reflow(e.modified()).modifies(n)}});function CV(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[i]=s,u[r]=s+=Math.abs(n(u))}function $V(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[i]=o,c[r]=o=s*(l+=Math.abs(n(c)))}function jV(e,t,n,i,r){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[i]=o,c[r]=o+=l):(c[i]=s,c[r]=s+=l)}function kV(e,t,n,i){var r=[],s=m=>m(c),o,a,u,l,c,f,h,g,p;if(t==null)r.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),h=o[f],h||(o[f]=h=[],r.push(h)),h.push(c);for(f=0,p=0,l=r.length;f<l;++f){for(h=r[f],a=0,g=0,u=h.length;a<u;++a)g+=Math.abs(i(h[a]));h.sum=g,g>p&&(p=g),n&&h.sort(n)}return r.max=p,r}var FV=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:RD,datajoin:PD,encode:LD,legendentries:ID,linkpath:Mx,pie:Tx,scale:WD,sortitems:VD,stack:Rx}),se=1e-6,ep=1e-12,ve=Math.PI,ot=ve/2,tp=ve/4,yn=ve*2,dt=180/ve,xe=ve/180,_e=Math.abs,tl=Math.atan,bi=Math.atan2,oe=Math.cos,np=Math.ceil,ZD=Math.exp,Px=Math.hypot,ip=Math.log,Lx=Math.pow,te=Math.sin,vi=Math.sign||function(e){return e>0?1:e<0?-1:0},bn=Math.sqrt,Ix=Math.tan;function e3(e){return e>1?0:e<-1?ve:Math.acos(e)}function Ln(e){return e>1?ot:e<-1?-ot:Math.asin(e)}function Bt(){}function rp(e,t){e&&n3.hasOwnProperty(e.type)&&n3[e.type](e,t)}var t3={Feature:function(e,t){rp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)rp(n[i].geometry,t)}},n3={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Bx(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Bx(n[i],t,0)},Polygon:function(e,t){i3(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)i3(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)rp(n[i],t)}};function Bx(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function i3(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Bx(e[n],t,1);t.polygonEnd()}function us(e,t){e&&t3.hasOwnProperty(e.type)?t3[e.type](e,t):rp(e,t)}var sp=new gn,op=new gn,r3,s3,Ux,zx,qx,_r={point:Bt,lineStart:Bt,lineEnd:Bt,polygonStart:function(){sp=new gn,_r.lineStart=DV,_r.lineEnd=MV},polygonEnd:function(){var e=+sp;op.add(e<0?yn+e:e),this.lineStart=this.lineEnd=this.point=Bt},sphere:function(){op.add(yn)}};function DV(){_r.point=TV}function MV(){o3(r3,s3)}function TV(e,t){_r.point=o3,r3=e,s3=t,e*=xe,t*=xe,Ux=e,zx=oe(t=t/2+tp),qx=te(t)}function o3(e,t){e*=xe,t*=xe,t=t/2+tp;var n=e-Ux,i=n>=0?1:-1,r=i*n,s=oe(t),o=te(t),a=qx*o,u=zx*s+a*oe(r),l=a*i*te(r);sp.add(bi(l,u)),Ux=e,zx=s,qx=o}function NV(e){return op=new gn,us(e,_r),op*2}function ap(e){return[bi(e[1],e[0]),Ln(e[2])]}function wa(e){var t=e[0],n=e[1],i=oe(n);return[i*oe(t),i*te(t),te(n)]}function up(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function nl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Hx(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function lp(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function cp(e){var t=bn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var tt,In,at,ii,Ea,a3,u3,il,mf,mo,ls,cs={point:Wx,lineStart:c3,lineEnd:f3,polygonStart:function(){cs.point=d3,cs.lineStart=RV,cs.lineEnd=PV,mf=new gn,_r.polygonStart()},polygonEnd:function(){_r.polygonEnd(),cs.point=Wx,cs.lineStart=c3,cs.lineEnd=f3,sp<0?(tt=-(at=180),In=-(ii=90)):mf>se?ii=90:mf<-se&&(In=-90),ls[0]=tt,ls[1]=at},sphere:function(){tt=-(at=180),In=-(ii=90)}};function Wx(e,t){mo.push(ls=[tt=e,at=e]),t<In&&(In=t),t>ii&&(ii=t)}function l3(e,t){var n=wa([e*xe,t*xe]);if(il){var i=nl(il,n),r=[i[1],-i[0],0],s=nl(r,i);cp(s),s=ap(s);var o=e-Ea,a=o>0?1:-1,u=s[0]*dt*a,l,c=_e(o)>180;c^(a*Ea<u&&u<a*e)?(l=s[1]*dt,l>ii&&(ii=l)):(u=(u+360)%360-180,c^(a*Ea<u&&u<a*e)?(l=-s[1]*dt,l<In&&(In=l)):(t<In&&(In=t),t>ii&&(ii=t))),c?e<Ea?ri(tt,e)>ri(tt,at)&&(at=e):ri(e,at)>ri(tt,at)&&(tt=e):at>=tt?(e<tt&&(tt=e),e>at&&(at=e)):e>Ea?ri(tt,e)>ri(tt,at)&&(at=e):ri(e,at)>ri(tt,at)&&(tt=e)}else mo.push(ls=[tt=e,at=e]);t<In&&(In=t),t>ii&&(ii=t),il=n,Ea=e}function c3(){cs.point=l3}function f3(){ls[0]=tt,ls[1]=at,cs.point=Wx,il=null}function d3(e,t){if(il){var n=e-Ea;mf.add(_e(n)>180?n+(n>0?360:-360):n)}else a3=e,u3=t;_r.point(e,t),l3(e,t)}function RV(){_r.lineStart()}function PV(){d3(a3,u3),_r.lineEnd(),_e(mf)>se&&(tt=-(at=180)),ls[0]=tt,ls[1]=at,il=null}function ri(e,t){return(t-=e)<0?t+360:t}function LV(e,t){return e[0]-t[0]}function h3(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function IV(e){var t,n,i,r,s,o,a;if(ii=at=-(tt=In=1/0),mo=[],us(e,cs),n=mo.length){for(mo.sort(LV),t=1,i=mo[0],s=[i];t<n;++t)r=mo[t],h3(i,r[0])||h3(i,r[1])?(ri(i[0],r[1])>ri(i[0],i[1])&&(i[1]=r[1]),ri(r[0],i[1])>ri(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=ri(i[1],r[0]))>o&&(o=a,tt=r[0],at=i[1])}return mo=ls=null,tt===1/0||In===1/0?[[NaN,NaN],[NaN,NaN]]:[[tt,In],[at,ii]]}var yf,fp,dp,hp,gp,pp,mp,yp,Gx,Yx,Vx,g3,p3,vn,xn,wn,Wi={sphere:Bt,point:Xx,lineStart:m3,lineEnd:y3,polygonStart:function(){Wi.lineStart=zV,Wi.lineEnd=qV},polygonEnd:function(){Wi.lineStart=m3,Wi.lineEnd=y3}};function Xx(e,t){e*=xe,t*=xe;var n=oe(t);bf(n*oe(e),n*te(e),te(t))}function bf(e,t,n){++yf,dp+=(e-dp)/yf,hp+=(t-hp)/yf,gp+=(n-gp)/yf}function m3(){Wi.point=BV}function BV(e,t){e*=xe,t*=xe;var n=oe(t);vn=n*oe(e),xn=n*te(e),wn=te(t),Wi.point=UV,bf(vn,xn,wn)}function UV(e,t){e*=xe,t*=xe;var n=oe(t),i=n*oe(e),r=n*te(e),s=te(t),o=bi(bn((o=xn*s-wn*r)*o+(o=wn*i-vn*s)*o+(o=vn*r-xn*i)*o),vn*i+xn*r+wn*s);fp+=o,pp+=o*(vn+(vn=i)),mp+=o*(xn+(xn=r)),yp+=o*(wn+(wn=s)),bf(vn,xn,wn)}function y3(){Wi.point=Xx}function zV(){Wi.point=HV}function qV(){b3(g3,p3),Wi.point=Xx}function HV(e,t){g3=e,p3=t,e*=xe,t*=xe,Wi.point=b3;var n=oe(t);vn=n*oe(e),xn=n*te(e),wn=te(t),bf(vn,xn,wn)}function b3(e,t){e*=xe,t*=xe;var n=oe(t),i=n*oe(e),r=n*te(e),s=te(t),o=xn*s-wn*r,a=wn*i-vn*s,u=vn*r-xn*i,l=Px(o,a,u),c=Ln(l),f=l&&-c/l;Gx.add(f*o),Yx.add(f*a),Vx.add(f*u),fp+=c,pp+=c*(vn+(vn=i)),mp+=c*(xn+(xn=r)),yp+=c*(wn+(wn=s)),bf(vn,xn,wn)}function WV(e){yf=fp=dp=hp=gp=pp=mp=yp=0,Gx=new gn,Yx=new gn,Vx=new gn,us(e,Wi);var t=+Gx,n=+Yx,i=+Vx,r=Px(t,n,i);return r<ep&&(t=pp,n=mp,i=yp,fp<se&&(t=dp,n=hp,i=gp),r=Px(t,n,i),r<ep)?[NaN,NaN]:[bi(n,t)*dt,Ln(i/r)*dt]}function Qx(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Kx(e,t){return[_e(e)>ve?e+Math.round(-e/yn)*yn:e,t]}Kx.invert=Kx;function v3(e,t,n){return(e%=yn)?t||n?Qx(w3(e),E3(t,n)):w3(e):t||n?E3(t,n):Kx}function x3(e){return function(t,n){return t+=e,[t>ve?t-yn:t<-ve?t+yn:t,n]}}function w3(e){var t=x3(e);return t.invert=x3(-e),t}function E3(e,t){var n=oe(e),i=te(e),r=oe(t),s=te(t);function o(a,u){var l=oe(u),c=oe(a)*l,f=te(a)*l,h=te(u),g=h*n+c*i;return[bi(f*r-g*s,c*n-h*i),Ln(g*r+f*s)]}return o.invert=function(a,u){var l=oe(u),c=oe(a)*l,f=te(a)*l,h=te(u),g=h*r-f*s;return[bi(f*r+h*s,c*n+g*i),Ln(g*n-c*i)]},o}function GV(e){e=v3(e[0]*xe,e[1]*xe,e.length>2?e[2]*xe:0);function t(n){return n=e(n[0]*xe,n[1]*xe),n[0]*=dt,n[1]*=dt,n}return t.invert=function(n){return n=e.invert(n[0]*xe,n[1]*xe),n[0]*=dt,n[1]*=dt,n},t}function YV(e,t,n,i,r,s){if(!!n){var o=oe(t),a=te(t),u=i*n;r==null?(r=t+i*yn,s=t-u/2):(r=A3(o,r),s=A3(o,s),(i>0?r<s:r>s)&&(r+=i*yn));for(var l,c=r;i>0?c>s:c<s;c-=u)l=ap([o,-a*oe(c),-a*te(c)]),e.point(l[0],l[1])}}function A3(e,t){t=wa(t),t[0]-=e,cp(t);var n=e3(-t[1]);return((-t[2]<0?-n:n)+yn-se)%yn}function _3(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Bt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function bp(e,t){return _e(e[0]-t[0])<se&&_e(e[1]-t[1])<se}function vp(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function S3(e,t,n,i,r){var s=[],o=[],a,u;if(e.forEach(function(p){if(!((m=p.length-1)<=0)){var m,y=p[0],x=p[m],w;if(bp(y,x)){if(!y[2]&&!x[2]){for(r.lineStart(),a=0;a<m;++a)r.point((y=p[a])[0],y[1]);r.lineEnd();return}x[0]+=2*se}s.push(w=new vp(y,p,null,!0)),o.push(w.o=new vp(y,null,w,!1)),s.push(w=new vp(x,p,null,!1)),o.push(w.o=new vp(x,null,w,!0))}}),!!s.length){for(o.sort(t),O3(s),O3(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var h=l,g=!0;h.v;)if((h=h.n)===l)return;c=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(g)for(a=0,u=c.length;a<u;++a)r.point((f=c[a])[0],f[1]);else i(h.x,h.n.x,1,r);h=h.n}else{if(g)for(c=h.p.z,a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(h.x,h.p.x,-1,r);h=h.p}h=h.o,c=h.z,g=!g}while(!h.v);r.lineEnd()}}}function O3(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function Jx(e){return _e(e[0])<=ve?e[0]:vi(e[0])*((_e(e[0])+ve)%yn-ve)}function VV(e,t){var n=Jx(t),i=t[1],r=te(i),s=[te(n),-oe(n),0],o=0,a=0,u=new gn;r===1?i=ot+se:r===-1&&(i=-ot-se);for(var l=0,c=e.length;l<c;++l)if(!!(h=(f=e[l]).length))for(var f,h,g=f[h-1],p=Jx(g),m=g[1]/2+tp,y=te(m),x=oe(m),w=0;w<h;++w,p=A,y=O,x=_,g=E){var E=f[w],A=Jx(E),S=E[1]/2+tp,O=te(S),_=oe(S),C=A-p,j=C>=0?1:-1,$=j*C,k=$>ve,M=y*O;if(u.add(bi(M*j*te($),x*_+M*oe($))),o+=k?C+j*yn:C,k^p>=n^A>=n){var D=nl(wa(g),wa(E));cp(D);var I=nl(s,D);cp(I);var F=(k^C>=0?-1:1)*Ln(I[2]);(i>F||i===F&&(D[0]||D[1]))&&(a+=k^C>=0?1:-1)}}return(o<-se||o<se&&u<-ep)^a&1}function C3(e,t,n,i){return function(r){var s=t(r),o=_3(),a=t(o),u=!1,l,c,f,h={point:g,lineStart:m,lineEnd:y,polygonStart:function(){h.point=x,h.lineStart=w,h.lineEnd=E,c=[],l=[]},polygonEnd:function(){h.point=g,h.lineStart=m,h.lineEnd=y,c=$O(c);var A=VV(l,i);c.length?(u||(r.polygonStart(),u=!0),S3(c,QV,A,n,r)):A&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function g(A,S){e(A,S)&&r.point(A,S)}function p(A,S){s.point(A,S)}function m(){h.point=p,s.lineStart()}function y(){h.point=g,s.lineEnd()}function x(A,S){f.push([A,S]),a.point(A,S)}function w(){a.lineStart(),f=[]}function E(){x(f[0][0],f[0][1]),a.lineEnd();var A=a.clean(),S=o.result(),O,_=S.length,C,j,$;if(f.pop(),l.push(f),f=null,!!_){if(A&1){if(j=S[0],(C=j.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),O=0;O<C;++O)r.point(($=j[O])[0],$[1]);r.lineEnd()}return}_>1&&A&2&&S.push(S.pop().concat(S.shift())),c.push(S.filter(XV))}}return h}}function XV(e){return e.length>1}function QV(e,t){return((e=e.x)[0]<0?e[1]-ot-se:ot-e[1])-((t=t.x)[0]<0?t[1]-ot-se:ot-t[1])}var $3=C3(function(){return!0},KV,ZV,[-ve,-ot]);function KV(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?ve:-ve,u=_e(s-t);_e(u-ve)<se?(e.point(t,n=(n+o)/2>0?ot:-ot),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&u>=ve&&(_e(t-i)<se&&(t-=i*se),_e(s-a)<se&&(s-=a*se),n=JV(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function JV(e,t,n,i){var r,s,o=te(e-n);return _e(o)>se?tl((te(t)*(s=oe(i))*te(n)-te(i)*(r=oe(t))*te(e))/(r*s*o)):(t+i)/2}function ZV(e,t,n,i){var r;if(e==null)r=n*ot,i.point(-ve,r),i.point(0,r),i.point(ve,r),i.point(ve,0),i.point(ve,-r),i.point(0,-r),i.point(-ve,-r),i.point(-ve,0),i.point(-ve,r);else if(_e(e[0]-t[0])>se){var s=e[0]<t[0]?ve:-ve;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function eX(e){var t=oe(e),n=6*xe,i=t>0,r=_e(t)>se;function s(c,f,h,g){YV(g,e,n,h,c,f)}function o(c,f){return oe(c)*oe(f)>t}function a(c){var f,h,g,p,m;return{lineStart:function(){p=g=!1,m=1},point:function(y,x){var w=[y,x],E,A=o(y,x),S=i?A?0:l(y,x):A?l(y+(y<0?ve:-ve),x):0;if(!f&&(p=g=A)&&c.lineStart(),A!==g&&(E=u(f,w),(!E||bp(f,E)||bp(w,E))&&(w[2]=1)),A!==g)m=0,A?(c.lineStart(),E=u(w,f),c.point(E[0],E[1])):(E=u(f,w),c.point(E[0],E[1],2),c.lineEnd()),f=E;else if(r&&f&&i^A){var O;!(S&h)&&(O=u(w,f,!0))&&(m=0,i?(c.lineStart(),c.point(O[0][0],O[0][1]),c.point(O[1][0],O[1][1]),c.lineEnd()):(c.point(O[1][0],O[1][1]),c.lineEnd(),c.lineStart(),c.point(O[0][0],O[0][1],3)))}A&&(!f||!bp(f,w))&&c.point(w[0],w[1]),f=w,g=A,h=S},lineEnd:function(){g&&c.lineEnd(),f=null},clean:function(){return m|(p&&g)<<1}}}function u(c,f,h){var g=wa(c),p=wa(f),m=[1,0,0],y=nl(g,p),x=up(y,y),w=y[0],E=x-w*w;if(!E)return!h&&c;var A=t*x/E,S=-t*w/E,O=nl(m,y),_=lp(m,A),C=lp(y,S);Hx(_,C);var j=O,$=up(_,j),k=up(j,j),M=$*$-k*(up(_,_)-1);if(!(M<0)){var D=bn(M),I=lp(j,(-$-D)/k);if(Hx(I,_),I=ap(I),!h)return I;var F=c[0],L=f[0],B=c[1],W=f[1],X;L<F&&(X=F,F=L,L=X);var ce=L-F,Te=_e(ce-ve)<se,$e=Te||ce<se;if(!Te&&W<B&&(X=B,B=W,W=X),$e?Te?B+W>0^I[1]<(_e(I[0]-F)<se?B:W):B<=I[1]&&I[1]<=W:ce>ve^(F<=I[0]&&I[0]<=L)){var it=lp(j,(-$+D)/k);return Hx(it,_),[I,ap(it)]}}}function l(c,f){var h=i?e:ve-e,g=0;return c<-h?g|=1:c>h&&(g|=2),f<-h?g|=4:f>h&&(g|=8),g}return C3(o,a,s,i?[0,-e]:[-ve,e-ve])}function tX(e,t,n,i,r,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,h=u-o,g=l-a,p;if(p=n-o,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=r-o,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=i-a,!(!g&&p>0)){if(p/=g,g<0){if(p<c)return;p<f&&(f=p)}else if(g>0){if(p>f)return;p>c&&(c=p)}if(p=s-a,!(!g&&p<0)){if(p/=g,g<0){if(p>f)return;p>c&&(c=p)}else if(g>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*h,e[1]=a+c*g),f<1&&(t[0]=o+f*h,t[1]=a+f*g),!0}}}}}var vf=1e9,xp=-vf;function j3(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function s(l,c,f,h){var g=0,p=0;if(l==null||(g=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do h.point(g===0||g===3?e:n,g>1?i:t);while((g=(g+f+4)%4)!==p);else h.point(c[0],c[1])}function o(l,c){return _e(l[0]-e)<se?c>0?0:3:_e(l[0]-n)<se?c>0?2:1:_e(l[1]-t)<se?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),h=o(c,1);return f!==h?f-h:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=_3(),h,g,p,m,y,x,w,E,A,S,O,_={point:C,lineStart:M,lineEnd:D,polygonStart:$,polygonEnd:k};function C(F,L){r(F,L)&&c.point(F,L)}function j(){for(var F=0,L=0,B=g.length;L<B;++L)for(var W=g[L],X=1,ce=W.length,Te=W[0],$e,it,He=Te[0],lt=Te[1];X<ce;++X)$e=He,it=lt,Te=W[X],He=Te[0],lt=Te[1],it<=i?lt>i&&(He-$e)*(i-it)>(lt-it)*(e-$e)&&++F:lt<=i&&(He-$e)*(i-it)<(lt-it)*(e-$e)&&--F;return F}function $(){c=f,h=[],g=[],O=!0}function k(){var F=j(),L=O&&F,B=(h=$O(h)).length;(L||B)&&(l.polygonStart(),L&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),B&&S3(h,a,F,s,l),l.polygonEnd()),c=l,h=g=p=null}function M(){_.point=I,g&&g.push(p=[]),S=!0,A=!1,w=E=NaN}function D(){h&&(I(m,y),x&&A&&f.rejoin(),h.push(f.result())),_.point=C,A&&c.lineEnd()}function I(F,L){var B=r(F,L);if(g&&p.push([F,L]),S)m=F,y=L,x=B,S=!1,B&&(c.lineStart(),c.point(F,L));else if(B&&A)c.point(F,L);else{var W=[w=Math.max(xp,Math.min(vf,w)),E=Math.max(xp,Math.min(vf,E))],X=[F=Math.max(xp,Math.min(vf,F)),L=Math.max(xp,Math.min(vf,L))];tX(W,X,e,t,n,i)?(A||(c.lineStart(),c.point(W[0],W[1])),c.point(X[0],X[1]),B||c.lineEnd(),O=!1):B&&(c.lineStart(),c.point(F,L),O=!1)}w=F,E=L,A=B}return _}}function k3(e,t,n){var i=Zn(e,t-se,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function F3(e,t,n){var i=Zn(e,t-se,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function nX(){var e,t,n,i,r,s,o,a,u=10,l=u,c=90,f=360,h,g,p,m,y=2.5;function x(){return{type:"MultiLineString",coordinates:w()}}function w(){return Zn(np(i/c)*c,n,c).map(p).concat(Zn(np(a/f)*f,o,f).map(m)).concat(Zn(np(t/u)*u,e,u).filter(function(E){return _e(E%c)>se}).map(h)).concat(Zn(np(s/l)*l,r,l).filter(function(E){return _e(E%f)>se}).map(g))}return x.lines=function(){return w().map(function(E){return{type:"LineString",coordinates:E}})},x.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(m(o).slice(1),p(n).reverse().slice(1),m(a).reverse().slice(1))]}},x.extent=function(E){return arguments.length?x.extentMajor(E).extentMinor(E):x.extentMinor()},x.extentMajor=function(E){return arguments.length?(i=+E[0][0],n=+E[1][0],a=+E[0][1],o=+E[1][1],i>n&&(E=i,i=n,n=E),a>o&&(E=a,a=o,o=E),x.precision(y)):[[i,a],[n,o]]},x.extentMinor=function(E){return arguments.length?(t=+E[0][0],e=+E[1][0],s=+E[0][1],r=+E[1][1],t>e&&(E=t,t=e,e=E),s>r&&(E=s,s=r,r=E),x.precision(y)):[[t,s],[e,r]]},x.step=function(E){return arguments.length?x.stepMajor(E).stepMinor(E):x.stepMinor()},x.stepMajor=function(E){return arguments.length?(c=+E[0],f=+E[1],x):[c,f]},x.stepMinor=function(E){return arguments.length?(u=+E[0],l=+E[1],x):[u,l]},x.precision=function(E){return arguments.length?(y=+E,h=k3(s,r,90),g=F3(t,e,y),p=k3(a,o,90),m=F3(i,n,y),x):y},x.extentMajor([[-180,-90+se],[180,90-se]]).extentMinor([[-180,-80-se],[180,80+se]])}var xf=e=>e,Zx=new gn,e2=new gn,D3,M3,t2,n2,yo={point:Bt,lineStart:Bt,lineEnd:Bt,polygonStart:function(){yo.lineStart=iX,yo.lineEnd=sX},polygonEnd:function(){yo.lineStart=yo.lineEnd=yo.point=Bt,Zx.add(_e(e2)),e2=new gn},result:function(){var e=Zx/2;return Zx=new gn,e}};function iX(){yo.point=rX}function rX(e,t){yo.point=T3,D3=t2=e,M3=n2=t}function T3(e,t){e2.add(n2*e-t2*t),t2=e,n2=t}function sX(){T3(D3,M3)}var N3=yo,rl=1/0,wp=rl,wf=-rl,Ep=wf,oX={point:aX,lineStart:Bt,lineEnd:Bt,polygonStart:Bt,polygonEnd:Bt,result:function(){var e=[[rl,wp],[wf,Ep]];return wf=Ep=-(wp=rl=1/0),e}};function aX(e,t){e<rl&&(rl=e),e>wf&&(wf=e),t<wp&&(wp=t),t>Ep&&(Ep=t)}var Ap=oX,i2=0,r2=0,Ef=0,_p=0,Sp=0,sl=0,s2=0,o2=0,Af=0,R3,P3,Sr,Or,Gi={point:Aa,lineStart:L3,lineEnd:I3,polygonStart:function(){Gi.lineStart=cX,Gi.lineEnd=fX},polygonEnd:function(){Gi.point=Aa,Gi.lineStart=L3,Gi.lineEnd=I3},result:function(){var e=Af?[s2/Af,o2/Af]:sl?[_p/sl,Sp/sl]:Ef?[i2/Ef,r2/Ef]:[NaN,NaN];return i2=r2=Ef=_p=Sp=sl=s2=o2=Af=0,e}};function Aa(e,t){i2+=e,r2+=t,++Ef}function L3(){Gi.point=uX}function uX(e,t){Gi.point=lX,Aa(Sr=e,Or=t)}function lX(e,t){var n=e-Sr,i=t-Or,r=bn(n*n+i*i);_p+=r*(Sr+e)/2,Sp+=r*(Or+t)/2,sl+=r,Aa(Sr=e,Or=t)}function I3(){Gi.point=Aa}function cX(){Gi.point=dX}function fX(){B3(R3,P3)}function dX(e,t){Gi.point=B3,Aa(R3=Sr=e,P3=Or=t)}function B3(e,t){var n=e-Sr,i=t-Or,r=bn(n*n+i*i);_p+=r*(Sr+e)/2,Sp+=r*(Or+t)/2,sl+=r,r=Or*e-Sr*t,s2+=r*(Sr+e),o2+=r*(Or+t),Af+=r*3,Aa(Sr=e,Or=t)}var U3=Gi;function z3(e){this._context=e}z3.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,yn);break}}},result:Bt};var a2=new gn,u2,q3,H3,_f,Sf,Op={point:Bt,lineStart:function(){Op.point=hX},lineEnd:function(){u2&&W3(q3,H3),Op.point=Bt},polygonStart:function(){u2=!0},polygonEnd:function(){u2=null},result:function(){var e=+a2;return a2=new gn,e}};function hX(e,t){Op.point=W3,q3=_f=e,H3=Sf=t}function W3(e,t){_f-=e,Sf-=t,a2.add(bn(_f*_f+Sf*Sf)),_f=e,Sf=t}var G3=Op;function Y3(){this._string=[]}Y3.prototype={_radius:4.5,_circle:V3(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=V3(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function V3(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function X3(e,t){var n=4.5,i,r;function s(o){return o&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),us(o,i(r))),r.result()}return s.area=function(o){return us(o,i(N3)),N3.result()},s.measure=function(o){return us(o,i(G3)),G3.result()},s.bounds=function(o){return us(o,i(Ap)),Ap.result()},s.centroid=function(o){return us(o,i(U3)),U3.result()},s.projection=function(o){return arguments.length?(i=o==null?(e=null,xf):(e=o).stream,s):e},s.context=function(o){return arguments.length?(r=o==null?(t=null,new Y3):new z3(t=o),typeof n!="function"&&r.pointRadius(n),s):t},s.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(r.pointRadius(+o),+o),s):n},s.projection(e).context(t)}function Cp(e){return function(t){var n=new l2;for(var i in e)n[i]=e[i];return n.stream=t,n}}function l2(){}l2.prototype={constructor:l2,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function c2(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),us(n,e.stream(Ap)),t(Ap.result()),i!=null&&e.clipExtent(i),e}function $p(e,t,n){return c2(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function f2(e,t,n){return $p(e,[[0,0],t],n)}function d2(e,t,n){return c2(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function h2(e,t,n){return c2(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var Q3=16,gX=oe(30*xe);function K3(e,t){return+t?mX(e,t):pX(e)}function pX(e){return Cp({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function mX(e,t){function n(i,r,s,o,a,u,l,c,f,h,g,p,m,y){var x=l-i,w=c-r,E=x*x+w*w;if(E>4*t&&m--){var A=o+h,S=a+g,O=u+p,_=bn(A*A+S*S+O*O),C=Ln(O/=_),j=_e(_e(O)-1)<se||_e(s-f)<se?(s+f)/2:bi(S,A),$=e(j,C),k=$[0],M=$[1],D=k-i,I=M-r,F=w*D-x*I;(F*F/E>t||_e((x*D+w*I)/E-.5)>.3||o*h+a*g+u*p<gX)&&(n(i,r,s,o,a,u,k,M,j,A/=_,S/=_,O,m,y),y.point(k,M),n(k,M,j,A,S,O,l,c,f,h,g,p,m,y))}}return function(i){var r,s,o,a,u,l,c,f,h,g,p,m,y={point:x,lineStart:w,lineEnd:A,polygonStart:function(){i.polygonStart(),y.lineStart=S},polygonEnd:function(){i.polygonEnd(),y.lineStart=w}};function x(C,j){C=e(C,j),i.point(C[0],C[1])}function w(){f=NaN,y.point=E,i.lineStart()}function E(C,j){var $=wa([C,j]),k=e(C,j);n(f,h,c,g,p,m,f=k[0],h=k[1],c=C,g=$[0],p=$[1],m=$[2],Q3,i),i.point(f,h)}function A(){y.point=x,i.lineEnd()}function S(){w(),y.point=O,y.lineEnd=_}function O(C,j){E(r=C,j),s=f,o=h,a=g,u=p,l=m,y.point=E}function _(){n(f,h,c,g,p,m,s,o,r,a,u,l,Q3,i),y.lineEnd=A,A()}return y}}var yX=Cp({point:function(e,t){this.stream.point(e*xe,t*xe)}});function bX(e){return Cp({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function vX(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function J3(e,t,n,i,r,s){if(!s)return vX(e,t,n,i,r);var o=oe(s),a=te(s),u=o*e,l=a*e,c=o/e,f=a/e,h=(a*n-o*t)/e,g=(a*t+o*n)/e;function p(m,y){return m*=i,y*=r,[u*m-l*y+t,n-l*m-u*y]}return p.invert=function(m,y){return[i*(c*m-f*y+h),r*(g-f*m-c*y)]},p}function Cr(e){return Z3(function(){return e})()}function Z3(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,u=0,l=0,c,f=0,h=1,g=1,p=null,m=$3,y=null,x,w,E,A=xf,S=.5,O,_,C,j,$;function k(F){return C(F[0]*xe,F[1]*xe)}function M(F){return F=C.invert(F[0],F[1]),F&&[F[0]*dt,F[1]*dt]}k.stream=function(F){return j&&$===F?j:j=yX(bX(c)(m(O(A($=F)))))},k.preclip=function(F){return arguments.length?(m=F,p=void 0,I()):m},k.postclip=function(F){return arguments.length?(A=F,y=x=w=E=null,I()):A},k.clipAngle=function(F){return arguments.length?(m=+F?eX(p=F*xe):(p=null,$3),I()):p*dt},k.clipExtent=function(F){return arguments.length?(A=F==null?(y=x=w=E=null,xf):j3(y=+F[0][0],x=+F[0][1],w=+F[1][0],E=+F[1][1]),I()):y==null?null:[[y,x],[w,E]]},k.scale=function(F){return arguments.length?(n=+F,D()):n},k.translate=function(F){return arguments.length?(i=+F[0],r=+F[1],D()):[i,r]},k.center=function(F){return arguments.length?(s=F[0]%360*xe,o=F[1]%360*xe,D()):[s*dt,o*dt]},k.rotate=function(F){return arguments.length?(a=F[0]%360*xe,u=F[1]%360*xe,l=F.length>2?F[2]%360*xe:0,D()):[a*dt,u*dt,l*dt]},k.angle=function(F){return arguments.length?(f=F%360*xe,D()):f*dt},k.reflectX=function(F){return arguments.length?(h=F?-1:1,D()):h<0},k.reflectY=function(F){return arguments.length?(g=F?-1:1,D()):g<0},k.precision=function(F){return arguments.length?(O=K3(_,S=F*F),I()):bn(S)},k.fitExtent=function(F,L){return $p(k,F,L)},k.fitSize=function(F,L){return f2(k,F,L)},k.fitWidth=function(F,L){return d2(k,F,L)},k.fitHeight=function(F,L){return h2(k,F,L)};function D(){var F=J3(n,0,0,h,g,f).apply(null,t(s,o)),L=J3(n,i-F[0],r-F[1],h,g,f);return c=v3(a,u,l),_=Qx(t,L),C=Qx(c,_),O=K3(_,S),I()}function I(){return j=$=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&M,D()}}function g2(e){var t=0,n=ve/3,i=Z3(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*xe,n=s[1]*xe):[t*dt,n*dt]},r}function xX(e){var t=oe(e);function n(i,r){return[i*t,te(r)/t]}return n.invert=function(i,r){return[i/t,Ln(r*t)]},n}function wX(e,t){var n=te(e),i=(n+te(t))/2;if(_e(i)<se)return xX(e);var r=1+n*(2*i-n),s=bn(r)/i;function o(a,u){var l=bn(r-2*i*te(u))/i;return[l*te(a*=i),s-l*oe(a)]}return o.invert=function(a,u){var l=s-u,c=bi(a,_e(l))*vi(l);return l*i<0&&(c-=ve*vi(a)*vi(l)),[c/i,Ln((r-(a*a+l*l)*i*i)/(2*i))]},o}function jp(){return g2(wX).scale(155.424).center([0,33.6442])}function eM(){return jp().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function EX(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function AX(){var e,t,n=eM(),i,r=jp().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=jp().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(h,g){u=[h,g]}};function c(h){var g=h[0],p=h[1];return u=null,i.point(g,p),u||(s.point(g,p),u)||(a.point(g,p),u)}c.invert=function(h){var g=n.scale(),p=n.translate(),m=(h[0]-p[0])/g,y=(h[1]-p[1])/g;return(y>=.12&&y<.234&&m>=-.425&&m<-.214?r:y>=.166&&y<.234&&m>=-.214&&m<-.115?o:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=EX([n.stream(t=h),r.stream(h),o.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),r.precision(h),o.precision(h),f()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),r.scale(h*.35),o.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var g=n.scale(),p=+h[0],m=+h[1];return i=n.translate(h).clipExtent([[p-.455*g,m-.238*g],[p+.455*g,m+.238*g]]).stream(l),s=r.translate([p-.307*g,m+.201*g]).clipExtent([[p-.425*g+se,m+.12*g+se],[p-.214*g-se,m+.234*g-se]]).stream(l),a=o.translate([p-.205*g,m+.212*g]).clipExtent([[p-.214*g+se,m+.166*g+se],[p-.115*g-se,m+.234*g-se]]).stream(l),f()},c.fitExtent=function(h,g){return $p(c,h,g)},c.fitSize=function(h,g){return f2(c,h,g)},c.fitWidth=function(h,g){return d2(c,h,g)},c.fitHeight=function(h,g){return h2(c,h,g)};function f(){return e=t=null,c}return c.scale(1070)}function tM(e){return function(t,n){var i=oe(t),r=oe(n),s=e(i*r);return s===1/0?[2,0]:[s*r*te(t),s*te(n)]}}function Of(e){return function(t,n){var i=bn(t*t+n*n),r=e(i),s=te(r),o=oe(r);return[bi(t*s,i*o),Ln(i&&n*s/i)]}}var nM=tM(function(e){return bn(2/(1+e))});nM.invert=Of(function(e){return 2*Ln(e/2)});function _X(){return Cr(nM).scale(124.75).clipAngle(180-.001)}var iM=tM(function(e){return(e=e3(e))&&e/te(e)});iM.invert=Of(function(e){return e});function SX(){return Cr(iM).scale(79.4188).clipAngle(180-.001)}function kp(e,t){return[e,ip(Ix((ot+t)/2))]}kp.invert=function(e,t){return[e,2*tl(ZD(t))-ot]};function OX(){return rM(kp).scale(961/yn)}function rM(e){var t=Cr(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=ve*i(),h=t(GV(t.rotate()).invert([0,0]));return s(o==null?[[h[0]-f,h[1]-f],[h[0]+f,h[1]+f]]:e===kp?[[Math.max(h[0]-f,o),a],[Math.min(h[0]+f,u),l]]:[[o,Math.max(h[1]-f,a)],[u,Math.min(h[1]+f,l)]])}return c()}function Fp(e){return Ix((ot+e)/2)}function CX(e,t){var n=oe(e),i=e===t?te(e):ip(n/oe(t))/ip(Fp(t)/Fp(e)),r=n*Lx(Fp(e),i)/i;if(!i)return kp;function s(o,a){r>0?a<-ot+se&&(a=-ot+se):a>ot-se&&(a=ot-se);var u=r/Lx(Fp(a),i);return[u*te(i*o),r-u*oe(i*o)]}return s.invert=function(o,a){var u=r-a,l=vi(i)*bn(o*o+u*u),c=bi(o,_e(u))*vi(u);return u*i<0&&(c-=ve*vi(o)*vi(u)),[c/i,2*tl(Lx(r/l,1/i))-ot]},s}function $X(){return g2(CX).scale(109.5).parallels([30,30])}function Dp(e,t){return[e,t]}Dp.invert=Dp;function jX(){return Cr(Dp).scale(152.63)}function kX(e,t){var n=oe(e),i=e===t?te(e):(n-oe(t))/(t-e),r=n/i+e;if(_e(i)<se)return Dp;function s(o,a){var u=r-a,l=i*o;return[u*te(l),r-u*oe(l)]}return s.invert=function(o,a){var u=r-a,l=bi(o,_e(u))*vi(u);return u*i<0&&(l-=ve*vi(o)*vi(u)),[l/i,r-vi(i)*bn(o*o+u*u)]},s}function FX(){return g2(kX).scale(131.154).center([0,13.9389])}var Cf=1.340264,$f=-.081106,jf=893e-6,kf=.003796,Mp=bn(3)/2,DX=12;function sM(e,t){var n=Ln(Mp*te(t)),i=n*n,r=i*i*i;return[e*oe(n)/(Mp*(Cf+3*$f*i+r*(7*jf+9*kf*i))),n*(Cf+$f*i+r*(jf+kf*i))]}sM.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,u;s<DX&&(a=n*(Cf+$f*i+r*(jf+kf*i))-t,u=Cf+3*$f*i+r*(7*jf+9*kf*i),n-=o=a/u,i=n*n,r=i*i*i,!(_e(o)<ep));++s);return[Mp*e*(Cf+3*$f*i+r*(7*jf+9*kf*i))/oe(n),Ln(te(n)/Mp)]};function MX(){return Cr(sM).scale(177.158)}function oM(e,t){var n=oe(t),i=oe(e)*n;return[n*te(e)/i,te(t)/i]}oM.invert=Of(tl);function TX(){return Cr(oM).scale(144.049).clipAngle(60)}function NX(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,u=null,l,c,f,h=1,g=1,p=Cp({point:function(A,S){var O=E([A,S]);this.stream.point(O[0],O[1])}}),m=xf,y,x;function w(){return h=e*i,g=e*r,y=x=null,E}function E(A){var S=A[0]*h,O=A[1]*g;if(s){var _=O*o-S*a;S=S*o+O*a,O=_}return[S+t,O+n]}return E.invert=function(A){var S=A[0]-t,O=A[1]-n;if(s){var _=O*o+S*a;S=S*o-O*a,O=_}return[S/h,O/g]},E.stream=function(A){return y&&x===A?y:y=p(m(x=A))},E.postclip=function(A){return arguments.length?(m=A,u=l=c=f=null,w()):m},E.clipExtent=function(A){return arguments.length?(m=A==null?(u=l=c=f=null,xf):j3(u=+A[0][0],l=+A[0][1],c=+A[1][0],f=+A[1][1]),w()):u==null?null:[[u,l],[c,f]]},E.scale=function(A){return arguments.length?(e=+A,w()):e},E.translate=function(A){return arguments.length?(t=+A[0],n=+A[1],w()):[t,n]},E.angle=function(A){return arguments.length?(s=A%360*xe,a=te(s),o=oe(s),w()):s*dt},E.reflectX=function(A){return arguments.length?(i=A?-1:1,w()):i<0},E.reflectY=function(A){return arguments.length?(r=A?-1:1,w()):r<0},E.fitExtent=function(A,S){return $p(E,A,S)},E.fitSize=function(A,S){return f2(E,A,S)},E.fitWidth=function(A,S){return d2(E,A,S)},E.fitHeight=function(A,S){return h2(E,A,S)},E}function aM(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}aM.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(_e(r)>se&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function RX(){return Cr(aM).scale(175.295)}function uM(e,t){return[oe(t)*te(e),te(t)]}uM.invert=Of(Ln);function PX(){return Cr(uM).scale(249.5).clipAngle(90+se)}function lM(e,t){var n=oe(t),i=1+oe(e)*n;return[n*te(e)/i,te(t)/i]}lM.invert=Of(function(e){return 2*tl(e)});function LX(){return Cr(lM).scale(250).clipAngle(142)}function cM(e,t){return[ip(Ix((ot+t)/2)),-e]}cM.invert=function(e,t){return[-t,2*tl(ZD(e))-ot]};function IX(){var e=rM(cM),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var BX=Math.abs,p2=Math.cos,Tp=Math.sin,UX=1e-6,fM=Math.PI,m2=fM/2,dM=zX(2);function hM(e){return e>1?m2:e<-1?-m2:Math.asin(e)}function zX(e){return e>0?Math.sqrt(e):0}function qX(e,t){var n=e*Tp(t),i=30,r;do t-=r=(t+Tp(t)-n)/(1+p2(t));while(BX(r)>UX&&--i>0);return t/2}function HX(e,t,n){function i(r,s){return[e*r*p2(s=qX(n,s)),t*Tp(s)]}return i.invert=function(r,s){return s=hM(s/t),[r/(e*p2(s)),hM((2*s+Tp(2*s))/n)]},i}var WX=HX(dM/m2,dM,fM);function GX(){return Cr(WX).scale(169.529)}const YX=X3(),y2=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function VX(e,t){return function n(){const i=t();return i.type=e,i.path=X3().projection(i),i.copy=i.copy||function(){const r=n();return y2.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function b2(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Np[e]=VX(e,t),this):Np[e]||null}function gM(e){return e&&e.path||YX}const Np={albers:eM,albersusa:AX,azimuthalequalarea:_X,azimuthalequidistant:SX,conicconformal:$X,conicequalarea:jp,conicequidistant:FX,equalEarth:MX,equirectangular:jX,gnomonic:TX,identity:NX,mercator:OX,mollweide:GX,naturalEarth1:RX,orthographic:PX,stereographic:LX,transversemercator:IX};for(const e in Np)b2(e,Np[e]);function XX(){}const fs=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function pM(){var e=1,t=1,n=a;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return s(u,l,h=>{n(h,u,l),QX(h)>0?c.push([h]):f.push(h)}),f.forEach(h=>{for(var g=0,p=c.length,m;g<p;++g)if(KX((m=c[g])[0],h)!==-1){m.push(h);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=new Array,h=new Array,g,p,m,y,x,w;for(g=p=-1,y=u[0]>=l,fs[y<<1].forEach(E);++g<e-1;)m=y,y=u[g+1]>=l,fs[m|y<<1].forEach(E);for(fs[y<<0].forEach(E);++p<t-1;){for(g=-1,y=u[p*e+e]>=l,x=u[p*e]>=l,fs[y<<1|x<<2].forEach(E);++g<e-1;)m=y,y=u[p*e+e+g+1]>=l,w=x,x=u[p*e+g+1]>=l,fs[m|y<<1|x<<2|w<<3].forEach(E);fs[y|x<<3].forEach(E)}for(g=-1,x=u[p*e]>=l,fs[x<<2].forEach(E);++g<e-1;)w=x,x=u[p*e+g+1]>=l,fs[x<<2|w<<3].forEach(E);fs[x<<3].forEach(E);function E(A){var S=[A[0][0]+g,A[0][1]+p],O=[A[1][0]+g,A[1][1]+p],_=o(S),C=o(O),j,$;(j=h[_])?($=f[C])?(delete h[j.end],delete f[$.start],j===$?(j.ring.push(O),c(j.ring)):f[j.start]=h[$.end]={start:j.start,end:$.end,ring:j.ring.concat($.ring)}):(delete h[j.end],j.ring.push(O),h[j.end=C]=j):(j=f[C])?($=h[_])?(delete f[j.start],delete h[$.end],j===$?(j.ring.push(O),c(j.ring)):f[$.start]=h[j.end]={start:$.start,end:j.end,ring:$.ring.concat(j.ring)}):(delete f[j.start],j.ring.unshift(S),f[j.start=_]=j):f[_]=h[C]={start:_,end:C,ring:[S,O]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var h=f[0],g=f[1],p=h|0,m=g|0,y,x=l[m*e+p];h>0&&h<e&&p===h&&(y=l[m*e+p-1],f[0]=h+(c-y)/(x-y)-.5),g>0&&g<t&&m===g&&(y=l[(m-1)*e+p],f[1]=g+(c-y)/(x-y)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||P("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?a:XX,i):n===a},i}function QX(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function KX(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=JX(e,t[n]))return r;return 0}function JX(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],h=f[0],g=f[1];if(ZX(u,f,t))return 0;c>i!=g>i&&n<(h-l)*(i-c)/(g-c)+l&&(r=-r)}return r}function ZX(e,t,n){var i;return eQ(e,t,n)&&tQ(e[i=+(e[0]===t[0])],n[i],t[i])}function eQ(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function tQ(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function mM(e,t,n){return function(i){var r=cr(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,u=t?Bs(s,o,e):a/(e+1);return Zn(s+u,o,u)}}function v2(e){T.call(this,null,e)}v2.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};H(v2,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||hn,s=pM().smooth(e.smooth!==!1),o=e.thresholds||nQ(i,r,e),a=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=s.size([c.width,c.height])(c.values,Z(o)?o:o(c.values));iQ(f,c,l,e),f.forEach(h=>{u.push(Ph(l,Ne(a!=null?{[a]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function nQ(e,t,n){const i=mM(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>ea(t(r).values)))}function iQ(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(ye(r)&&(r=r(n,i)),ye(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(Ls(r)?r:r[0])||1,a=(Ls(r)?r:r[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(yM(t,o,a,u,l))}function yM(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-o)*n+r}return function(f){return f.coordinates.forEach(u),f}}function bM(e,t,n){const i=e>=0?e:Hy(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function x2(e){return ye(e)?e:Yt(+e)}function vM(){var e=u=>u[0],t=u=>u[1],n=xu,i=[-1,-1],r=960,s=500,o=2;function a(u,l){const c=bM(i[0],u,e)>>o,f=bM(i[1],u,t)>>o,h=c?c+2:0,g=f?f+2:0,p=2*h+(r>>o),m=2*g+(s>>o),y=new Float32Array(p*m),x=new Float32Array(p*m);let w=y;u.forEach(A=>{const S=h+(+e(A)>>o),O=g+(+t(A)>>o);S>=0&&S<p&&O>=0&&O<m&&(y[S+O*p]+=+n(A))}),c>0&&f>0?(ol(p,m,y,x,c),al(p,m,x,y,f),ol(p,m,y,x,c),al(p,m,x,y,f),ol(p,m,y,x,c),al(p,m,x,y,f)):c>0?(ol(p,m,y,x,c),ol(p,m,x,y,c),ol(p,m,y,x,c),w=x):f>0&&(al(p,m,y,x,f),al(p,m,x,y,f),al(p,m,y,x,f),w=x);const E=l?Math.pow(2,-2*o):1/jO(w);for(let A=0,S=p*m;A<S;++A)w[A]*=E;return{values:w,scale:1<<o,width:p,height:m,x1:h,y1:g,x2:h+(r>>o),y2:g+(s>>o)}}return a.x=function(u){return arguments.length?(e=x2(u),a):e},a.y=function(u){return arguments.length?(t=x2(u),a):t},a.weight=function(u){return arguments.length?(n=x2(u),a):n},a.size=function(u){if(!arguments.length)return[r,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||P("invalid size"),r=l,s=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||P("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),a):1<<o},a.bandwidth=function(u){return arguments.length?(u=ae(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&P("invalid bandwidth"),i=u,a):i},a}function ol(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,u=0;a<e+r;++a)a<e&&(u+=n[a+o*e]),a>=r&&(a>=s&&(u-=n[a-s+o*e]),i[a-r+o*e]=u/Math.min(a+1,e-1+s-a,s))}function al(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,u=0;a<t+r;++a)a<t&&(u+=n[o+a*e]),a>=r&&(a>=s&&(u-=n[o+(a-s)*e]),i[o+(a-r)*e]=u/Math.min(a+1,t-1+s-a,s))}function w2(e){T.call(this,null,e)}w2.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const rQ=["x","y","weight","size","cellSize","bandwidth"];function xM(e,t){return rQ.forEach(n=>t[n]!=null?e[n](t[n]):0),e}H(w2,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=sQ(i,e.groupby),s=(e.groupby||[]).map(st),o=xM(vM(),e),a=e.as||"grid",u=[];function l(c,f){for(let h=0;h<s.length;++h)c[s[h]]=f[h];return c}return u=r.map(c=>Ne(l({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function sQ(e,t){var n=[],i=c=>c(a),r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function E2(e){T.call(this,null,e)}E2.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};H(E2,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=pM().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||mM(e.count||10,e.nice,!!r),o=e.size,a,u;return r||(r=t.materialize(t.SOURCE).source,a=xM(vM(),e)(r,!0),u=yM(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=Z(s)?s:s(r),r=i.size(o)(r,s),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ne),n}});const A2="Feature",_2="FeatureCollection",oQ="MultiPoint";function S2(e){T.call(this,null,e)}S2.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};H(S2,T,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&hn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Wt(a))||s&&t.modified(Wt(s))||o&&t.modified(Wt(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(u,c=>n.push(a(c))),s&&o&&(t.visit(u,c=>{var f=s(c),h=o(c);f!=null&&h!=null&&(f=+f)===f&&(h=+h)===h&&i.push([f,h])}),n=n.concat({type:A2,geometry:{type:oQ,coordinates:i}})),this.value={type:_2,features:n}}});function O2(e){T.call(this,null,e)}O2.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};H(O2,T,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||hn,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=gM(e.projection),n.materialize().reflow()):o=r===hn||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=aQ(i,e.pointRadius);return n.visit(o,u=>u[s]=i(r(u))),i.pointRadius(a),n.modifies(s)}});function aQ(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function C2(e){T.call(this,null,e)}C2.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};H(C2,T,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function $2(e){T.call(this,null,e)}$2.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};H($2,T,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=uQ(gM(e.projection),e.field||Dn("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function uQ(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function j2(e){T.call(this,[],e),this.generator=nX()}j2.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};H(j2,T,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)ye(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(GC(n[0],r)):t.add.push(Ne(r)),n[0]=r,t}});function k2(e){T.call(this,null,e)}k2.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};H(k2,T,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||hn,s=cQ(e.opacity,e),o=lQ(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?ea(n.map(l=>ea(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=pe({},l,u);i||(f.$max=ea(c.values||[])),l[a]=fQ(c,f,o.dep?o:Yt(o(f)),s.dep?s:Yt(s(f)))}),t.reflow(!0).modifies(a)}});function lQ(e,t){let n;return ye(e)?(n=i=>Zs(e(i,t)),n.dep=wM(e)):n=Yt(Zs(e||"#888")),n}function cQ(e,t){let n;return ye(e)?(n=i=>e(i,t),n.dep=wM(e)):e?n=Yt(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function wM(e){if(!ye(e))return!1;const t=Pi(Wt(e));return t.$x||t.$y||t.$value||t.$max}function fQ(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,u=e.x2||r,l=e.y2||s,c=e.values,f=c?y=>c[y]:Ns,h=Ru(u-o,l-a),g=h.getContext("2d"),p=g.getImageData(0,0,u-o,l-a),m=p.data;for(let y=a,x=0;y<l;++y){t.$y=y-a;for(let w=o,E=y*r;w<u;++w,x+=4){t.$x=w-o,t.$value=f(w+E);const A=n(t);m[x+0]=A.r,m[x+1]=A.g,m[x+2]=A.b,m[x+3]=~~(255*i(t))}}return g.putImageData(p,0,0),h}function EM(e){T.call(this,null,e),this.modified(!0)}H(EM,T,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=hQ(e.type),y2.forEach(i=>{e[i]!=null&&AM(n,i,e[i])})):y2.forEach(i=>{e.modified(i)&&AM(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&dQ(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function dQ(e,t){const n=gQ(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function hQ(e){const t=b2((e||"mercator").toLowerCase());return t||P("Unrecognized projection type: "+e),t()}function AM(e,t,n){ye(e[t])&&e[t](n)}function gQ(e){return e=ae(e),e.length===1?e[0]:{type:_2,features:e.reduce((t,n)=>t.concat(pQ(n)),[])}}function pQ(e){return e.type===_2?e.features:ae(e).filter(t=>t!=null).map(t=>t.type===A2?t:{type:A2,geometry:t})}var mQ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:E2,geojson:S2,geopath:O2,geopoint:C2,geoshape:$2,graticule:j2,heatmap:k2,isocontour:v2,kde2d:w2,projection:EM});function yQ(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,u=0,l=0;for(s=0;s<o;++s)a=n[s],u+=a.x,l+=a.y;for(u=(u/o-e)*i,l=(l/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=u,a.y-=l}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function bQ(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return _M(this.cover(t,n),t,n,e)}function _M(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,h,g,p,m,y,x,w;if(!s)return e._root=o,e;for(;s.length;)if((m=t>=(f=(a+l)/2))?a=f:l=f,(y=n>=(h=(u+c)/2))?u=h:c=h,r=s,!(s=s[x=y<<1|m]))return r[x]=o,e;if(g=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===g&&n===p)return o.next=s,r?r[x]=o:e._root=o,e;do r=r?r[x]=new Array(4):e._root=new Array(4),(m=t>=(f=(a+l)/2))?a=f:l=f,(y=n>=(h=(u+c)/2))?u=h:c=h;while((x=y<<1|m)==(w=(p>=h)<<1|g>=f));return r[w]=s,r[x]=o,e}function vQ(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<u&&(u=r),r>c&&(c=r),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)_M(this,o[n],a[n],e[n]);return this}function xQ(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,u,l;n>e||e>=r||i>t||t>=s;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function wQ(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function EQ(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function En(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function AQ(e,t,n){var i,r=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,h=[],g=this._root,p,m;for(g&&h.push(new En(g,r,s,c,f)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=h.pop();)if(!(!(g=p.node)||(o=p.x0)>c||(a=p.y0)>f||(u=p.x1)<r||(l=p.y1)<s))if(g.length){var y=(o+u)/2,x=(a+l)/2;h.push(new En(g[3],y,x,u,l),new En(g[2],o,x,y,l),new En(g[1],y,a,u,x),new En(g[0],o,a,y,x)),(m=(t>=x)<<1|e>=y)&&(p=h[h.length-1],h[h.length-1]=h[h.length-1-m],h[h.length-1-m]=p)}else{var w=e-+this._x.call(null,g.data),E=t-+this._y.call(null,g.data),A=w*w+E*E;if(A<n){var S=Math.sqrt(n=A);r=e-S,s=t-S,c=e+S,f=t+S,i=g.data}}return i}function _Q(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,h,g,p,m,y,x;if(!n)return this;if(n.length)for(;;){if((p=c>=(h=(o+u)/2))?o=h:u=h,(m=f>=(g=(a+l)/2))?a=g:l=g,t=n,!(n=n[y=m<<1|p]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(i=t,x=y)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[y]=s:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[x]=n:this._root=n),this):(this._root=s,this)}function SQ(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function OQ(){return this._root}function CQ(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function $Q(e){var t=[],n,i=this._root,r,s,o,a,u;for(i&&t.push(new En(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&i.length){var l=(s+a)/2,c=(o+u)/2;(r=i[3])&&t.push(new En(r,l,c,a,u)),(r=i[2])&&t.push(new En(r,s,c,l,u)),(r=i[1])&&t.push(new En(r,l,o,a,c)),(r=i[0])&&t.push(new En(r,s,o,l,c))}return this}function jQ(e){var t=[],n=[],i;for(this._root&&t.push(new En(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,u=i.x1,l=i.y1,c=(o+u)/2,f=(a+l)/2;(s=r[0])&&t.push(new En(s,o,a,c,f)),(s=r[1])&&t.push(new En(s,c,a,u,f)),(s=r[2])&&t.push(new En(s,o,f,c,l)),(s=r[3])&&t.push(new En(s,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function kQ(e){return e[0]}function FQ(e){return arguments.length?(this._x=e,this):this._x}function DQ(e){return e[1]}function MQ(e){return arguments.length?(this._y=e,this):this._y}function F2(e,t,n){var i=new D2(t==null?kQ:t,n==null?DQ:n,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function D2(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function SM(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var An=F2.prototype=D2.prototype;An.copy=function(){var e=new D2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=SM(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=SM(i));return e};An.add=bQ;An.addAll=vQ;An.cover=xQ;An.data=wQ;An.extent=EQ;An.find=AQ;An.remove=_Q;An.removeAll=SQ;An.root=OQ;An.size=CQ;An.visit=$Q;An.visitAfter=jQ;An.x=FQ;An.y=MQ;function _n(e){return function(){return e}}function bo(e){return(e()-.5)*1e-6}function TQ(e){return e.x+e.vx}function NQ(e){return e.y+e.vy}function RQ(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=_n(e==null?1:+e));function o(){for(var l,c=t.length,f,h,g,p,m,y,x=0;x<s;++x)for(f=F2(t,TQ,NQ).visitAfter(a),l=0;l<c;++l)h=t[l],m=n[h.index],y=m*m,g=h.x+h.vx,p=h.y+h.vy,f.visit(w);function w(E,A,S,O,_){var C=E.data,j=E.r,$=m+j;if(C){if(C.index>h.index){var k=g-C.x-C.vx,M=p-C.y-C.vy,D=k*k+M*M;D<$*$&&(k===0&&(k=bo(i),D+=k*k),M===0&&(M=bo(i),D+=M*M),D=($-(D=Math.sqrt(D)))/D*r,h.vx+=(k*=D)*($=(j*=j)/(y+j)),h.vy+=(M*=D)*$,C.vx-=k*($=1-$),C.vy-=M*$)}return}return A>g+$||O<g-$||S>p+$||_<p-$}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,i=c,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(r=+l,o):r},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:_n(+l),u(),o):e},o}function PQ(e){return e.index}function OM(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function LQ(e){var t=PQ,n=f,i,r=_n(30),s,o,a,u,l,c=1;e==null&&(e=[]);function f(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function h(y){for(var x=0,w=e.length;x<c;++x)for(var E=0,A,S,O,_,C,j,$;E<w;++E)A=e[E],S=A.source,O=A.target,_=O.x+O.vx-S.x-S.vx||bo(l),C=O.y+O.vy-S.y-S.vy||bo(l),j=Math.sqrt(_*_+C*C),j=(j-s[E])/j*y*i[E],_*=j,C*=j,O.vx-=_*($=u[E]),O.vy-=C*$,S.vx+=_*($=1-$),S.vy+=C*$}function g(){if(!!o){var y,x=o.length,w=e.length,E=new Map(o.map((S,O)=>[t(S,O,o),S])),A;for(y=0,a=new Array(x);y<w;++y)A=e[y],A.index=y,typeof A.source!="object"&&(A.source=OM(E,A.source)),typeof A.target!="object"&&(A.target=OM(E,A.target)),a[A.source.index]=(a[A.source.index]||0)+1,a[A.target.index]=(a[A.target.index]||0)+1;for(y=0,u=new Array(w);y<w;++y)A=e[y],u[y]=a[A.source.index]/(a[A.source.index]+a[A.target.index]);i=new Array(w),p(),s=new Array(w),m()}}function p(){if(!!o)for(var y=0,x=e.length;y<x;++y)i[y]=+n(e[y],y,e)}function m(){if(!!o)for(var y=0,x=e.length;y<x;++y)s[y]=+r(e[y],y,e)}return h.initialize=function(y,x){o=y,l=x,g()},h.links=function(y){return arguments.length?(e=y,g(),h):e},h.id=function(y){return arguments.length?(t=y,h):t},h.iterations=function(y){return arguments.length?(c=+y,h):c},h.strength=function(y){return arguments.length?(n=typeof y=="function"?y:_n(+y),p(),h):n},h.distance=function(y){return arguments.length?(r=typeof y=="function"?y:_n(+y),m(),h):r},h}var IQ={value:()=>{}};function CM(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Rp(n)}function Rp(e){this._=e}function BQ(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Rp.prototype=CM.prototype={constructor:Rp,on:function(e,t){var n=this._,i=BQ(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=UQ(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=$M(n[r],e.name,t);else if(t==null)for(r in n)n[r]=$M(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Rp(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function UQ(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function $M(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=IQ,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var ul=0,Ff=0,Df=0,jM=1e3,Pp,Mf,Lp=0,_a=0,Ip=0,Tf=typeof performance=="object"&&performance.now?performance:Date,kM=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function M2(){return _a||(kM(zQ),_a=Tf.now()+Ip)}function zQ(){_a=0}function Bp(){this._call=this._time=this._next=null}Bp.prototype=FM.prototype={constructor:Bp,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?M2():+n)+(t==null?0:+t),!this._next&&Mf!==this&&(Mf?Mf._next=this:Pp=this,Mf=this),this._call=e,this._time=n,T2()},stop:function(){this._call&&(this._call=null,this._time=1/0,T2())}};function FM(e,t,n){var i=new Bp;return i.restart(e,t,n),i}function qQ(){M2(),++ul;for(var e=Pp,t;e;)(t=_a-e._time)>=0&&e._call.call(null,t),e=e._next;--ul}function DM(){_a=(Lp=Tf.now())+Ip,ul=Ff=0;try{qQ()}finally{ul=0,WQ(),_a=0}}function HQ(){var e=Tf.now(),t=e-Lp;t>jM&&(Ip-=t,Lp=e)}function WQ(){for(var e,t=Pp,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Pp=n);Mf=e,T2(i)}function T2(e){if(!ul){Ff&&(Ff=clearTimeout(Ff));var t=e-_a;t>24?(e<1/0&&(Ff=setTimeout(DM,e-Tf.now()-Ip)),Df&&(Df=clearInterval(Df))):(Df||(Lp=Tf.now(),Df=setInterval(HQ,jM)),ul=1,kM(DM))}}function GQ(e,t,n){var i=new Bp,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?M2():+a,i._restart(function u(l){l+=r,i._restart(u,r+=o,a),s(l)},o,a)},i.restart(e,t,n),i)}const YQ=1664525,VQ=1013904223,MM=4294967296;function XQ(){let e=1;return()=>(e=(YQ*e+VQ)%MM)/MM}function QQ(e){return e.x}function KQ(e){return e.y}var JQ=10,ZQ=Math.PI*(3-Math.sqrt(5));function eK(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,u=FM(f),l=CM("tick","end"),c=XQ();e==null&&(e=[]);function f(){h(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function h(m){var y,x=e.length,w;m===void 0&&(m=1);for(var E=0;E<m;++E)for(n+=(s-n)*r,a.forEach(function(A){A(n)}),y=0;y<x;++y)w=e[y],w.fx==null?w.x+=w.vx*=o:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=o:(w.y=w.fy,w.vy=0);return t}function g(){for(var m=0,y=e.length,x;m<y;++m){if(x=e[m],x.index=m,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var w=JQ*Math.sqrt(.5+m),E=m*ZQ;x.x=w*Math.cos(E),x.y=w*Math.sin(E)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function p(m){return m.initialize&&m.initialize(e,c),m}return g(),t={tick:h,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(m){return arguments.length?(e=m,g(),a.forEach(p),t):e},alpha:function(m){return arguments.length?(n=+m,t):n},alphaMin:function(m){return arguments.length?(i=+m,t):i},alphaDecay:function(m){return arguments.length?(r=+m,t):+r},alphaTarget:function(m){return arguments.length?(s=+m,t):s},velocityDecay:function(m){return arguments.length?(o=1-m,t):1-o},randomSource:function(m){return arguments.length?(c=m,a.forEach(p),t):c},force:function(m,y){return arguments.length>1?(y==null?a.delete(m):a.set(m,p(y)),t):a.get(m)},find:function(m,y,x){var w=0,E=e.length,A,S,O,_,C;for(x==null?x=1/0:x*=x,w=0;w<E;++w)_=e[w],A=m-_.x,S=y-_.y,O=A*A+S*S,O<x&&(C=_,x=O);return C},on:function(m,y){return arguments.length>1?(l.on(m,y),t):l.on(m)}}}function tK(){var e,t,n,i,r=_n(-30),s,o=1,a=1/0,u=.81;function l(g){var p,m=e.length,y=F2(e,QQ,KQ).visitAfter(f);for(i=g,p=0;p<m;++p)t=e[p],y.visit(h)}function c(){if(!!e){var g,p=e.length,m;for(s=new Array(p),g=0;g<p;++g)m=e[g],s[m.index]=+r(m,g,e)}}function f(g){var p=0,m,y,x=0,w,E,A;if(g.length){for(w=E=A=0;A<4;++A)(m=g[A])&&(y=Math.abs(m.value))&&(p+=m.value,x+=y,w+=y*m.x,E+=y*m.y);g.x=w/x,g.y=E/x}else{m=g,m.x=m.data.x,m.y=m.data.y;do p+=s[m.data.index];while(m=m.next)}g.value=p}function h(g,p,m,y){if(!g.value)return!0;var x=g.x-t.x,w=g.y-t.y,E=y-p,A=x*x+w*w;if(E*E/u<A)return A<a&&(x===0&&(x=bo(n),A+=x*x),w===0&&(w=bo(n),A+=w*w),A<o&&(A=Math.sqrt(o*A)),t.vx+=x*g.value*i/A,t.vy+=w*g.value*i/A),!0;if(g.length||A>=a)return;(g.data!==t||g.next)&&(x===0&&(x=bo(n),A+=x*x),w===0&&(w=bo(n),A+=w*w),A<o&&(A=Math.sqrt(o*A)));do g.data!==t&&(E=s[g.data.index]*i/A,t.vx+=x*E,t.vy+=w*E);while(g=g.next)}return l.initialize=function(g,p){e=g,n=p,c()},l.strength=function(g){return arguments.length?(r=typeof g=="function"?g:_n(+g),c(),l):r},l.distanceMin=function(g){return arguments.length?(o=g*g,l):Math.sqrt(o)},l.distanceMax=function(g){return arguments.length?(a=g*g,l):Math.sqrt(a)},l.theta=function(g){return arguments.length?(u=g*g,l):Math.sqrt(u)},l}function nK(e){var t=_n(.1),n,i,r;typeof e!="function"&&(e=_n(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*a}function o(){if(!!n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:_n(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:_n(+a),o(),s):e},s}function iK(e){var t=_n(.1),n,i,r;typeof e!="function"&&(e=_n(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*a}function o(){if(!!n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:_n(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:_n(+a),o(),s):e},s}const TM={center:yQ,collide:RQ,nbody:tK,link:LQ,x:nK,y:iK},Nf="forces",N2=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],rK=["static","iterations"],NM=["x","y","vx","vy"];function R2(e){T.call(this,null,e)}R2.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:NM}]};H(R2,T,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(N2),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&RM(n,e,0,t)):(this.value=n=oK(t.source,e),n.on("tick",sK(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(rK)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Nf||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(NM)}});function sK(e,t){return()=>e.touch(t).run()}function oK(e,t){const n=eK(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),RM(n,t,!0).on("end",()=>s=!0)}function RM(e,t,n,i){var r=ae(t.forces),s,o,a,u;for(s=0,o=N2.length;s<o;++s)a=N2[s],a!==Nf&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)u=Nf+s,a=n||t.modified(Nf,s)?uK(r[s]):i&&aK(r[s],i)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(Nf+s,null);return e.numForces=r.length,e}function aK(e,t){var n,i;for(n in e)if(ye(i=e[n])&&t.modified(Wt(i)))return 1;return 0}function uK(e){var t,n;ue(TM,e.force)||P("Unrecognized force: "+e.force),t=TM[e.force]();for(n in e)ye(t[n])&&lK(t[n],e[n],e);return t}function lK(e,t,n){e(ye(t)?i=>t(i,n):t)}var cK=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:R2});function fK(e,t){return e.parent===t.parent?1:2}function dK(e){return e.reduce(hK,0)/e.length}function hK(e,t){return e+t.x}function gK(e){return 1+e.reduce(pK,0)}function pK(e,t){return Math.max(e,t.y)}function mK(e){for(var t;t=e.children;)e=t[0];return e}function yK(e){for(var t;t=e.children;)e=t[t.length-1];return e}function bK(){var e=fK,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(h){var g=h.children;g?(h.x=dK(g),h.y=gK(g)):(h.x=o?a+=e(h,o):0,h.y=0,o=h)});var u=mK(s),l=yK(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(i?function(h){h.x=(h.x-s.x)*t,h.y=(s.y-h.y)*n}:function(h){h.x=(h.x-c)/(f-c)*t,h.y=(1-(s.y?h.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function vK(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function xK(){return this.eachAfter(vK)}function wK(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function EK(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function AK(e,t){for(var n=this,i=[n],r=[],s,o,a,u=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function _K(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function SK(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function OK(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function CK(e){for(var t=this,n=$K(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function $K(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function jK(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function kK(){return Array.from(this)}function FK(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function DK(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*MK(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function P2(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=RK)):t===void 0&&(t=NK);for(var n=new ll(e),i,r=[n],s,o,a,u;i=r.pop();)if((o=t(i.data))&&(u=(o=Array.from(o)).length))for(i.children=o,a=u-1;a>=0;--a)r.push(s=o[a]=new ll(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(PM)}function TK(){return P2(this).eachBefore(PK)}function NK(e){return e.children}function RK(e){return Array.isArray(e)?e[1]:null}function PK(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function PM(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ll(e){this.data=e,this.depth=this.height=0,this.parent=null}ll.prototype=P2.prototype={constructor:ll,count:xK,each:wK,eachAfter:AK,eachBefore:EK,find:_K,sum:SK,sort:OK,path:CK,ancestors:jK,descendants:kK,leaves:FK,links:DK,copy:TK,[Symbol.iterator]:MK};function LK(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function IK(e){for(var t=e.length,n,i;t;)i=Math.random()*t--|0,n=e[t],e[t]=e[i],e[i]=n;return e}function BK(e){for(var t=0,n=(e=IK(Array.from(e))).length,i=[],r,s;t<n;)r=e[t],s&&LM(s,r)?++t:(s=zK(i=UK(i,r)),t=0);return s}function UK(e,t){var n,i;if(L2(t,e))return[t];for(n=0;n<e.length;++n)if(Up(t,e[n])&&L2(Rf(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(Up(Rf(e[n],e[i]),t)&&Up(Rf(e[n],t),e[i])&&Up(Rf(e[i],t),e[n])&&L2(IM(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function Up(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function LM(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function L2(e,t){for(var n=0;n<t.length;++n)if(!LM(e,t[n]))return!1;return!0}function zK(e){switch(e.length){case 1:return qK(e[0]);case 2:return Rf(e[0],e[1]);case 3:return IM(e[0],e[1],e[2])}}function qK(e){return{x:e.x,y:e.y,r:e.r}}function Rf(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-i,c=a-r,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(i+o+l/f*c)/2,r:(f+r+a)/2}}function IM(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,h=i-o,g=i-l,p=r-a,m=r-c,y=u-s,x=f-s,w=i*i+r*r-s*s,E=w-o*o-a*a+u*u,A=w-l*l-c*c+f*f,S=g*p-h*m,O=(p*A-m*E)/(S*2)-i,_=(m*y-p*x)/S,C=(g*E-h*A)/(S*2)-r,j=(h*x-g*y)/S,$=_*_+j*j-1,k=2*(s+O*_+C*j),M=O*O+C*C-s*s,D=-($?(k+Math.sqrt(k*k-4*$*M))/(2*$):M/k);return{x:i+O+_*D,y:r+C+j*D,r:D}}function BM(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,u,l=i*i+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(r=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function UM(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function zM(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function zp(e){this._=e,this.next=null,this.previous=null}function HK(e){if(!(r=(e=LK(e)).length))return 0;var t,n,i,r,s,o,a,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;BM(n,t,i=e[2]),t=new zp(t),n=new zp(n),i=new zp(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(a=3;a<r;++a){BM(t._,n._,i=e[a]),i=new zp(i),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(UM(u._,i._)){n=u,t.next=n,n.previous=t,--a;continue e}c+=u._.r,u=u.next}else{if(UM(l._,i._)){t=l,t.next=n,n.previous=t,--a;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,s=zM(t);(i=i.next)!==n;)(o=zM(i))<s&&(t=i,s=o);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=BK(t),a=0;a<r;++a)t=e[a],t.x-=i.x,t.y-=i.y;return i.r}function WK(e){return e==null?null:qp(e)}function qp(e){if(typeof e!="function")throw new Error;return e}function Sa(){return 0}function cl(e){return function(){return e}}function GK(e){return Math.sqrt(e.value)}function YK(){var e=null,t=1,n=1,i=Sa;function r(s){return s.x=t/2,s.y=n/2,e?s.eachBefore(qM(e)).eachAfter(I2(i,.5)).eachBefore(HM(1)):s.eachBefore(qM(GK)).eachAfter(I2(Sa,1)).eachAfter(I2(i,s.r/Math.min(t,n))).eachBefore(HM(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=WK(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:cl(+s),r):i},r}function qM(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function I2(e,t){return function(n){if(i=n.children){var i,r,s=i.length,o=e(n)*t||0,a;if(o)for(r=0;r<s;++r)i[r].r+=o;if(a=HK(i),o)for(r=0;r<s;++r)i[r].r-=o;n.r=a+o}}}function HM(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function WM(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Pf(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*l}function VK(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(WM),o}function s(o,a){return function(u){u.children&&Pf(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,h=u.y1-n;f<l&&(l=f=(l+f)/2),h<c&&(c=h=(c+h)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=h}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var XK={depth:-1},GM={};function QK(e){return e.id}function KK(e){return e.parentId}function YM(){var e=QK,t=KK;function n(i){var r=Array.from(i),s=r.length,o,a,u,l,c,f,h,g=new Map;for(a=0;a<s;++a)o=r[a],c=r[a]=new ll(o),(f=e(o,a,i))!=null&&(f+="")&&(h=c.id=f,g.set(h,g.has(h)?GM:c)),(f=t(o,a,i))!=null&&(f+="")&&(c.parent=f);for(a=0;a<s;++a)if(c=r[a],f=c.parent){if(l=g.get(f),!l)throw new Error("missing: "+f);if(l===GM)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=XK,u.eachBefore(function(p){p.depth=p.parent.depth+1,--s}).eachBefore(PM),u.parent=null,s>0)throw new Error("cycle");return u}return n.id=function(i){return arguments.length?(e=qp(i),n):e},n.parentId=function(i){return arguments.length?(t=qp(i),n):t},n}function JK(e,t){return e.parent===t.parent?1:2}function B2(e){var t=e.children;return t?t[0]:e.t}function U2(e){var t=e.children;return t?t[t.length-1]:e.t}function ZK(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function eJ(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function tJ(e,t,n){return e.a.parent===t.parent?e.a:n}function Hp(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Hp.prototype=Object.create(ll.prototype);function nJ(e){for(var t=new Hp(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new Hp(s[o],o)),r.parent=n;return(t.parent=new Hp(null,0)).children=[t],t}function iJ(){var e=JK,t=1,n=1,i=null;function r(l){var c=nJ(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)l.eachBefore(u);else{var f=l,h=l,g=l;l.eachBefore(function(w){w.x<f.x&&(f=w),w.x>h.x&&(h=w),w.depth>g.depth&&(g=w)});var p=f===h?1:e(f,h)/2,m=p-f.x,y=t/(h.x+p+m),x=n/(g.depth||1);l.eachBefore(function(w){w.x=(w.x+m)*y,w.y=w.depth*x})}return l}function s(l){var c=l.children,f=l.parent.children,h=l.i?f[l.i-1]:null;if(c){eJ(l);var g=(c[0].z+c[c.length-1].z)/2;h?(l.z=h.z+e(l._,h._),l.m=l.z-g):l.z=g}else h&&(l.z=h.z+e(l._,h._));l.parent.A=a(l,h,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var h=l,g=l,p=c,m=h.parent.children[0],y=h.m,x=g.m,w=p.m,E=m.m,A;p=U2(p),h=B2(h),p&&h;)m=B2(m),g=U2(g),g.a=l,A=p.z+w-h.z-y+e(p._,h._),A>0&&(ZK(tJ(p,l,f),l,A),y+=A,x+=A),w+=p.m,y+=h.m,E+=m.m,x+=g.m;p&&!U2(g)&&(g.t=p,g.m+=w-x),h&&!B2(m)&&(m.t=h,m.m+=y-E,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function Wp(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*l}var VM=(1+Math.sqrt(5))/2;function XM(e,t,n,i,r,s){for(var o=[],a=t.children,u,l,c=0,f=0,h=a.length,g,p,m=t.value,y,x,w,E,A,S,O;c<h;){g=r-n,p=s-i;do y=a[f++].value;while(!y&&f<h);for(x=w=y,S=Math.max(p/g,g/p)/(m*e),O=y*y*S,A=Math.max(w/O,O/x);f<h;++f){if(y+=l=a[f].value,l<x&&(x=l),l>w&&(w=l),O=y*y*S,E=Math.max(w/O,O/x),E>A){y-=l;break}A=E}o.push(u={value:y,dice:g<p,children:a.slice(c,f)}),u.dice?Pf(u,n,i,r,m?i+=p*y/m:s):Wp(u,n,i,m?n+=g*y/m:r,s),m-=y,c=f}return o}var QM=function e(t){function n(i,r,s,o,a){XM(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(VM);function rJ(){var e=QM,t=!1,n=1,i=1,r=[0],s=Sa,o=Sa,a=Sa,u=Sa,l=Sa;function c(h){return h.x0=h.y0=0,h.x1=n,h.y1=i,h.eachBefore(f),r=[0],t&&h.eachBefore(WM),h}function f(h){var g=r[h.depth],p=h.x0+g,m=h.y0+g,y=h.x1-g,x=h.y1-g;y<p&&(p=y=(p+y)/2),x<m&&(m=x=(m+x)/2),h.x0=p,h.y0=m,h.x1=y,h.y1=x,h.children&&(g=r[h.depth+1]=s(h)/2,p+=l(h)-g,m+=o(h)-g,y-=a(h)-g,x-=u(h)-g,y<p&&(p=y=(p+y)/2),x<m&&(m=x=(m+x)/2),e(h,p,m,y,x))}return c.round=function(h){return arguments.length?(t=!!h,c):t},c.size=function(h){return arguments.length?(n=+h[0],i=+h[1],c):[n,i]},c.tile=function(h){return arguments.length?(e=qp(h),c):e},c.padding=function(h){return arguments.length?c.paddingInner(h).paddingOuter(h):c.paddingInner()},c.paddingInner=function(h){return arguments.length?(s=typeof h=="function"?h:cl(+h),c):s},c.paddingOuter=function(h){return arguments.length?c.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):c.paddingTop()},c.paddingTop=function(h){return arguments.length?(o=typeof h=="function"?h:cl(+h),c):o},c.paddingRight=function(h){return arguments.length?(a=typeof h=="function"?h:cl(+h),c):a},c.paddingBottom=function(h){return arguments.length?(u=typeof h=="function"?h:cl(+h),c):u},c.paddingLeft=function(h){return arguments.length?(l=typeof h=="function"?h:cl(+h),c):l},c}function sJ(e,t,n,i,r){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,i,r);function c(f,h,g,p,m,y,x){if(f>=h-1){var w=s[f];w.x0=p,w.y0=m,w.x1=y,w.y1=x;return}for(var E=l[f],A=g/2+E,S=f+1,O=h-1;S<O;){var _=S+O>>>1;l[_]<A?S=_+1:O=_}A-l[S-1]<l[S]-A&&f+1<S&&--S;var C=l[S]-E,j=g-C;if(y-p>x-m){var $=g?(p*j+y*C)/g:y;c(f,S,C,p,m,$,x),c(S,h,j,$,m,y,x)}else{var k=g?(m*j+x*C)/g:x;c(f,S,C,p,m,y,k),c(S,h,j,p,k,y,x)}}}function oJ(e,t,n,i,r){(e.depth&1?Wp:Pf)(e,t,n,i,r)}var aJ=function e(t){function n(i,r,s,o,a){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,h=-1,g,p=u.length,m=i.value;++h<p;){for(l=u[h],c=l.children,f=l.value=0,g=c.length;f<g;++f)l.value+=c[f].value;l.dice?Pf(l,r,s,o,m?s+=(a-s)*l.value/m:a):Wp(l,r,s,m?r+=(o-r)*l.value/m:o,a),m-=l.value}else i._squarify=u=XM(t,i,r,s,o,a),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(VM);function z2(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function q2(e){T.call(this,null,e)}q2.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const uJ=e=>e.values;H(q2,T,{transform(e,t){t.source||P("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&Rh(o.data)&&r.rem.push(o.data)}),this.value=s=P2({values:ae(e.keys).reduce((o,a)=>(o.key(a),o),lJ()).entries(r.source)},uJ),n&&s.each(o=>{o.children&&(o=Ne(o.data),r.add.push(o),r.source.push(o))}),z2(s,ee,ee)),r.source.root=s,r}});function lJ(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],u={},l={};let c=-1,f,h,g;for(;++c<o;)f=a(h=r[c])+"",(g=u[f])?g.push(h):u[f]=[h];for(f in u)l[f]=n(u[f],s);return l}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function ds(e){T.call(this,null,e)}const cJ=(e,t)=>e.parent===t.parent?1:2;H(ds,T,{transform(e,t){(!t.source||!t.source.root)&&P(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(sa(e.sort,o=>o.data)),fJ(n,this.params,e),n.separation&&n.separation(e.separation!==!1?cJ:xu);try{this.value=n(r)}catch(o){P(o)}return r.each(o=>dJ(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function fJ(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function dJ(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const H2=["x","y","r","depth","children"];function W2(e){ds.call(this,e)}W2.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:H2.length,default:H2}]};H(W2,ds,{layout:YK,params:["radius","size","padding"],fields:H2});const G2=["x0","y0","x1","y1","depth","children"];function Y2(e){ds.call(this,e)}Y2.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:G2.length,default:G2}]};H(Y2,ds,{layout:VK,params:["size","round","padding"],fields:G2});function V2(e){T.call(this,null,e)}V2.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};H(V2,T,{transform(e,t){t.source||P("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?z2(YM().id(e.key).parentId(e.parentKey)(r.source),e.key,di):z2(YM()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const KM={tidy:iJ,cluster:bK},X2=["x","y","depth","children"];function Q2(e){ds.call(this,e)}Q2.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:X2.length,default:X2}]};H(Q2,ds,{layout(e){const t=e||"tidy";if(ue(KM,t))return KM[t]();P("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:X2});function K2(e){T.call(this,[],e)}K2.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};H(K2,T,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||P("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[ee(o)]=1),i.each(o=>{const a=o.data,u=o.parent&&o.parent.data;u&&s[ee(a)]&&s[ee(u)]&&r.add.push(Ne({source:u,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[ee(o)]=1),n.forEach(o=>{(s[ee(o.source)]||s[ee(o.target)])&&r.mod.push(o)})),r}});const JM={binary:sJ,dice:Pf,slice:Wp,slicedice:oJ,squarify:QM,resquarify:aJ},J2=["x0","y0","x1","y1","depth","children"];function Z2(e){ds.call(this,e)}Z2.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:J2.length,default:J2}]};H(Z2,ds,{layout(){const e=rJ();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ue(JM,t)?e.tile(JM[t]):P("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:J2});var hJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:q2,pack:W2,partition:Y2,stratify:V2,tree:Q2,treelinks:K2,treemap:Z2});const gJ=4278190080,pJ=268435456,mJ=.0625;function yJ(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function bJ(e,t,n,i){const r=e.width,s=e.height,o=n||i,a=Ru(r,s).getContext("2d");t.forEach(y=>ZM(a,y,o));const u=new Uint32Array(a.getImageData(0,0,r,s).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,h,g,p,m;for(h=0;h<s;++h)for(f=0;f<r;++f)m=u[h*r+f]&gJ,m&&(g=e(f),p=e(h),i||l.set(g,p),o&&m^pJ&&c.set(g,p));return[l,c]}function ZM(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>ZM(e,s.items,n))}):ni[i].draw(e,{items:n?t.map(vJ):t})}function vJ(e){const t=Ph(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=mJ,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const hs=5,Sn=31,Lf=32,vo=new Uint32Array(Lf+1),Yi=new Uint32Array(Lf+1);Yi[0]=0;vo[0]=~Yi[0];for(let e=1;e<=Lf;++e)Yi[e]=Yi[e-1]<<1|1,vo[e]=~Yi[e];function xJ(e,t){const n=new Uint32Array(~~((e*t+Lf)/Lf));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>hs]&1<<(a&Sn)},set:(s,o)=>{const a=o*e+s;i(a>>>hs,1<<(a&Sn))},clear:(s,o)=>{const a=o*e+s;r(a>>>hs,~(1<<(a&Sn)))},getRange:(s,o,a,u)=>{let l=u,c,f,h,g;for(;l>=o;--l)if(c=l*e+s,f=l*e+a,h=c>>>hs,g=f>>>hs,h===g){if(n[h]&vo[c&Sn]&Yi[(f&Sn)+1])return!0}else{if(n[h]&vo[c&Sn]||n[g]&Yi[(f&Sn)+1])return!0;for(let p=h+1;p<g;++p)if(n[p])return!0}return!1},setRange:(s,o,a,u)=>{let l,c,f,h,g;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>hs,h=c>>>hs,f===h)i(f,vo[l&Sn]&Yi[(c&Sn)+1]);else for(i(f,vo[l&Sn]),i(h,Yi[(c&Sn)+1]),g=f+1;g<h;++g)i(g,4294967295)},clearRange:(s,o,a,u)=>{let l,c,f,h,g;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>hs,h=c>>>hs,f===h)r(f,Yi[l&Sn]|vo[(c&Sn)+1]);else for(r(f,Yi[l&Sn]),r(h,vo[(c&Sn)+1]),g=f+1;g<h;++g)r(g,0)},outOfBounds:(s,o,a,u)=>s<0||o<0||u>=t||a>=e}}function wJ(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>xJ(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function EJ(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,u=a.length,l=o.datum.fontSize,c=wr.width(o.datum,o.datum.text);let f=0,h,g,p,m,y,x,w;for(let E=0;E<u;++E)h=a[E].x,p=a[E].y,g=a[E].x2===void 0?h:a[E].x2,m=a[E].y2===void 0?p:a[E].y2,y=(h+g)/2,x=(p+m)/2,w=Math.abs(g-h+m-p),w>=f&&(f=w,o.x=y,o.y=x);return y=c/2,x=l/2,h=o.x-y,g=o.x+y,p=o.y-x,m=o.y+x,o.align="center",h<0&&g<=r?o.align="left":0<=h&&r<g&&(o.align="right"),o.baseline="middle",p<0&&m<=s?o.baseline="top":0<=p&&s<m&&(o.baseline="bottom"),!0}}function AJ(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function _J(){return!1}function SJ(e,t,n,i,r,s,o,a){const u=r*s/(i*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),h=e(n+s);return o.outOfBounds(l,f,c,h)||o.getRange(l,f,c,h)||a&&a.getRange(l,f,c,h)}function OJ(e,t,n,i,r,s,o,a){const u=r*s/(i*2);let l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),h=e(n+s);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,h=h<e.height?h:e.height-1,o.getRange(l,f,c,h)||a&&a.getRange(l,f,c,h)}function eT(e){return e?[OJ,_J]:[SJ,AJ]}function CJ(e,t,n,i,r){const s=e.width,o=e.height,[a,u]=eT(r),l=t[0],c=t[1];function f(h,g,p,m,y){const x=e.invert(h),w=e.invert(g);let E=p,A=o,S;if(!u(x,w,m,y,s,o)&&!a(e,x,w,y,m,E,l,c)&&!a(e,x,w,y,m,y,l,null)){for(;A-E>=1;)S=(E+A)/2,a(e,x,w,y,m,S,l,c)?A=S:E=S;if(E>p)return[x,w,E,!0]}}return function(h){const g=h.datum.datum.items[i].items,p=g.length,m=h.datum.fontSize,y=wr.width(h.datum,h.datum.text);let x=n?m:0,w=!1,E=!1,A=0,S,O,_,C,j,$,k,M,D,I,F,L,B,W,X,ce,Te;for(let $e=0;$e<p;++$e){for(S=g[$e].x,_=g[$e].y,O=g[$e].x2===void 0?S:g[$e].x2,C=g[$e].y2===void 0?_:g[$e].y2,S>O&&(Te=S,S=O,O=Te),_>C&&(Te=_,_=C,C=Te),D=e(S),F=e(O),I=~~((D+F)/2),L=e(_),W=e(C),B=~~((L+W)/2),k=I;k>=D;--k)for(M=B;M>=L;--M)ce=f(k,M,x,y,m),ce&&([h.x,h.y,x,w]=ce);for(k=I;k<=F;++k)for(M=B;M<=W;++M)ce=f(k,M,x,y,m),ce&&([h.x,h.y,x,w]=ce);!w&&!n&&(X=Math.abs(O-S+C-_),j=(S+O)/2,$=(_+C)/2,X>=A&&!u(j,$,y,m,s,o)&&!a(e,j,$,m,y,m,l,null)&&(A=X,h.x=j,h.y=$,E=!0))}return w||E?(j=y/2,$=m/2,l.setRange(e(h.x-j),e(h.y-$),e(h.x+j),e(h.y+$)),h.align="center",h.baseline="middle",!0):!1}}const $J=[-1,-1,1,1],jJ=[-1,1,-1,1];function kJ(e,t,n,i,r){const s=e.width,o=e.height,[a,u]=eT(r),l=t[0],c=t[1],f=e.bitmap();return function(h){const g=h.datum.datum.items[i].items,p=g.length,m=h.datum.fontSize,y=wr.width(h.datum,h.datum.text),x=[];let w=n?m:0,E=!1,A=!1,S=0,O,_,C,j,$,k,M,D,I,F,L,B;for(let W=0;W<p;++W){for(O=g[W].x,C=g[W].y,_=g[W].x2===void 0?O:g[W].x2,j=g[W].y2===void 0?C:g[W].y2,x.push([e((O+_)/2),e((C+j)/2)]);x.length;)if([M,D]=x.pop(),!(l.get(M,D)||c.get(M,D)||f.get(M,D))){f.set(M,D);for(let X=0;X<4;++X)$=M+$J[X],k=D+jJ[X],f.outOfBounds($,k,$,k)||x.push([$,k]);if($=e.invert(M),k=e.invert(D),I=w,F=o,!u($,k,y,m,s,o)&&!a(e,$,k,m,y,I,l,c)&&!a(e,$,k,m,y,m,l,null)){for(;F-I>=1;)L=(I+F)/2,a(e,$,k,m,y,L,l,c)?F=L:I=L;I>w&&(h.x=$,h.y=k,w=I,E=!0)}}!E&&!n&&(B=Math.abs(_-O+j-C),$=(O+_)/2,k=(C+j)/2,B>=S&&!u($,k,y,m,s,o)&&!a(e,$,k,m,y,m,l,null)&&(S=B,h.x=$,h.y=k,A=!0))}return E||A?($=y/2,k=m/2,l.setRange(e(h.x-$),e(h.y-k),e(h.x+$),e(h.y+k)),h.align="center",h.baseline="middle",!0):!1}}const FJ=["right","center","left"],DJ=["bottom","middle","top"];function MJ(e,t,n,i,r){const s=e.width,o=e.height,a=t[0],u=t[1],l=i.length;return function(c){const f=c.boundary,h=c.datum.fontSize;if(!r&&(f[2]<0||f[5]<0||f[0]>s||f[3]>o))return!1;let g=0,p,m,y,x,w,E,A,S,O,_,C,j,$,k,M;for(let D=0;D<l;++D){if(p=(n[D]&3)-1,m=(n[D]>>>2&3)-1,y=p===0&&m===0||i[D]<0,x=p&&m?Math.SQRT1_2:1,w=i[D]<0?-1:1,E=f[1+p]+i[D]*p*x,C=f[4+m]+w*h*m/2+i[D]*m*x,S=C-h/2,O=C+h/2,j=e(E),k=e(S),M=e(O),r&&(j=j<0?0:j,k=k<0?0:k,M=M>=e.height?e.height-1:M),!g)if(tT(j,j,k,M,a,u,E,E,S,O,f,y))g=wr.width(c.datum,c.datum.text);else continue;if(_=E+w*g*p/2,E=_-g/2,A=_+g/2,j=e(E),$=e(A),r&&(j=j<0?0:j,$=$>=e.width?e.width-1:$),tT(j,$,k,M,a,u,E,A,S,O,f,y))return c.x=p?p*w<0?A:E:_,c.y=m?m*w<0?O:S:C,c.align=FJ[p*w+1],c.baseline=DJ[m*w+1],a.setRange(j,k,$,M),!0}return!1}}function tT(e,t,n,i,r,s,o,a,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s?s.getRange(e,n,t,i)||!TJ(o,u,a,l,c):r.getRange(e,n,t,i)))}function TJ(e,t,n,i,r){return r[0]<=e&&n<=r[2]&&r[3]<=t&&i<=r[5]}const ew=0,tw=4,nw=8,iw=0,rw=1,sw=2,NJ={"top-left":ew+iw,top:ew+rw,"top-right":ew+sw,left:tw+iw,middle:tw+rw,right:tw+sw,"bottom-left":nw+iw,bottom:nw+rw,"bottom-right":nw+sw},RJ={naive:EJ,"reduced-search":CJ,floodfill:kJ};function PJ(e,t,n,i,r,s,o,a,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),h=LJ(i,f),g=IJ(r,f),p=BJ(e[0].datum),m=p==="group"&&e[0].datum.items[u].marktype,y=m==="area",x=UJ(p,m,a,u),w=l===null||l===1/0,E=wJ(t[0],t[1],w?0:l),A=y&&c==="naive",S=e.map(C=>({datum:C,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:x(C)}));let O;if(!A){n&&S.sort((j,$)=>n(j.datum,$.datum));let C=!1;for(let j=0;j<g.length&&!C;++j)C=g[j]===5||h[j]<0;p&&(o||y)&&(s=[e.map(j=>j.datum)].concat(s)),O=s.length?bJ(E,s,C,y):yJ(E,o&&S)}const _=y?RJ[c](E,O,o,u,w):MJ(E,O,g,h,w);return S.forEach(C=>C.opacity=+_(C)),S}function LJ(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function IJ(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=NJ[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function BJ(e){return e&&e.mark&&e.mark.marktype}function UJ(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const ow=["x","y","opacity","align","baseline"],nT=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function aw(e){T.call(this,null,e)}aw.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:nT},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:ow.length,default:ow}]};H(aw,T,{transform(e,t){function n(s){const o=e[s];return ye(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&P("Size parameter should be specified as a [width, height] array.");const r=e.as||ow;return PJ(t.materialize(t.SOURCE).source||[],e.size,e.sort,ae(e.offset==null?1:e.offset),ae(e.anchor||nT),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});var zJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:aw});function iT(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function uw(e){T.call(this,null,e)}uw.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};H(uw,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=iT(i,e.groupby),s=(e.groupby||[]).map(st),o=s.length,a=e.as||[st(e.x),st(e.y)],u=[];r.forEach(l=>{b$(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let h=0;h<o;++h)f[s[h]]=l.dims[h];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Ne(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const lw={linear:nb,log:d$,exp:h$,pow:g$,quad:ib,poly:p$},qJ=(e,t)=>e==="poly"?t:e==="quad"?2:1;function cw(e){T.call(this,null,e)}cw.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(lw)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};H(cw,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=iT(i,e.groupby),s=(e.groupby||[]).map(st),o=e.method||"linear",a=e.order||3,u=qJ(o,a),l=e.as||[st(e.x),st(e.y)],c=lw[o],f=[];let h=e.extent;ue(lw,o)||P("Invalid regression method: "+o),h!=null&&o==="log"&&h[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach(g=>{if(g.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const m=c(g,e.x,e.y,a);if(e.params){f.push(Ne({keys:g.dims,coef:m.coef,rSquared:m.rSquared}));return}const y=h||cr(g,e.x),x=w=>{const E={};for(let A=0;A<s.length;++A)E[s[A]]=g.dims[A];E[l[0]]=w[0],E[l[1]]=w[1],f.push(Ne(E))};o==="linear"?y.forEach(w=>x([w,m.predict(w)])):Yh(m.predict,y,25,200).forEach(x)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var HJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:uw,regression:cw});const rT=Math.pow(2,-52),Gp=new Uint32Array(512);class Yp{static from(t,n=XJ,i=QJ){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new Yp(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let $=0;$<o;$++){const k=t[2*$],M=t[2*$+1];k<a&&(a=k),M<u&&(u=M),k>l&&(l=k),M>c&&(c=M),this._ids[$]=$}const f=(a+l)/2,h=(u+c)/2;let g=1/0,p,m,y;for(let $=0;$<o;$++){const k=fw(f,h,t[2*$],t[2*$+1]);k<g&&(p=$,g=k)}const x=t[2*p],w=t[2*p+1];g=1/0;for(let $=0;$<o;$++){if($===p)continue;const k=fw(x,w,t[2*$],t[2*$+1]);k<g&&k>0&&(m=$,g=k)}let E=t[2*m],A=t[2*m+1],S=1/0;for(let $=0;$<o;$++){if($===p||$===m)continue;const k=YJ(x,w,E,A,t[2*$],t[2*$+1]);k<S&&(y=$,S=k)}let O=t[2*y],_=t[2*y+1];if(S===1/0){for(let M=0;M<o;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];fl(this._ids,this._dists,0,o-1);const $=new Uint32Array(o);let k=0;for(let M=0,D=-1/0;M<o;M++){const I=this._ids[M];this._dists[I]>D&&($[k++]=I,D=this._dists[I])}this.hull=$.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Vp(x,w,E,A,O,_)){const $=m,k=E,M=A;m=y,E=O,A=_,y=$,O=k,_=M}const C=VJ(x,w,E,A,O,_);this._cx=C.x,this._cy=C.y;for(let $=0;$<o;$++)this._dists[$]=fw(t[2*$],t[2*$+1],C.x,C.y);fl(this._ids,this._dists,0,o-1),this._hullStart=p;let j=3;i[p]=n[y]=m,i[m]=n[p]=y,i[y]=n[m]=p,r[p]=0,r[m]=1,r[y]=2,s.fill(-1),s[this._hashKey(x,w)]=p,s[this._hashKey(E,A)]=m,s[this._hashKey(O,_)]=y,this.trianglesLen=0,this._addTriangle(p,m,y,-1,-1,-1);for(let $=0,k,M;$<this._ids.length;$++){const D=this._ids[$],I=t[2*D],F=t[2*D+1];if($>0&&Math.abs(I-k)<=rT&&Math.abs(F-M)<=rT||(k=I,M=F,D===p||D===m||D===y))continue;let L=0;for(let Te=0,$e=this._hashKey(I,F);Te<this._hashSize&&(L=s[($e+Te)%this._hashSize],!(L!==-1&&L!==i[L]));Te++);L=n[L];let B=L,W;for(;W=i[B],!Vp(I,F,t[2*B],t[2*B+1],t[2*W],t[2*W+1]);)if(B=W,B===L){B=-1;break}if(B===-1)continue;let X=this._addTriangle(B,D,i[B],-1,-1,r[B]);r[D]=this._legalize(X+2),r[B]=X,j++;let ce=i[B];for(;W=i[ce],Vp(I,F,t[2*ce],t[2*ce+1],t[2*W],t[2*W+1]);)X=this._addTriangle(ce,D,W,r[D],-1,r[ce]),r[D]=this._legalize(X+2),i[ce]=ce,j--,ce=W;if(B===L)for(;W=n[B],Vp(I,F,t[2*W],t[2*W+1],t[2*B],t[2*B+1]);)X=this._addTriangle(W,D,B,-1,r[B],r[W]),this._legalize(X+2),r[W]=X,i[B]=B,j--,B=W;this._hullStart=n[D]=B,i[B]=n[ce]=D,i[D]=ce,s[this._hashKey(I,F)]=D,s[this._hashKey(t[2*B],t[2*B+1])]=B}this.hull=new Uint32Array(j);for(let $=0,k=this._hullStart;$<j;$++)this.hull[$]=k,k=i[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(WJ(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(s===0)break;t=Gp[--s];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,h=n[o],g=n[t],p=n[c],m=n[f];if(GJ(r[2*h],r[2*h+1],r[2*g],r[2*g+1],r[2*p],r[2*p+1],r[2*m],r[2*m+1])){n[t]=m,n[a]=h;const x=i[f];if(x===-1){let E=this._hullStart;do{if(this._hullTri[E]===f){this._hullTri[E]=t;break}E=this._hullPrev[E]}while(E!==this._hullStart)}this._link(t,x),this._link(a,i[o]),this._link(o,f);const w=l+(a+1)%3;s<Gp.length&&(Gp[s++]=w)}else{if(s===0)break;t=Gp[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function WJ(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function fw(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function dw(e,t,n,i,r,s){const o=(i-t)*(r-e),a=(n-e)*(s-t);return Math.abs(o-a)>=33306690738754716e-32*Math.abs(o+a)?o-a:0}function Vp(e,t,n,i,r,s){return(dw(r,s,e,t,n,i)||dw(e,t,n,i,r,s)||dw(n,i,r,s,e,t))<0}function GJ(e,t,n,i,r,s,o,a){const u=e-o,l=t-a,c=n-o,f=i-a,h=r-o,g=s-a,p=u*u+l*l,m=c*c+f*f,y=h*h+g*g;return u*(f*y-m*g)-l*(c*y-m*h)+p*(c*g-f*h)<0}function YJ(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,h=.5/(o*l-a*u),g=(l*c-a*f)*h,p=(o*f-u*c)*h;return g*g+p*p}function VJ(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,h=.5/(o*l-a*u),g=e+(l*c-a*f)*h,p=t+(o*f-u*c)*h;return{x:g,y:p}}function fl(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;If(e,r,s),t[e[n]]>t[e[i]]&&If(e,n,i),t[e[s]]>t[e[i]]&&If(e,s,i),t[e[n]]>t[e[s]]&&If(e,n,s);const a=e[s],u=t[a];for(;;){do s++;while(t[e[s]]<u);do o--;while(t[e[o]]>u);if(o<s)break;If(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(fl(e,t,s,i),fl(e,t,n,o-1)):(fl(e,t,n,o-1),fl(e,t,s,i))}}function If(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function XJ(e){return e[0]}function QJ(e){return e[1]}const sT=1e-6;class Oa{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>sT||Math.abs(this._y1-s)>sT)&&(this._+="L"+r+","+s),!!i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class hw{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class KJ{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let g=0,p=0,m=i.length,y,x;g<m;g+=3,p+=2){const w=i[g]*2,E=i[g+1]*2,A=i[g+2]*2,S=t[w],O=t[w+1],_=t[E],C=t[E+1],j=t[A],$=t[A+1],k=_-S,M=C-O,D=j-S,I=$-O,F=k*k+M*M,L=D*D+I*I,B=(k*I-M*D)*2;if(!B)y=(S+j)/2-1e8*I,x=(O+$)/2+1e8*D;else if(Math.abs(B)<1e-8)y=(S+j)/2,x=(O+$)/2;else{const W=1/B;y=S+(I*F-M*L)*W,x=O+(k*L-D*F)*W}s[p]=y,s[p+1]=x}let o=n[n.length-1],a,u=o*4,l,c=t[2*o],f,h=t[2*o+1];r.fill(0);for(let g=0;g<n.length;++g)o=n[g],a=u,l=c,f=h,u=o*4,c=t[2*o],h=t[2*o+1],r[a+2]=r[u]=f-h,r[a+3]=r[u+1]=c-l}render(t){const n=t==null?t=new Oa:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const h=i[c];if(h<c)continue;const g=Math.floor(c/3)*2,p=Math.floor(h/3)*2,m=o[g],y=o[g+1],x=o[p],w=o[p+1];this._renderSegment(m,y,x,w,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(r[l]/3)*2,h=o[f],g=o[f+1],p=u*4,m=this._project(h,g,a[p+2],a[p+3]);m&&this._renderSegment(h,g,m[0],m[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Oa:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Oa:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new hw;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),u=this._regioncode(i,r);a===0&&u===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,u))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,u=r.length;a<u;a+=2)if(n[s]==r[a]&&n[s+1]==r[a+1]&&n[(s+2)%o]==r[(a+u-2)%u]&&n[(s+3)%o]==r[(a+u-1)%u]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let u=o;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,s[u]!==t)break;u=r[u]}while(u!==o&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],u=n[i-1],l,c=this._regioncode(a,u),f,h;for(let g=0;g<i;g+=2)if(s=a,o=u,a=n[g],u=n[g+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=h,h=0,r?r.push(a,u):r=[a,u];else{let p,m,y,x,w;if(l===0){if((p=this._clipSegment(s,o,a,u,l,c))===null)continue;[m,y,x,w]=p}else{if((p=this._clipSegment(a,u,s,o,c,l))===null)continue;[x,w,m,y]=p,f=h,h=this._edgecode(m,y),f&&h&&this._edge(t,f,h,r,r.length),r?r.push(m,y):r=[m,y]}f=h,h=this._edgecode(x,w),f&&h&&this._edge(t,f,h,r,r.length),r?r.push(x,w):r=[x,w]}if(r)f=h,h=this._edgecode(r[0],r[1]),f&&h&&this._edge(t,f,h,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){for(;;){if(s===0&&o===0)return[t,n,i,r];if(s&o)return null;let a,u,l=s||o;l&8?(a=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):l&4?(a=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):l&2?(u=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),s?(t=a,n=u,s=this._regioncode(t,n)):(i=a,r=u,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),u;if((u=this._project(a[0],a[1],i,r))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,h=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=h,h=this._edgecode(a[l],a[l+1]),f&&h&&(l=this._edge(t,f,h,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const a=(o+2)%r.length,u=(o+4)%r.length;(r[o]===r[a]&&r[a]===r[u]||r[o+1]===r[a+1]&&r[a+1]===r[u+1])&&(r.splice(a,2),o-=2)}return s}_project(t,n,i,r){let s=1/0,o,a,u;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(u=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(u=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,u=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,u=n+(s=o)*r)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const JJ=2*Math.PI,dl=Math.pow;function ZJ(e){return e[0]}function eZ(e){return e[1]}function tZ(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function nZ(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class gw{static from(t,n=ZJ,i=eZ,r){return new gw("length"in t?iZ(t,n,i,r):Float64Array.from(rZ(t,n,i,r)))}constructor(t){this._delaunator=new Yp(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&tZ(t)){this.collinear=Int32Array.from({length:n.length/2},(h,g)=>g).sort((h,g)=>n[2*h]-n[2*g]||n[2*h+1]-n[2*g+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,g=n.length/2;h<g;++h){const p=nZ(n[2*h],n[2*h+1],f);n[2*h]=p[0],n[2*h+1]=p[1]}this._delaunator=new Yp(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=s[u%3==2?u-2:u+1];(i[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=r.length;u<l;++u)a[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,r.length===2&&(o[r[1]]=0))}voronoi(t){return new KJ(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=dl(n-l[t*2],2)+dl(i-l[t*2+1],2);const h=r[t];let g=h;do{let p=u[g];const m=dl(n-l[p*2],2)+dl(i-l[p*2+1],2);if(m<f&&(f=m,c=p),g=g%3==2?g-2:g+1,u[g]!==t)break;if(g=a[g],g===-1){if(g=s[(o[t]+1)%s.length],g!==p&&dl(n-l[g*2],2)+dl(i-l[g*2+1],2)<f)return g;break}}while(g!==h);return c}render(t){const n=t==null?t=new Oa:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u<o)continue;const l=s[o]*2,c=s[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const i=t==null?t=new Oa:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],u=r[s+1];t.moveTo(a+n,u),t.arc(a,u,n,0,JJ)}return i&&i.value()}renderHull(t){const n=t==null?t=new Oa:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const u=2*i[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new hw;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Oa:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,u=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new hw;return this.renderTriangle(t,n),n.value()}}function iZ(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*rZ(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function pw(e){T.call(this,null,e)}pw.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const sZ=[-1e5,-1e5,1e5,1e5];H(pw,T,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:sZ;const s=this.value=gw.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const u=s.cellPolygon(o);i[o][n]=u?oZ(u):null}return t.reflow(e.modified()).modifies(n)}});function oZ(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}var aZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:pw}),mw=Math.PI/180,Bf=1<<11>>5,Xp=1<<11;function uZ(){var e=[256,256],t,n,i,r,s,o,a,u=oT,l=[],c=Math.random,f={};f.layout=function(){for(var p=h(Ru()),m=gZ((e[0]>>5)*e[1]),y=null,x=l.length,w=-1,E=[],A=l.map(O=>({text:t(O),font:n(O),style:r(O),weight:s(O),rotate:o(O),size:~~(i(O)+1e-14),padding:a(O),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:O})).sort((O,_)=>_.size-O.size);++w<x;){var S=A[w];S.x=e[0]*(c()+.5)>>1,S.y=e[1]*(c()+.5)>>1,lZ(p,S,A,w),S.hasText&&g(m,S,y)&&(E.push(S),y?fZ(y,S):y=[{x:S.x+S.x0,y:S.y+S.y0},{x:S.x+S.x1,y:S.y+S.y1}],S.x-=e[0]>>1,S.y-=e[1]>>1)}return E};function h(p){p.width=p.height=1;var m=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(Bf<<5)/m,p.height=Xp/m;var y=p.getContext("2d");return y.fillStyle=y.strokeStyle="red",y.textAlign="center",{context:y,ratio:m}}function g(p,m,y){for(var x=m.x,w=m.y,E=Math.sqrt(e[0]*e[0]+e[1]*e[1]),A=u(e),S=c()<.5?1:-1,O=-S,_,C,j;(_=A(O+=S))&&(C=~~_[0],j=~~_[1],!(Math.min(Math.abs(C),Math.abs(j))>=E));)if(m.x=x+C,m.y=w+j,!(m.x+m.x0<0||m.y+m.y0<0||m.x+m.x1>e[0]||m.y+m.y1>e[1])&&(!y||!cZ(m,p,e[0]))&&(!y||dZ(m,y))){for(var $=m.sprite,k=m.width>>5,M=e[0]>>5,D=m.x-(k<<4),I=D&127,F=32-I,L=m.y1-m.y0,B=(m.y+m.y0)*M+(D>>5),W,X=0;X<L;X++){W=0;for(var ce=0;ce<=k;ce++)p[B+ce]|=W<<F|(ce<k?(W=$[X*k+ce])>>>I:0);B+=M}return m.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Ca(p),f):n},f.fontStyle=function(p){return arguments.length?(r=Ca(p),f):r},f.fontWeight=function(p){return arguments.length?(s=Ca(p),f):s},f.rotate=function(p){return arguments.length?(o=Ca(p),f):o},f.text=function(p){return arguments.length?(t=Ca(p),f):t},f.spiral=function(p){return arguments.length?(u=pZ[p]||p,f):u},f.fontSize=function(p){return arguments.length?(i=Ca(p),f):i},f.padding=function(p){return arguments.length?(a=Ca(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function lZ(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(Bf<<5)/s,Xp/s);var o=0,a=0,u=0,l=n.length,c,f,h,g,p;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,h=t.size<<1,t.rotate){var m=Math.sin(t.rotate*mw),y=Math.cos(t.rotate*mw),x=c*y,w=c*m,E=h*y,A=h*m;c=Math.max(Math.abs(x+A),Math.abs(x-A))+31>>5<<5,h=~~Math.max(Math.abs(w+E),Math.abs(w-E))}else c=c+31>>5<<5;if(h>u&&(u=h),o+c>=Bf<<5&&(o=0,a+=u,u=0),a+h>=Xp)break;r.translate((o+(c>>1))/s,(a+(h>>1))/s),t.rotate&&r.rotate(t.rotate*mw),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=h,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=h>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var S=r.getImageData(0,0,(Bf<<5)/s,Xp/s).data,O=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,h=t.y1-t.y0,g=0;g<h*f;g++)O[g]=0;if(o=t.xoff,o==null)return;a=t.yoff;var _=0,C=-1;for(p=0;p<h;p++){for(g=0;g<c;g++){var j=f*p+(g>>5),$=S[(a+p)*(Bf<<5)+(o+g)<<2]?1<<31-g%32:0;O[j]|=$,_|=$}_?C=p:(t.y0++,h--,p--,a++)}t.y1=t.y0+C,t.sprite=O.slice(0,(t.y1-t.y0)*f)}}}function cZ(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var h=0;h<=r;h++)if((c<<a|(h<r?(c=i[f*r+h])>>>o:0))&t[l+h])return!0;l+=n}return!1}function fZ(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function dZ(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function oT(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function hZ(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function gZ(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Ca(e){return typeof e=="function"?e:function(){return e}}var pZ={archimedean:oT,rectangular:hZ};const aT=["x","y","font","fontSize","fontStyle","fontWeight","angle"],mZ=["text","font","rotate","fontSize","fontStyle","fontWeight"];function yw(e){T.call(this,uZ(),e)}yw.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:aT}]};H(yw,T,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&P("Wordcloud size dimensions must be non-zero.");function n(p){const m=e[p];return ye(m)&&t.modified(m.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||mZ.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||aT;let a=e.fontSize||14,u;if(ye(a)?u=e.fontSizeRange:a=Yt(a),u){const p=a,m=Fe("sqrt")().domain(cr(r,p)).range(u);a=y=>m(p(y))}r.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(pi).layout(),c=s.size(),f=c[0]>>1,h=c[1]>>1,g=l.length;for(let p=0,m,y;p<g;++p)m=l[p],y=m.datum,y[o[0]]=m.x+f,y[o[1]]=m.y+h,y[o[2]]=m.font,y[o[3]]=m.size,y[o[4]]=m.style,y[o[5]]=m.weight,y[o[6]]=m.rotate;return t.reflow(i).modifies(o)}});var yZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:yw});const bZ=e=>new Uint8Array(e),vZ=e=>new Uint16Array(e),Uf=e=>new Uint32Array(e);function xZ(){let e=8,t=[],n=Uf(0),i=Qp(0,e),r=Qp(0,e);return{data:()=>t,seen:()=>n=wZ(n,t.length),add(s){for(let o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove(s,o){const a=t.length,u=Array(a-s),l=t;let c,f,h;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(h=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=h,i[h]=i[f],r[h]=r[f],u[h]=c,c._index=h++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=Qp(s,e,i),r=Qp(s,e))}}}function wZ(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Qp(e,t,n){const i=(t<257?bZ:t<65537?vZ:Uf)(e);return n&&i.set(n),i}function uT(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),u=r.index,l=a[0],c=a[1],f=u.length;let h;for(h=0;h<l;++h)s[u[h]]|=i;for(h=c;h<f;++h)s[u[h]]|=i;return o}}}function lT(){let e=Uf(0),t=[],n=0;function i(a,u,l){if(!u.length)return[];const c=n,f=u.length,h=Uf(f);let g=Array(f),p,m,y;for(y=0;y<f;++y)g[y]=a(u[y]),h[y]=y;if(g=EZ(g,h),c)p=t,m=e,t=Array(c+f),e=Uf(c+f),AZ(l,p,m,c,g,h,f,t,e);else{if(l>0)for(y=0;y<f;++y)h[y]+=l;t=g,e=h}return n=c+f,{index:h,value:g}}function r(a,u){const l=n;let c,f,h;for(f=0;!u[e[f]]&&f<l;++f);for(h=f;f<l;++f)u[c=e[f]]||(e[h]=c,t[h]=t[f],++h);n=l-a}function s(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){let l;return u?l=u.length:(u=t,l=n),[ZL(u,a[0],0,l),Ah(u,a[1],0,l)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function EZ(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),nI(e,t)}function AZ(e,t,n,i,r,s,o,a,u){let l=0,c=0,f;for(f=0;l<i&&c<o;++f)t[l]<r[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=r[c],u[f]=s[c++]+e);for(;l<i;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=r[c],u[f]=s[c]+e}function bw(e){T.call(this,xZ(),e),this._indices=null,this._dims=null}bw.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};H(bw,T,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,u,l;for(;a<o;++a)u=n[a].fname,l=r[u]||(r[u]=lT()),s.push(uT(l,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,h=n.mod,g=r.length,p={};let m,y,x,w,E,A,S,O,_;if(l.set(u),t.rem.length&&(E=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(A={},w=t.mod,S=0,O=w.length;S<O;++S)A[w[S]._index]=1;for(S=0;S<g;++S)_=i[S],(!o[S]||e.modified("fields",S)||t.modified(_.fields))&&(x=_.fname,(m=p[x])||(s[x]=y=lT(),p[x]=m=y.insert(_,t.source,0)),o[S]=uT(y,S,r[S]).onAdd(m,u));for(S=0,O=a.data().length;S<O;++S)E[S]||(l[S]!==u[S]?f.push(S):A[S]&&u[S]!==c&&h.push(S));return a.mask=(1<<g)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=r.size()+i.length,f=s.length;let h=r.size(),g,p,m;r.resize(c,f),r.add(i);const y=r.curr(),x=r.prev(),w=r.all();for(g=0;g<f;++g)p=a[g].fname,m=u[p]||(u[p]=o[p].insert(a[g],i,h)),s[g].onAdd(m,y);for(;h<c;++h)x[h]=w,y[h]!==w&&l.push(h)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,r[l]!==s&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),u={},l=n.rem,c=t.rem;let f,h,g,p;for(f=0,h=c.length;f<h;++f)g=c[f]._index,u[g]=1,o[g]=p=s[g],s[g]=a,p!==a&&l.push(g);for(g in i)i[g].remove(h,u);return this.reindex(t,h,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)!e.modified("query",l)||(a|=i[l].one,this.incrementAll(i[l],r[l],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],h=c[1],g=l[0],p=l[1],m=e.one;let y,x,w;if(f<g)for(y=f,x=Math.min(g,h);y<x;++y)w=u[y],s[w]!==n&&(a[w]=o[w],s[w]=n,i.push(w)),o[w]^=m;else if(f>g)for(y=g,x=Math.min(f,p);y<x;++y)w=u[y],s[w]!==n&&(a[w]=o[w],s[w]=n,i.push(w)),o[w]^=m;if(h>p)for(y=Math.max(f,p),x=h;y<x;++y)w=u[y],s[w]!==n&&(a[w]=o[w],s[w]=n,i.push(w)),o[w]^=m;else if(h<p)for(y=Math.max(g,h),x=p;y<x;++y)w=u[y],s[w]!==n&&(a[w]=o[w],s[w]=n,i.push(w)),o[w]^=m;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],h=a[1],g=e.one;let p,m,y;if(l<f)for(p=l,m=Math.min(f,c);p<m;++p)y=o[p],s[y]^=g,n.push(y);else if(l>f)for(p=f,m=Math.min(l,h);p<m;++p)y=o[p],s[y]^=g,i.push(y);if(c>h)for(p=Math.max(l,h),m=c;p<m;++p)y=o[p],s[y]^=g,n.push(y);else if(c<h)for(p=Math.max(f,c),m=h;p<m;++p)y=o[p],s[y]^=g,i.push(y);e.range=t.slice()}});function vw(e){T.call(this,null,e)}vw.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};H(vw,T,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)==0)return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),u=i.prev(),l=c=>a[c]&n?null:o[c];return s.filter(s.MOD,l),r&r-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});var _Z=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:bw,resolvefilter:vw});const SZ="RawCode",$a="Literal",OZ="Property",CZ="Identifier",$Z="ArrayExpression",jZ="BinaryExpression",cT="CallExpression",kZ="ConditionalExpression",FZ="LogicalExpression",DZ="MemberExpression",MZ="ObjectExpression",TZ="UnaryExpression";function Vi(e){this.type=e}Vi.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=NZ(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function NZ(e){switch(e.type){case $Z:return e.elements;case jZ:case FZ:return[e.left,e.right];case cT:return[e.callee].concat(e.arguments);case kZ:return[e.test,e.consequent,e.alternate];case DZ:return[e.object,e.property];case MZ:return e.properties;case OZ:return[e.key,e.value];case TZ:return[e.argument];case CZ:case $a:case SZ:default:return[]}}var $r,Q,N,en,Le,Kp=1,zf=2,ja=3,xo=4,Jp=5,ka=6,Bn=7,qf=8,RZ=9;$r={};$r[Kp]="Boolean";$r[zf]="<end>";$r[ja]="Identifier";$r[xo]="Keyword";$r[Jp]="Null";$r[ka]="Numeric";$r[Bn]="Punctuator";$r[qf]="String";$r[RZ]="RegularExpression";var PZ="ArrayExpression",LZ="BinaryExpression",IZ="CallExpression",BZ="ConditionalExpression",fT="Identifier",UZ="Literal",zZ="LogicalExpression",qZ="MemberExpression",HZ="ObjectExpression",WZ="Property",GZ="UnaryExpression",Ft="Unexpected token %0",YZ="Unexpected number",VZ="Unexpected string",XZ="Unexpected identifier",QZ="Unexpected reserved word",KZ="Unexpected end of input",xw="Invalid regular expression",ww="Invalid regular expression: missing /",dT="Octal literals are not allowed in strict mode.",JZ="Duplicate data property in object literal not allowed in strict mode",Ut="ILLEGAL",Hf="Disabled.",ZZ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),eee=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Zp(e,t){if(!e)throw new Error("ASSERT: "+t)}function gs(e){return e>=48&&e<=57}function Ew(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Wf(e){return"01234567".indexOf(e)>=0}function tee(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Gf(e){return e===10||e===13||e===8232||e===8233}function Yf(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&ZZ.test(String.fromCharCode(e))}function em(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&eee.test(String.fromCharCode(e))}const nee={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function hT(){for(;N<en;){const e=Q.charCodeAt(N);if(tee(e)||Gf(e))++N;else break}}function Aw(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)N<en&&Ew(Q[N])?(i=Q[N++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):De({},Ft,Ut);return String.fromCharCode(r)}function iee(){var e,t,n,i;for(e=Q[N],t=0,e==="}"&&De({},Ft,Ut);N<en&&(e=Q[N++],!!Ew(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&De({},Ft,Ut),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function gT(){var e,t;for(e=Q.charCodeAt(N++),t=String.fromCharCode(e),e===92&&(Q.charCodeAt(N)!==117&&De({},Ft,Ut),++N,e=Aw("u"),(!e||e==="\\"||!Yf(e.charCodeAt(0)))&&De({},Ft,Ut),t=e);N<en&&(e=Q.charCodeAt(N),!!em(e));)++N,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),Q.charCodeAt(N)!==117&&De({},Ft,Ut),++N,e=Aw("u"),(!e||e==="\\"||!em(e.charCodeAt(0)))&&De({},Ft,Ut),t+=e);return t}function ree(){var e,t;for(e=N++;N<en;){if(t=Q.charCodeAt(N),t===92)return N=e,gT();if(em(t))++N;else break}return Q.slice(e,N)}function see(){var e,t,n;return e=N,t=Q.charCodeAt(N)===92?gT():ree(),t.length===1?n=ja:nee.hasOwnProperty(t)?n=xo:t==="null"?n=Jp:t==="true"||t==="false"?n=Kp:n=ja,{type:n,value:t,start:e,end:N}}function _w(){var e=N,t=Q.charCodeAt(N),n,i=Q[N],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++N,{type:Bn,value:String.fromCharCode(t),start:e,end:N};default:if(n=Q.charCodeAt(N+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return N+=2,{type:Bn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:N};case 33:case 61:return N+=2,Q.charCodeAt(N)===61&&++N,{type:Bn,value:Q.slice(e,N),start:e,end:N}}}if(o=Q.substr(N,4),o===">>>=")return N+=4,{type:Bn,value:o,start:e,end:N};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return N+=3,{type:Bn,value:s,start:e,end:N};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return N+=2,{type:Bn,value:r,start:e,end:N};if(r==="//"&&De({},Ft,Ut),"<>=!+-*%&|^/".indexOf(i)>=0)return++N,{type:Bn,value:i,start:e,end:N};De({},Ft,Ut)}function oee(e){let t="";for(;N<en&&Ew(Q[N]);)t+=Q[N++];return t.length===0&&De({},Ft,Ut),Yf(Q.charCodeAt(N))&&De({},Ft,Ut),{type:ka,value:parseInt("0x"+t,16),start:e,end:N}}function aee(e){let t="0"+Q[N++];for(;N<en&&Wf(Q[N]);)t+=Q[N++];return(Yf(Q.charCodeAt(N))||gs(Q.charCodeAt(N)))&&De({},Ft,Ut),{type:ka,value:parseInt(t,8),octal:!0,start:e,end:N}}function pT(){var e,t,n;if(n=Q[N],Zp(gs(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=N,e="",n!=="."){if(e=Q[N++],n=Q[N],e==="0"){if(n==="x"||n==="X")return++N,oee(t);if(Wf(n))return aee(t);n&&gs(n.charCodeAt(0))&&De({},Ft,Ut)}for(;gs(Q.charCodeAt(N));)e+=Q[N++];n=Q[N]}if(n==="."){for(e+=Q[N++];gs(Q.charCodeAt(N));)e+=Q[N++];n=Q[N]}if(n==="e"||n==="E")if(e+=Q[N++],n=Q[N],(n==="+"||n==="-")&&(e+=Q[N++]),gs(Q.charCodeAt(N)))for(;gs(Q.charCodeAt(N));)e+=Q[N++];else De({},Ft,Ut);return Yf(Q.charCodeAt(N))&&De({},Ft,Ut),{type:ka,value:parseFloat(e),start:t,end:N}}function uee(){var e="",t,n,i,r,s=!1;for(t=Q[N],Zp(t==="'"||t==='"',"String literal must starts with a quote"),n=N,++N;N<en;)if(i=Q[N++],i===t){t="";break}else if(i==="\\")if(i=Q[N++],!i||!Gf(i.charCodeAt(0)))switch(i){case"u":case"x":Q[N]==="{"?(++N,e+=iee()):e+=Aw(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Wf(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),N<en&&Wf(Q[N])&&(s=!0,r=r*8+"01234567".indexOf(Q[N++]),"0123".indexOf(i)>=0&&N<en&&Wf(Q[N])&&(r=r*8+"01234567".indexOf(Q[N++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&Q[N]===`
`&&++N;else{if(Gf(i.charCodeAt(0)))break;e+=i}return t!==""&&De({},Ft,Ut),{type:qf,value:e,octal:s,start:n,end:N}}function lee(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";De({},xw)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{De({},xw)}try{return new RegExp(e,t)}catch{return null}}function cee(){var e,t,n,i,r;for(e=Q[N],Zp(e==="/","Regular expression literal must start with a slash"),t=Q[N++],n=!1,i=!1;N<en;)if(e=Q[N++],t+=e,e==="\\")e=Q[N++],Gf(e.charCodeAt(0))&&De({},ww),t+=e;else if(Gf(e.charCodeAt(0)))De({},ww);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||De({},ww),r=t.substr(1,t.length-2),{value:r,literal:t}}function fee(){var e,t,n;for(t="",n="";N<en&&(e=Q[N],!!em(e.charCodeAt(0)));)++N,e==="\\"&&N<en?De({},Ft,Ut):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&De({},xw,n),{value:n,literal:t}}function dee(){var e,t,n,i;return Le=null,hT(),e=N,t=cee(),n=fee(),i=lee(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:N}}function hee(e){return e.type===ja||e.type===xo||e.type===Kp||e.type===Jp}function mT(){if(hT(),N>=en)return{type:zf,start:N,end:N};const e=Q.charCodeAt(N);return Yf(e)?see():e===40||e===41||e===59?_w():e===39||e===34?uee():e===46?gs(Q.charCodeAt(N+1))?pT():_w():gs(e)?pT():_w()}function Un(){const e=Le;return N=e.end,Le=mT(),N=e.end,e}function yT(){const e=N;Le=mT(),N=e}function gee(e){const t=new Vi(PZ);return t.elements=e,t}function bT(e,t,n){const i=new Vi(e==="||"||e==="&&"?zZ:LZ);return i.operator=e,i.left=t,i.right=n,i}function pee(e,t){const n=new Vi(IZ);return n.callee=e,n.arguments=t,n}function mee(e,t,n){const i=new Vi(BZ);return i.test=e,i.consequent=t,i.alternate=n,i}function Sw(e){const t=new Vi(fT);return t.name=e,t}function Vf(e){const t=new Vi(UZ);return t.value=e.value,t.raw=Q.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function vT(e,t,n){const i=new Vi(qZ);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function yee(e){const t=new Vi(HZ);return t.properties=e,t}function xT(e,t,n){const i=new Vi(WZ);return i.key=t,i.value=n,i.kind=e,i}function bee(e,t){const n=new Vi(GZ);return n.operator=e,n.argument=t,n.prefix=!0,n}function De(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(Zp(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=N,n.description=r,n}function tm(e){e.type===zf&&De(e,KZ),e.type===ka&&De(e,YZ),e.type===qf&&De(e,VZ),e.type===ja&&De(e,XZ),e.type===xo&&De(e,QZ),De(e,Ft,e.value)}function tn(e){const t=Un();(t.type!==Bn||t.value!==e)&&tm(t)}function Qe(e){return Le.type===Bn&&Le.value===e}function Ow(e){return Le.type===xo&&Le.value===e}function vee(){const e=[];for(N=Le.start,tn("[");!Qe("]");)Qe(",")?(Un(),e.push(null)):(e.push(Fa()),Qe("]")||tn(","));return Un(),gee(e)}function wT(){N=Le.start;const e=Un();return e.type===qf||e.type===ka?(e.octal&&De(e,dT),Vf(e)):Sw(e.value)}function xee(){var e,t,n,i;if(N=Le.start,e=Le,e.type===ja)return n=wT(),tn(":"),i=Fa(),xT("init",n,i);if(e.type===zf||e.type===Bn)tm(e);else return t=wT(),tn(":"),i=Fa(),xT("init",t,i)}function wee(){var e=[],t,n,i,r={},s=String;for(N=Le.start,tn("{");!Qe("}");)t=xee(),t.key.type===fT?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?De({},JZ):r[i]=!0,e.push(t),Qe("}")||tn(",");return tn("}"),yee(e)}function Eee(){tn("(");const e=Cw();return tn(")"),e}const Aee={if:1};function _ee(){var e,t,n;if(Qe("("))return Eee();if(Qe("["))return vee();if(Qe("{"))return wee();if(e=Le.type,N=Le.start,e===ja||Aee[Le.value])n=Sw(Un().value);else if(e===qf||e===ka)Le.octal&&De(Le,dT),n=Vf(Un());else{if(e===xo)throw new Error(Hf);e===Kp?(t=Un(),t.value=t.value==="true",n=Vf(t)):e===Jp?(t=Un(),t.value=null,n=Vf(t)):Qe("/")||Qe("/=")?(n=Vf(dee()),yT()):tm(Un())}return n}function See(){const e=[];if(tn("("),!Qe(")"))for(;N<en&&(e.push(Fa()),!Qe(")"));)tn(",");return tn(")"),e}function Oee(){N=Le.start;const e=Un();return hee(e)||tm(e),Sw(e.value)}function Cee(){return tn("."),Oee()}function $ee(){tn("[");const e=Cw();return tn("]"),e}function jee(){var e,t,n;for(e=_ee();;)if(Qe("."))n=Cee(),e=vT(".",e,n);else if(Qe("("))t=See(),e=pee(e,t);else if(Qe("["))n=$ee(),e=vT("[",e,n);else break;return e}function ET(){const e=jee();if(Le.type===Bn&&(Qe("++")||Qe("--")))throw new Error(Hf);return e}function nm(){var e,t;if(Le.type!==Bn&&Le.type!==xo)t=ET();else{if(Qe("++")||Qe("--"))throw new Error(Hf);if(Qe("+")||Qe("-")||Qe("~")||Qe("!"))e=Un(),t=nm(),t=bee(e.value,t);else{if(Ow("delete")||Ow("void")||Ow("typeof"))throw new Error(Hf);t=ET()}}return t}function AT(e){let t=0;if(e.type!==Bn&&e.type!==xo)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function kee(){var e,t,n,i,r,s,o,a,u,l;if(e=Le,u=nm(),i=Le,r=AT(i),r===0)return u;for(i.prec=r,Un(),t=[e,Le],o=nm(),s=[u,i,o];(r=AT(Le))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=bT(a,u,o),s.push(n);i=Un(),i.prec=r,s.push(i),t.push(Le),n=nm(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=bT(s[l-1].value,s[l-2],n),l-=2;return n}function Fa(){var e,t,n;return e=kee(),Qe("?")&&(Un(),t=Fa(),tn(":"),n=Fa(),e=mee(e,t,n)),e}function Cw(){const e=Fa();if(Qe(","))throw new Error(Hf);return e}function _T(e){Q=e,N=0,en=Q.length,Le=null,yT();const t=Cw();if(Le.type!==zf)throw new Error("Unexpect token after expression.");return t}var ST={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function OT(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&P("Missing arguments to clamp function."),o.length>3&&P("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&P("Missing arguments to if function."),o.length>3&&P("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Fee(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function CT(e){e=e||{};const t=e.allowed?Pi(e.allowed):{},n=e.forbidden?Pi(e.forbidden):{},i=e.constants||ST,r=(e.functions||OT)(f),s=e.globalvar,o=e.fieldvar,a=ye(s)?s:p=>`${s}["${p}"]`;let u={},l={},c=0;function f(p){if(Oe(p))return p;const m=h[p.type];return m==null&&P("Unsupported type: "+p.type),m(p)}const h={Literal:p=>p.raw,Identifier:p=>{const m=p.name;return c>0?m:ue(n,m)?P("Illegal identifier: "+m):ue(i,m)?i[m]:ue(t,m)?m:(u[m]=1,a(m))},MemberExpression:p=>{const m=!p.computed,y=f(p.object);m&&(c+=1);const x=f(p.property);return y===o&&(l[Fee(x)]=1),m&&(c-=1),y+(m?"."+x:"["+x+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&P("Illegal callee type: "+p.callee.type);const m=p.callee.name,y=p.arguments,x=ue(r,m)&&r[m];return x||P("Unrecognized function: "+m),ye(x)?x(y):x+"("+y.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const m=f(p.key);return c-=1,m+":"+f(p.value)}};function g(p){const m={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},m}return g.functions=r,g.constants=i,g}function Dee(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Mee(e){let t=e,n=e;e.length===1&&(t=(o,a)=>e(o)-a,n=Tee(e));function i(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)<0?u=c+1:l=c}return u}function r(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)>0?l=c:u=c+1}return u}function s(o,a,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=i(o,a,u,l-1);return c>u&&t(o[c-1],a)>-t(o[c],a)?c-1:c}return{left:i,center:s,right:r}}function Tee(e){return(t,n)=>Dee(e(t),n)}const $w="intersect",$T="union",Nee="vlMulti",Ree="vlPoint",jT="or",Pee="and",Lee="_vgsid_",Iee="E",Bee="R",Uee="R-E",zee="R-LE",qee="R-RE",im="index:unit";function kT(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],a.getter=Dn.getter||Dn(a.field),o=a.getter(e),Ps(o)&&(o=Gt(o)),Ps(i[s])&&(i[s]=Gt(i[s])),Ps(i[s][0])&&(i[s]=i[s].map(Gt)),a.type===Iee){if(Z(i[s])?i[s].indexOf(o)<0:o!==i[s])return!1}else if(a.type===Bee){if(!Eu(o,i[s]))return!1}else if(a.type===qee){if(!Eu(o,i[s],!0,!1))return!1}else if(a.type===Uee){if(!Eu(o,i[s],!1,!1))return!1}else if(a.type===zee&&!Eu(o,i[s],!1,!0))return!1;return!0}function Hee(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[im]&&i[im].value:void 0,o=n===$w,a=r.length,u=0,l,c,f,h,g;u<a;++u)if(l=r[u],s&&o){if(c=c||{},f=c[h=l.unit]||0,f===-1)continue;if(g=kT(t,l),c[h]=g?-1:++f,g&&s.size===1)return!0;if(!g&&f===s.get(h).count)return!1}else if(g=kT(t,l),o^g)return g;return a&&o}const jw=Dn(Lee),FT=Mee(jw),Wee=FT.left,Gee=FT.right;function Yee(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[im]&&i[im].value:void 0,o=n===$w,a=jw(t),u=Wee(r,a);if(u===r.length||jw(r[u])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(Gee(r,a)-u<s.size)return!1}return!0}function Vee(e,t){return e.map(n=>pe({values:t.fields.map(i=>(i.getter||(i.getter=Dn(i.field)))(n.datum))},t))}function Xee(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},u={},l,c,f,h,g,p,m,y,x,w=s.length,E=0,A,S;E<w;++E){for(l=s[E],h=l.unit,c=l.fields,f=l.values,A=0,S=c.length;A<S;++A)g=c[A],p=o[g.field]||(o[g.field]={}),m=p[h]||(p[h]=[]),u[g.field]=y=g.type.charAt(0),x=DT[y+"_union"],p[h]=x(m,ae(f[A]));n&&(m=a[h]||(a[h]=[]),m.push(ae(f).reduce((O,_,C)=>(O[c[C].field]=_,O),{})))}if(t=t||$T,Object.keys(o).forEach(O=>{o[O]=Object.keys(o[O]).map(_=>o[O][_]).reduce((_,C)=>_===void 0?C:DT[u[O]+"_"+t](_,C))}),s=Object.keys(a),n&&s.length){const O=i?Ree:Nee;o[O]=t===$T?{[jT]:s.reduce((_,C)=>(_.push(...a[C]),_),[])}:{[Pee]:s.map(_=>({[jT]:a[_]}))}}return o}var DT={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Gt(t[0]),i=Gt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Gt(t[0]),i=Gt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const Qee=":",Kee="@";function kw(e,t,n,i){t[0].type!==$a&&P("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&Ee(t).value,o="unit",a=Kee+o,u=Qee+r;s===$w&&!ue(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),ue(i,u)||(i[u]=n.getData(r).tuplesRef())}function MT(e){const t=this.context.data[e];return t?t.values.value:[]}function Jee(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Zee(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(di).insert(t)),1}function ete(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const Xf=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},tte=Xf("format"),TT=Xf("timeFormat"),nte=Xf("utcFormat"),ite=Xf("timeParse"),rte=Xf("utcParse"),rm=new Date(2e3,0,1);function sm(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(rm.setYear(2e3),rm.setMonth(e),rm.setDate(t),TT.call(this,rm,n))}function ste(e){return sm.call(this,e,1,"%B")}function ote(e){return sm.call(this,e,1,"%b")}function ate(e){return sm.call(this,0,2+e,"%A")}function ute(e){return sm.call(this,0,2+e,"%a")}const lte=":",cte="@",Fw="%",NT="$";function Dw(e,t,n,i){t[0].type!==$a&&P("First argument to data functions must be a string literal.");const r=t[0].value,s=lte+r;if(!ue(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function fte(e,t,n,i){t[0].type!==$a&&P("First argument to indata must be a string literal."),t[1].type!==$a&&P("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=cte+s;ue(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function zn(e,t,n,i){if(t[0].type===$a)RT(n,i,t[0].value);else for(e in n.scales)RT(n,i,e)}function RT(e,t,n){const i=Fw+n;if(!ue(t,i))try{t[i]=e.scaleRef(n)}catch{}}function ps(e,t){let n;return ye(e)?e:Oe(e)?(n=t.scales[e])&&n.value:void 0}function dte(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=zn,n._range=zn,n._scale=zn;const i=r=>"_["+(r.type===$a?ie(Fw+r.value):ie(Fw)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function Mw(e,t){return function(n,i,r){if(n){const s=ps(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const hte=Mw("area",NV),gte=Mw("bounds",IV),pte=Mw("centroid",WV);function mte(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function Tw(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function yte(){return Tw(this.context.dataflow,"warn",arguments)}function bte(){return Tw(this.context.dataflow,"info",arguments)}function vte(){return Tw(this.context.dataflow,"debug",arguments)}function Nw(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Rw(e){const t=Zs(e),n=Nw(t.r),i=Nw(t.g),r=Nw(t.b);return .2126*n+.7152*i+.0722*r}function xte(e,t){const n=Rw(e),i=Rw(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function wte(){const e=[].slice.call(arguments);return e.unshift({}),pe(...e)}function PT(e,t){return e===t||e!==e&&t!==t?!0:Z(e)?Z(t)&&e.length===t.length?Ete(e,t):!1:fe(e)&&fe(t)?LT(e,t):!1}function Ete(e,t){for(let n=0,i=e.length;n<i;++n)if(!PT(e[n],t[n]))return!1;return!0}function LT(e,t){for(const n in e)if(!PT(e[n],t[n]))return!1;return!0}function IT(e){return t=>LT(e,t)}function Ate(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],u=a.input,l=o.stamp();let c=a.changes,f,h;if(o._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(a.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{a.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?di:Z(n)||Rh(n)?n:IT(n),c.remove(f)),t&&c.insert(t),i&&(f=IT(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(h in s)c.modify(r,h,s[h]);return 1}function _te(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function Ste(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const BT={};function Ote(e,t){const n=BT[t]||(BT[t]=Dn(t));return Z(e)?e.map(n):n(e)}function Pw(e){return Z(e)||ArrayBuffer.isView(e)?e:null}function Lw(e){return Pw(e)||(Oe(e)?e:null)}function Cte(e,...t){return Pw(e).join(...t)}function $te(e,...t){return Lw(e).indexOf(...t)}function jte(e,...t){return Lw(e).lastIndexOf(...t)}function kte(e,...t){return Lw(e).slice(...t)}function Fte(e,t,n){return ye(n)&&P("Function argument passed to replace."),String(e).replace(t,n)}function Dte(e){return Pw(e).slice().reverse()}function Mte(e,t,n){return mv(e||0,t||0,n||0)}function Tte(e,t){const n=ps(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Nte(e,t){const n=ps(e,(t||this).context);return n?n.copy():void 0}function Rte(e,t){const n=ps(e,(t||this).context);return n?n.domain():[]}function Pte(e,t,n){const i=ps(e,(n||this).context);return i?Z(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function Lte(e,t){const n=ps(e,(t||this).context);return n&&n.range?n.range():[]}function Ite(e,t,n){const i=ps(e,(n||this).context);return i?i(t):void 0}function Bte(e,t,n,i,r){e=ps(e,(r||this).context);const s=Yk(t,n);let o=e.domain(),a=o[0],u=Ee(o),l=hn;return u-a?l=Dk(e,a,u):e=(e.interpolator?Fe("sequential")().interpolator(e.interpolator()):Fe("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),u!==Ee(o)&&o.push(u)),o.forEach(c=>s.stop(l(c),e(c))),s}function Ute(e,t,n){const i=ps(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function zte(e){let t=null;return function(n){return n?Kc(n,t=t||Wu(e)):e}}const UT=e=>e.data;function zT(e,t){const n=MT.call(t,e);return n.root&&n.root.lookup||{}}function qte(e,t,n){const i=zT(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(UT):void 0}function Hte(e,t){const n=zT(e,this)[t];return n?n.ancestors().map(UT):void 0}const qT=()=>typeof window!="undefined"&&window||null;function Wte(){const e=qT();return e?e.screen:{}}function Gte(){const e=qT();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Yte(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Vte(e,t,n){if(!e)return[];const[i,r]=e,s=new wt().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return aD(o,s,Xte(t))}function Xte(e){let t=null;if(e){const n=ae(e.marktype),i=ae(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}const Qf={random(){return pi()},cumulativeNormal:Hh,cumulativeLogNormal:Qy,cumulativeUniform:eb,densityNormal:Wy,densityLogNormal:Xy,densityUniform:Zy,quantileNormal:Wh,quantileLogNormal:Ky,quantileUniform:tb,sampleNormal:qh,sampleLogNormal:Vy,sampleUniform:Jy,isArray:Z,isBoolean:q1,isDate:Ps,isDefined(e){return e!==void 0},isNumber:Ls,isObject:fe,isRegExp:fO,isString:Oe,isTuple:Rh,isValid(e){return e!=null&&e===e},toBoolean:W1,toDate:G1,toNumber:Gt,toString:Y1,indexof:$te,join:Cte,lastindexof:jte,replace:Fte,reverse:Dte,slice:kte,flush:lO,lerp:dO,merge:wte,pad:pO,peek:Ee,pluck:Ote,span:fc,inrange:Eu,truncate:mO,rgb:Zs,lab:og,hcl:ag,hsl:rg,luminance:Rw,contrast:xte,sequence:Zn,format:tte,utcFormat:nte,utcParse:rte,utcOffset:nC,utcSequence:sC,timeFormat:TT,timeParse:ite,timeOffset:tC,timeSequence:rC,timeUnitSpecifier:HO,monthFormat:ste,monthAbbrevFormat:ote,dayFormat:ate,dayAbbrevFormat:ute,quarter:sO,utcquarter:oO,week:GO,utcweek:XO,dayofyear:WO,utcdayofyear:VO,warn:yte,info:bte,debug:vte,extent:cr,inScope:mte,intersect:Vte,clampRange:aO,pinchDistance:_te,pinchAngle:Ste,screen:Wte,containerSize:Yte,windowSize:Gte,bandspace:Mte,setdata:Zee,pathShape:zte,panLinear:tO,panLog:nO,panPow:iO,panSymlog:rO,zoomLinear:L1,zoomLog:I1,zoomPow:xh,zoomSymlog:B1,encode:ete,modify:Ate},Qte=["view","item","group","xy","x","y"],Kte="event.vega.",HT="this.",Iw={},WT={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ie(NT+e)}]`,functions:Jte,constants:ST,visitors:Iw},Bw=CT(WT);function Jte(e){const t=OT(e);Qte.forEach(n=>t[n]=Kte+n);for(const n in Qf)t[n]=HT+n;return pe(t,dte(e,Qf,Iw)),t}function gt(e,t,n){return arguments.length===1?Qf[e]:(Qf[e]=t,n&&(Iw[e]=n),Bw&&(Bw.functions[e]=HT+e),this)}gt("bandwidth",Tte,zn);gt("copy",Nte,zn);gt("domain",Rte,zn);gt("range",Lte,zn);gt("invert",Pte,zn);gt("scale",Ite,zn);gt("gradient",Bte,zn);gt("geoArea",hte,zn);gt("geoBounds",gte,zn);gt("geoCentroid",pte,zn);gt("geoShape",Ute,zn);gt("indata",Jee,fte);gt("data",MT,Dw);gt("treePath",qte,Dw);gt("treeAncestors",Hte,Dw);gt("vlSelectionTest",Hee,kw);gt("vlSelectionIdTest",Yee,kw);gt("vlSelectionResolve",Xee,kw);gt("vlSelectionTuples",Vee);function jr(e,t){const n={};let i;try{e=Oe(e)?e:ie(e)+"",i=_T(e)}catch{P("Expression parse error: "+e)}i.visit(s=>{if(s.type!==cT)return;const o=s.callee.name,a=WT.visitors[o];a&&a(o,s.arguments,t,n)});const r=Bw(i);return r.globals.forEach(s=>{const o=NT+s;!ue(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:pe({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function Zte(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const ene=Pi(["rule"]),GT=Pi(["group","image","rect"]);function tne(e,t){let n="";return ene[t]||(e.x2&&(e.x?(GT[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(GT[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Uw(e){return(e+"").toLowerCase()}function nne(e){return Uw(e)==="operator"}function ine(e){return Uw(e)==="collect"}function Kf(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function rne(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var sne={operator:(e,t)=>Kf(e,["_"],t.code),parameter:(e,t)=>Kf(e,["datum","_"],t.code),event:(e,t)=>Kf(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Kf(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+ie(s)+"]";r+="$=".concat(i[s].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return r+=tne(i,n),r+="return m;",Kf(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(ie).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let u,l;return s.path?(u="a".concat(s.path),l="b".concat(s.path)):((n=n||{})["f"+o]=s,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),rne(u,l,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function one(e){const t=this;nne(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function ane(e){const t=this;if(e.params){const n=t.get(e.id);n||P("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function une(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Z(r)?r.map(s=>YT(s,n,t)):YT(r,n,t)}return t}function YT(e,t,n){if(!e||!fe(e))return e;for(let i=0,r=VT.length,s;i<r;++i)if(s=VT[i],ue(e,s.key))return s.parse(e,t,n);return e}var VT=[{key:"$ref",parse:lne},{key:"$key",parse:fne},{key:"$expr",parse:cne},{key:"$field",parse:dne},{key:"$encode",parse:gne},{key:"$compare",parse:hne},{key:"$context",parse:pne},{key:"$subflow",parse:mne},{key:"$tupleid",parse:yne}];function lne(e,t){return t.get(e.$ref)||P("Operator not defined: "+e.$ref)}function cne(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=Fn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function fne(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=H1(e.$key,e.$flat,t.expr.codegen))}function dne(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Dn(e.$field,e.$name,t.expr.codegen))}function hne(e,t){const n="c:"+e.$compare+"_"+e.$order,i=ae(e.$compare).map(r=>r&&r.$tupleid?ee:r);return t.fn[n]||(t.fn[n]=U1(i,e.$order,t.expr.codegen))}function gne(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=Fn(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function pne(e,t){return t}function mne(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a.detachSubflow=()=>t.detach(o),a}}function yne(){return ee}function bne(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&P("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function vne(e){var t=this,n=fe(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||P("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const xne={skip:!0};function wne(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function Ene(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],xne)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(di).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function XT(e,t,n,i){return new QT(e,t,n,i)}function QT(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||sne,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function KT(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}QT.prototype=KT.prototype={fork(){const e=new KT(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),ine(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Uw(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Zte,parseOperator:one,parseOperatorParameters:ane,parseParameters:une,parseStream:bne,parseUpdate:vne,getState:wne,setState:Ene};function Ane(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),JT(t,e.description()))}function JT(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function _ne(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const zw="default";function Sne(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:zw,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,s=r?Oe(r)?r:r.user:zw,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return Oe(i)||(r=i.item,i=i.user),qw(e,i&&i!==zw?i:r||i),r},{cursor:t})}function qw(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function om(e,t){var n=e._runtime.data;return ue(n,t)||P("Unrecognized data set: "+t),n[t]}function One(e,t){return arguments.length<2?om(this,e).values.value:am.call(this,e,oa().remove(di).insert(t))}function am(e,t){YC(t)||P("Second argument to changes must be a changeset.");const n=om(this,e);return n.modified=!0,this.pulse(n.input,t)}function Cne(e,t){return am.call(this,e,oa().insert(t))}function $ne(e,t){return am.call(this,e,oa().remove(t))}function ZT(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function e5(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function um(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function jne(e){var t=um(e),n=ZT(e),i=e5(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function kne(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=um(e),o=t.changedTouches?t.changedTouches[0]:t,s=Ig(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=Fne(e,n,s),t}function Fne(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;Oe(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Yt(e),item:Yt(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const t5="view",Dne="timer",Mne="window",Tne={trap:!1};function Nne(e){const t=pe({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{Z(i[s])&&(i[s]=Pi(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function n5(e,t,n,i){e._eventListeners.push({type:n,sources:ae(t),handler:i})}function Rne(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function lm(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||fe(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Pne(e,t,n){var i=this,r=new Bh(n),s=function(l,c){i.runAsync(null,()=>{e===t5&&Rne(i,t)&&l.preventDefault(),r.receive(kne(i,l,c))})},o;if(e===Dne)lm(i,"timer",t)&&i.timer(s,t);else if(e===t5)lm(i,"view",t)&&i.addEventListener(t,s,Tne);else if(e===Mne?lm(i,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&lm(i,"selector",t)&&(o=document.querySelectorAll(e)),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);n5(i,o,t,s)}return r}function i5(e){return e.item}function r5(e){return e.item.mark.source}function s5(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Lne(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",i5),r5,s5(e)),this.on(this.events("view","mouseout",i5),r5,s5(t)),this}function Ine(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,s;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(s=n[i],r=s.sources.length;--r>=0;)s.sources[r].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function si(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const Bne="vega-bind",Une="vega-bind-name",zne="vega-bind-radio";function qne(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=z1(i.debounce,r.update))),(i.input==null&&i.element?Hne:Gne)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function Hne(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),n5(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(Wne(r))}}function Wne(e){return typeof Event!="undefined"?new Event(e):{type:e}}function Gne(e,t,n,i){const r=i.signal(n.signal),s=si("div",{class:Bne}),o=n.input==="radio"?s:s.appendChild(si("label"));o.appendChild(si("span",{class:Une},n.name||n.signal)),t.appendChild(s);let a=Yne;switch(n.input){case"checkbox":a=Vne;break;case"select":a=Xne;break;case"radio":a=Qne;break;case"range":a=Kne;break}a(e,o,n,r)}function Yne(e,t,n,i){const r=si("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function Vne(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=si("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function Xne(e,t,n,i){const r=si("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const u={value:o};cm(o,i)&&(u.selected=!0),r.appendChild(si("option",u,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,u=n.options.length;a<u;++a)if(cm(n.options[a],o)){r.selectedIndex=a;return}}}function Qne(e,t,n,i){const r=si("span",{class:zne}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const u={type:"radio",name:n.signal,value:o};cm(o,i)&&(u.checked=!0);const l=si("input",u);l.addEventListener("change",()=>e.update(o));const c=si("label",{},(s[a]||o)+"");return c.prepend(l),r.appendChild(c),l}),e.set=o=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)cm(a[l].value,o)&&(a[l].checked=!0)}}function Kne(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Bs(s,r,100),a=si("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const u=si("span",{},+i);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function cm(e,t){return e===t||e+""==t+""}function o5(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,ZT(e),e5(e),um(e),r,s).background(e.background())}function Hw(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Jne(e,t,n,i){const r=new i(e.loader(),Hw(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,um(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function Zne(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=Vg(i);e=n._el=e?Ww(n,e,!0):null,Ane(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||df,a=e?s.renderer:s.headless;return n._renderer=a?o5(n,n._renderer,e,a):null,n._handler=Jne(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=Ww(n,t,!0):e.appendChild(si("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=Ww(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{qne(n,u.element||t,u)})),n}function Ww(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(i){t=null,e.error(i)}return t}const Jf=e=>+e||0,eie=e=>({top:e,bottom:e,left:e,right:e});function a5(e){return fe(e)?{top:Jf(e.top),bottom:Jf(e.bottom),left:Jf(e.left),right:Jf(e.right)}:eie(Jf(e))}async function Gw(e,t,n,i){const r=Vg(t),s=r&&r.headless;return s||P("Unrecognized renderer type: "+t),await e.runAsync(),o5(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function tie(e,t){e!==fo.Canvas&&e!==fo.SVG&&e!==fo.PNG&&P("Unrecognized image type: "+e);const n=await Gw(this,e,t);return e===fo.SVG?nie(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function nie(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function iie(e,t){return(await Gw(this,fo.Canvas,e,t)).canvas()}async function rie(e){return(await Gw(this,fo.SVG,e)).svg()}function sie(e,t,n){return XT(e,Du,Qf,n).parse(t)}function oie(e){var t=this._runtime.scales;return ue(t,e)||P("Unrecognized scale or projection: "+e),t[e].value}var u5="width",l5="height",Yw="padding",c5={skip:!0};function f5(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Yw?i.left+i.right:0)}function d5(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Yw?i.top+i.bottom:0)}function aie(e){var t=e._signals,n=t[u5],i=t[l5],r=t[Yw];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=f5(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=d5(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function uie(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(u5,n,c5),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(l5,i,c5),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(u=>u.resize())},!1,1)}function lie(e){return this._runtime.getState(e||{data:cie,signals:fie,recurse:!0})}function cie(e,t){return t.modified&&Z(t.input.value)&&e.indexOf("_:vega:_")}function fie(e,t){return!(e==="parent"||t instanceof Du.proxy)}function die(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function hie(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(GQ(n,t))}function gie(e,t,n,i){const r=e.element();r&&r.setAttribute("title",pie(i))}function pie(e){return e==null?"":Z(e)?h5(e):fe(e)&&!Ps(e)?mie(e):e+""}function mie(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Z(n)?h5(n):g5(n))}).join(`
`)}function h5(e){return"["+e.map(g5).join(", ")+"]"}function g5(e){return Z(e)?"[\u2026]":fe(e)&&!Ps(e)?"{\u2026}":e}function p5(e,t){const n=this;if(t=t||{},Fu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=pe({},e.locale,t.locale);n.locale(NC(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||fo.Canvas,n._scenegraph=new ox;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||gie,n._redraw=!0,n._handler=new df().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Nne(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=sie(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:pe({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=f5(n,n._width),n._viewHeight=d5(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,aie(n),_ne(n),Sne(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function fm(e,t){return ue(e._signals,t)?e._signals[t]:P("Unrecognized signal name: "+ie(t))}function m5(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function y5(e,t,n,i){let r=m5(n,i);return r||(r=Hw(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function b5(e,t,n){const i=m5(t,n);return i&&t._targets.remove(i),e}H(p5,Fu,{async evaluate(e,t,n){if(await Fu.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,jne(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Nh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&JT(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=fm(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",a5(e)):a5(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Vg(e)||P("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Fu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(fm(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:uie,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=Hw(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return y5(this,e,fm(this,e),t)},removeSignalListener(e,t){return b5(this,fm(this,e),t)},addDataListener(e,t){return y5(this,e,om(this,e).values,t)},removeDataListener(e,t){return b5(this,om(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=qw(this,null);this._globalCursor=!!e,t&&qw(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:hie,events:Pne,finalize:Ine,hover:Lne,data:One,change:am,insert:Cne,remove:$ne,scale:oie,initialize:Zne,toImageURL:tie,toCanvas:iie,toSVG:rie,getState:lie,setState:die});const yie="view",dm="[",hm="]",v5="{",x5="}",bie=":",w5=",",vie="@",xie=">",wie=/[[\]{}]/,Eie={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let E5,A5;function _5(e,t,n){return E5=t||yie,A5=n||Eie,S5(e.trim()).map(Vw)}function Aie(e){return A5[e]}function Zf(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function S5(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Zf(e,r,w5,dm+v5,hm+x5),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function Vw(e){return e[0]==="["?_ie(e):Sie(e)}function _ie(e){const t=e.length;let n=1,i;if(n=Zf(e,n,hm,dm,hm),n===t)throw"Empty between selector: "+e;if(i=S5(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==xie)throw"Expected '>' after between selector: "+e;i=i.map(Vw);const r=Vw(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function Sie(e){const t={source:E5},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===x5){if(a=e.lastIndexOf(v5),a>=0){try{i=Oie(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===vie&&(r=++a),u=Zf(e,a,bie),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=Zf(e,a,dm),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Zf(e,a,hm),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==dm)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||wie.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):Aie(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Oie(e){const t=e.split(w5);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function Cie(e){return fe(e)?e:{type:e||"pad"}}const ed=e=>+e||0,$ie=e=>({top:e,bottom:e,left:e,right:e});function jie(e){return fe(e)?e.signal?e:{top:ed(e.top),bottom:ed(e.bottom),left:ed(e.left),right:ed(e.right)}:$ie(ed(e))}const Dt=e=>fe(e)&&!Z(e)?pe({},e):{value:e};function O5(e,t,n,i){return n!=null?(fe(n)&&!Z(n)||Z(n)&&n.length&&fe(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function zt(e,t,n){for(const i in t)O5(e,i,t[i]);for(const i in n)O5(e,i,n[i],"update")}function hl(e,t,n){for(const i in t)n&&ue(n,i)||(e[i]=pe(e[i]||{},t[i]));return e}function gl(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const Xw="mark",Qw="frame",Kw="scope",kie="axis",Fie="axis-domain",Die="axis-grid",Mie="axis-label",Tie="axis-tick",Nie="axis-title",Rie="legend",Pie="legend-band",Lie="legend-entry",Iie="legend-gradient",C5="legend-label",Bie="legend-symbol",Uie="legend-title",zie="title",qie="title-text",Hie="title-subtitle";function Wie(e,t,n,i,r){const s={},o={};let a,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!gl(u,e)&&Jw(s,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===Qw?r.group:n===Xw?pe({},r.mark,r[t]):null;for(u in c)l=gl(u,e)||(u==="fill"||u==="stroke")&&(gl("fill",e)||gl("stroke",e)),l||Jw(s,u,c[u]);ae(i).forEach(f=>{const h=r.style&&r.style[f];for(const g in h)gl(g,e)||Jw(s,g,h[g])}),e=pe({},e);for(u in s)c=s[u],c.signal?(a=a||{})[u]=c:o[u]=c;return e.enter=pe(o,e.enter),a&&(e.update=pe(a,e.update)),e}function Jw(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const $5=e=>Oe(e)?ie(e):e.signal?`(${e.signal})`:j5(e);function gm(e){if(e.gradient!=null)return Yie(e);let t=e.signal?`(${e.signal})`:e.color?Gie(e.color):e.field!=null?j5(e.field):e.value!==void 0?ie(e.value):void 0;return e.scale!=null&&(t=Vie(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${mm(e.exponent)})`),e.mult!=null&&(t+=`*${mm(e.mult)}`),e.offset!=null&&(t+=`+${mm(e.offset)}`),e.round&&(t=`round(${t})`),t}const pm=(e,t,n,i)=>`(${e}(${[t,n,i].map(gm).join(",")})+'')`;function Gie(e){return e.c?pm("hcl",e.h,e.c,e.l):e.h||e.s?pm("hsl",e.h,e.s,e.l):e.l||e.a?pm("lab",e.l,e.a,e.b):e.r||e.g||e.b?pm("rgb",e.r,e.g,e.b):null}function Yie(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ie(n));for(;t.length&&Ee(t)==null;)t.pop();return t.unshift($5(e.gradient)),`gradient(${t.join(",")})`}function mm(e){return fe(e)?"("+gm(e)+")":e}function j5(e){return k5(fe(e)?e:{datum:e})}function k5(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):P("Invalid field reference: "+ie(e));return e.signal||(i=Oe(i)?ph(i).map(ie).join("]["):k5(i)),t+"["+i+"]"}function Vie(e,t){const n=$5(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+mm(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Xie(e){let t="";return e.forEach(n=>{const i=gm(n);t+=n.test?`(${n.test})?${i}:`:i}),Ee(t)===":"&&(t+="null"),t}function F5(e,t,n,i,r,s){const o={};s=s||{},s.encoders={$encode:o},e=Wie(e,t,n,i,r.config);for(const a in e)o[a]=Qie(e[a],t,s,r);return s}function Qie(e,t,n,i){const r={},s={};for(const o in e)e[o]!=null&&(r[o]=Jie(Kie(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function Kie(e){return Z(e)?Xie(e):gm(e)}function Jie(e,t,n,i){const r=jr(e,t);return r.$fields.forEach(s=>i[s]=1),pe(n,r.$params),r.$expr}const Zie="outer",ere=["value","update","init","react","bind"];function D5(e,t){P(e+' for "outer" push: '+ie(t))}function M5(e,t){const n=e.name;if(e.push===Zie)t.signals[n]||D5("No prior signal definition",n),ere.forEach(i=>{e[i]!==void 0&&D5("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Zw(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function ym(e,t,n,i){return new Zw(e,t,n,i)}function bm(e,t){return ym("operator",e,t)}function ne(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function td(e,t){return t?{$field:e,$name:t}:{$field:e}}const eE=td("key");function T5(e,t){return{$compare:e,$order:t}}function tre(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const nre="ascending",ire="descending";function rre(e){return fe(e)?(e.order===ire?"-":"+")+vm(e.op,e.field):""}function vm(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const tE="scope",nE="view";function At(e){return e&&e.signal}function sre(e){return e&&e.expr}function xm(e){if(At(e))return!0;if(fe(e)){for(const t in e)if(xm(e[t]))return!0}return!1}function Xi(e,t){return e!=null?e:t}function Da(e){return e&&e.signal||e}const N5="timer";function nd(e,t){return(e.merge?are:e.stream?ure:e.type?lre:P("Invalid stream specification: "+ie(e)))(e,t)}function ore(e){return e===tE?nE:e||nE}function are(e,t){const n=e.merge.map(r=>nd(r,t)),i=iE({merge:n},e,t);return t.addStream(i).id}function ure(e,t){const n=nd(e.stream,t),i=iE({stream:n},e,t);return t.addStream(i).id}function lre(e,t){let n;e.type===N5?(n=t.event(N5,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(ore(e.source),e.type);const i=iE({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function iE(e,t,n){let i=t.between;return i&&(i.length!==2&&P('Stream "between" parameter must have 2 entries: '+ie(t)),e.between=[nd(i[0],n),nd(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(cre(t.marktype,t.markname,t.markrole)),t.source===tE&&i.push("inScope(event.item)"),i.length&&(e.filter=jr("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function cre(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const fre={code:"_.$value",ast:{type:"Identifier",value:"value"}};function dre(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||P("Signal update missing events specification."),Oe(s)&&(s=_5(s,t.isSubscope()?tE:nE)),s=ae(s).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[gre(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),i!=null&&(o&&P("Signal encode and update are mutually exclusive."),o="encode(item(),"+ie(i)+")"),r.update=Oe(o)?jr(o,t):o.expr!=null?jr(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:fre,$params:{$value:t.signalRef(o.signal)}}:P("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(u=>t.addUpdate(pe(hre(u,t),r)))}function hre(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):nd(e,t)}}function gre(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function pre(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?P("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=jr(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>dre(r,t,n.id))}const Be=e=>(t,n,i)=>ym(e,n,t||void 0,i),R5=Be("aggregate"),mre=Be("axisticks"),P5=Be("bound"),Qi=Be("collect"),L5=Be("compare"),yre=Be("datajoin"),I5=Be("encode"),bre=Be("expression"),vre=Be("facet"),xre=Be("field"),wre=Be("key"),Ere=Be("legendentries"),Are=Be("load"),_re=Be("mark"),Sre=Be("multiextent"),Ore=Be("multivalues"),Cre=Be("overlap"),$re=Be("params"),B5=Be("prefacet"),jre=Be("projection"),kre=Be("proxy"),Fre=Be("relay"),U5=Be("render"),Dre=Be("scale"),Ma=Be("sieve"),Mre=Be("sortitems"),z5=Be("viewlayout"),Tre=Be("values");let Nre=0;const q5={min:"min",max:"max",count:"sum"};function Rre(e,t){const n=e.type||"linear";Ok(n)||P("Unrecognized scale type: "+ie(n)),t.addScale(e.name,{type:n,domain:void 0})}function Pre(e,t){const n=t.getScale(e.name).params;let i;n.domain=H5(e.domain,e,t),e.range!=null&&(n.range=G5(e,t,n)),e.interpolate!=null&&Yre(e.interpolate,n),e.nice!=null&&(n.nice=Gre(e.nice)),e.bins!=null&&(n.bins=Wre(e.bins,t));for(i in e)ue(n,i)||i==="name"||(n[i]=xi(e[i],t))}function xi(e,t){return fe(e)?e.signal?t.signalRef(e.signal):P("Unsupported object: "+ie(e)):e}function wm(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>xi(n,t))}function Em(e){P("Can not find data set: "+ie(e))}function H5(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&P("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Z(e)?Lre:e.fields?Bre:Ire)(e,t,n)}function Lre(e,t,n){return e.map(i=>xi(i,n))}function Ire(e,t,n){const i=n.getData(e.data);return i||Em(e.data),Hu(t.type)?i.valuesRef(n,e.field,W5(e.sort,!1)):jk(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function Bre(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=Oe(o)?{data:i,field:o}:Z(o)||o.signal?Ure(o,n):o,s.push(o),s),[]);return(Hu(t.type)?zre:jk(t.type)?qre:Hre)(e,n,r)}function Ure(e,t){const n="_:vega:_"+Nre++,i=Qi({});if(Z(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+ie(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Ma({})]),{data:n,field:"data"}}function zre(e,t,n){const i=W5(e.sort,!0);let r,s;const o=n.map(l=>{const c=t.getData(l.data);return c||Em(l.data),c.countsRef(t,l.field,i)}),a={groupby:eE,pulse:o};i&&(r=i.op||"count",s=i.field?vm(r,i.field):"count",a.ops=[q5[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(R5(a));const u=t.add(Qi({pulse:ne(r)}));return s=t.add(Tre({field:eE,sort:t.sortRef(i),pulse:ne(u)})),ne(s)}function W5(e,t){return e&&(!e.field&&!e.op?fe(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?P("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!q5[e.op]&&P("Multiple domain scales can not be sorted using "+e.op)),e}function qre(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||Em(r.data),s.domainRef(t,r.field)});return ne(t.add(Ore({values:i})))}function Hre(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||Em(r.data),s.extentRef(t,r.field)});return ne(t.add(Sre({extents:i})))}function Wre(e,t){return e.signal||Z(e)?wm(e,t):t.objectProperty(e)}function Gre(e){return fe(e)?{interval:xi(e.interval),step:xi(e.step)}:xi(e)}function Yre(e,t){t.interpolate=xi(e.type||e),e.gamma!=null&&(t.interpolateGamma=xi(e.gamma))}function G5(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(Oe(r)){if(i&&ue(i,r))return e=pe({},e,{range:i[r]}),G5(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Hu(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:P("Unrecognized scale range value: "+ie(r))}else if(r.scheme){n.scheme=Z(r.scheme)?wm(r.scheme,t):xi(r.scheme,t),r.extent&&(n.schemeExtent=wm(r.extent,t)),r.count&&(n.schemeCount=xi(r.count,t));return}else if(r.step){n.rangeStep=xi(r.step,t);return}else{if(Hu(e.type)&&!Z(r))return H5(r,e,t);Z(r)||P("Unsupported range type: "+ie(r))}return r.map(s=>(Z(s)?wm:xi)(s,t))}function Vre(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=rE(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=rE(n[r],r,t));t.addProjection(e.name,i)}function rE(e,t,n){return Z(e)?e.map(i=>rE(i,t,n)):fe(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:P("Unsupported parameter object: "+ie(e)):e}const Ki="top",pl="left",ml="right",wo="bottom",Y5="center",Xre="vertical",Qre="start",Kre="middle",Jre="end",sE="index",oE="label",Zre="offset",yl="perc",ese="perc2",wi="value",id="guide-label",aE="guide-title",tse="group-title",nse="group-subtitle",V5="symbol",Am="gradient",uE="discrete",lE="size",ise="shape",rse="fill",sse="stroke",ose="strokeWidth",ase="strokeDash",use="opacity",cE=[lE,ise,rse,sse,ose,ase,use],rd={name:1,style:1,interactive:1},Se={value:0},Ei={value:1},_m="group",X5="rect",fE="rule",lse="symbol",Ta="text";function sd(e){return e.type=_m,e.interactive=e.interactive||!1,e}function qn(e,t){const n=(i,r)=>Xi(e[i],Xi(t[i],r));return n.isVertical=i=>Xre===Xi(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Xi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Xi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Xi(e.columns,Xi(t.columns,+n.isVertical(!0))),n}function Q5(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function cse(e,t,n){const i=t.config.style[n];return i&&i[e]}function Sm(e,t,n){return`item.anchor === '${Qre}' ? ${e} : item.anchor === '${Jre}' ? ${t} : ${n}`}const dE=Sm(ie(pl),ie(ml),ie(Y5));function fse(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},fe(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function K5(e,t){return t?e?fe(e)?Object.assign({},e,{offset:K5(e.offset,t)}):{value:e,offset:t}:t:e}function oi(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=hl(e.encode,t,rd)):e.interactive=!1,e}function dse(e,t,n,i){const r=qn(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let u,l,c,f,h;s?(l=[0,1],c=[0,0],f=o,h=a):(l=[0,0],c=[1,0],f=a,h=o);const g={enter:u={opacity:Se,x:Se,y:Se,width:Dt(f),height:Dt(h)},update:pe({},u,{opacity:Ei,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Se}};return zt(g,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),oi({type:X5,role:Iie,encode:g},i)}function hse(e,t,n,i,r){const s=qn(e,n),o=s.isVertical(),a=s.gradientThickness(),u=s.gradientLength();let l,c,f,h,g="";o?(l="y",f="y2",c="x",h="width",g="1-"):(l="x",f="x2",c="y",h="height");const p={opacity:Se,fill:{scale:t,field:wi}};p[l]={signal:g+"datum."+yl,mult:u},p[c]=Se,p[f]={signal:g+"datum."+ese,mult:u},p[h]=Dt(a);const m={enter:p,update:pe({},p,{opacity:Ei}),exit:{opacity:Se}};return zt(m,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),oi({type:X5,role:Pie,key:wi,from:r,encode:m},i)}const gse=`datum.${yl}<=0?"${pl}":datum.${yl}>=1?"${ml}":"${Y5}"`,pse=`datum.${yl}<=0?"${wo}":datum.${yl}>=1?"${Ki}":"${Kre}"`;function J5(e,t,n,i){const r=qn(e,t),s=r.isVertical(),o=Dt(r.gradientThickness()),a=r.gradientLength();let u=r("labelOverlap"),l,c,f,h,g="";const p={enter:l={opacity:Se},update:c={opacity:Ei,text:{field:oE}},exit:{opacity:Se}};return zt(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:Xi(e.labelLimit,t.gradientLabelLimit)}),s?(l.align={value:"left"},l.baseline=c.baseline={signal:pse},f="y",h="x",g="1-"):(l.align=c.align={signal:gse},l.baseline={value:"top"},f="x",h="y"),l[f]=c[f]={signal:g+"datum."+yl,mult:a},l[h]=c[h]=o,o.offset=Xi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+sE}:void 0,oi({type:Ta,role:C5,style:id,key:wi,from:i,encode:p,overlap:u},n)}function mse(e,t,n,i,r){const s=qn(e,t),o=n.entries,a=!!(o&&o.interactive),u=o?o.name:void 0,l=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},h=`(${r}) ? datum.${Zre} : datum.${lE}`,g=l?Dt(l):{field:lE},p=`datum.${sE}`,m=`max(1, ${r})`;let y,x,w,E,A;g.mult=.5,y={enter:x={opacity:Se,x:{signal:h,mult:.5,offset:c},y:g},update:w={opacity:Ei,x:x.x,y:x.y},exit:{opacity:Se}};let S=null,O=null;e.fill||(S=t.symbolBaseFillColor,O=t.symbolBaseStrokeColor),zt(y,{fill:s("symbolFillColor",S),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",O),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),cE.forEach($=>{e[$]&&(w[$]=x[$]={scale:e[$],field:wi})});const _=oi({type:lse,role:Bie,key:wi,from:f,clip:l?!0:void 0,encode:y},n.symbols),C=Dt(c);C.offset=s("labelOffset"),y={enter:x={opacity:Se,x:{signal:h,offset:C},y:g},update:w={opacity:Ei,text:{field:oE},x:x.x,y:x.y},exit:{opacity:Se}},zt(y,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const j=oi({type:Ta,role:C5,style:id,key:wi,from:f,encode:y},n.labels);return y={enter:{noBound:{value:!l},width:Se,height:l?Dt(l):Se,opacity:Se},exit:{opacity:Se},update:w={opacity:Ei,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(E=`ceil(item.mark.items.length / ${m})`,w.row.signal=`${p}%${E}`,w.column.signal=`floor(${p} / ${E})`,A={field:["row",p]}):(w.row.signal=`floor(${p} / ${m})`,w.column.signal=`${p} % ${m}`,A={field:p}),w.column.signal=`(${r})?${w.column.signal}:${p}`,i={facet:{data:i,name:"value",groupby:sE}},sd({role:Kw,from:i,encode:hl(y,o,rd),marks:[_,j],name:u,interactive:a,sort:A})}function yse(e,t){const n=qn(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const hE='item.orient === "left"',gE='item.orient === "right"',Om=`(${hE} || ${gE})`,bse=`datum.vgrad && ${Om}`,vse=Sm('"top"','"bottom"','"middle"'),xse=Sm('"right"','"left"','"center"'),wse=`datum.vgrad && ${gE} ? (${xse}) : (${Om} && !(datum.vgrad && ${hE})) ? "left" : ${dE}`,Ese=`item._anchor || (${Om} ? "middle" : "start")`,Ase=`${bse} ? (${hE} ? -90 : 90) : 0`,_se=`${Om} ? (datum.vgrad ? (${gE} ? "bottom" : "top") : ${vse}) : "top"`;function Sse(e,t,n,i){const r=qn(e,t),s={enter:{opacity:Se},update:{opacity:Ei,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Se}};return zt(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:Ese},angle:{signal:Ase},align:{signal:wse},baseline:{signal:_se},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),oi({type:Ta,role:Uie,style:aE,from:i,encode:s},n)}function Ose(e,t){let n;return fe(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Z5(e.path)+")":e.sphere&&(n="geoShape("+Z5(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Z5(e){return fe(e)&&e.signal?e.signal:ie(e)}function eN(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===_m?Kw:t||Xw}function Cse(e){return{marktype:e.type,name:e.name||void 0,role:e.role||eN(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function $se(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function pE(e,t){const n=n$(e.type);n||P("Unrecognized transform type: "+ie(e.type));const i=ym(n.type.toLowerCase(),null,tN(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function tN(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=jse(o,t,n)}return i}function jse(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return kse(e,t,n);if(r===void 0){e.required&&P("Missing required "+ie(t.type)+" parameter: "+ie(e.name));return}else{if(i==="param")return Fse(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!At(r)?r.map(s=>nN(e,s,n)):nN(e,r,n)}function nN(e,t,n){const i=e.type;if(At(t))return rN(i)?P("Expression references can not be signals."):mE(i)?n.fieldRef(t):sN(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||mE(i);return r&&Dse(t)?n.exprRef(t.expr,t.as):r&&Mse(t)?td(t.field,t.as):rN(i)?jr(t,n):Tse(i)?ne(n.getData(t).values):mE(i)?td(t):sN(i)?n.compareRef(t):t}}function kse(e,t,n){return Oe(t.from)||P('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Fse(e,t,n){const i=t[e.name];return e.array?(Z(i)||P("Expected an array of sub-parameters. Instead: "+ie(i)),i.map(r=>iN(e,r,n))):iN(e,i,n)}function iN(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||P("Unsupported parameter: "+ie(t));const s=pe(tN(r,t,n),r.key);return ne(n.add($re(s)))}const Dse=e=>e&&e.expr,Mse=e=>e&&e.field,Tse=e=>e==="data",rN=e=>e==="expr",mE=e=>e==="field",sN=e=>e==="compare";function Nse(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||P("Only group marks can be faceted."),i.field!=null?o=a=Cm(i,n):(e.data?a=ne(n.getData(e.data).aggregate):(s=pE(pe({type:"aggregate",groupby:ae(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=Cm(i,n),o=a=ne(n.add(s))),r=n.keyRef(i.groupby,!0))):o=ne(n.add(Qi(null,[{}]))),o||(o=Cm(e,n)),{key:r,pulse:o,parent:a}}function Cm(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ne(t.getData(e.data).output)}function Na(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}Na.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ne(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new Na(e,s,r,i,o)};function oN(e){return Oe(e)?e:null}function aN(e,t,n){const i=vm(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function od(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),u=rre(s);let l=oN(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const h=s?{field:eE,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:ne(t.output)};u&&(h.sort=e.sortRef(s)),f=e.add(ym(i,void 0,h)),o&&(t.index[r]=f),c=ne(f),l!=null&&(a[l]=c)}return c}Na.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=oN(t);let o,a,u;return s!=null&&(e=i.scope,o=r[s]),o?n&&n.field&&aN(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ne(i.output)},n&&n.field&&aN(e,u,n),a=e.add(R5(u)),o=e.add(Qi({pulse:ne(a)})),o={agg:a,ref:ne(o)},s!=null&&(r[s]=o)),o.ref},tuplesRef(){return ne(this.values)},extentRef(e,t){return od(e,this,"extent","extent",t,!1)},domainRef(e,t){return od(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return od(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return od(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return od(e,this,"indata","tupleindex",t,!0,!0)}};function Rse(e,t,n){const i=e.from.facet,r=i.name,s=Cm(i,t);let o;i.name||P("Facet must have a name: "+ie(i)),i.data||P("Facet must reference a data set: "+ie(i)),i.field?o=t.add(B5({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(vre({key:t.keyRef(i.groupby),group:ne(t.proxy(n.parent)),pulse:s})):P("Facet must specify groupby or field: "+ie(i));const a=t.fork(),u=a.add(Qi()),l=a.add(Ma({pulse:ne(u)}));a.addData(r,new Na(a,u,u,l)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function Pse(e,t,n){const i=t.add(B5({pulse:n.pulse})),r=t.fork();r.add(Ma()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function uN(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,u=t.add(bm()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(f=>f==null?"null":f).join(",")+"),0)",c=jr(l,t);u.update=c.$expr,u.params=c.$params}function $m(e,t){const n=eN(e),i=e.type===_m,r=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===Kw||n===Qw,a,u,l,c,f,h,g;const p=n===Xw||o||r,m=Nse(e.from,i,t);u=t.add(yre({key:m.key||(e.key?td(e.key):void 0),pulse:m.pulse,clean:!i}));const y=ne(u);u=l=t.add(Qi({pulse:y})),u=t.add(_re({markdef:Cse(e),interactive:$se(e.interactive,t),clip:Ose(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ne(u)}));const x=ne(u);u=c=t.add(I5(F5(e.encode,e.type,n,e.style,t,{mod:!1,pulse:x}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(O=>{const _=pE(O,t),C=_.metadata;(C.generates||C.changes)&&P("Mark transforms should not generate new data."),C.nomod||(c.params.mod=!0),_.params.pulse=ne(u),t.add(u=_)}),e.sort&&(u=t.add(Mre({sort:t.compareRef(e.sort),pulse:ne(u)})));const w=ne(u);(r||o)&&(o=t.add(z5({layout:t.objectProperty(e.layout),legends:t.legends,mark:x,pulse:w})),h=ne(o));const E=t.add(P5({mark:x,pulse:h||w}));g=ne(E),i&&(p&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(w,h||g,y),r?Rse(e,t,m):p?Pse(e,t,m):t.parse(e),t.popState(),p&&(o&&a.push(o),a.push(E))),s&&(g=Lse(s,g,t));const A=t.add(U5({pulse:g})),S=t.add(Ma({pulse:ne(A)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Na(t,l,A,S)),e.on&&e.on.forEach(O=>{(O.insert||O.remove||O.toggle)&&P("Marks only support modify triggers."),uN(O,t,f)}))}function Lse(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:At(s)?n.signalRef(s.signal):s,method:At(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=At(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return ne(n.add(Cre(o)))}function Ise(e,t){const n=t.config.legend,i=e.encode||{},r=qn(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,u=s.style,l={};let c=0,f,h,g;cE.forEach(E=>e[E]?(l[E]=e[E],c=c||e[E]):0),c||P("Missing valid scale for legend.");const p=Bse(e,t.scaleType(c)),m={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&r.isVertical()},y=ne(t.add(Qi(null,[m]))),x={enter:{x:{value:0},y:{value:0}}},w=ne(t.add(Ere(h={type:p,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===Am?(g=[dse(e,c,n,i.gradient),J5(e,n,i.labels,w)],h.count=h.count||t.signalRef(`max(2,2*floor((${Da(r.gradientLength())})/100))`)):p===uE?g=[hse(e,c,n,i.gradient,w),J5(e,n,i.labels,w)]:(f=yse(e,n),g=[mse(e,n,i,w,Da(f.columns))],h.size=qse(e,t,g[0].marks)),g=[sd({role:Lie,from:y,encode:x,marks:g,layout:f,interactive:a})],m.title&&g.push(Sse(e,n,i.title,y)),$m(sd({role:Rie,from:y,encode:hl(zse(r,e,n),s,rd),marks:g,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:u}),t)}function Bse(e,t){let n=e.type||V5;return!e.type&&Use(e)===1&&(e.fill||e.stroke)&&(n=Ev(t)?Am:Av(t)?uE:V5),n!==Am?n:Av(t)?uE:Am}function Use(e){return cE.reduce((t,n)=>t+(e[n]?1:0),0)}function zse(e,t,n){const i={enter:{},update:{}};return zt(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function qse(e,t,n){const i=Da(lN("size",e,n)),r=Da(lN("strokeWidth",e,n)),s=Da(Hse(n[1].encode,t,id));return jr(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function lN(e,t,n){return t[e]?`scale("${t[e]}",datum)`:Q5(e,n[0].encode)}function Hse(e,t,n){return Q5("fontSize",e)||cse("fontSize",t,n)}const Wse=`item.orient==="${pl}"?-90:item.orient==="${ml}"?90:0`;function Gse(e,t){e=Oe(e)?{text:e}:e;const n=qn(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,u=[],l={},c=ne(t.add(Qi(null,[l])));return u.push(Xse(e,n,Yse(e),c)),e.subtitle&&u.push(Qse(e,n,i.subtitle,c)),$m(sd({role:zie,from:c,encode:Vse(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function Yse(e){const t=e.encode;return t&&t.title||pe({name:e.name,interactive:e.interactive,style:e.style},t)}function Vse(e,t){const n={enter:{},update:{}};return zt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:dE},angle:{signal:Wse},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),hl(n,t,rd)}function Xse(e,t,n,i){const r={value:0},s=e.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return zt(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),oi({type:Ta,role:qie,style:tse,from:i,encode:o},n)}function Qse(e,t,n,i){const r={value:0},s=e.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return zt(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),oi({type:Ta,role:Hie,style:nse,from:i,encode:o},n)}function Kse(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(pE(i,t))}),e.on&&e.on.forEach(i=>{uN(i,t,e.name)}),t.addDataPipeline(e.name,Jse(e,t,n))}function Jse(e,t,n){const i=[];let r=null,s=!1,o=!1,a,u,l,c,f;for(e.values?At(e.values)||xm(e.format)?(i.push(cN(t,e)),i.push(r=Ra())):i.push(r=Ra({$ingest:e.values,$format:e.format})):e.url?xm(e.url)||xm(e.format)?(i.push(cN(t,e)),i.push(r=Ra())):i.push(r=Ra({$request:e.url,$format:e.format})):e.source&&(r=a=ae(e.source).map(h=>ne(t.getData(h).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=Ra()),i.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?r=c:f.changes&&(r=null);return a&&(l=a.length-1,i[0]=Fre({derive:s,pulse:l?a:a[0]}),(s||l)&&i.splice(1,0,Ra())),r||i.push(Ra()),i.push(Ma({})),i}function Ra(e){const t=Qi({},e);return t.metadata={source:!0},t}function cN(e,t){return Are({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const fN=e=>e===wo||e===Ki,jm=(e,t,n)=>At(e)?noe(e.signal,t,n):e===pl||e===Ki?t:n,Mt=(e,t,n)=>At(e)?eoe(e.signal,t,n):fN(e)?t:n,Ji=(e,t,n)=>At(e)?toe(e.signal,t,n):fN(e)?n:t,dN=(e,t,n)=>At(e)?ioe(e.signal,t,n):e===Ki?{value:t}:{value:n},Zse=(e,t,n)=>At(e)?roe(e.signal,t,n):e===ml?{value:t}:{value:n},eoe=(e,t,n)=>hN(`${e} === '${Ki}' || ${e} === '${wo}'`,t,n),toe=(e,t,n)=>hN(`${e} !== '${Ki}' && ${e} !== '${wo}'`,t,n),noe=(e,t,n)=>yE(`${e} === '${pl}' || ${e} === '${Ki}'`,t,n),ioe=(e,t,n)=>yE(`${e} === '${Ki}'`,t,n),roe=(e,t,n)=>yE(`${e} === '${ml}'`,t,n),hN=(e,t,n)=>(t=t!=null?Dt(t):t,n=n!=null?Dt(n):n,gN(t)&&gN(n)?(t=t?t.signal||ie(t.value):null,n=n?n.signal||ie(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[pe({test:e},t)].concat(n||[])),gN=e=>e==null||Object.keys(e).length===1,yE=(e,t,n)=>({signal:`${e} ? (${bl(t)}) : (${bl(n)})`}),soe=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${pl}' ? (${bl(i)}) : `:"")+(n!=null?`${e} === '${wo}' ? (${bl(n)}) : `:"")+(r!=null?`${e} === '${ml}' ? (${bl(r)}) : `:"")+(t!=null?`${e} === '${Ki}' ? (${bl(t)}) : `:"")+"(null)"}),bl=e=>At(e)?e.signal:e==null?null:ie(e),ooe=(e,t)=>t===0?0:At(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},vl=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function xl(e,t,n,i){let r;if(t&&ue(t,e))return t[e];if(ue(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[aE][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[id][r]}return null}function pN(e){const t={};for(const n of e)if(!!n)for(const i in n)t[i]=1;return Object.keys(t)}function aoe(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,u,l;if(At(o)){const f=pN([n.axisX,n.axisY]),h=pN([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=Mt(o,xl(l,n.axisX,r,i),xl(l,n.axisY,r,i));u={};for(l of h)u[l]=soe(o.signal,xl(l,n.axisTop,r,i),xl(l,n.axisBottom,r,i),xl(l,n.axisLeft,r,i),xl(l,n.axisRight,r,i))}else a=o===Ki||o===wo?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||u||s?pe({},r,a,u,s):r}function uoe(e,t,n,i){const r=qn(e,t),s=e.orient;let o,a;const u={enter:o={opacity:Se},update:a={opacity:Ei},exit:{opacity:Se}};zt(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=mN(e,0),c=mN(e,1);return o.x=a.x=Mt(s,l,Se),o.x2=a.x2=Mt(s,c),o.y=a.y=Ji(s,l,Se),o.y2=a.y2=Ji(s,c),oi({type:fE,role:Fie,from:i,encode:u},n)}function mN(e,t){return{scale:e.scale,range:t}}function loe(e,t,n,i,r){const s=qn(e,t),o=e.orient,a=e.gridScale,u=jm(o,1,-1),l=coe(e.offset,u);let c,f,h;const g={enter:c={opacity:Se},update:h={opacity:Ei},exit:f={opacity:Se}};zt(g,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:wi,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},m=Mt(o,{signal:"height"},{signal:"width"}),y=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},x=a?{scale:a,range:1,mult:u,offset:l}:pe(m,{mult:u,offset:l});return c.x=h.x=Mt(o,p,y),c.y=h.y=Ji(o,p,y),c.x2=h.x2=Ji(o,x),c.y2=h.y2=Mt(o,x),f.x=Mt(o,p),f.y=Ji(o,p),oi({type:fE,role:Die,key:wi,from:i,encode:g},n)}function coe(e,t){if(t!==1)if(!fe(e))e=At(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=pe({},e);for(;n.mult!=null;)if(fe(n.mult))n=n.mult=pe({},n.mult);else return n.mult=At(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function foe(e,t,n,i,r,s){const o=qn(e,t),a=e.orient,u=jm(a,-1,1);let l,c,f;const h={enter:l={opacity:Se},update:f={opacity:Ei},exit:c={opacity:Se}};zt(h,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const g=Dt(r);g.mult=u;const p={scale:e.scale,field:wi,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return f.y=l.y=Mt(a,Se,p),f.y2=l.y2=Mt(a,g),c.x=Mt(a,p),f.x=l.x=Ji(a,Se,p),f.x2=l.x2=Ji(a,g),c.y=Ji(a,p),oi({type:fE,role:Tie,key:wi,from:i,encode:h},n)}function bE(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function doe(e,t,n,i,r,s){const o=qn(e,t),a=e.orient,u=e.scale,l=jm(a,-1,1),c=Da(o("labelFlush")),f=Da(o("labelFlushOffset")),h=o("labelAlign"),g=o("labelBaseline");let p=c===0||!!c,m;const y=Dt(r);y.mult=l,y.offset=Dt(o("labelPadding")||0),y.offset.mult=l;const x={scale:u,field:wi,band:.5,offset:K5(s.offset,o("labelOffset"))},w=Mt(a,p?bE(u,c,'"left"','"right"','"center"'):{value:"center"},Zse(a,"left","right")),E=Mt(a,dN(a,"bottom","top"),p?bE(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),A=bE(u,c,`-(${f})`,f,0);p=p&&f;const S={opacity:Se,x:Mt(a,x,y),y:Ji(a,x,y)},O={enter:S,update:m={opacity:Ei,text:{field:oE},x:S.x,y:S.y,align:w,baseline:E},exit:{opacity:Se,x:S.x,y:S.y}};zt(O,{dx:!h&&p?Mt(a,A):null,dy:!g&&p?Ji(a,A):null}),zt(O,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:h,baseline:g});const _=o("labelBound");let C=o("labelOverlap");return C=C||_?{separation:o("labelSeparation"),method:C,order:"datum.index",bound:_?{scale:u,orient:a,tolerance:_}:null}:void 0,m.align!==w&&(m.align=vl(m.align,w)),m.baseline!==E&&(m.baseline=vl(m.baseline,E)),oi({type:Ta,role:Mie,style:id,key:wi,from:i,encode:O,overlap:C},n)}function hoe(e,t,n,i){const r=qn(e,t),s=e.orient,o=jm(s,-1,1);let a,u;const l={enter:a={opacity:Se,anchor:Dt(r("titleAnchor",null)),align:{signal:dE}},update:u=pe({},a,{opacity:Ei,text:Dt(e.title)}),exit:{opacity:Se}},c={signal:`lerp(range("${e.scale}"), ${Sm(0,1,.5)})`};return u.x=Mt(s,c),u.y=Ji(s,c),a.angle=Mt(s,Se,ooe(o,90)),a.baseline=Mt(s,dN(s,wo,Ki),{value:wo}),u.angle=a.angle,u.baseline=a.baseline,zt(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),goe(r,s,l,n),l.update.align=vl(l.update.align,a.align),l.update.angle=vl(l.update.angle,a.angle),l.update.baseline=vl(l.update.baseline,a.baseline),oi({type:Ta,role:Nie,style:aE,from:i,encode:l},n)}function goe(e,t,n,i){const r=(a,u)=>a!=null?(n.update[u]=vl(Dt(a),n.update[u]),!1):!gl(u,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?Dt(o):Mt(t,Dt(o),Dt(s))}function poe(e,t){const n=aoe(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,u=qn(e,n),l=fse(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ne(t.add(Qi({},[c]))),h=ne(t.add(mre({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),g=[];let p;return c.grid&&g.push(loe(e,n,i.grid,h,l)),c.ticks&&(p=u("tickSize"),g.push(foe(e,n,i.ticks,h,p,l))),c.labels&&(p=c.ticks?p:0,g.push(doe(e,n,i.labels,h,p,l))),c.domain&&g.push(uoe(e,n,i.domain,f)),c.title&&g.push(hoe(e,n,i.title,f)),$m(sd({role:kie,from:f,encode:hl(moe(u,e),r,rd),marks:g,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:o,style:a}),t)}function moe(e,t){const n={enter:{},update:{}};return zt(n,{orient:e("orient"),offset:e("offset")||0,position:Xi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function yN(e,t,n){const i=ae(e.signals),r=ae(e.scales);return n||i.forEach(s=>M5(s,t)),ae(e.projections).forEach(s=>Vre(s,t)),r.forEach(s=>Rre(s,t)),ae(e.data).forEach(s=>Kse(s,t)),r.forEach(s=>Pre(s,t)),(n||i).forEach(s=>pre(s,t)),ae(e.axes).forEach(s=>poe(s,t)),ae(e.marks).forEach(s=>$m(s,t)),ae(e.legends).forEach(s=>Ise(s,t)),e.title&&Gse(e.title,t),t.parseLambdas(),t}const yoe=e=>hl({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function boe(e,t){const n=t.config,i=ne(t.root=t.add(bm())),r=voe(e,n);r.forEach(l=>M5(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(Qi()),o=t.add(I5(F5(yoe(e.encode),_m,Qw,e.style,t,{pulse:ne(s)}))),a=t.add(z5({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:ne(o)}));t.operators.pop(),t.pushState(ne(o),ne(a),null),yN(e,t,r),t.operators.push(a);let u=t.add(P5({mark:i,pulse:ne(a)}));return u=t.add(U5({pulse:ne(u)})),u=t.add(Ma({pulse:ne(u)})),t.addData("root",new Na(t,s,s,u)),t}function ad(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function voe(e,t){const n=o=>Xi(e[o],t[o]),i=[ad("background",n("background")),ad("autosize",Cie(n("autosize"))),ad("padding",jie(n("padding"))),ad("width",n("width")||0),ad("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return ae(e.signals).forEach(o=>{ue(r,o.name)?o=pe(r[o.name],o):i.push(o),s[o.name]=o}),ae(t.signals).forEach(o=>{!ue(s,o.name)&&!ue(r,o.name)&&i.push(o)}),i}function bN(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function vN(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}bN.prototype=vN.prototype={parse(e){return yN(e,this)},fork(){return new vN(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof Zw?ne(e):e;return this.add(kre({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(ne(this.add(Ma({pulse:e})))),this._parent.push(t),this._lookup.push(n?ne(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Ee(this._parent)},encode(){return Ee(this._encode)},lookup(){return Ee(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Oe(e))return td(e,t);e.signal||P("Unsupported field reference: "+ie(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=ne(this.add(xre(r)))}return i},compareRef(e){let t=!1;const n=s=>At(s)?(t=!0,this.signalRef(s.signal)):sre(s)?(t=!0,this.exprRef(s.expr)):s,i=ae(e.field).map(n),r=ae(e.order).map(n);return t?ne(this.add(L5({fields:i,orders:r}))):T5(i,r)},keyRef(e,t){let n=!1;const i=s=>At(s)?(n=!0,ne(r[s.signal])):s,r=this.signals;return e=ae(e).map(i),n?ne(this.add(wre({fields:e,flat:t}))):tre(e,t)},sortRef(e){if(!e)return e;const t=vm(e.op,e.field),n=e.order||nre;return n.signal?ne(this.add(L5({fields:t,orders:this.signalRef(n.signal)}))):T5(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return ue(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&P("Duplicate signal name: "+ie(e));const n=t instanceof Zw?t:this.add(bm(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||P("Unrecognized signal name: "+ie(e)),this.signals[e]},signalRef(e){return this.signals[e]?ne(this.signals[e]):(ue(this.lambdas,e)||(this.lambdas[e]=this.add(bm(null))),ne(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=jr(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!fe(e)?e:this.signalRef(e.signal||vE(e))},exprRef(e,t){const n={expr:jr(e,this)};return t&&(n.expr.$name=t),ne(this.add(bre(n)))},addBinding(e,t){this.bindings||P("Nested signals do not support binding: "+ie(e)),this.bindings.push(pe({signal:e},t))},addScaleProj(e,t){ue(this.scales,e)&&P("Duplicate scale or projection name: "+ie(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Dre(t))},addProjection(e,t){this.addScaleProj(e,jre(t))},getScale(e){return this.scales[e]||P("Unrecognized scale name: "+ie(e)),this.scales[e]},scaleRef(e){return ne(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ue(this.data,e)&&P("Duplicate data set name: "+ie(e)),this.data[e]=t},getData(e){return this.data[e]||P("Undefined data set name: "+ie(e)),this.data[e]},addDataPipeline(e,t){return ue(this.data,e)&&P("Duplicate data set name: "+ie(e)),this.addData(e,Na.fromEntries(this,t))}};function vE(e){return(Z(e)?xoe:woe)(e)}function xoe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(fe(r)?r.signal||vE(r):ie(r))}return n+"]"}function woe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+ie(i)+":"+(fe(r)?r.signal||vE(r):ie(r));return t+"}"}function Eoe(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Aoe(e,t,n){return fe(e)||P("Input Vega specification must be an object."),t=mh(Eoe(),t,e.config),boe(e,new bN(t,n)).toRuntime()}var _oe="vega",Soe="5.21.0",Ooe="The Vega visualization grammar.",Coe=["vega","visualization","interaction","dataflow","library","data","d3"],$oe="BSD-3-Clause",joe="UW Interactive Data Lab (http://idl.cs.washington.edu)",koe="build/vega-node.js",Foe="build/vega.module.js",Doe="build/vega.min.js",Moe="build/vega.min.js",Toe="index.d.ts",Noe="vega/vega",Roe={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Poe={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Loe={"vega-schema":"*"},Ioe="774165e29850b66ec8b79ba52a7955f1ab936ea6",Boe={name:_oe,version:Soe,description:Ooe,keywords:Coe,license:$oe,author:joe,main:koe,module:Foe,unpkg:Doe,jsdelivr:Moe,types:Toe,repository:Noe,scripts:Roe,dependencies:Poe,devDependencies:Loe,gitHead:Ioe};pe(Du,Bz,ZY,FV,mQ,cK,zJ,hJ,HJ,aZ,yZ,_Z);const Uoe=Boe.version;var zoe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Uoe,Dataflow:Fu,EventStream:Bh,MultiPulse:By,Operator:We,Parameters:Ih,Pulse:Vs,Transform:T,changeset:oa,definition:n$,ingest:Ne,isTuple:Rh,transform:i$,transforms:Du,tupleid:ee,interpolate:_v,interpolateColors:vg,interpolateRange:kk,quantizeInterpolator:Fk,scale:Fe,scheme:Sv,projection:b2,View:p5,defaultLocale:My,formatLocale:kh,locale:NC,resetDefaultLocale:BB,timeFormatLocale:Fc,expressionFunction:gt,parse:Aoe,runtimeContext:XT,codegenExpression:CT,parseExpression:_T,parseSelector:_5,Debug:VS,Error:P1,Info:YS,None:WS,Warn:GS,accessor:Fn,accessorFields:Wt,accessorName:st,array:ae,ascending:wh,clampRange:aO,compare:U1,constant:Yt,debounce:z1,error:P,extend:pe,extent:cr,extentIndex:uO,falsy:Rs,fastmap:wu,field:Dn,flush:lO,hasOwnProperty:ue,id:uc,identity:hn,inherits:H,inrange:Eu,isArray:Z,isBoolean:q1,isDate:Ps,isFunction:ye,isIterable:cO,isNumber:Ls,isObject:fe,isRegExp:fO,isString:Oe,key:H1,lerp:dO,logger:XS,lruCache:hO,merge:gO,mergeConfig:mh,one:xu,pad:pO,panLinear:tO,panLog:nO,panPow:iO,panSymlog:rO,peek:Ee,quarter:sO,repeat:cc,span:fc,splitAccessPath:ph,stringValue:ie,toBoolean:W1,toDate:G1,toNumber:Gt,toSet:Pi,toString:Y1,truncate:mO,truthy:di,utcquarter:oO,visitArray:Is,writeConfig:lc,zero:Ns,zoomLinear:L1,zoomLog:I1,zoomPow:xh,zoomSymlog:B1,bandwidthNRD:Hy,bin:s$,bootstrapCI:o$,cumulativeLogNormal:Qy,cumulativeNormal:Hh,cumulativeUniform:eb,densityLogNormal:Xy,densityNormal:Wy,densityUniform:Zy,dotbin:a$,quantileLogNormal:Ky,quantileNormal:Wh,quantileUniform:tb,quantiles:zy,quartiles:qy,get random(){return pi},randomInteger:HU,randomKDE:Yy,randomLCG:qU,randomLogNormal:l$,randomMixture:c$,randomNormal:Gy,randomUniform:f$,regressionExp:h$,regressionLinear:nb,regressionLoess:b$,regressionLog:d$,regressionPoly:p$,regressionPow:g$,regressionQuad:ib,sampleCurve:Yh,sampleLogNormal:Vy,sampleNormal:qh,sampleUniform:Jy,setRandom:UU,DATE:Nn,DAY:Xt,DAYOFYEAR:fr,HOURS:ei,MILLISECONDS:Li,MINUTES:ti,MONTH:Vt,QUARTER:Tn,SECONDS:gi,TIME_UNITS:yy,WEEK:vt,YEAR:Pt,dayofyear:WO,timeBin:cC,timeFloor:JO,timeInterval:Cu,timeOffset:tC,timeSequence:rC,timeUnitSpecifier:HO,timeUnits:vy,utcFloor:ZO,utcInterval:$u,utcOffset:nC,utcSequence:sC,utcdayofyear:VO,utcweek:XO,week:GO,format:Dh,formats:Py,inferType:LC,inferTypes:IC,loader:Mh,read:qC,responseType:zC,typeParsers:Ty,Bounds:wt,CanvasHandler:df,CanvasRenderer:Gg,Gradient:Yk,GroupItem:Sg,Handler:lo,Item:_g,Marks:ni,RenderType:fo,Renderer:Ar,ResourceLoader:Rv,SVGHandler:fx,SVGRenderer:bx,SVGStringRenderer:wx,Scenegraph:ox,boundClip:fD,boundContext:nf,boundItem:sx,boundMark:OF,boundStroke:os,domChild:Pn,domClear:zi,domCreate:uo,domFind:ax,font:Pg,fontFamily:uf,fontSize:Er,intersect:aD,intersectBoxLine:Vu,intersectPath:qv,intersectPoint:Hv,intersectRule:fF,lineHeight:oo,markup:yx,multiLineOffset:nx,pathCurves:kv,pathEqual:dD,pathParse:Wu,pathRectangle:eF,pathRender:Kc,pathSymbols:Zk,pathTrail:tF,point:Ig,renderModule:Vg,resetSVGClipId:iF,resetSVGDefIds:pY,sceneEqual:Ax,sceneFromJSON:$F,scenePickVisit:Dg,sceneToJSON:CF,sceneVisit:Ui,sceneZOrder:Wv,serializeXML:QF,textMetrics:wr});function qoe(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var Hoe={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Woe={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},Goe={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const Yoe=Array.prototype.slice,Pa=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,Yoe.call(t,1))},Voe=(e,t,n,i,r,s,o)=>new Date(e,t||0,n!=null?n:1,i||0,r||0,s||0,o||0);var Xoe={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:Voe,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Pa("join",arguments)},indexof:function(){return Pa("indexOf",arguments)},lastindexof:function(){return Pa("lastIndexOf",arguments)},slice:function(){return Pa("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Pa("substring",arguments,String)},split:function(){return Pa("split",arguments,String)},replace:function(){return Pa("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const Qoe=["view","item","group","xy","x","y"],Koe={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:Hoe[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||Xoe[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Woe[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>Goe[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function ud(e,t,n,i,r,s){const o=a=>Koe[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,Qoe.forEach(a=>o.fn[a]=(...u)=>r.vega[a](...u)),o(e)}var Joe={operator(e,t){const n=t.ast,i=e.functions;return r=>ud(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>ud(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>ud(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>{const o=s.item&&s.item.datum;return ud(n,i,r,o,s)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s=n==="group"||n==="image"||n==="rect";return(o,a)=>{const u=o.datum;let l=0,c;for(const f in i)c=ud(i[f].ast,r,a,u,void 0,o),o[f]!==c&&(o[f]=c,l=1);return n!=="rule"&&qoe(o,i,s),l}}};const Zoe="vega-lite",eae='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',tae="5.1.1",nae=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],iae="https://vega.github.io/vega-lite/",rae="Vega-Lite is a concise high-level language for interactive visualization.",sae="build/vega-lite.js",oae="build/vega-lite.min.js",aae="build/vega-lite.min.js",uae="build/src/index",lae="build/src/index.d.ts",cae={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},fae={test:"test"},dae=["bin","build","src","vega-lite*","tsconfig.json"],hae={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},gae={type:"git",url:"https://github.com/vega/vega-lite.git"},pae="BSD-3-Clause",mae={url:"https://github.com/vega/vega-lite/issues"},yae={"@babel/core":"^7.15.0","@babel/preset-env":"^7.15.0","@babel/preset-typescript":"^7.15.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.4","@types/chai":"^4.2.21","@types/d3":"^7.0.0","@types/jest":"^27.0.1","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^4.29.2","@typescript-eslint/parser":"^4.29.2",ajv:"^8.6.2","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.0.1","del-cli":"^4.0.1",eslint:"^7.32.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^24.4.0","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.2.0",jest:"^27.0.6","jest-dev-server":"^5.0.3",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.3.2",puppeteer:"^10.2.0",rollup:"^2.56.3","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^12.0.0",terser:"^5.7.1","ts-jest":"^27.0.5","ts-json-schema-generator":"^0.95.0",typescript:"~4.4.2","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.18.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},bae={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1",yargs:"~17.1.1"},vae={vega:"^5.20.2"},xae={node:">=12"};var wae={name:Zoe,author:eae,version:tae,collaborators:nae,homepage:iae,description:rae,main:sae,unpkg:oae,jsdelivr:aae,module:uae,types:lae,bin:cae,directories:fae,files:dae,scripts:hae,repository:gae,license:pae,bugs:mae,devDependencies:yae,dependencies:bae,peerDependencies:vae,engines:xae};function wl(e,t,n){return e.fields=t||[],e.fname=n,e}function Eae(e){return e.length===1?Aae(e[0]):_ae(e)}const Aae=e=>function(t){return t[e]},_ae=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function xE(e){throw Error(e)}function La(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||xE("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&xE("Access path missing closing bracket: "+e),i&&xE("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Sae(e,t,n){const i=La(e);return e=i.length===1?i[0]:e,wl((n&&n.get||Eae)(i),[e],t||e)}Sae("id");const Oae=wl(e=>e,[],"identity");wl(()=>0,[],"zero");wl(()=>1,[],"one");wl(()=>!0,[],"true");wl(()=>!1,[],"false");function km(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const Cae=0,$ae=1,xN=2,jae=3,kae=4;function Fae(e,t){let n=e||Cae;return{level(i){return arguments.length?(n=+i,this):n},error(){return n>=$ae&&km(t||"error","ERROR",arguments),this},warn(){return n>=xN&&km(t||"warn","WARN",arguments),this},info(){return n>=jae&&km(t||"log","INFO",arguments),this},debug(){return n>=kae&&km(t||"log","DEBUG",arguments),this}}}var K=Array.isArray;function Ge(e){return e===Object(e)}const wN=e=>e!=="__proto__";function EN(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=Dae(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;wE(t,i,n[i],r)}return t},{})}function wE(e,t,n,i){if(!wN(t))return;let r,s;if(Ge(n)&&!K(n)){s=Ge(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?wE(s,r,n[r]):wN(r)&&(s[r]=n[r])}else e[t]=n}function Dae(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function ut(e){return e!=null?K(e)?e:[e]:[]}function Mae(e){return typeof e=="function"}const Tae=Object.prototype.hasOwnProperty;function El(e,t){return Tae.call(e,t)}function ld(e){return typeof e=="boolean"}function pt(e){return typeof e=="number"}function he(e){return typeof e=="string"}function Ce(e){return K(e)?"["+e.map(Ce)+"]":Ge(e)||he(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Ia(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var AN={exports:{}};(function(e){var t=function(){function n(h,g){return g!=null&&h instanceof g}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var s;try{s=Promise}catch{s=function(){}}function o(h,g,p,m,y){typeof g=="object"&&(p=g.depth,m=g.prototype,y=g.includeNonEnumerable,g=g.circular);var x=[],w=[],E=typeof Buffer!="undefined";typeof g=="undefined"&&(g=!0),typeof p=="undefined"&&(p=1/0);function A(S,O){if(S===null)return null;if(O===0)return S;var _,C;if(typeof S!="object")return S;if(n(S,i))_=new i;else if(n(S,r))_=new r;else if(n(S,s))_=new s(function(B,W){S.then(function(X){B(A(X,O-1))},function(X){W(A(X,O-1))})});else if(o.__isArray(S))_=[];else if(o.__isRegExp(S))_=new RegExp(S.source,f(S)),S.lastIndex&&(_.lastIndex=S.lastIndex);else if(o.__isDate(S))_=new Date(S.getTime());else{if(E&&Buffer.isBuffer(S))return Buffer.allocUnsafe?_=Buffer.allocUnsafe(S.length):_=new Buffer(S.length),S.copy(_),_;n(S,Error)?_=Object.create(S):typeof m=="undefined"?(C=Object.getPrototypeOf(S),_=Object.create(C)):(_=Object.create(m),C=m)}if(g){var j=x.indexOf(S);if(j!=-1)return w[j];x.push(S),w.push(_)}n(S,i)&&S.forEach(function(B,W){var X=A(W,O-1),ce=A(B,O-1);_.set(X,ce)}),n(S,r)&&S.forEach(function(B){var W=A(B,O-1);_.add(W)});for(var $ in S){var k;C&&(k=Object.getOwnPropertyDescriptor(C,$)),!(k&&k.set==null)&&(_[$]=A(S[$],O-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(S),$=0;$<M.length;$++){var D=M[$],I=Object.getOwnPropertyDescriptor(S,D);I&&!I.enumerable&&!y||(_[D]=A(S[D],O-1),I.enumerable||Object.defineProperty(_,D,{enumerable:!1}))}if(y)for(var F=Object.getOwnPropertyNames(S),$=0;$<F.length;$++){var L=F[$],I=Object.getOwnPropertyDescriptor(S,L);I&&I.enumerable||(_[L]=A(S[L],O-1),Object.defineProperty(_,L,{enumerable:!1}))}return _}return A(h,p)}o.clonePrototype=function(g){if(g===null)return null;var p=function(){};return p.prototype=g,new p};function a(h){return Object.prototype.toString.call(h)}o.__objToStr=a;function u(h){return typeof h=="object"&&a(h)==="[object Date]"}o.__isDate=u;function l(h){return typeof h=="object"&&a(h)==="[object Array]"}o.__isArray=l;function c(h){return typeof h=="object"&&a(h)==="[object RegExp]"}o.__isRegExp=c;function f(h){var g="";return h.global&&(g+="g"),h.ignoreCase&&(g+="i"),h.multiline&&(g+="m"),g}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(AN);var Nae=AN.exports,Rae=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,s;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!=0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),i=s.length,i!==Object.keys(n).length)return!1;for(r=i;r--!=0;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=i;r--!=0;){var o=s[r];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},EE=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(s){return function(o){return function(a,u){var l={key:a,value:o[a]},c={key:u,value:o[u]};return s(l,c)}}}(t.cmp),r=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,u;if(Array.isArray(o)){for(u="[",a=0;a<o.length;a++)a&&(u+=","),u+=s(o[a])||"null";return u+"]"}if(o===null)return"null";if(r.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(o)-1,c=Object.keys(o).sort(i&&i(o));for(u="",a=0;a<c.length;a++){var f=c[a],h=s(o[f]);!h||(u&&(u+=","),u+=JSON.stringify(f)+":"+h)}return r.splice(l,1),"{"+u+"}"}}(e)};function AE(e){return!!e.or}function _E(e){return!!e.and}function SE(e){return!!e.not}function Fm(e,t){if(SE(e))Fm(e.not,t);else if(_E(e))for(const n of e.and)Fm(n,t);else if(AE(e))for(const n of e.or)Fm(n,t);else t(e)}function Al(e,t){return SE(e)?{not:Al(e.not,t)}:_E(e)?{and:e.and.map(n=>Al(n,t))}:AE(e)?{or:e.or.map(n=>Al(n,t))}:t(e)}const kr=Rae,ge=Nae;function _l(e,t){const n={};for(const i of t)El(e,i)&&(n[i]=e[i]);return n}function ai(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>EE(e)).join(",")})`};const Ye=EE;function Ae(e){if(pt(e))return e;const t=he(e)?e:EE(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function OE(e){return e===!1||e===null}function be(e,t){return e.includes(t)}function Sl(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function CE(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function _N(e,...t){for(const n of t)Pae(e,n!=null?n:{});return e}function Pae(e,t){for(const n of U(t))wE(e,n,t[n],!0)}function Fr(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function Lae(e,t){const n=U(e),i=U(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function SN(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function $E(e,t){for(const n of e)if(t.has(n))return!0;return!1}function jE(e){const t=new Set;for(const n of e){const r=La(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function kE(e,t){return e===void 0||t===void 0?!0:$E(jE(e),jE(t))}function Ue(e){return U(e).length===0}const U=Object.keys,nn=Object.values,Eo=Object.entries;function cd(e){return e===!0||e===!1}function Ze(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function fd(e,t){return SE(e)?`!(${fd(e.not,t)})`:_E(e)?`(${e.and.map(n=>fd(n,t)).join(") && (")})`:AE(e)?`(${e.or.map(n=>fd(n,t)).join(") || (")})`:t(e)}function Dm(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&Dm(e[n],t)&&delete e[n],Ue(e)}function dd(e){return e.charAt(0).toUpperCase()+e.substr(1)}function FE(e,t="datum"){const n=La(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(Ce).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function ON(e,t="datum"){return`${t}[${Ce(La(e).join("."))}]`}function Iae(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ai(e){return`${La(e).map(Iae).join("\\.")}`}function Ba(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function DE(e){return`${La(e).join(".")}`}function Ol(e){return e?La(e).length:0}function mt(...e){for(const t of e)if(t!==void 0)return t}let CN=42;function $N(e){const t=++CN;return e?String(e)+t:t}function Bae(){CN=42}function jN(e){return kN(e)?e:`__${e}`}function kN(e){return e.startsWith("__")}function hd(e){if(e!==void 0)return(e%360+360)%360}function Mm(e){return pt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var gd=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const ms="row",ys="column",Tm="facet",nt="x",_t="y",Zi="x2",Dr="y2",Mr="radius",bs="radius2",er="theta",vs="theta2",Tr="latitude",Nr="longitude",tr="latitude2",_i="longitude2",Hn="color",Rr="fill",Pr="stroke",Wn="shape",xs="size",Ua="angle",ws="opacity",Ao="fillOpacity",_o="strokeOpacity",So="strokeWidth",Oo="strokeDash",pd="text",md="order",yd="detail",Nm="key",za="tooltip",Rm="href",Pm="url",Lm="description",Uae={x:1,y:1,x2:1,y2:1},FN={theta:1,theta2:1,radius:1,radius2:1};function DN(e){return e in FN}const ME={longitude:1,longitude2:1,latitude:1,latitude2:1};function zae(e){switch(e){case Tr:return"y";case tr:return"y2";case Nr:return"x";case _i:return"x2"}}function qae(e){return e in ME}const Hae=U(ME),MN=Object.assign(Object.assign(Object.assign(Object.assign({},Uae),FN),ME),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Cl(e){return e===Hn||e===Rr||e===Pr}const TN={row:1,column:1,facet:1},Si=U(TN),TE=Object.assign(Object.assign({},MN),TN),Wae=U(TE),Gae=gd(TE,["order","detail","tooltip"]),Yae=gd(Gae,["row","column","facet"]);function Vae(e){return!!Yae[e]}function NN(e){return!!TE[e]}const Xae=[Zi,Dr,tr,_i,vs,bs];function RN(e){return qa(e)!==e}function qa(e){switch(e){case Zi:return nt;case Dr:return _t;case tr:return Tr;case _i:return Nr;case vs:return er;case bs:return Mr}return e}function Co(e){if(DN(e))switch(e){case er:return"startAngle";case vs:return"endAngle";case Mr:return"outerRadius";case bs:return"innerRadius"}return e}function Es(e){switch(e){case nt:return Zi;case _t:return Dr;case Tr:return tr;case Nr:return _i;case er:return vs;case Mr:return bs}}function Oi(e){switch(e){case nt:case Zi:return"width";case _t:case Dr:return"height"}}function Qae(e){switch(e){case nt:return"xOffset";case _t:return"yOffset";case Zi:return"x2Offset";case Dr:return"y2Offset";case er:return"thetaOffset";case Mr:return"radiusOffset";case vs:return"theta2Offset";case bs:return"radius2Offset"}}const NE=gd(MN,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Kae=U(NE),$o={x:1,y:1},Lr=U($o);function Ir(e){return e in $o}const RE={theta:1,radius:1},Jae=U(RE);function Im(e){return e==="width"?nt:_t}const PN=gd(NE,["text","tooltip","href","url","description","detail","key","order"]),Zae=U(PN);function eue(e){return!!NE[e]}function tue(e){switch(e){case Hn:case Rr:case Pr:case xs:case Wn:case ws:case So:case Oo:return!0;case Ao:case _o:case Ua:return!1}}const LN=Object.assign(Object.assign(Object.assign({},$o),RE),PN),Bm=U(LN);function jo(e){return!!LN[e]}function nue(e,t){return rue(e)[t]}const IN={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},iue=gd(IN,["geoshape"]);function rue(e){switch(e){case Hn:case Rr:case Pr:case Lm:case yd:case Nm:case za:case Rm:case md:case ws:case Ao:case _o:case So:case Tm:case ms:case ys:return IN;case nt:case _t:case Tr:case Nr:return iue;case Zi:case Dr:case tr:case _i:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case xs:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Oo:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Wn:return{point:"always",geoshape:"always"};case pd:return{text:"always"};case Ua:return{point:"always",square:"always",text:"always"};case Pm:return{image:"always"};case er:return{text:"always",arc:"always"};case Mr:return{text:"always",arc:"always"};case vs:case bs:return{arc:"always"}}}function PE(e){switch(e){case nt:case _t:case er:case Mr:case xs:case Ua:case So:case ws:case Ao:case _o:case Zi:case Dr:case vs:case bs:return;case Tm:case ms:case ys:case Wn:case Oo:case pd:case za:case Rm:case Pm:case Lm:return"discrete";case Hn:case Rr:case Pr:return"flexible";case Tr:case Nr:case tr:case _i:case yd:case Nm:case md:return}}const sue={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},oue={count:1,min:1,max:1};function As(e){return!!e&&!!e.argmin}function ko(e){return!!e&&!!e.argmax}function LE(e){return he(e)&&!!sue[e]}const aue=["count","valid","missing","distinct"];function BN(e){return he(e)&&be(aue,e)}function uue(e){return he(e)&&be(["min","max"],e)}const lue=["count","sum","distinct","valid","missing"],cue=["mean","average","median","q1","q3","min","max"],fue=Ia(cue);function UN(e){return ld(e)&&(e=o0(e,void 0)),"bin"+U(e).map(t=>Um(e[t])?Ze(`_${t}_${Eo(e[t])}`):Ze(`_${t}_${e[t]}`)).join("")}function Ve(e){return e===!0||Ha(e)&&!e.binned}function On(e){return e==="binned"||Ha(e)&&e.binned===!0}function Ha(e){return Ge(e)}function Um(e){return e==null?void 0:e.param}function zN(e){switch(e){case ms:case ys:case xs:case Hn:case Rr:case Pr:case So:case ws:case Ao:case _o:case Wn:return 6;case Oo:return 4;default:return 10}}function bd(e){return e&&!!e.expr}function Gn(e){const t=U(e||{}),n={};for(const i of t)n[i]=ui(e[i]);return n}var due=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function qN(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:h,subtitleLineHeight:g,subtitlePadding:p}=e,m=due(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),y=Object.assign(Object.assign({},m),a?{fill:a}:{}),x=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),s!==void 0?{angle:s}:{}),o!==void 0?{limit:o}:{}),w=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),h?{subtitleFontWeight:h}:{}),g?{subtitleLineHeight:g}:{}),p?{subtitlePadding:p}:{}),E=_l(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:y,subtitleMarkConfig:E,nonMarkTitleProperties:x,subtitle:w}}function Fo(e){return he(e)||K(e)&&he(e[0])}function re(e){return e&&!!e.signal}function Do(e){return!!e.step}function hue(e){return K(e)?!1:"fields"in e&&!("data"in e)}function gue(e){return K(e)?!1:"fields"in e&&"data"in e}function _s(e){return K(e)?!1:"field"in e&&"data"in e}const pue={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},mue=U(pue),yue={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},IE=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var BE=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function HN(e){const t=K(e.condition)?e.condition.map(WN):WN(e.condition);return Object.assign(Object.assign({},ui(e)),{condition:t})}function ui(e){if(bd(e)){const{expr:t}=e,n=BE(e,["expr"]);return Object.assign({signal:t},n)}return e}function WN(e){if(bd(e)){const{expr:t}=e,n=BE(e,["expr"]);return Object.assign({signal:t},n)}return e}function et(e){if(bd(e)){const{expr:t}=e,n=BE(e,["expr"]);return Object.assign({signal:t},n)}return re(e)?e:e!==void 0?{value:e}:void 0}function GN(e){return re(e)?e.signal:Ce(e.value)}function Ss(e){return re(e)?e.signal:e==null?null:Ce(e)}function bue(e,t,n){for(const i of n){const r=Wa(i,t.markDef,t.config);r!==void 0&&(e[i]=et(r))}return e}function YN(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Pe(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Wa(e,t,n,i)}function Wa(e,t,n,{vgChannel:i}={}){return mt(i?zm(e,t,n.style):void 0,zm(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function zm(e,t,n){return VN(e,YN(t),n)}function VN(e,t,n){t=ut(t);let i;for(const r of t){const s=n[r];s&&s[e]!==void 0&&(i=s[e])}return i}function XN(e,t){return ut(e).reduce((n,i)=>{var r;return n.field.push(G(i,t)),n.order.push((r=i.sort)!==null&&r!==void 0?r:"ascending"),n},{field:[],order:[]})}function QN(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(kr(r,i))return;n.push(i)}),n}function KN(e,t){return kr(e,t)||!t?e:e?[...ut(e),...ut(t)].join(", "):t}function JN(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((Fo(n)||re(n))&&(Fo(i)||re(i)))return{explicit:e.explicit,value:KN(n,i)};if(Fo(n)||re(n))return{explicit:e.explicit,value:n};if(Fo(i)||re(i))return{explicit:e.explicit,value:i};if(!Fo(n)&&!re(n)&&!Fo(i)&&!re(i))return{explicit:e.explicit,value:QN(n,i)};throw new Error("It should never reach here")}function UE(e){return`Invalid specification ${Ye(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const vue='Autosize "fit" only works for single views and layered views.';function ZN(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function e6(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function t6(e){return e?`Dropping "fit-${e}" because spec has discrete ${Oi(e)}.`:'Dropping "fit" because spec has discrete size.'}function zE(e){return`Unknown field for ${e}. Cannot calculate view size.`}function n6(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function xue(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function wue(e){return`The "nearest" transform is not supported for ${e} marks.`}function i6(e){return`Selection not supported for ${e} yet.`}function Eue(e){return`Cannot find a selection named "${e}".`}const Aue="Scale bindings are currently only supported for scales with unbinned, continuous domains.",_ue="Legend bindings are only supported for selections over an individual field or encoding channel.";function Sue(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Oue(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Cue="The same selection must be used to override scale domains in a layered view.",$ue='Interval selections should be initialized using "x" and/or "y" keys.';function jue(e){return`Unknown repeated value "${e}".`}function r6(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const kue="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Fue(e){return`Unrecognized parse "${e}".`}function s6(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Due="Attempt to add the same child twice.";function Mue(e){return`Ignoring an invalid transform: ${Ye(e)}.`}const Tue='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function o6(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Nue(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ye(t)} is overridden by a child projection ${Ye(n)}.`}const Rue="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Pue(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ye(n)}}.`}function a6(e){return`Invalid field type "${e}".`}function Lue(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Iue(e){return`Invalid aggregation operator "${e}".`}function u6(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function Bue(e){return`Position range does not support relative band size for ${e}.`}function qE(e,t){return`Dropping ${Ye(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Uue="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function qm(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function zue(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function que(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Hue(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Wue(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function HE(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Gue(e){return`The ${e} for range marks cannot be an expression`}function Yue(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Vue(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Xue(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Que(e){return`Cannot use the relative band size with ${e} scale.`}function Kue(e){return`Using unaggregated domain with raw field has no effect (${Ye(e)}).`}function Jue(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Zue(e){return`Unaggregated domain is currently unsupported for log scale (${Ye(e)}).`}function ele(e){return`Cannot apply size to non-oriented mark "${e}".`}function tle(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function nle(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function l6(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function c6(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function ile(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ye(n)} and ${Ye(i)}). Using ${Ye(n)}.`}function rle(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ye(n)} and ${Ye(i)}). Using the union of the two domains.`}function sle(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function ole(e){return`Dropping sort property ${Ye(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const f6="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",ale="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",ule="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",lle="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function cle(e){return`Cannot stack "${e}" if there is already "${e}2".`}function fle(e){return`Cannot stack non-linear scale (${e}).`}function dle(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Hm(e,t){return`Invalid ${e}: ${Ye(t)}.`}function hle(e){return`Dropping day from datetime ${Ye(e)} as day cannot be combined with other units.`}function gle(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function ple(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function mle(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function d6(e){return`1D error band does not support ${e}.`}function h6(e){return`Channel ${e} is required for "binned" bin.`}function yle(e){return`Channel ${e} should not be used with "binned" bin.`}function ble(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const g6=Fae(xN);let $l=g6;function vle(e){return $l=e,$l}function xle(){return $l=g6,$l}function q(...e){$l.warn(...e)}function wle(...e){$l.debug(...e)}function Ga(e){if(e&&Ge(e)){for(const t of GE)if(t in e)return!0}return!1}const p6=["january","february","march","april","may","june","july","august","september","october","november","december"],Ele=p6.map(e=>e.substr(0,3)),m6=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Ale=m6.map(e=>e.substr(0,3));function _le(e){if(Mm(e)&&(e=+e),pt(e))return e>4&&q(Hm("quarter",e)),e-1;throw new Error(Hm("quarter",e))}function Sle(e){if(Mm(e)&&(e=+e),pt(e))return e-1;{const t=e.toLowerCase(),n=p6.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Ele.indexOf(i);if(r!==-1)return r;throw new Error(Hm("month",e))}}function Ole(e){if(Mm(e)&&(e=+e),pt(e))return e%7;{const t=e.toLowerCase(),n=m6.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Ale.indexOf(i);if(r!==-1)return r;throw new Error(Hm("day",e))}}function WE(e,t){const n=[];if(t&&e.day!==void 0&&U(e).length>1&&(q(hle(e)),e=ge(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?Sle(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?_le(e.quarter):e.quarter;n.push(pt(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?Ole(e.day):e.day;n.push(pt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r=="undefined"?0:r)}return n}function vd(e){const n=WE(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Cle(e){const n=WE(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function $le(e){const t=WE(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var jle=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const y6={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},GE=U(y6);function kle(e){return!!y6[e]}function YE(e){return e.startsWith("utc")}function Fle(e){return e.substr(3)}const Dle={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function VE(e){return GE.filter(t=>b6(e,t))}function b6(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Mle(e,t,{end:n}={end:!1}){const i=FE(t),r=YE(e)?"utc":"";function s(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let o;const a={};for(const u of GE)b6(e,u)&&(a[u]=s(u),o=u);return n&&(a[o]+="+1"),Cle(a)}function v6(e){if(!e)return;const t=VE(e);return`timeUnitSpecifier(${Ye(t)}, ${Ye(Dle)})`}function Tle(e,t,n){if(!e)return;const i=v6(e);return`${n||YE(e)?"utc":"time"}Format(${t}, ${i})`}function Cn(e){if(!e)return;let t;return he(e)?t={unit:e}:Ge(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),YE(t.unit)&&(t.utc=!0,t.unit=Fle(t.unit)),t}function Nle(e){const t=Cn(e),{utc:n}=t,i=jle(t,["utc"]);return i.unit?(n?"utc":"")+U(i).map(r=>Ze(`${r==="unit"?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+U(i).map(r=>Ze(`_${r}_${i[r]}`)).join("")}function Rle(e){return e==null?void 0:e.param}function XE(e){return e&&!!e.field&&e.equal!==void 0}function QE(e){return e&&!!e.field&&e.lt!==void 0}function KE(e){return e&&!!e.field&&e.lte!==void 0}function JE(e){return e&&!!e.field&&e.gt!==void 0}function ZE(e){return e&&!!e.field&&e.gte!==void 0}function eA(e){if(e==null?void 0:e.field){if(K(e.range)&&e.range.length===2)return!0;if(re(e.range))return!0}return!1}function tA(e){return e&&!!e.field&&(K(e.oneOf)||K(e.in))}function Ple(e){return e&&!!e.field&&e.valid!==void 0}function x6(e){return tA(e)||XE(e)||eA(e)||QE(e)||JE(e)||KE(e)||ZE(e)}function Br(e,t){return a0(e,{timeUnit:t,wrapTime:!0})}function Lle(e,t){return e.map(n=>Br(n,t))}function w6(e,t=!0){var n;const{field:i}=e,r=(n=Cn(e.timeUnit))===null||n===void 0?void 0:n.unit,s=r?`time(${Mle(r,i)})`:G(e,{expr:"datum"});if(XE(e))return`${s}===${Br(e.equal,r)}`;if(QE(e)){const o=e.lt;return`${s}<${Br(o,r)}`}else if(JE(e)){const o=e.gt;return`${s}>${Br(o,r)}`}else if(KE(e)){const o=e.lte;return`${s}<=${Br(o,r)}`}else if(ZE(e)){const o=e.gte;return`${s}>=${Br(o,r)}`}else{if(tA(e))return`indexof([${Lle(e.oneOf,r).join(",")}], ${s}) !== -1`;if(Ple(e))return nA(s,e.valid);if(eA(e)){const{range:o}=e,a=re(o)?{signal:`${o.signal}[0]`}:o[0],u=re(o)?{signal:`${o.signal}[1]`}:o[1];if(a!==null&&u!==null&&t)return"inrange("+s+", ["+Br(a,r)+", "+Br(u,r)+"])";const l=[];return a!==null&&l.push(`${s} >= ${Br(a,r)}`),u!==null&&l.push(`${s} <= ${Br(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ye(e)}`)}function nA(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Ile(e){var t;return x6(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Cn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const xd={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Ya=xd.quantitative,iA=xd.ordinal,jl=xd.temporal,rA=xd.nominal,kl=xd.geojson;function Ble(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Ya:return"quantitative";case"t":case jl:return"temporal";case"o":case iA:return"ordinal";case"n":case rA:return"nominal";case kl:return"geojson"}}var Ule=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const St={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},sA={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function zle(e,t){const n=sA[e],i=sA[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const qle={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function E6(e){return qle[e]}const A6=["linear","log","pow","sqrt","symlog","time","utc"],Hle=Ia(A6),Wle=["linear","log","pow","sqrt","symlog"],Gle=Ia(Wle);function Yle(e){return e in Gle}const Vle=["quantile","quantize","threshold"],Xle=Ia(Vle),Qle=A6.concat(["quantile","quantize","threshold","sequential","identity"]),Kle=Ia(Qle),Jle=["ordinal","bin-ordinal","point","band"],Zle=Ia(Jle);function rn(e){return e in Zle}function li(e){return e in Kle}function nr(e){return e in Hle}function wd(e){return e in Xle}const ece={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function tce(e){return!he(e)&&!!e.name}function _6(e){return e==null?void 0:e.param}function nce(e){return e&&e.unionWith}function ice(e){return fe(e)&&"field"in e}const rce={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},sce=Ule(rce,["type","domain","range","rangeMax","rangeMin","scheme"]),oce=U(sce);function oA(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return nr(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return nr(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return nr(e);case"nice":return nr(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return li(e)&&!be(["log","time","utc","threshold","quantile"],e)}}function S6(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Cl(e)?void 0:Xue(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function ace(e,t){return be([iA,rA],t)?e===void 0||rn(e):t===jl?be([St.TIME,St.UTC,void 0],e):t===Ya?be([St.LOG,St.POW,St.SQRT,St.SYMLOG,St.QUANTILE,St.QUANTIZE,St.THRESHOLD,St.LINEAR,void 0],e):!0}function uce(e,t){if(!jo(e))return!1;switch(e){case nt:case _t:case er:case Mr:return nr(t)||be(["band","point"],t);case xs:case So:case ws:case Ao:case _o:case Ua:return nr(t)||wd(t)||be(["band","point","ordinal"],t);case Hn:case Rr:case Pr:return t!=="band";case Oo:case Wn:return t==="ordinal"||wd(t)}}const $n={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},O6=$n.arc,Wm=$n.area,Gm=$n.bar,lce=$n.image,Ym=$n.line,Vm=$n.point,cce=$n.rect,Xm=$n.rule,C6=$n.text,aA=$n.tick,fce=$n.trail,uA=$n.circle,lA=$n.square,$6=$n.geoshape;function Mo(e){return["line","area","trail"].includes(e)}function j6(e){return["rect","bar","image","arc"].includes(e)}const k6=U($n);function Ur(e){return e.type}Ia(k6);const dce=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],hce=["fill","fillOpacity"],gce=[...dce,...hce],pce={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},F6=U(pce),mce={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},yce={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},bce={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},D6=U(bce);function Fl(e){return e&&e.band!=null}const vce={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},M6=5,xce={binSpacing:1,continuousBandSize:M6,timeUnitBandPosition:.5},wce={binSpacing:0,continuousBandSize:M6,timeUnitBandPosition:.5},Ece={thickness:1};function Ace(e){return Ur(e)?e.type:e}function cA(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:s}=e,o=N6(e);return Y(n)&&!BN(n.aggregate)&&r&&nr(r.get("type"))&&r.get("zero")===!1?T6({fieldDef:n,channel:t,markDef:i,ref:o,config:s}):o}function T6({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return Mo(n.type)||Pe("invalid",n,r)===null?i:[_ce(e,t),i]}function _ce(e,t){const n=fA(e,!0),r=qa(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function fA(e,t=!0){return nA(he(e)?e:G(e,{expr:"datum"}),!t)}function Sce(e){const{datum:t}=e;return Ga(t)?vd(t):`${Ye(t)}`}function Va(e,t,n,i){const r={};if(t&&(r.scale=t),To(e)){const{datum:s}=e;Ga(s)?r.signal=vd(s):re(s)?r.signal=s.signal:bd(s)?r.signal=s.expr:r.value=s}else r.field=G(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function Qm({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:s=.5}){const o=0<s&&s<1?"datum":void 0,a=G(t,{expr:o,suffix:r}),u=n!==void 0?G(n,{expr:o}):G(t,{suffix:"end",expr:o}),l={};if(s===0||s===1){l.scale=e;const c=s===0?a:u;l.field=c}else{const c=re(s)?`${s.signal} * ${a} + (1-${s.signal}) * ${u}`:`${s} * ${a} + ${1-s} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function N6({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(de(t)){if(Ci(t)){c!=null||(c=Y6({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:g,timeUnit:p,type:m}=t;if(Ve(g)||c&&p&&m===jl)return(a==null?void 0:a.impute)?Va(t,s,{binSuffix:"mid"},{offset:u}):c?Qm({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:u}):Va(t,s,_d(t,e)?{binSuffix:"range"}:{},{offset:u});if(On(g)){if(Y(n))return Qm({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});q(h6(e===nt?Zi:Dr))}}const h=o==null?void 0:o.get("type");return Va(t,s,rn(h)?{binSuffix:"range"}:{},{offset:u,band:h==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(ir(t)){const h=t.value,g=u?{offset:u}:{};return Object.assign(Object.assign({},Ed(e,h)),g)}}return Mae(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function Ed(e,t){return be(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:be(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:et(t)}function Xa(e){return e&&e!=="number"&&e!=="time"}function R6(e,t,n){return`${e}(${t}${n?`, ${Ye(n)}`:""})`}const Oce=" \u2013 ";function dA({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var o,a;if(Xa(n))return hA({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const u=P6(e,i,r);if(Tl(e)){const l=$ce(u,Y(e)?(o=Cn(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,s.timeFormat,Qa(e)&&((a=e.scale)===null||a===void 0?void 0:a.type)===St.UTC);return l?{signal:l}:void 0}if(t=B6(yA(e),t,s),Y(e)&&Ve(e.bin)){const l=G(e,{expr:i,binSuffix:"end"});return{signal:Km(u,l,t,n,s)}}else return t||yA(e)==="quantitative"?{signal:`${U6(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function P6(e,t,n){return Y(e)?n?`${G(e,{expr:t,suffix:"end"})}-${G(e,{expr:t,suffix:"start"})}`:G(e,{expr:t}):Sce(e)}function hA({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o!=null||(o=P6(e,i,r)),Y(e)&&Ve(e.bin)){const a=G(e,{expr:i,binSuffix:"end"});return{signal:Km(o,a,t,n,s)}}return{signal:R6(n,o,t)}}function L6(e,t,n,i,r,s){var o;if(!Xa(i)){if(Tl(e)){const a=Y(e)?(o=Cn(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return Cce(n,a,r,s)}return B6(t,n,r)}}function I6(e,t,n){if(e&&(re(e)||e==="number"||e==="time"))return e;if(Tl(t)&&n!=="time"&&n!=="utc")return"time"}function B6(e,t,n){if(he(t))return t;if(e===Ya)return n.numberFormat}function Cce(e,t,n,i){return e||(t?{signal:v6(t)}:i?void 0:n.timeFormat)}function U6(e,t){return`format(${e}, "${t||""}")`}function z6(e,t,n,i){var r;return Xa(n)?R6(n,e,t):U6(e,(r=he(t)?t:void 0)!==null&&r!==void 0?r:i.numberFormat)}function Km(e,t,n,i,r){const s=z6(e,n,i,r),o=z6(t,n,i,r);return`${nA(e,!1)} ? "null" : ${s} + "${Oce}" + ${o}`}function $ce(e,t,n,i,r){return!t||n?(n=he(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):Tle(t,e,r)}const Jm="min",jce={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function q6(e){return e in jce}function H6(e){return!!e&&!!e.encoding}function zr(e){return!!e&&(e.op==="count"||!!e.field)}function W6(e){return!!e&&K(e)}function Ad(e){return"row"in e||"column"in e}function gA(e){return!!e&&"header"in e}function Zm(e){return"facet"in e}var pA=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function kce(e){return e.param}function Fce(e){return e&&!he(e)&&"repeat"in e}function G6(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function mA(e){return"sort"in e}function Y6({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(de(e)&&e.bandPosition!==void 0)return e.bandPosition;if(Y(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return j6(n.type)?0:Wa("timeUnitBandPosition",n,i);if(Ve(s))return .5}}function V6({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){var a,u,l;const c=Oi(e),f=Pe(o?"size":c,i,r,{vgChannel:c});if(f!==void 0)return f;if(Y(t)){const{timeUnit:h,bin:g}=t;if(h&&!n)return{band:Wa("timeUnitBandSize",i,r)};if(Ve(g)&&!rn(s))return{band:1}}if(j6(i.type))return s?rn(s)?((a=r[i.type])===null||a===void 0?void 0:a.discreteBandSize)||{band:1}:(u=r[i.type])===null||u===void 0?void 0:u.continuousBandSize:(l=r[i.type])===null||l===void 0?void 0:l.discreteBandSize}function X6(e,t,n,i){return Ve(e.bin)||e.timeUnit&&Ci(e)&&e.type==="temporal"?Y6({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function e0(e){return e&&"condition"in e}function t0(e){const t=e&&e.condition;return!!t&&!K(t)&&Y(t)}function n0(e){const t=e&&e.condition;return!!t&&!K(t)&&de(t)}function Dce(e){const t=e&&e.condition;return!!t&&(K(t)||ir(t))}function Y(e){return e&&(!!e.field||e.aggregate==="count")}function yA(e){return e&&e.type}function To(e){return e&&"datum"in e}function qr(e){return Ci(e)&&!i0(e)||bA(e)}function bA(e){return To(e)&&pt(e.datum)}function de(e){return Y(e)||To(e)}function Ci(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function ir(e){return e&&"value"in e&&"value"in e}function Qa(e){return e&&("scale"in e||"sort"in e)}function vA(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Q6(e){return e&&"legend"in e}function K6(e){return e&&("format"in e||"formatType"in e)}function Mce(e){return ai(e,["legend","axis","header","scale"])}function Tce(e){return"op"in e}function G(e,t={}){var n,i,r;let s=e.field;const o=t.prefix;let a=t.suffix,u="";if(Rce(e))s=jN("count");else{let l;if(!t.nofn)if(Tce(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:h}=e;Ve(c)?(l=UN(c),a=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((i=t.suffix)!==null&&i!==void 0?i:"")):f?ko(f)?(u=`["${s}"]`,s=`argmax_${f.argmax}`):As(f)?(u=`["${s}"]`,s=`argmin_${f.argmin}`):l=String(f):h&&(l=Nle(h),a=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((r=t.suffix)!==null&&r!==void 0?r:""))}l&&(s=s?`${l}_${s}`:l)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?DE(s):t.expr?ON(s,t.expr)+u:Ai(s)+u}function i0(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Y(e)&&!!e.bin;case"temporal":return!1}throw new Error(a6(e.type))}function Nce(e){var t;return Qa(e)&&wd((t=e.scale)===null||t===void 0?void 0:t.type)}function Rce(e){return e.aggregate==="count"}function Pce(e,t){var n;const{field:i,bin:r,timeUnit:s,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ve(r))return`${i} (binned)`;if(s){const a=(n=Cn(s))===null||n===void 0?void 0:n.unit;if(a)return`${i} (${VE(a).join("-")})`}else if(o)return ko(o)?`${i} for max ${o.argmax}`:As(o)?`${i} for min ${o.argmin}`:`${dd(o)} of ${i}`;return i}function Lce(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(ko(t))return`${r} for argmax(${t.argmax})`;if(As(t))return`${r} for argmin(${t.argmin})`;const s=Cn(i),o=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||Ve(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}const J6=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Lce(e);default:return Pce(e,t)}};let Z6=J6;function eR(e){Z6=e}function Ice(){eR(J6)}function Dl(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,s;const o=(r=xA(e))===null||r===void 0?void 0:r.title;if(!Y(e))return o;const a=e,u=i?wA(a,t):void 0;return n?mt(o,a.title,u):(s=o!=null?o:a.title)!==null&&s!==void 0?s:u}function xA(e){if(vA(e)&&e.axis)return e.axis;if(Q6(e)&&e.legend)return e.legend;if(gA(e)&&e.header)return e.header}function wA(e,t){return Z6(e,t)}function r0(e){var t;if(K6(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=xA(e))!==null&&t!==void 0?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function Bce(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(mA(e)&&K(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:s}=e;if(s)return"temporal";if(r||i&&!ko(i)&&!As(i))return"quantitative";if(Qa(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(sA[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Hr(e){if(Y(e))return e;if(t0(e))return e.condition}function Ot(e){if(de(e))return e;if(n0(e))return e.condition}function tR(e,t,n,i={}){if(he(e)||pt(e)||ld(e)){const r=he(e)?"string":pt(e)?"number":"boolean";return q(Pue(t,r,e)),{value:e}}return de(e)?s0(e,t,n,i):n0(e)?Object.assign(Object.assign({},e),{condition:s0(e.condition,t,n,i)}):e}function s0(e,t,n,i){if(K6(e)){const{format:r,formatType:s}=e,o=pA(e,["format","formatType"]);if(Xa(s)&&!n.customFormatTypes)return q(o6(t)),s0(o,t,n,i)}else{const r=vA(e)?"axis":Q6(e)?"legend":gA(e)?"header":null;if(r&&e[r]){const s=e[r],{format:o,formatType:a}=s,u=pA(s,["format","formatType"]);if(Xa(a)&&!n.customFormatTypes)return q(o6(t)),s0(Object.assign(Object.assign({},e),{[r]:u}),t,n,i)}}return Y(e)?EA(e,t,i):Uce(e)}function Uce(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=pt(n)?"quantitative":he(n)?"nominal":Ga(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function EA(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a=Object.assign({},e);if(!n&&i&&!LE(i)&&!ko(i)&&!As(i)&&(q(Iue(i)),delete a.aggregate),r&&(a.timeUnit=Cn(r)),o&&(a.field=`${o}`),Ve(s)&&(a.bin=o0(s,t)),On(s)&&!Ir(t)&&q(yle(t)),Ci(a)){const{type:u}=a,l=Ble(u);u!==l&&(a.type=l),u!=="quantitative"&&BN(i)&&(q(Lue(u,i)),a.type="quantitative")}else if(!RN(t)){const u=Bce(a,t);a.type=u}if(Ci(a)){const{compatible:u,warning:l}=zce(a,t)||{};u===!1&&q(l)}if(mA(a)&&he(a.sort)){const{sort:u}=a;if(q6(u))return Object.assign(Object.assign({},a),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&q6(l))return Object.assign(Object.assign({},a),{sort:{encoding:l,order:"descending"}})}if(gA(a)){const{header:u}=a;if(u){const{orient:l}=u,c=pA(u,["orient"]);if(l)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return a}function o0(e,t){return ld(e)?{maxbins:zN(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:zN(t)}):e}const Ml={compatible:!0};function zce(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ms:case ys:case Tm:return i0(e)?Ml:{compatible:!1,warning:que(t)};case nt:case _t:case Hn:case Rr:case Pr:case pd:case yd:case Nm:case za:case Rm:case Pm:case Ua:case er:case Mr:case Lm:return Ml;case Nr:case _i:case Tr:case tr:return n!==Ya?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Ml;case ws:case Ao:case _o:case So:case xs:case vs:case bs:case Zi:case Dr:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Ml;case Wn:case Oo:return!i0(e)&&!Nce(e)?{compatible:!1,warning:Hue(t)}:Ml;case md:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Ml}}function Tl(e){const{formatType:t}=r0(e);return t==="time"||!t&&qce(e)}function qce(e){return e&&(e.type==="temporal"||Y(e)&&!!e.timeUnit)}function a0(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var s;const o=t&&((s=Cn(t))===null||s===void 0?void 0:s.unit);let a=o||n==="temporal",u;return bd(e)?u=e.expr:re(e)?u=e.signal:Ga(e)?(a=!0,u=vd(e)):(he(e)||pt(e))&&a&&(u=`datetime(${Ye(e)})`,kle(o)&&(pt(e)&&e<1e4||he(e)&&isNaN(Date.parse(e)))&&(u=vd({[o]:e}))),u?i&&a?`time(${u})`:u:r?void 0:Ye(e)}function nR(e,t){const{type:n}=e;return t.map(i=>{const r=a0(i,{timeUnit:Y(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function _d(e,t){return Ve(e.bin)?jo(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const iR={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Sd(e){return e&&e.condition}const rR=["domain","grid","labels","ticks","title"],Hce={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},sR={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Wce=Object.assign(Object.assign({},sR),{style:1,labelExpr:1,encoding:1});function oR(e){return!!Wce[e]}const Gce={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},aR=U(Gce);function Os(e){return"mark"in e}class u0{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Os(t)?Ace(t.mark)===this.name:!1}}var Yce=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Ka(e,t){const n=e&&e[t];return n?K(n)?Sl(n,i=>!!i.field):Y(n)||t0(n):!1}function AA(e){return Sl(Wae,t=>{if(Ka(e,t)){const n=e[t];if(K(n))return Sl(n,i=>!!i.aggregate);{const i=Hr(n);return i&&!!i.aggregate}}return!1})}function uR(e,t){const n=[],i=[],r=[],s=[],o={};return _A(e,(a,u)=>{if(Y(a)){const{field:l,aggregate:c,bin:f,timeUnit:h}=a,g=Yce(a,["field","aggregate","bin","timeUnit"]);if(c||h||f){const p=xA(a),m=p==null?void 0:p.title;let y=G(a,{forAs:!0});const x=Object.assign(Object.assign(Object.assign({},m?[]:{title:Dl(a,t,{allowDisabling:!0})}),g),{field:y});if(c){let w;if(ko(c)?(w="argmax",y=G({op:"argmax",field:c.argmax},{forAs:!0}),x.field=`${y}.${l}`):As(c)?(w="argmin",y=G({op:"argmin",field:c.argmin},{forAs:!0}),x.field=`${y}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(w=c),w){const E={op:w,as:y};l&&(E.field=l),s.push(E)}}else if(n.push(y),Ci(a)&&Ve(f)){if(i.push({bin:f,field:l,as:y}),n.push(G(a,{binSuffix:"end"})),_d(a,u)&&n.push(G(a,{binSuffix:"range"})),Ir(u)){const w={field:`${y}_end`};o[`${u}2`]=w}x.bin="binned",RN(u)||(x.type=Ya)}else if(h){r.push({timeUnit:h,field:l,as:y});const w=Ci(a)&&a.type!==jl&&"time";w&&(u===pd||u===za?x.formatType=w:eue(u)?x.legend=Object.assign({formatType:w},x.legend):Ir(u)&&(x.axis=Object.assign({formatType:w},x.axis)))}o[u]=x}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function Vce(e,t,n){const i=nue(t,n);if(i){if(i==="binned"){const r=e[t===Zi?nt:_t];return!!(Y(r)&&Y(e[t])&&On(r.bin))}}else return!1;return!0}function Xce(e,t,n,i){return U(e).reduce((r,s)=>{if(!NN(s))return q(zue(s)),r;const o=e[s];if(s==="angle"&&t==="arc"&&!e.theta&&(q(Rue),s=er),!Vce(e,s,t))return q(qm(s,t)),r;if(s===xs&&t==="line"){const a=Hr(e[s]);if(a==null?void 0:a.aggregate)return q(Uue),r}if(s===Hn&&(n?"fill"in e:"stroke"in e))return q(u6("encoding",{fill:"fill"in e,stroke:"stroke"in e})),r;if(s===yd||s===md&&!K(o)&&!ir(o)||s===za&&K(o))o&&(r[s]=ut(o).reduce((a,u)=>(Y(u)?a.push(EA(u,s)):q(qE(u,s)),a),[]));else{if(s===za&&o===null)r[s]=null;else if(!Y(o)&&!To(o)&&!ir(o)&&!e0(o)&&!re(o))return q(qE(o,s)),r;r[s]=tR(o,s,i)}return r},{})}function l0(e,t){const n={};for(const i of U(e)){const r=tR(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Qce(e){const t=[];for(const n of U(e))if(Ka(e,n)){const i=e[n],r=ut(i);for(const s of r)Y(s)?t.push(s):t0(s)&&t.push(s.condition)}return t}function _A(e,t,n){if(!!e)for(const i of U(e)){const r=e[i];if(K(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function Kce(e,t,n,i){return e?U(e).reduce((r,s)=>{const o=e[s];return K(o)?o.reduce((a,u)=>t.call(i,a,u,s),r):t.call(i,r,o,s)},n):n}function lR(e,t){return U(t).reduce((n,i)=>{switch(i){case nt:case _t:case Rm:case Lm:case Pm:case Zi:case Dr:case er:case vs:case Mr:case bs:case Tr:case Nr:case tr:case _i:case pd:case Wn:case Ua:case za:return n;case md:if(e==="line"||e==="trail")return n;case yd:case Nm:{const r=t[i];if(K(r)||Y(r))for(const s of ut(r))s.aggregate||n.push(G(s,{}));return n}case xs:if(e==="trail")return n;case Hn:case Rr:case Pr:case ws:case Ao:case _o:case Oo:case So:{const r=Hr(t[i]);return r&&!r.aggregate&&n.push(G(r,{})),n}}},[])}var cR=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Jce(e){const{tooltip:t}=e,n=cR(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(K(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return K(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function SA(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const u=i?` of ${OA(t)}`:"";return{field:o+t.field,type:t.type,title:re(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),s=Qce(n).map(Mce);return{tooltip:[...r,...Fr(s,Ae)]}}function OA(e){const{title:t,field:n}=e;return mt(t,n)}function CA(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const h=OA(n);return fR(e,a,r,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},h!==void 0?{title:h}:{}),s!==void 0?{scale:s}:{}),o!==void 0?{axis:o}:{})},he(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function fR(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),s?{color:s}:{}),o?{opacity:o}:{}),Ur(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),ld(e[t])?{}:e[t])})]:[]}function dR(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[`${r}2`],a=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:c0(s,n),continuousAxisChannelDef2:c0(o,n),continuousAxisChannelDefError:c0(a,n),continuousAxisChannelDefError2:c0(u,n),continuousAxis:r}}function c0(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,i=cR(e,["aggregate"]);return n!==t&&q(mle(n,t)),i}else return e}function hR(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Ur(n)&&n.orient)return n.orient;if(qr(r)){if(qr(s)){const o=Y(r)&&r.aggregate,a=Y(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return Tl(s)&&!Tl(r)?"horizontal":"vertical"}return"horizontal"}else{if(qr(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var f0=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const d0="boxplot",Zce=["box","median","outliers","rule","ticks"],efe=new u0(d0,pR);function gR(e){return pt(e)?"tukey":e}function pR(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:l0(e.encoding,t)});const{mark:r,encoding:s,params:o,projection:a}=e,u=f0(e,["mark","encoding","params","projection"]),l=Ur(r)?r:{type:r};o&&q(i6("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Pe("size",l,t),h=gR(c),{bins:g,timeUnits:p,transform:m,continuousAxisChannelDef:y,continuousAxis:x,groupby:w,aggregate:E,encodingWithoutContinuousAxis:A,ticksOrient:S,boxOrient:O,customTooltipWithoutAggregatedField:_}=tfe(e,c,t),{color:C,size:j}=A,$=f0(A,["color","size"]),k=ct=>CA(l,x,y,ct,t.boxplot),M=k($),D=k(A),I=k(Object.assign(Object.assign({},$),j?{size:j}:{})),F=SA([{fieldPrefix:h==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:h==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],y,A),L={type:"tick",color:"black",opacity:1,orient:S,invalid:null,aria:!1},B=h==="min-max"?F:SA([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,A),W=[...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:B}),...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:B}),...M({partName:"ticks",mark:L,positionPrefix:"lower_whisker",extraEncoding:B}),...M({partName:"ticks",mark:L,positionPrefix:"upper_whisker",extraEncoding:B})],X=[...h!=="tukey"?W:[],...D({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:O,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:F}),...I({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ge(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:S,aria:!1}),positionPrefix:"mid_box",extraEncoding:F})];if(h==="min-max")return Object.assign(Object.assign({},u),{transform:((i=u.transform)!==null&&i!==void 0?i:[]).concat(m),layer:X});const ce=`datum["lower_box_${y.field}"]`,Te=`datum["upper_box_${y.field}"]`,$e=`(${Te} - ${ce})`,it=`${ce} - ${c} * ${$e}`,He=`${Te} + ${c} * ${$e}`,lt=`datum["${y.field}"]`,cn={joinaggregate:mR(y.field),groupby:w},Di={transform:[{filter:`(${it} <= ${lt}) && (${lt} <= ${He})`},{aggregate:[{op:"min",field:y.field,as:`lower_whisker_${y.field}`},{op:"max",field:y.field,as:`upper_whisker_${y.field}`},{op:"min",field:`lower_box_${y.field}`,as:`lower_box_${y.field}`},{op:"max",field:`upper_box_${y.field}`,as:`upper_box_${y.field}`},...E],groupby:w}],layer:W},fi=f0($,["tooltip"]),{scale:V,axis:le}=y,me=OA(y),z=ai(le,["title"]),ht=fR(l,"outliers",t.boxplot,{transform:[{filter:`(${lt} < ${it}) || (${lt} > ${He})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[x]:Object.assign(Object.assign(Object.assign({field:y.field,type:y.type},me!==void 0?{title:me}:{}),V!==void 0?{scale:V}:{}),Ue(z)?{}:{axis:z})},fi),C?{color:C}:{}),_?{tooltip:_}:{})})[0];let we;const bt=[...g,...p,cn];return ht?we={transform:bt,layer:[ht,Di]}:(we=Di,we.transform.unshift(...bt)),Object.assign(Object.assign({},u),{layer:[we,{transform:m,layer:X}]})}function mR(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function tfe(e,t,n){const i=hR(e,d0),{continuousAxisChannelDef:r,continuousAxis:s}=dR(e,i,d0),o=r.field,a=gR(t),u=[...mR(o),{op:"median",field:o,as:`mid_box_${o}`},{op:"min",field:o,as:(a==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(a==="min-max"?"upper_whisker_":"max_")+o}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:`iqr_${o}`},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:`upper_whisker_${o}`},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:`lower_whisker_${o}`}],c=e.encoding,f=s;c[f];const h=f0(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:g,filteredEncoding:p}=Jce(h),{bins:m,timeUnits:y,aggregate:x,groupby:w,encoding:E}=uR(p,n),A=i==="vertical"?"horizontal":"vertical",S=i,O=[...m,...y,{aggregate:[...x,...u],groupby:w},...l];return{bins:m,timeUnits:y,transform:O,groupby:w,aggregate:x,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:E,ticksOrient:A,boxOrient:S,customTooltipWithoutAggregatedField:g}}var yR=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const $A="errorbar",nfe=["ticks","rule"],ife=new u0($A,bR);function bR(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:l0(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=vR(e,$A,t);delete s.size;const c=CA(a,r,i,s,t.errorbar),f=a.thickness,h=a.size,g=Object.assign(Object.assign({type:"tick",orient:o,aria:!1},f!==void 0?{thickness:f}:{}),h!==void 0?{size:h}:{}),p=[...c({partName:"ticks",mark:g,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:g,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function rfe(e,t){const{encoding:n}=e;if(sfe(n))return{orient:hR(e,t),inputType:"raw"};const i=ofe(n),r=afe(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(de(a)&&de(u))throw new Error(`${t} cannot have both x2 and y2`);if(de(a)){if(qr(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(de(u)){if(qr(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(de(u)&&!de(a))throw new Error(`${t} cannot have xError2 without xError`);if(de(c)&&!de(l))throw new Error(`${t} cannot have yError2 without yError`);if(de(a)&&de(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(de(a)){if(qr(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(de(l)){if(qr(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function sfe(e){return(de(e.x)||de(e.y))&&!de(e.x2)&&!de(e.y2)&&!de(e.xError)&&!de(e.xError2)&&!de(e.yError)&&!de(e.yError2)}function ofe(e){return de(e.x2)||de(e.y2)}function afe(e){return de(e.xError)||de(e.xError2)||de(e.yError)||de(e.yError2)}function vR(e,t,n){var i;const{mark:r,encoding:s,params:o,projection:a}=e,u=yR(e,["mark","encoding","params","projection"]),l=Ur(r)?r:{type:r};o&&q(i6(t));const{orient:c,inputType:f}=rfe(e,t),{continuousAxisChannelDef:h,continuousAxisChannelDef2:g,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:y}=dR(e,c,t),{errorBarSpecificAggregate:x,postAggregateCalculates:w,tooltipSummary:E,tooltipTitleWithFieldName:A}=ufe(l,h,g,p,m,f,t,n),S=s,O=y;S[O];const _=y==="x"?"x2":"y2";S[_];const C=y==="x"?"xError":"yError";S[C];const j=y==="x"?"xError2":"yError2";S[j];const $=yR(S,[typeof O=="symbol"?O:O+"",typeof _=="symbol"?_:_+"",typeof C=="symbol"?C:C+"",typeof j=="symbol"?j:j+""]),{bins:k,timeUnits:M,aggregate:D,groupby:I,encoding:F}=uR($,n),L=[...D,...x],B=f!=="raw"?[]:I,W=SA(E,h,F,A);return{transform:[...(i=u.transform)!==null&&i!==void 0?i:[],...k,...M,...L.length===0?[]:[{aggregate:L,groupby:B}],...w],groupby:B,continuousAxisChannelDef:h,continuousAxis:y,encodingWithoutContinuousAxis:F,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:W}}function ufe(e,t,n,i,r,s,o,a){let u=[],l=[];const c=t.field;let f,h=!1;if(s==="raw"){const g=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:g==="mean"?"stderr":"iqr";if(g==="median"!=(p==="iqr")&&q(ple(g,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:g,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:dd(g)},{fieldPrefix:"upper_",titlePrefix:xR(g,p,"+")},{fieldPrefix:"lower_",titlePrefix:xR(g,p,"-")}],h=!0;else{let m,y,x;p==="ci"?(m="mean",y="ci0",x="ci1"):(m="median",y="q1",x="q3"),u=[{op:y,field:c,as:`lower_${c}`},{op:x,field:c,as:`upper_${c}`},{op:m,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Dl({field:c,aggregate:x,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Dl({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Dl({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&q(gle(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const g of l)f.push({fieldPrefix:g.as.substring(0,6),titlePrefix:Ba(Ba(g.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:h}}function xR(e,t,n){return`${dd(e)} ${n} ${t}`}const jA="errorband",lfe=["band","borders"],cfe=new u0(jA,wR);function wR(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:l0(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=vR(e,jA,t),l=o,c=CA(l,r,i,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let h={type:f?"area":"rect"},g={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(h=Object.assign(Object.assign(Object.assign({},h),p),{ariaRoleDescription:"errorband"}),g=Object.assign(Object.assign(Object.assign({},g),p),{aria:!1})):l.interpolate?q(d6("interpolate")):l.tension&&q(d6("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:g,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:g,positionPrefix:"upper",extraEncoding:u})]})}const ER={};function kA(e,t,n){const i=new u0(e,t);ER[e]={normalizer:i,parts:n}}function ffe(){return U(ER)}kA(d0,pR,Zce);kA($A,bR,nfe);kA(jA,wR,lfe);const dfe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],AR={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},_R={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},hfe=U(AR),gfe=U(_R),pfe={header:1,headerRow:1,headerColumn:1,headerFacet:1},SR=U(pfe),OR=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],mfe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},yfe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Od="_vgsid_",bfe={point:{on:"click",fields:[Od],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function FA(e){return!!e&&(e==="legend"||!!e.legend)}function DA(e){return FA(e)&&Ge(e)}function MA(e){return!!e.select}var vfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function CR(e){const t=[];for(const n of e||[]){if(MA(n))continue;const{expr:i,bind:r}=n,s=vfe(n,["expr","bind"]);if(r&&i){const o=Object.assign(Object.assign({},s),{bind:r,init:i});t.push(o)}else{const o=Object.assign(Object.assign(Object.assign({},s),i?{update:i}:{}),r?{bind:r}:{});t.push(o)}}return t}function xfe(e){return h0(e)||NA(e)||TA(e)}function TA(e){return"concat"in e}function h0(e){return"vconcat"in e}function NA(e){return"hconcat"in e}function Wr(e){return Ge(e)&&e.step!==void 0}function $R(e){return e.view||e.width||e.height}const jR=20,wfe={align:1,bounds:1,center:1,columns:1,spacing:1},Efe=U(wfe);function Afe(e,t,n){var i,r;const s=n[t],o={},{spacing:a,columns:u}=s;a!==void 0&&(o.spacing=a),u!==void 0&&(Zm(e)&&!Ad(e.facet)||TA(e))&&(o.columns=u),h0(e)&&(o.columns=1);for(const l of Efe)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=pt(c)?c:{row:(i=c.row)!==null&&i!==void 0?i:a,column:(r=c.column)!==null&&r!==void 0?r:a}}else o[l]=e[l];return o}var _fe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function RA(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function g0(e,t){const n=Cd(e,t);return Wr(n)?n.step:kR}function Cd(e,t){var n;const i=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return mt(i,{step:e.step})}const kR=20,Sfe={continuousWidth:200,continuousHeight:200,step:kR},Ofe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Sfe,mark:yce,arc:{},area:{},bar:xce,circle:{},geoshape:{},image:{},line:{},point:{},rect:wce,rule:{color:"black"},square:{},text:{color:"black"},tick:Ece,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:ece,projection:{},legend:mfe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:bfe,style:{},title:{},facet:{spacing:jR},concat:{spacing:jR}},Cs=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],FR={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},DR={blue:Cs[0],orange:Cs[1],red:Cs[2],teal:Cs[3],green:Cs[4],yellow:Cs[5],purple:Cs[6],pink:Cs[7],brown:Cs[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Cfe(e={}){return{signals:[{name:"color",value:Ge(e)?Object.assign(Object.assign({},DR),e):DR}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function $fe(e){return{signals:[{name:"fontSize",value:Ge(e)?Object.assign(Object.assign({},FR),e):FR}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function jfe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function MR(e){const t=U(e||{}),n={};for(const i of t){const r=e[i];n[i]=Sd(r)?HN(r):ui(r)}return n}function kfe(e){const t=U(e),n={};for(const i of t)n[i]=MR(e[i]);return n}const Ffe=[...D6,...aR,...SR,"background","padding","legend","lineBreak","scale","style","title","view"];function TR(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,s=_fe(e,["color","font","fontSize","selection"]),o=EN({},ge(Ofe),n?jfe(n):{},t?Cfe(t):{},i?$fe(i):{},s||{});r&&lc(o,"selection",r,!0);const a=ai(o,Ffe);for(const u of["background","lineBreak","padding"])o[u]&&(a[u]=ui(o[u]));for(const u of D6)o[u]&&(a[u]=Gn(o[u]));for(const u of aR)o[u]&&(a[u]=MR(o[u]));for(const u of SR)o[u]&&(a[u]=Gn(o[u]));return o.legend&&(a.legend=Gn(o.legend)),o.scale&&(a.scale=Gn(o.scale)),o.style&&(a.style=kfe(o.style)),o.title&&(a.title=Gn(o.title)),o.view&&(a.view=Gn(o.view)),a}const Dfe=["view",...k6],Mfe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Tfe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},mce);function Nfe(e){e=ge(e);for(const t of Mfe)delete e[t];if(e.axis)for(const t in e.axis)Sd(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of dfe)delete e.legend[t];if(e.mark){for(const t of F6)delete e.mark[t];e.mark.tooltip&&Ge(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(CR(e.params)),delete e.params);for(const t of Dfe){for(const i of F6)delete e[t][i];const n=Tfe[t];if(n)for(const i of n)delete e[t][i];Pfe(e,t)}for(const t of ffe())delete e[t];Rfe(e);for(const t in e)Ge(e[t])&&Ue(e[t])&&delete e[t];return Ue(e)?void 0:e}function Rfe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=qN(e.title);Ue(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Ue(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Ue(i)?delete e.title:e.title=i}function Pfe(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const s=Object.assign(Object.assign({},r),e.style[n!=null?n:t]);Ue(s)||(e.style[n!=null?n:t]=s),i||delete e[t]}function p0(e){return"layer"in e}function Lfe(e){return"repeat"in e}function Ife(e){return!K(e.repeat)&&e.repeat.layer}var Bfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class PA{map(t,n){return Zm(t)?this.mapFacet(t,n):Lfe(t)?this.mapRepeat(t,n):NA(t)?this.mapHConcat(t,n):h0(t)?this.mapVConcat(t,n):TA(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(p0(t))return this.mapLayer(t,n);if(Os(t))return this.mapUnit(t,n);throw new Error(UE(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=Bfe(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Ufe={zero:1,center:1,normalize:1};function zfe(e){return e in Ufe}const qfe=new Set([O6,Gm,Wm,Xm,Vm,uA,lA,Ym,C6,aA]),Hfe=new Set([Gm,Wm,O6]);function Nl(e){return Y(e)&&yA(e)==="quantitative"&&!e.bin}function NR(e,t){var n,i;const r=t==="x"?"y":"radius",s=e[t],o=e[r];if(Y(s)&&Y(o))if(Nl(s)&&Nl(o)){if(s.stack)return t;if(o.stack)return r;const a=Y(s)&&!!s.aggregate,u=Y(o)&&!!o.aggregate;if(a!==u)return a?t:r;{const l=(n=s.scale)===null||n===void 0?void 0:n.type,c=(i=o.scale)===null||i===void 0?void 0:i.type;if(l&&l!=="linear")return r;if(c&&c!=="linear")return t}}else{if(Nl(s))return t;if(Nl(o))return r}else{if(Nl(s))return t;if(Nl(o))return r}}function Wfe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function RR(e,t,n={}){var i,r;const s=Ur(e)?e.type:e;if(!qfe.has(s))return null;const o=NR(t,"x")||NR(t,"theta");if(!o)return null;const a=t[o],u=Y(a)?G(a,{}):void 0;let l=Wfe(o),c=t[l],f=Y(c)?G(c,{}):void 0;f===u&&(f=void 0,c=void 0,l=void 0);const h=Kae.reduce((p,m)=>{if(m!=="tooltip"&&Ka(t,m)){const y=t[m];for(const x of ut(y)){const w=Hr(x);if(w.aggregate)continue;const E=G(w,{});(!E||E!==f)&&p.push({channel:m,fieldDef:w})}}return p},[]);let g;if(a.stack!==void 0?ld(a.stack)?g=a.stack?"zero":null:g=a.stack:Hfe.has(s)&&(g="zero"),!g||!zfe(g)||AA(t)&&h.length===0)return null;if(((i=a==null?void 0:a.scale)===null||i===void 0?void 0:i.type)&&((r=a==null?void 0:a.scale)===null||r===void 0?void 0:r.type)!==St.LINEAR){if(n.disallowNonLinearStack)return null;q(fle(a.scale.type))}return de(t[Es(o)])?(a.stack!==void 0&&q(cle(o)),null):(Y(a)&&a.aggregate&&!be(lue,a.aggregate)&&q(dle(a.aggregate)),{groupbyChannel:c?l:void 0,groupbyField:f,fieldChannel:o,impute:a.impute===null?!1:Mo(s),stackBy:h,offset:g})}var PR=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Gfe(e){const t=PR(e,["point","line"]);return U(t).length>1?t:t.type}function Yfe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:ai(e[t],["point","line"])}));return e}function LA(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Ge(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Ge(t.point)?t.point:{}:void 0}function LR(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Vfe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Os(t)){const{mark:i,encoding:r}=t,s=Ur(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!LA(s,n[s.type],r);case"area":return!!LA(s,n[s.type],r)||!!LR(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,encoding:u}=t,l=PR(t,["params","projection","mark","encoding"]),c=l0(u,r),f=Ur(a)?a:{type:a},h=LA(f,r[f.type],c),g=f.type==="area"&&LR(f,r[f.type]),p=[Object.assign(Object.assign({},s?{params:s}:{}),{mark:Gfe(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:ai(c,["shape"])})],m=RR(f,c);let y=c;if(m){const{fieldChannel:x,offset:w}=m;y=Object.assign(Object.assign({},c),{[x]:Object.assign(Object.assign({},c[x]),w?{stack:w}:{})})}return g&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},_l(f,["clip","interpolate","tension","tooltip"])),g),encoding:y})),h&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},_l(f,["clip","tooltip"])),h),encoding:y})),i(Object.assign(Object.assign({},l),{layer:p}),Object.assign(Object.assign({},n),{config:Yfe(r)}))}}var Xfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Qfe(e,t){return t?Ad(e)?zR(e,t):IR(e,t):e}function IA(e,t){return t?zR(e,t):e}function BA(e,t,n){const i=t[e];if(Fce(i)){if(i.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[i.repeat]});q(jue(i.repeat));return}return t}function IR(e,t){if(e=BA("field",e,t),e!==void 0){if(e===null)return null;if(mA(e)&&zr(e.sort)){const n=BA("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function BR(e,t){if(Y(e))return IR(e,t);{const n=BA("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function UR(e,t){if(de(e)){const n=BR(e,t);if(n)return n;if(e0(e))return{condition:e.condition}}else{if(n0(e)){const n=BR(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):Xfe(e,["condition"])}return e}}function zR(e,t){const n={};for(const i in e)if(El(e,i)){const r=e[i];if(K(r))n[i]=r.map(s=>UR(s,t)).filter(s=>s);else{const s=UR(r,t);s!==void 0&&(n[i]=s)}}return n}class Kfe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Os(t)){const{encoding:n,mark:i}=t;if(i==="line"||Ur(i)&&i.type==="line")for(const r of Xae){const s=qa(r),o=n[s];if(n[r]&&(Y(o)&&!On(o.bin)||To(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return q(Yue(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Ge(s)?Object.assign(Object.assign({},s),{type:"rule"}):"rule"}),n)}}var No=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Jfe extends PA{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[efe,ife,cfe,new Vfe,new Kfe]}map(t,n){if(Os(t)){const i=Ka(t.encoding,ms),r=Ka(t.encoding,ys),s=Ka(t.encoding,Tm);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=IA(t.encoding,n.repeater),o=Object.assign(Object.assign({},t),s?{encoding:s}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(o,n.config))return u.run(o,n,a);return o}mapRepeat(t,n){return Ife(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,s=No(t,["repeat","spec"]),{row:o,column:a,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:u},spec:r}}),n):Object.assign(Object.assign({},s),{layer:u.map(f=>{const h=Object.assign(Object.assign({},l),{layer:f}),g=`${(r.name||"")+c}child__layer_${Ze(f)}`,p=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:h,repeaterPrefix:g}));return p.name=g,p})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:s,data:o}=t,a=No(t,["repeat","spec","data"]);!K(r)&&t.columns&&(t=ai(t,["columns"]),q(r6("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!K(r)&&r.row||[l?l.row:null],h=!K(r)&&r.column||[l?l.column:null],g=K(r)&&r||[l?l.repeat:null];for(const m of g)for(const y of f)for(const x of h){const w={repeat:m,row:y,column:x,layer:l.layer},E=(s.name||"")+c+"child__"+(K(r)?`${Ze(m)}`:(r.row?`row_${Ze(y)}`:"")+(r.column?`column_${Ze(x)}`:"")),A=this.map(s,Object.assign(Object.assign({},n),{repeater:w,repeaterPrefix:E}));A.name=E,u.push(ai(A,["data"]))}const p=K(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(i=s.data)!==null&&i!==void 0?i:o,align:"all"},a),{columns:p,concat:u})}mapFacet(t,n){const{facet:i}=t;return Ad(i)&&t.columns&&(t=ai(t,["columns"]),q(r6("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,u=HR({parentProjection:o,projection:r}),l=qR({parentEncoding:s,encoding:IA(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:a})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:s,facet:o}=i,a=No(i,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:h,params:g,encoding:p}=t,m=No(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:y,layout:x}=this.getFacetMappingAndLayout({row:r,column:s,facet:o},n),w=IA(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},m),x),{facet:y,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),h?{view:h}:{}),c?{projection:c}:{}),{mark:u,encoding:w}),g?{params:g}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:s,facet:o}=t;if(r||s){o&&q(Wue([...r?[ms]:[],...s?[ys]:[]]));const a={},u={};for(const l of[ms,ys]){const c=t[l];if(c){const f=No(c,["align","center","spacing","columns"]);a[l]=f;for(const h of["align","center","spacing"])c[h]!==void 0&&((i=u[h])!==null&&i!==void 0||(u[h]={}),u[h][l]=c[h])}}return{facetMapping:a,layout:u}}else{const{align:a,center:u,spacing:l,columns:c}=o,f=No(o,["align","center","spacing","columns"]);return{facetMapping:Qfe(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,s=No(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,u=No(t,["encoding","projection"]),l=Object.assign(Object.assign({},s),{parentEncoding:qR({parentEncoding:i,encoding:o,layer:!0}),parentProjection:HR({parentProjection:r,projection:a})});return super.mapLayer(u,l)}}function qR({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...U(e),...U(t)]);for(const s of r){const o=t[s],a=e[s];if(de(o)){const u=Object.assign(Object.assign({},a),o);i[s]=u}else n0(o)?i[s]=Object.assign(Object.assign({},o),{condition:Object.assign(Object.assign({},a),o.condition)}):o||o===null?i[s]=o:(n||ir(a)||re(a)||de(a)||K(a))&&(i[s]=a)}}else i=t;return!i||Ue(i)?void 0:i}function HR(e){const{parentProjection:t,projection:n}=e;return t&&n&&q(Nue({parentProjection:t,projection:n})),n!=null?n:t}function UA(e){return"filter"in e}function Zfe(e){return(e==null?void 0:e.stop)!==void 0}function WR(e){return"lookup"in e}function ede(e){return"data"in e}function tde(e){return"param"in e}function nde(e){return"pivot"in e}function ide(e){return"density"in e}function rde(e){return"quantile"in e}function sde(e){return"regression"in e}function ode(e){return"loess"in e}function ade(e){return"sample"in e}function ude(e){return"window"in e}function lde(e){return"joinaggregate"in e}function cde(e){return"flatten"in e}function fde(e){return"calculate"in e}function GR(e){return"bin"in e}function dde(e){return"impute"in e}function hde(e){return"timeUnit"in e}function gde(e){return"aggregate"in e}function pde(e){return"stack"in e}function mde(e){return"fold"in e}function yde(e){return e.map(t=>UA(t)?{filter:Al(t.filter,Ile)}:t)}var Ro=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class bde extends PA{map(t,n){var i,r;return(i=n.emptySelections)!==null&&i!==void 0||(n.emptySelections={}),(r=n.selectionPredicates)!==null&&r!==void 0||(n.selectionPredicates={}),t=YR(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=YR(t,n),t.encoding){const i={};for(const[r,s]of Eo(t.encoding))i[r]=VR(s,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,s=Ro(i,["selection"]);return r?Object.assign(Object.assign({},s),{params:Eo(r).map(([o,a])=>{var u;const l=a,{init:c,bind:f,empty:h}=l,g=Ro(l,["init","bind","empty"]);g.type==="single"?(g.type="point",g.toggle=!1):g.type==="multi"&&(g.type="point"),n.emptySelections[o]=h!=="none";for(const p of nn((u=n.selectionPredicates[o])!==null&&u!==void 0?u:{}))p.empty=h!=="none";return{name:o,value:c,select:g,bind:f}})}):t}}function YR(e,t){const{transform:n}=e,i=Ro(e,["transform"]);if(n){const r=n.map(s=>{if(UA(s))return{filter:zA(s,t)};if(GR(s)&&Ha(s.bin))return Object.assign(Object.assign({},s),{bin:XR(s.bin)});if(WR(s)){const o=s.from,{selection:a}=o,u=Ro(o,["selection"]);return a?Object.assign(Object.assign({},s),{from:Object.assign({param:a},u)}):s}return s});return Object.assign(Object.assign({},i),{transform:r})}return e}function VR(e,t){var n,i;const r=ge(e);if(Y(r)&&Ha(r.bin)&&(r.bin=XR(r.bin)),Qa(r)&&((i=(n=r.scale)===null||n===void 0?void 0:n.domain)===null||i===void 0?void 0:i.selection)){const s=r.scale.domain,{selection:o}=s,a=Ro(s,["selection"]);r.scale.domain=Object.assign(Object.assign({},a),o?{param:o}:{})}if(e0(r))if(Z(r.condition))r.condition=r.condition.map(s=>{const{selection:o,param:a,test:u}=s,l=Ro(s,["selection","param","test"]);return a?s:Object.assign(Object.assign({},l),{test:zA(s,t)})});else{const s=VR(r.condition,t),{selection:o,param:a,test:u}=s,l=Ro(s,["selection","param","test"]);r.condition=a?r.condition:Object.assign(Object.assign({},l),{test:zA(r.condition,t)})}return r}function XR(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,i=Ro(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function zA(e,t){const n=i=>Al(i,r=>{var s,o,a;const u=(s=t.emptySelections[r])!==null&&s!==void 0?s:!0,l={param:r,empty:u};return(o=(a=t.selectionPredicates)[r])!==null&&o!==void 0||(a[r]=[]),t.selectionPredicates[r].push(l),l});return e.selection?n(e.selection):Al(e.test||e.filter,i=>i.selection?n(i.selection):i)}class qA extends PA{map(t,n){var i;const r=(i=n.selections)!==null&&i!==void 0?i:[];if(t.params&&!Os(t)){const s=[];for(const o of t.params)MA(o)?r.push(o):s.push(o);t.params=s}return n.selections=r,super.map(t,QR(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const s=((i=n.path)!==null&&i!==void 0?i:[]).concat(t.name),o=[];for(const a of r)if(!a.views||!a.views.length)o.push(a);else for(const u of a.views)(Oe(u)&&(u===t.name||s.indexOf(u)>=0)||Z(u)&&u.map(l=>s.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&o.push(a);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=qA.prototype[e];qA.prototype[e]=function(n,i){return t.call(this,n,QR(n,i))}}function QR(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function KR(e,t){t===void 0&&(t=TR(e.config));const n=Ede(e,t),{width:i,height:r}=e,s=Ade(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const vde=new Jfe,xde=new bde,wde=new qA;function Ede(e,t={}){const n={config:t};return wde.map(vde.map(xde.map(e,n),n),n)}function JR(e){return he(e)?{type:e}:e!=null?e:{}}function Ade(e,t,n){let{width:i,height:r}=t;const s=Os(e)||p0(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(q(ZN("width")),i=void 0),r=="container"&&(q(ZN("height")),r=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?JR(n.autosize):{}),JR(e.autosize));if(a.type==="fit"&&!s&&(q(vue),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&q(e6("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&q(e6("height")),!kr(a,{type:"pad"}))return a}function _de(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Sde(e){return e?`fit-${Im(e)}`:"fit"}const Ode=["background","padding"];function ZR(e,t){const n={};for(const i of Ode)e&&e[i]!==void 0&&(n[i]=ui(e[i]));return t&&(n.params=e.params),n}class $s{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new $s(ge(this.explicit),ge(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return mt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of U(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function js(e){return{explicit:!0,value:e}}function ci(e){return{explicit:!1,value:e}}function e8(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:m0(t,n,i,r)}}function m0(e,t,n,i){return e.explicit&&t.explicit&&q(ile(n,i,e.value,t.value)),e}function Po(e,t,n,i,r=m0){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:kr(e.value,t.value)?e:r(e,t,n,i)}class Cde extends $s{constructor(t={},n={},i=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Rl(e){return"url"in e}function $d(e){return"values"in e}function t8(e){return"name"in e&&!Rl(e)&&!$d(e)&&!Lo(e)}function Lo(e){return e&&(n8(e)||i8(e)||HA(e))}function n8(e){return"sequence"in e}function i8(e){return"sphere"in e}function HA(e){return"graticule"in e}var Xe;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Xe||(Xe={}));const $de="view",y0="[",b0="]",r8="{",s8="}",jde=":",o8=",",kde="@",Fde=">",Dde=/[[\]{}]/,Mde={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let a8,u8;function Pl(e,t,n){return a8=t||$de,u8=n||Mde,l8(e.trim()).map(WA)}function Tde(e){return u8[e]}function jd(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function l8(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=jd(e,r,o8,y0+r8,b0+s8),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function WA(e){return e[0]==="["?Nde(e):Rde(e)}function Nde(e){const t=e.length;let n=1,i;if(n=jd(e,n,b0,y0,b0),n===t)throw"Empty between selector: "+e;if(i=l8(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Fde)throw"Expected '>' after between selector: "+e;i=i.map(WA);const r=WA(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function Rde(e){const t={source:a8},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===s8){if(a=e.lastIndexOf(r8),a>=0){try{i=Pde(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===kde&&(r=++a),u=jd(e,a,jde),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=jd(e,a,y0),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=jd(e,a,b0),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==y0)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||Dde.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):Tde(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Pde(e){const t=e.split(o8);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}var Lde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Ll(e,t=!0,n=Oae){if(K(e)){const i=e.map(r=>Ll(r,t,n));return t?`[${i.join(", ")}]`:i}else if(Ga(e))return n(t?vd(e):$le(e));return t?n(Ye(e)):e}function Ide(e,t){var n;for(const i of nn((n=e.component.selection)!==null&&n!==void 0?n:{})){const r=i.name;let s=`${r}${Uo}, ${i.resolve==="global"?"true":`{unit: ${Ul(e)}}`}`;for(const o of A0)!o.defined(i)||(o.signals&&(t=o.signals(e,i,t)),o.modifyExpr&&(s=o.modifyExpr(e,i,s)));t.push({name:r+bhe,on:[{events:{signal:i.name+Uo},update:`modify(${Ce(i.name+Ja)}, ${s})`}]})}return GA(t)}function Bde(e,t){if(e.component.selection&&U(e.component.selection).length){const n=Ce(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Pl("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return GA(t)}function Ude(e,t){var n;let i=!1;for(const r of nn((n=e.component.selection)!==null&&n!==void 0?n:{})){const s=r.name,o=Ce(s+Ja);if(t.filter(u=>u.name===s).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${D8}(${o}, ${Ce(u)}${l}`})}i=!0;for(const u of A0)u.defined(r)&&u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))}return i&&t.filter(s=>s.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),GA(t)}function zde(e,t){var n;const i=[...t];for(const r of nn((n=e.component.selection)!==null&&n!==void 0?n:{})){const s={name:r.name+Ja};if(r.init){const a=r.project.items.map(u=>Lde(u,["signals"]));s.values=r.init.map(u=>({unit:Ul(e,{escape:!1}),fields:a,values:Ll(u,!1)}))}i.filter(a=>a.name===r.name+Ja).length||i.push(s)}return i}function c8(e,t){var n;for(const i of nn((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const r of A0)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function qde(e,t){for(const n of e.children)yt(n)&&(t=c8(n,t));return t}function Hde(e,t,n,i){const r=Q8(e,t.param,t);return{signal:li(n.get("type"))&&K(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function GA(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class ze{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){q(Due);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class jn extends ze{constructor(t,n,i,r){super(t,n);this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${$N()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var f8=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Gr extends ze{constructor(t,n){super(t);this.formula=n}clone(){return new Gr(null,ge(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s)=>{const{field:o,timeUnit:a}=s;if(a){const u=G(s,{forAs:!0});r[Ae({as:u,field:o,timeUnit:a})]={as:u,field:o,timeUnit:a}}return r},{});return Ue(i)?null:new Gr(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,s=f8(i,["timeUnit"]),o=Cn(r),a=Object.assign(Object.assign({},s),{timeUnit:o});return new Gr(t,{[Ae(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Eo(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(nn(this.formula).map(t=>t.as))}dependentFields(){return new Set(nn(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${Ae(this.formula)}`}assemble(){const t=[];for(const n of nn(this.formula)){const{field:i,as:r,timeUnit:s}=n,o=Cn(s),{unit:a,utc:u}=o,l=f8(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Ai(i),type:"timeunit"},a?{units:VE(a)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return t}}var Wde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const kd="_tuple_fields";class Gde{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const Yde={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,s=(i=t.project)!==null&&i!==void 0?i:t.project=new Gde,o={},a={},u=new Set,l=(m,y)=>{const x=y==="visual"?m.channel:m.field;let w=Ze(`${r}_${x}`);for(let E=1;u.has(w);E++)w=Ze(`${r}_${x}_${E}`);return u.add(w),{[y]:w}},c=t.type,f=e.config.selection[c],h=n.value!==void 0?ut(n.value):null;let{fields:g,encodings:p}=Ge(n.select)?n.select:{};if(!g&&!p&&h){for(const m of h)if(!!Ge(m))for(const y of U(m))Vae(y)?(p||(p=[])).push(y):c==="interval"?(q($ue),p=f.encodings):(g||(g=[])).push(y)}!g&&!p&&(p=f.encodings,"fields"in f&&(g=f.fields));for(const m of p!=null?p:[]){const y=e.fieldDef(m);if(y){let x=y.field;if(y.aggregate){q(xue(m,y.aggregate));continue}else if(!x){q(n6(m));continue}if(y.timeUnit){x=e.vgField(m);const w={timeUnit:y.timeUnit,as:x,field:y.field};a[Ae(w)]=w}if(!o[x]){let w="E";if(c==="interval"){const A=e.getScaleComponent(m).get("type");li(A)&&(w="R")}else y.bin&&(w="R-RE");const E={field:x,channel:m,type:w};E.signals=Object.assign(Object.assign({},l(E,"data")),l(E,"visual")),s.items.push(o[x]=E),s.hasField[x]=s.hasChannel[m]=o[x]}}else q(n6(m))}for(const m of g!=null?g:[]){if(s.hasField[m])continue;const y={type:"E",field:m};y.signals=Object.assign({},l(y,"data")),s.items.push(y),s.hasField[m]=y}h&&(t.init=h.map(m=>s.items.map(y=>Ge(m)?m[y.channel]!==void 0?m[y.channel]:m[y.field]:m))),Ue(a)||(s.timeUnit=new Gr(null,a))},signals:(e,t,n)=>{const i=t.name+kd;return n.filter(s=>s.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(s=>{const o=Wde(s,["signals","hasLegend"]);return o.field=Ai(o.field),o})})}},Io={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!jo(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(!s||!li(o)){q(Aue);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||VA(e)||i.length===0)return n;const r=n.filter(o=>o.name===t.name)[0];let s=r.update;if(s.indexOf(D8)>=0)r.update=`{${i.map(o=>`${Ce(Ai(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${Ce(Ai(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!VA(e))for(const i of t.scales){const r=n.filter(s=>s.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function YA(e,t){return`domain(${Ce(e.scaleName(t))})`}function VA(e){var t;return e.parent&&Vl(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:VA(e.parent.parent))}var Vde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Il="_brush",XA="_scale_trigger",Xde={defined:e=>e.type==="interval",signals:(e,t,n)=>{const i=t.name,r=i+kd,s=Io.defined(t),o=t.init?t.init[0]:null,a=[],u=[];if(t.translate&&!s){const c=`!event.item || event.item.mark.name !== ${Ce(i+Il)}`;d8(t,(f,h)=>{var g,p;const m=ut((g=(p=h.between[0]).filter)!==null&&g!==void 0?g:p.filter=[]);return m.includes(c)||m.push(c),f})}t.project.items.forEach((c,f)=>{const h=c.channel;if(h!==nt&&h!==_t){q("Interval selections only support x and y encoding channels.");return}const g=o?o[f]:null,p=Qde(e,t,c,g),m=c.signals.data,y=c.signals.visual,x=Ce(e.scaleName(h)),w=e.getScaleComponent(h).get("type"),E=li(w)?"+":"";n.push(...p),a.push(m),u.push({scaleName:e.scaleName(h),expr:`(!isArray(${m}) || (${E}invert(${x}, ${y})[0] === ${E}${m}[0] && ${E}invert(${x}, ${y})[1] === ${E}${m}[1]))`})}),!s&&u.length&&n.push({name:i+XA,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${i+XA} : {}`}]});const l=`unit: ${Ul(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+Uo},o?{init:`{${l}: ${Ll(o)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r&&r.signals.visual,a=s&&s.signals.visual,u=`data(${Ce(t.name+Ja)})`;if(Io.defined(t)||!r&&!s)return n;const l={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const y of U(l))l[y]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Ul(e)}`},l[y]),{value:0}];const c=t.mark,{fill:f,fillOpacity:h,cursor:g}=c,p=Vde(c,["fill","fillOpacity","cursor"]),m=U(p).reduce((y,x)=>(y[x]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(w=>w).join(" && "),value:p[x]},{value:null}],y),{});return[{name:`${i+Il}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:h}},update:l}},...n,{name:i+Il,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},g?{cursor:{value:g}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),m)}}]}};function Qde(e,t,n,i){const r=n.channel,s=n.signals.visual,o=n.signals.data,a=Io.defined(t),u=Ce(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=m=>`scale(${u}, ${m})`,h=e.getSizeSignalRef(r===nt?"width":"height").signal,g=`${r}(unit)`,p=d8(t,(m,y)=>[...m,{events:y.between[0],update:`[${g}, ${g}]`},{events:y,update:`[${s}[0], clamp(${g}, 0, ${h})]`}]);return p.push({events:{signal:t.name+XA},update:li(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},i?{init:Ll(i,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},i?{init:Ll(i)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${u}, ${s})`}]})]}function d8(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(q(`${i} is not an ordered event stream for interval selections.`),n),[])}const Kde={defined:e=>e.type==="point",signals:(e,t,n)=>{var i;const r=t.name,s=r+kd,o=t.project,a="(item().isVoronoi ? datum.datum : datum)",u=o.items.map(g=>{const p=e.fieldDef(g.channel);return(p==null?void 0:p.bin)?`[${a}[${Ce(e.vgField(g.channel,{}))}], ${a}[${Ce(e.vgField(g.channel,{binSuffix:"end"}))}]]`:`${a}[${Ce(g.field)}]`}).join(", "),l=`unit: ${Ul(e)}, fields: ${s}, values`,c=t.events,f=nn((i=e.component.selection)!==null&&i!==void 0?i:{}).reduce((g,p)=>p.type==="interval"?g.concat(p.name+Il):g,[]).map(g=>`indexof(item().mark.name, '${g}') < 0`).join(" && "),h="datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"");return n.concat([{name:r+Uo,on:c?[{events:c,update:`${h} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Bl(e,t,n,i){const r=e0(t)&&t.condition,s=i(t);if(r){const a=ut(r).map(u=>{const l=i(u);if(kce(u)){const{param:c,empty:f}=u,h=X8(e,{param:c,empty:f});return Object.assign({test:h},l)}else{const c=k0(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...a,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function QA(e,t="text"){const n=e.encoding[t];return Bl(e,n,t,i=>v0(i,e.config))}function v0(e,t,n="datum"){if(e){if(ir(e))return et(e.value);if(de(e)){const{format:i,formatType:r}=r0(e);return dA({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function h8(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(K(o))return{tooltip:p8({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Bl(e,o,"tooltip",u=>{const l=v0(u,r,a);if(l)return l;if(u===null)return;let c=Pe("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),he(c))return{value:c};if(Ge(c))return re(c)?c:c.content==="encoding"?p8(n,s,r,t):{signal:a}})}}function g8(e,t,n,{reactiveGeom:i}={}){const r={},s=i?"datum.datum":"datum",o=[];function a(l,c){const f=qa(c),h=Ci(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),g=h.title||wA(h,n),p=ut(g).join(", ");let m;if(Ir(c)){const y=c==="x"?"x2":"y2",x=Hr(e[y]);if(On(h.bin)&&x){const w=G(h,{expr:s}),E=G(x,{expr:s}),{format:A,formatType:S}=r0(h);m=Km(w,E,A,S,n),r[y]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:w,formatType:E}=r0(h);m=dA({fieldOrDatumDef:h,format:w,formatType:E,expr:s,config:n,normalizeStack:!0}).signal}}m!=null||(m=v0(h,n,s).signal),o.push({channel:c,key:p,value:m})}_A(e,(l,c)=>{Y(l)?a(l,c):t0(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!r[l]&&!u[c]&&(u[c]=f);return u}function p8(e,t,n,{reactiveGeom:i}={}){const r=g8(e,t,n,{reactiveGeom:i}),s=Eo(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function Jde(e){const{markDef:t,config:n}=e,i=Pe("aria",t,n);return i===!1?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),Zde(e)),ehe(e))}function Zde(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Pe("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in yue?{}:{ariaRoleDescription:{value:t}}}function ehe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Bl(e,s,"description",u=>v0(u,e.config));const o=Pe("description",n,i);if(o!=null)return{description:et(o)};if(i.aria===!1)return{};const a=g8(t,r,i);if(!Ue(a))return{description:{signal:Eo(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Tt(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u!=null||(u=Pe(e,i,s,{vgChannel:o,ignoreVgConfig:!0})),u!==void 0&&(a=et(u)));const l=r[e];return Bl(t,l,o!=null?o:e,c=>N6({channel:e,channelDef:c,markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function m8(e,t={filled:void 0}){var n,i,r,s;const{markDef:o,encoding:a,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Pe("filled",o,u),f=be(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,h=(r=(i=Pe(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&i!==void 0?i:u.mark[c===!0&&"color"])!==null&&r!==void 0?r:f,g=(s=Pe(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&s!==void 0?s:u.mark[c===!1&&"color"],p=c?"fill":"stroke",m=Object.assign(Object.assign({},h?{fill:et(h)}:{}),g?{stroke:et(g)}:{});return o.color&&(c?o.fill:o.stroke)&&q(u6("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},m),Tt("color",e,{vgChannel:p,defaultValue:c?h:g})),Tt("fill",e,{defaultValue:a.fill?h:void 0})),Tt("stroke",e,{defaultValue:a.stroke?g:void 0}))}function the(e){const{encoding:t,mark:n}=e,i=t.order;return!Mo(n)&&ir(i)?Bl(e,i,"zindex",r=>et(r.value)):{}}function Fd(e,t){const n=Qae(e),i=t[n];if(i)return i}function sn(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,u=r[e],l=r[Es(e)],c=t.scaleName(e),f=t.getScaleComponent(e),h=Fd(e,s),g=KA({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),p=!u&&Ir(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:nhe({channel:e,channelDef:u,channel2Def:l,markDef:s,config:o,scaleName:c,scale:f,stack:a,offset:h,defaultRef:g});return p?{[i||e]:p}:void 0}function nhe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(de(n)&&r&&t===r.fieldChannel){if(Y(n)){let a=n.bandPosition;if(a===void 0&&o.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return Qm({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Va(n,i,{suffix:"end"},{offset:s})}return cA(e)}function KA({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=qa(n),u=Co(n),l=Pe(n,s,o,{vgChannel:u});if(l!==void 0)return Ed(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!be([St.LOG,St.TIME,St.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Oi(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const ihe={left:"x",center:"xc",right:"x2"},rhe={top:"y",middle:"yc",bottom:"y2"};function y8(e,t,n,i="middle"){if(e==="radius"||e==="theta")return Co(e);const r=e==="x"?"align":"baseline",s=Pe(r,t,n);let o;return re(s)?(q(Gue(r)),o=void 0):o=s,e==="x"?ihe[o||(i==="top"?"left":"center")]:rhe[o||i]}function x0(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?b8(e,t,{defaultPos:n,defaultPos2:i}):sn(e,t,{defaultPos:n})}function b8(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=Es(e),a=Oi(e),u=she(t,i,o),l=u[a]?y8(e,r,s):Co(e);return Object.assign(Object.assign({},sn(e,t,{defaultPos:n,vgChannel:l})),u)}function she(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,u=qa(n),l=Oi(n),c=Co(n),f=i[u],h=e.scaleName(u),g=e.getScaleComponent(u),p=n in i||n in s?Fd(n,e.markDef):Fd(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const y=Oi(n),x=e.markDef[y];return x!=null?{[y]:{value:x}}:{[c]:{field:e.getName(n)}}}const m=ohe({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:a,scaleName:h,scale:g,stack:o,offset:p,defaultRef:void 0});return m!==void 0?{[c]:m}:w0(n,s)||w0(n,{[n]:zm(n,s,a.style),[l]:zm(l,s,a.style)})||w0(n,a[r])||w0(n,a.mark)||{[c]:KA({model:e,defaultPos:t,channel:n,scaleName:h,scale:g})()}}function ohe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l}){return de(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Va(t,s,{suffix:"start"},{offset:u}):cA({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:u,defaultRef:l})}function w0(e,t){const n=Oi(e),i=Co(e);if(t[i]!==void 0)return{[i]:Ed(e,t[i])};if(t[e]!==void 0)return{[i]:Ed(e,t[e])};if(t[n]){const r=t[n];if(Fl(r))q(Bue(n));else return{[n]:Ed(e,r)}}}function Bo(e,t,n){var i,r,s,o;const{config:a,encoding:u,markDef:l}=e,c=Es(t),f=Oi(t),h=u[t],g=u[c],p=e.getScaleComponent(t),m=p?p.get("type"):void 0,y=e.scaleName(t),x=l.orient,w=(r=(i=u[f])!==null&&i!==void 0?i:u.size)!==null&&r!==void 0?r:Pe("size",l,a,{vgChannel:f}),E=n==="bar"&&(t==="x"?x==="vertical":x==="horizontal");if(Y(h)&&(Ve(h.bin)||On(h.bin)||h.timeUnit&&!g)&&!(w&&!Fl(w))&&!rn(m)){const A=V6({channel:t,fieldDef:h,markDef:l,config:a,scaleType:m}),S=(s=e.component.axes[t])===null||s===void 0?void 0:s[0],O=(o=S==null?void 0:S.get("translate"))!==null&&o!==void 0?o:.5;return lhe({fieldDef:h,fieldDef2:g,channel:t,markDef:l,scaleName:y,bandSize:A,axisTranslate:O,spacing:Ir(t)?Pe("binSpacing",l,a):void 0,reverse:p.get("reverse"),config:a})}else return(de(h)&&rn(m)||E)&&!g?uhe(h,t,e):b8(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function ahe(e,t,n,i,r){if(Fl(r))if(n){const o=n.get("type");if(o==="band")return{scale:t,band:r.band};r.band!==1&&(q(Que(o)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(re(r))return r;if(r)return{value:r}}if(n){const o=n.get("range");if(Do(o)&&pt(o.step))return{value:o.step-2}}return{value:g0(i.view,e)-2}}function uhe(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=Oi(t),f=Es(t),h=a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let g;(r.size||i.size)&&(h?g=Tt("size",n,{vgChannel:c,defaultRef:et(i.size)}):q(ele(i.type)));const p=V6({channel:t,fieldDef:e,markDef:i,config:s,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:h});g=g||{[c]:ahe(c,u,l,s,p)};const m=(l==null?void 0:l.get("type"))!=="band"||!("band"in g[c])?"middle":"top",y=y8(t,i,s,m),x=y==="xc"||y==="yc",w=Fd(t,i),E=cA({channel:t,channelDef:e,markDef:i,config:s,scaleName:u,scale:l,stack:o,offset:w,defaultRef:KA({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:x?.5:re(p)?{signal:`(1-${p})/2`}:Fl(p)?(1-p.band)/2:0});if(c)return Object.assign({[y]:E},g);{const A=Co(f),S=g[c],O=w?Object.assign(Object.assign({},S),{offset:w}):S;return{[y]:E,[A]:K(E)?[E[0],Object.assign(Object.assign({},E[1]),{offset:O})]:Object.assign(Object.assign({},E),{offset:O})}}}function Dd(e,t,n,i,r){if(DN(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(re(n)||re(r)||re(i)){const o=Ss(n),a=Ss(r),u=Ss(i),l=u?`${u} + `:"",c=o?`(${o} ? -1 : 1) * `:"",f=a?`(${a} + ${s})`:s;return{signal:l+c+f}}else return r=r||0,i+(n?-r-s:+r+s)}function lhe({fieldDef:e,fieldDef2:t,channel:n,bandSize:i,scaleName:r,markDef:s,spacing:o=0,axisTranslate:a,reverse:u,config:l}){const c=Es(n),f=Co(n),h=Co(c),g=Fd(n,s),p=re(i)?{signal:`(1-${i.signal})/2`}:Fl(i)?(1-i.band)/2:.5;if(Ve(e.bin)||e.timeUnit)return{[h]:v8({channel:n,fieldDef:e,scaleName:r,markDef:s,bandPosition:p,offset:Dd(c,o,u,a,g),config:l}),[f]:v8({channel:n,fieldDef:e,scaleName:r,markDef:s,bandPosition:re(p)?{signal:`1-${p.signal}`}:1-p,offset:Dd(n,o,u,a,g),config:l})};if(On(e.bin)){const m=Va(e,r,{},{offset:Dd(c,o,u,a,g)});if(Y(t))return{[h]:m,[f]:Va(t,r,{},{offset:Dd(n,o,u,a,g)})};if(Ha(e.bin)&&e.bin.step)return{[h]:m,[f]:{signal:`scale("${r}", ${G(e,{expr:"datum"})} + ${e.bin.step})`,offset:Dd(n,o,u,a,g)}}}q(h6(c))}function v8({channel:e,fieldDef:t,scaleName:n,markDef:i,bandPosition:r,offset:s,config:o}){const a=Qm({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:s});return T6({fieldDef:t,channel:e,markDef:i,ref:a,config:o})}const che=new Set(["aria","width","height"]);function $i(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?m8(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fhe(e.markDef,t)),x8(e,"fill",n)),x8(e,"stroke",i)),Tt("opacity",e)),Tt("fillOpacity",e)),Tt("strokeOpacity",e)),Tt("strokeWidth",e)),Tt("strokeDash",e)),the(e)),h8(e)),QA(e,"href")),Jde(e))}function x8(e,t,n){const{config:i,mark:r,markDef:s}=e;if(Pe("invalid",s,i)==="hide"&&n&&!Mo(r)){const a=dhe(e,{invalid:!0,channels:Bm});if(a)return{[t]:[{test:a,value:null},...ut(n)]}}return n?{[t]:n}:{}}function fhe(e,t){return mue.reduce((n,i)=>(!che.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=et(e[i])),n),{})}function dhe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&li(u)&&(s[l]=!0)}return s},{}),r=U(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>fA(o,t)).join(` ${s} `)}}function JA(e){const{config:t,markDef:n}=e;if(Pe("invalid",n,t)){const r=hhe(e,{channels:Lr});if(r)return{defined:{signal:r}}}return{}}function hhe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&li(u)&&(s[l]=!0)}return s},{}),r=U(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>fA(o,t)).join(` ${s} `)}}function w8(e,t){if(t!==void 0)return{[e]:et(t)}}const ZA="voronoi",E8={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(ZA)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Mo(s))return q(wue(s)),n;const o={name:e.getName(ZA),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},h8(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{var f;const h=(f=l.name)!==null&&f!==void 0?f:"";h===e.component.mark[0].name?a=c:h.indexOf(ZA)>=0&&(u=!0)}),u||n.splice(a+1,0,o),n}},A8={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!FA(e.bind),parse:(e,t,n)=>M8(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=E8.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var c,f;const h=Ze(`${i}_${u.field}`);n.filter(p=>p.name===h).length||n.unshift(Object.assign(Object.assign({name:h},o?{init:Ll(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${Ce(u.field)}] : null`}]:[],bind:(f=(c=s[u.field])!==null&&c!==void 0?c:s[u.channel])!==null&&f!==void 0?f:s}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.filter(l=>l.name===i+Uo)[0],o=i+kd,a=r.items.map(l=>Ze(`${i}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},E0="_toggle",_8={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+E0,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Uo,i=t.name+E0;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Ul(e)}}, `)+`${i} ? ${n} : null`}},ghe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=he(t.clear)?Pl(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(A8.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===Ze(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+Uo);i(r,"null"),_8.defined(t)&&(r=n.findIndex(s=>s.name===t.name+E0),i(r,"false"))}return n}},S8={defined:e=>{const t=e.resolve==="global"&&e.bind&&FA(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Od;return t&&!n&&q(_ue),t&&n},parse:(e,t,n)=>{var i;const r=ge(n);if(r.select=he(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),M8(t,r),fe(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=ut((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.includes(a)||u.filter.push(a)}const s=DA(t.bind)?t.bind.legend:"click",o=he(s)?Pl(s,"view"):ut(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=DA(t.bind)&&t.bind.legend,s=o=>a=>{const u=ge(a);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${Ze(o.field)}_legend`,u=`${i}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(h=>h.name===i+Uo),o=i+kd,a=r.items.filter(h=>h.hasLegend).map(h=>Ze(`${i}_${Ze(h.field)}_legend`)),l=`${a.map(h=>`${h} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(h=>({signal:h})),update:l}):a.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(h=>h.name===i+E0),f=DA(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function phe(e,t,n){var i,r,s,o;const a=(i=e.fieldDef(t))===null||i===void 0?void 0:i.field;for(const u of nn((r=e.component.selection)!==null&&r!==void 0?r:{})){const l=(s=u.project.hasField[a])!==null&&s!==void 0?s:u.project.hasChannel[t];if(l&&S8.defined(u)){const c=(o=n.get("selections"))!==null&&o!==void 0?o:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const O8="_translate_anchor",C8="_translate_delta",mhe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Io.defined(t),s=i+O8,{x:o,y:a}=t.project.hasChannel;let u=Pl(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Il,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?`, extent_x: ${r?YA(e,nt):`slice(${o.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${r?YA(e,_t):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+C8,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&$8(e,t,o,"width",n),a!==void 0&&$8(e,t,a,"height",n),n}};function $8(e,t,n,i,r){var s,o;const a=t.name,u=a+O8,l=a+C8,c=n.channel,f=Io.defined(t),h=r.filter(_=>_.name===n.signals[f?"data":"visual"])[0],g=e.getSizeSignalRef(i).signal,p=e.getScaleComponent(c),m=p.get("type"),y=p.get("reverse"),x=f?c===nt?y?"":"-":y?"-":"":"",w=`${u}.extent_${c}`,E=`${x}${l}.${c} / ${f?`${g}`:`span(${w})`}`,A=f?m==="log"?"panLog":m==="symlog"?"panSymlog":m==="pow"?"panPow":"panLinear":"panLinear",S=f?m==="pow"?`, ${(s=p.get("exponent"))!==null&&s!==void 0?s:1}`:m==="symlog"?`, ${(o=p.get("constant"))!==null&&o!==void 0?o:1}`:"":"",O=`${A}(${w}, ${E}${S})`;h.on.push({events:{signal:l},update:f?O:`clampRange(${O}, 0, ${g})`})}const j8="_zoom_anchor",k8="_zoom_delta",yhe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Io.defined(t),s=i+k8,{x:o,y:a}=t.project.hasChannel,u=Ce(e.scaleName(nt)),l=Ce(e.scaleName(_t));let c=Pl(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Il,f))),n.push({name:i+j8,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&F8(e,t,o,"width",n),a!==void 0&&F8(e,t,a,"height",n),n}};function F8(e,t,n,i,r){var s,o;const a=t.name,u=n.channel,l=Io.defined(t),c=r.filter(A=>A.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(u),g=h.get("type"),p=l?YA(e,u):c.name,m=a+k8,y=`${a}${j8}.${u}`,x=l?g==="log"?"zoomLog":g==="symlog"?"zoomSymlog":g==="pow"?"zoomPow":"zoomLinear":"zoomLinear",w=l?g==="pow"?`, ${(s=h.get("exponent"))!==null&&s!==void 0?s:1}`:g==="symlog"?`, ${(o=h.get("constant"))!==null&&o!==void 0?o:1}`:"":"",E=`${x}(${p}, ${y}, ${m}${w})`;c.on.push({events:{signal:m},update:l?E:`clampRange(${E}, 0, ${f})`})}const Ja="_store",Uo="_tuple",bhe="_modify",D8="vlSelectionResolve",A0=[Kde,Xde,Yde,_8,A8,Io,S8,ghe,mhe,yhe,E8];function vhe(e){let t=e.parent;for(;t&&!ar(t);)t=t.parent;return t}function Ul(e,{escape:t}={escape:!0}){let n=t?Ce(e.name):e.name;const i=vhe(e);if(i){const{facet:r}=i;for(const s of Si)r[s]&&(n+=` + '__facet_${s}_' + (facet[${Ce(i.vgField(s))}])`)}return n}function e_(e){var t;return nn((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===Od),!1)}function M8(e,t){(Oe(t.select)||!t.select.on)&&delete e.events,(Oe(t.select)||!t.select.clear)&&delete e.clear,(Oe(t.select)||!t.select.toggle)&&delete e.toggle}const xhe="RawCode",whe="Literal",Ehe="Property",Ahe="Identifier",_he="ArrayExpression",She="BinaryExpression",Ohe="CallExpression",Che="ConditionalExpression",$he="LogicalExpression",jhe="MemberExpression",khe="ObjectExpression",Fhe="UnaryExpression";function rr(e){this.type=e}rr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Dhe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Dhe(e){switch(e.type){case _he:return e.elements;case She:case $he:return[e.left,e.right];case Ohe:return[e.callee].concat(e.arguments);case Che:return[e.test,e.consequent,e.alternate];case jhe:return[e.object,e.property];case khe:return e.properties;case Ehe:return[e.key,e.value];case Fhe:return[e.argument];case Ahe:case whe:case xhe:default:return[]}}var Yr,J,R,on,Ie,_0=1,Md=2,Za=3,zo=4,S0=5,eu=6,Yn=7,Td=8,Mhe=9;Yr={};Yr[_0]="Boolean";Yr[Md]="<end>";Yr[Za]="Identifier";Yr[zo]="Keyword";Yr[S0]="Null";Yr[eu]="Numeric";Yr[Yn]="Punctuator";Yr[Td]="String";Yr[Mhe]="RegularExpression";var The="ArrayExpression",Nhe="BinaryExpression",Rhe="CallExpression",Phe="ConditionalExpression",T8="Identifier",Lhe="Literal",Ihe="LogicalExpression",Bhe="MemberExpression",Uhe="ObjectExpression",zhe="Property",qhe="UnaryExpression",Nt="Unexpected token %0",Hhe="Unexpected number",Whe="Unexpected string",Ghe="Unexpected identifier",Yhe="Unexpected reserved word",Vhe="Unexpected end of input",t_="Invalid regular expression",n_="Invalid regular expression: missing /",N8="Octal literals are not allowed in strict mode.",Xhe="Duplicate data property in object literal not allowed in strict mode",qt="ILLEGAL",Nd="Disabled.",Qhe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Khe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function O0(e,t){if(!e)throw new Error("ASSERT: "+t)}function ks(e){return e>=48&&e<=57}function i_(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Rd(e){return"01234567".indexOf(e)>=0}function Jhe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Pd(e){return e===10||e===13||e===8232||e===8233}function Ld(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Qhe.test(String.fromCharCode(e))}function C0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Khe.test(String.fromCharCode(e))}const Zhe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function R8(){for(;R<on;){const e=J.charCodeAt(R);if(Jhe(e)||Pd(e))++R;else break}}function r_(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)R<on&&i_(J[R])?(i=J[R++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Me({},Nt,qt);return String.fromCharCode(r)}function ege(){var e,t,n,i;for(e=J[R],t=0,e==="}"&&Me({},Nt,qt);R<on&&(e=J[R++],!!i_(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Me({},Nt,qt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function P8(){var e,t;for(e=J.charCodeAt(R++),t=String.fromCharCode(e),e===92&&(J.charCodeAt(R)!==117&&Me({},Nt,qt),++R,e=r_("u"),(!e||e==="\\"||!Ld(e.charCodeAt(0)))&&Me({},Nt,qt),t=e);R<on&&(e=J.charCodeAt(R),!!C0(e));)++R,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),J.charCodeAt(R)!==117&&Me({},Nt,qt),++R,e=r_("u"),(!e||e==="\\"||!C0(e.charCodeAt(0)))&&Me({},Nt,qt),t+=e);return t}function tge(){var e,t;for(e=R++;R<on;){if(t=J.charCodeAt(R),t===92)return R=e,P8();if(C0(t))++R;else break}return J.slice(e,R)}function nge(){var e,t,n;return e=R,t=J.charCodeAt(R)===92?P8():tge(),t.length===1?n=Za:Zhe.hasOwnProperty(t)?n=zo:t==="null"?n=S0:t==="true"||t==="false"?n=_0:n=Za,{type:n,value:t,start:e,end:R}}function s_(){var e=R,t=J.charCodeAt(R),n,i=J[R],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++R,{type:Yn,value:String.fromCharCode(t),start:e,end:R};default:if(n=J.charCodeAt(R+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return R+=2,{type:Yn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:R};case 33:case 61:return R+=2,J.charCodeAt(R)===61&&++R,{type:Yn,value:J.slice(e,R),start:e,end:R}}}if(o=J.substr(R,4),o===">>>=")return R+=4,{type:Yn,value:o,start:e,end:R};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return R+=3,{type:Yn,value:s,start:e,end:R};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return R+=2,{type:Yn,value:r,start:e,end:R};if(r==="//"&&Me({},Nt,qt),"<>=!+-*%&|^/".indexOf(i)>=0)return++R,{type:Yn,value:i,start:e,end:R};Me({},Nt,qt)}function ige(e){let t="";for(;R<on&&i_(J[R]);)t+=J[R++];return t.length===0&&Me({},Nt,qt),Ld(J.charCodeAt(R))&&Me({},Nt,qt),{type:eu,value:parseInt("0x"+t,16),start:e,end:R}}function rge(e){let t="0"+J[R++];for(;R<on&&Rd(J[R]);)t+=J[R++];return(Ld(J.charCodeAt(R))||ks(J.charCodeAt(R)))&&Me({},Nt,qt),{type:eu,value:parseInt(t,8),octal:!0,start:e,end:R}}function L8(){var e,t,n;if(n=J[R],O0(ks(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=R,e="",n!=="."){if(e=J[R++],n=J[R],e==="0"){if(n==="x"||n==="X")return++R,ige(t);if(Rd(n))return rge(t);n&&ks(n.charCodeAt(0))&&Me({},Nt,qt)}for(;ks(J.charCodeAt(R));)e+=J[R++];n=J[R]}if(n==="."){for(e+=J[R++];ks(J.charCodeAt(R));)e+=J[R++];n=J[R]}if(n==="e"||n==="E")if(e+=J[R++],n=J[R],(n==="+"||n==="-")&&(e+=J[R++]),ks(J.charCodeAt(R)))for(;ks(J.charCodeAt(R));)e+=J[R++];else Me({},Nt,qt);return Ld(J.charCodeAt(R))&&Me({},Nt,qt),{type:eu,value:parseFloat(e),start:t,end:R}}function sge(){var e="",t,n,i,r,s=!1;for(t=J[R],O0(t==="'"||t==='"',"String literal must starts with a quote"),n=R,++R;R<on;)if(i=J[R++],i===t){t="";break}else if(i==="\\")if(i=J[R++],!i||!Pd(i.charCodeAt(0)))switch(i){case"u":case"x":J[R]==="{"?(++R,e+=ege()):e+=r_(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Rd(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),R<on&&Rd(J[R])&&(s=!0,r=r*8+"01234567".indexOf(J[R++]),"0123".indexOf(i)>=0&&R<on&&Rd(J[R])&&(r=r*8+"01234567".indexOf(J[R++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&J[R]===`
`&&++R;else{if(Pd(i.charCodeAt(0)))break;e+=i}return t!==""&&Me({},Nt,qt),{type:Td,value:e,octal:s,start:n,end:R}}function oge(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Me({},t_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Me({},t_)}try{return new RegExp(e,t)}catch{return null}}function age(){var e,t,n,i,r;for(e=J[R],O0(e==="/","Regular expression literal must start with a slash"),t=J[R++],n=!1,i=!1;R<on;)if(e=J[R++],t+=e,e==="\\")e=J[R++],Pd(e.charCodeAt(0))&&Me({},n_),t+=e;else if(Pd(e.charCodeAt(0)))Me({},n_);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Me({},n_),r=t.substr(1,t.length-2),{value:r,literal:t}}function uge(){var e,t,n;for(t="",n="";R<on&&(e=J[R],!!C0(e.charCodeAt(0)));)++R,e==="\\"&&R<on?Me({},Nt,qt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Me({},t_,n),{value:n,literal:t}}function lge(){var e,t,n,i;return Ie=null,R8(),e=R,t=age(),n=uge(),i=oge(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:R}}function cge(e){return e.type===Za||e.type===zo||e.type===_0||e.type===S0}function I8(){if(R8(),R>=on)return{type:Md,start:R,end:R};const e=J.charCodeAt(R);return Ld(e)?nge():e===40||e===41||e===59?s_():e===39||e===34?sge():e===46?ks(J.charCodeAt(R+1))?L8():s_():ks(e)?L8():s_()}function Vn(){const e=Ie;return R=e.end,Ie=I8(),R=e.end,e}function B8(){const e=R;Ie=I8(),R=e}function fge(e){const t=new rr(The);return t.elements=e,t}function U8(e,t,n){const i=new rr(e==="||"||e==="&&"?Ihe:Nhe);return i.operator=e,i.left=t,i.right=n,i}function dge(e,t){const n=new rr(Rhe);return n.callee=e,n.arguments=t,n}function hge(e,t,n){const i=new rr(Phe);return i.test=e,i.consequent=t,i.alternate=n,i}function o_(e){const t=new rr(T8);return t.name=e,t}function Id(e){const t=new rr(Lhe);return t.value=e.value,t.raw=J.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function z8(e,t,n){const i=new rr(Bhe);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function gge(e){const t=new rr(Uhe);return t.properties=e,t}function q8(e,t,n){const i=new rr(zhe);return i.key=t,i.value=n,i.kind=e,i}function pge(e,t){const n=new rr(qhe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Me(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(O0(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=R,n.description=r,n}function $0(e){e.type===Md&&Me(e,Vhe),e.type===eu&&Me(e,Hhe),e.type===Td&&Me(e,Whe),e.type===Za&&Me(e,Ghe),e.type===zo&&Me(e,Yhe),Me(e,Nt,e.value)}function an(e){const t=Vn();(t.type!==Yn||t.value!==e)&&$0(t)}function Ke(e){return Ie.type===Yn&&Ie.value===e}function a_(e){return Ie.type===zo&&Ie.value===e}function mge(){const e=[];for(R=Ie.start,an("[");!Ke("]");)Ke(",")?(Vn(),e.push(null)):(e.push(tu()),Ke("]")||an(","));return Vn(),fge(e)}function H8(){R=Ie.start;const e=Vn();return e.type===Td||e.type===eu?(e.octal&&Me(e,N8),Id(e)):o_(e.value)}function yge(){var e,t,n,i;if(R=Ie.start,e=Ie,e.type===Za)return n=H8(),an(":"),i=tu(),q8("init",n,i);if(e.type===Md||e.type===Yn)$0(e);else return t=H8(),an(":"),i=tu(),q8("init",t,i)}function bge(){var e=[],t,n,i,r={},s=String;for(R=Ie.start,an("{");!Ke("}");)t=yge(),t.key.type===T8?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Me({},Xhe):r[i]=!0,e.push(t),Ke("}")||an(",");return an("}"),gge(e)}function vge(){an("(");const e=u_();return an(")"),e}const xge={if:1};function wge(){var e,t,n;if(Ke("("))return vge();if(Ke("["))return mge();if(Ke("{"))return bge();if(e=Ie.type,R=Ie.start,e===Za||xge[Ie.value])n=o_(Vn().value);else if(e===Td||e===eu)Ie.octal&&Me(Ie,N8),n=Id(Vn());else{if(e===zo)throw new Error(Nd);e===_0?(t=Vn(),t.value=t.value==="true",n=Id(t)):e===S0?(t=Vn(),t.value=null,n=Id(t)):Ke("/")||Ke("/=")?(n=Id(lge()),B8()):$0(Vn())}return n}function Ege(){const e=[];if(an("("),!Ke(")"))for(;R<on&&(e.push(tu()),!Ke(")"));)an(",");return an(")"),e}function Age(){R=Ie.start;const e=Vn();return cge(e)||$0(e),o_(e.value)}function _ge(){return an("."),Age()}function Sge(){an("[");const e=u_();return an("]"),e}function Oge(){var e,t,n;for(e=wge();;)if(Ke("."))n=_ge(),e=z8(".",e,n);else if(Ke("("))t=Ege(),e=dge(e,t);else if(Ke("["))n=Sge(),e=z8("[",e,n);else break;return e}function W8(){const e=Oge();if(Ie.type===Yn&&(Ke("++")||Ke("--")))throw new Error(Nd);return e}function j0(){var e,t;if(Ie.type!==Yn&&Ie.type!==zo)t=W8();else{if(Ke("++")||Ke("--"))throw new Error(Nd);if(Ke("+")||Ke("-")||Ke("~")||Ke("!"))e=Vn(),t=j0(),t=pge(e.value,t);else{if(a_("delete")||a_("void")||a_("typeof"))throw new Error(Nd);t=W8()}}return t}function G8(e){let t=0;if(e.type!==Yn&&e.type!==zo)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Cge(){var e,t,n,i,r,s,o,a,u,l;if(e=Ie,u=j0(),i=Ie,r=G8(i),r===0)return u;for(i.prec=r,Vn(),t=[e,Ie],o=j0(),s=[u,i,o];(r=G8(Ie))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=U8(a,u,o),s.push(n);i=Vn(),i.prec=r,s.push(i),t.push(Ie),n=j0(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=U8(s[l-1].value,s[l-2],n),l-=2;return n}function tu(){var e,t,n;return e=Cge(),Ke("?")&&(Vn(),t=tu(),an(":"),n=tu(),e=hge(e,t,n)),e}function u_(){const e=tu();if(Ke(","))throw new Error(Nd);return e}function $ge(e){J=e,R=0,on=J.length,Ie=null,B8();const t=u_();if(Ie.type!==Md)throw new Error("Unexpect token after expression.");return t}function l_(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...l_(e.object)),t.push(...l_(e.property))),t)}function Y8(e){return e.object.type==="MemberExpression"?Y8(e.object):e.object.name==="datum"}function V8(e){const t=$ge(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&Y8(i)&&n.add(l_(i).slice(1).join("."))}),n}class zl extends ze{constructor(t,n,i){super(t);this.model=n,this.filter=i,this.expr=k0(this.model,this.filter,this),this._dependentFields=V8(this.expr)}clone(){return new zl(null,this.model,ge(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function jge(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const s of t){const o=Ze(s.name),a=s.select,u=he(a)?a:a.type,l=Ge(a)?ge(a):{type:u},c=r[u];for(const h in c)h==="fields"||h==="encodings"||(h==="mark"&&(l[h]=Object.assign(Object.assign({},c[h]),l[h])),(l[h]===void 0||l[h]===!0)&&(l[h]=(n=c[h])!==null&&n!==void 0?n:l[h]));const f=i[o]=Object.assign(Object.assign({},l),{name:o,type:u,init:s.value,bind:s.bind,events:he(l.on)?Pl(l.on,"scope"):ut(ge(l.on))});for(const h of A0)h.defined(f)&&h.parse&&h.parse(e,f,s)}return i}function X8(e,t,n,i="datum"){const r=he(t)?t:t.param,s=Ze(r),o=Ce(s+Ja);let a;try{a=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(a.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=a.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${o}, ${i}${a.resolve==="global"?")":`, ${Ce(a.resolve)})`}`,l=`length(data(${o}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function Q8(e,t,n){const i=Ze(t),r=n.encoding;let s=n.field,o;try{o=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=o.project.items[0].field,o.project.items.length>1&&q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Ce(s)}.`);else if(r&&!s){const a=o.project.items.filter(u=>u.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,q((a.length?"Multiple ":"No ")+`matching ${Ce(r)} encoding found for selection ${Ce(n.param)}. Using "field": ${Ce(s)}.`)):s=a[0].field}return`${o.name}[${Ce(Ai(s))}]`}function kge(e,t){var n;for(const[i,r]of Eo((n=e.component.selection)!==null&&n!==void 0?n:{})){const s=e.getName(`lookup_${i}`);e.component.data.outputNodes[s]=r.materialized=new jn(new zl(t,e,{param:i}),s,Xe.Lookup,e.component.data.outputNodeRefCounts)}}function k0(e,t,n){return fd(t,i=>he(i)?i:Rle(i)?X8(e,i,n):w6(i))}var F0=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Fge(e,t){if(!!e)return K(e)&&!Fo(e)?e.map(n=>wA(n,t)).join(", "):e}function c_(e,t,n,i){var r,s,o,a,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(s=(a=e.encode)[t])!==null&&s!==void 0||(a[t]={}),(o=(u=e.encode[t]).update)!==null&&o!==void 0||(u.update={}),e.encode[t].update[n]=i}function Bd(e,t,n,i={header:!1}){var r,s;const o=e.combine(),{disable:a,orient:u,scale:l,labelExpr:c,title:f,zindex:h}=o,g=F0(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const p in g){const m=Hce[p],y=g[p];if(m&&m!==t&&m!=="both")delete g[p];else if(Sd(y)){const{condition:x}=y,w=F0(y,["condition"]),E=ut(x),A=iR[p];if(A){const{vgProp:S,part:O}=A,_=[...E.map(C=>{const{test:j}=C,$=F0(C,["test"]);return Object.assign({test:k0(null,j)},$)}),w];c_(g,O,S,_),delete g[p]}else if(A===null){const S={signal:E.map(O=>{const{test:_}=O,C=F0(O,["test"]);return`${k0(null,_)} ? ${GN(C)} : `}).join("")+GN(w)};g[p]=S}}else if(re(y)){const x=iR[p];if(x){const{vgProp:w,part:E}=x;c_(g,E,w,y),delete g[p]}}be(["labelAlign","labelBaseline"],p)&&g[p]===null&&delete g[p]}if(t==="grid"){if(!g.grid)return;if(g.encode){const{grid:p}=g.encode;g.encode=Object.assign({},p?{grid:p}:{}),Ue(g.encode)&&delete g.encode}return Object.assign(Object.assign({scale:l,orient:u},g),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:mt(h,0)})}else{if(!i.header&&e.mainExtracted)return;if(c!==void 0){let m=c;((s=(r=g.encode)===null||r===void 0?void 0:r.labels)===null||s===void 0?void 0:s.update)&&re(g.encode.labels.update.text)&&(m=Ba(c,"datum.label",g.encode.labels.update.text.signal)),c_(g,"labels","text",{signal:m})}if(g.labelAlign===null&&delete g.labelAlign,g.encode){for(const m of rR)e.hasAxisPart(m)||delete g.encode[m];Ue(g.encode)&&delete g.encode}const p=Fge(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),g),n.aria===!1?{aria:!1}:{}),{zindex:mt(h,0)})}}}function K8(e){const{axes:t}=e.component,n=[];for(const i of Lr)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function Dge(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Bd(r,"grid",t)),...i.map(r=>Bd(r,"grid",t)),...n.map(r=>Bd(r,"main",t)),...i.map(r=>Bd(r,"main",t))].filter(r=>r)}function J8(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...U(o),...U(a)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${s}" ? ${Ss(o[c])} : ${Ss(a[c])}`};return l}return t[r]})])}function Mge(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:Yle(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=re(n)?"axisOrient":`axis${dd(n)}`,a=[...r,...r.map(l=>s+l.substr(4))],u=["axis",o,s];return{vlOnlyAxisConfig:J8(a,i,e,n),vgAxisConfig:J8(u,i,e,n),axisConfigStyle:Tge([...u,...a],i)}}function Tge(e,t){var n;const i=[{}];for(const r of e){let s=(n=t[r])===null||n===void 0?void 0:n.style;if(s){s=ut(s);for(const o of s)i.push(t.style[o])}}return Object.assign.apply(null,i)}function f_(e,t,n,i={}){var r;const s=VN(e,n,t);if(s!==void 0)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((r=i[o])===null||r===void 0?void 0:r[e])!==void 0)return{configFrom:o,configValue:i[o][e]};return{}}const Z8={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return L6(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return I6(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(i=t.grid)!==null&&i!==void 0?i:Nge(n,e)},gridScale:({model:e,channel:t})=>Rge(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||t4(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||e4(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!==null&&i!==void 0?i:Lge(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!==null&&i!==void 0?i:Ige(t.type,n,Y(t)&&!!t.timeUnit,Y(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var s;const o=e==="x"?"width":e==="y"?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:Uge({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=n4(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return QN(r?[G6(r)]:[],Y(o)?[G6(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>zge(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!==null&&i!==void 0?i:qge(n,t)}};function Nge(e,t){return!rn(e)&&Y(t)&&!Ve(t==null?void 0:t.bin)&&!On(t==null?void 0:t.bin)}function Rge(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Pge(e,t,n,i,r){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return re(s)?s:hd(s);{const{configValue:o}=f_("labelAngle",i,t==null?void 0:t.style,r);return o!==void 0?hd(o):n===nt&&be([rA,iA],e.type)&&!(Y(e)&&e.timeUnit)?270:void 0}}function d_(e){return`(((${e.signal} % 360) + 360) % 360)`}function e4(e,t,n,i){if(e!==void 0)if(n==="x"){if(re(e)){const r=d_(e),s=re(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(re(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(re(e)){const r=d_(e),s=re(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(re(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function t4(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(re(e)){const o=d_(e),a=re(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(re(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function Lge(e,t){if(t==="x"&&be(["quantitative","temporal"],e))return!0}function Ige(e,t,n,i){if(n&&!Ge(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function Bge(e){return e==="x"?"bottom":"left"}function Uge({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!rn(t)&&t!=="log"){if(Y(e)){if(Ve(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&be(["month","hours","day","quarter"],(r=Cn(e.timeUnit))===null||r===void 0?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function n4(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return KN(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function zge(e,t){const n=e.values;if(K(n))return nR(t,n);if(re(n))return n}function qge(e,t){return e==="rect"&&i0(t)?1:0}class ql extends ze{constructor(t,n){super(t);this.transform=n,this._dependentFields=V8(this.transform.calculate)}clone(){return new ql(null,ge(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(!!Qa(i)&&W6(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,u=a.map((l,c)=>`${w6({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new ql(t,{calculate:u,as:Hl(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ae(this.transform)}`}}function Hl(e,t,n){return G(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function D0(e,t){return be(["top","bottom"],t)?"column":be(["left","right"],t)||e==="row"?"row":"column"}function Wl(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return mt((t||{})[e],r[e],n.header[e])}function M0(e,t,n,i){const r={};for(const s of e){const o=Wl(s,t||{},n,i);o!==void 0&&(r[s]=o)}return r}const h_=["row","column"],g_=["header","footer"];function Hge(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=M0(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=D0(t,a),l=hd(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),r4(l,u)),i4(u,l,s)),s4(i,r,t,hfe,AR))}}function i4(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=t4(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function r4(e,t){const n=e4(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Wge(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of g_)if(n[r])for(const s of n[r]){const o=Yge(e,t,r,n,s);o!=null&&i.push(o)}return i}function Gge(e,t){var n;const{sort:i}=e;return zr(i)?{field:G(i,{expr:"datum"}),order:(n=i.order)!==null&&n!==void 0?n:"ascending"}:K(i)?{field:Hl(e,t,{expr:"datum"}),order:"ascending"}:{field:G(e,{expr:"datum"}),order:i!=null?i:"ascending"}}function p_(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:u}=M0(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=dA({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=D0(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Ba(Ba(u,"datum.label",l),"datum.value",G(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),r4(s,c)),i4(c,s,o)),s4(n,e,t,gfe,_R))}function Yge(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:f}=M0(["labelOrient"],o.header,a,t);(t==="row"&&!be(["top","bottom"],f)||t==="column"&&!be(["left","right"],f))&&(s=p_(o,t,a))}const u=ar(e)&&!Ad(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(s||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:Gge(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const Vge={column:{start:0,end:1},row:{start:1,end:0}};function Xge(e,t){return Vge[t][e]}function Qge(e,t){const n={};for(const i of Si){const r=e[i];if(r==null?void 0:r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=M0(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=D0(i,o),u=Xge(s,a);u!==void 0&&(n[a]=u)}}return Ue(n)?void 0:n}function s4(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=Wl(o,t==null?void 0:t.header,e,n);a!==void 0&&(s[r[o]]=a)}return s}function m_(e){return[...T0(e,"width"),...T0(e,"height"),...T0(e,"childWidth"),...T0(e,"childHeight")]}function T0(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(rn(o)&&Do(a)){const u=e.scaleName(n);return ar(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[o4(u,a)]:[o4(u,a),{name:r,update:a4(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=RA(e.config.view,s?"width":"height"),u=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function o4(e,t){return{name:`${e}_step`,value:t.step}}function a4(e,t,n){const i=t.get("type"),r=t.get("padding"),s=mt(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${Ss(o)}, ${Ss(s)}) * ${e}_step`}function u4(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function l4(e,t){return U(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),Bl(t,r,i,s=>et(s.value)))},{})}function c4(e,t){if(ar(t))return e==="theta"?"independent":"shared";if(Vl(t))return"shared";if(D_(t))return Ir(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function y_(e,t){const n=e.scale[t],i=Ir(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&q(sle(t)),"independent"):e[i][t]||"shared"}const Kge=Object.assign(Object.assign({},yfe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),f4=U(Kge);class Jge extends $s{}const d4={symbols:Zge,gradient:epe,labels:tpe,entries:npe};function Zge(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){var o,a,u,l,c,f,h,g;if(s!=="symbol")return;const{markDef:p,encoding:m,config:y,mark:x}=n,w=p.filled&&x!=="trail";let E=Object.assign(Object.assign({},bue({},n,gce)),m8(n,{filled:w}));const A=(o=r.get("symbolOpacity"))!==null&&o!==void 0?o:y.legend.symbolOpacity,S=(a=r.get("symbolFillColor"))!==null&&a!==void 0?a:y.legend.symbolFillColor,O=(u=r.get("symbolStrokeColor"))!==null&&u!==void 0?u:y.legend.symbolStrokeColor,_=A===void 0?(l=h4(m.opacity))!==null&&l!==void 0?l:p.opacity:void 0;if(E.fill){if(i==="fill"||w&&i===Hn)delete E.fill;else if(E.fill.field)S?delete E.fill:(E.fill=et((c=y.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),E.fillOpacity=et(_!=null?_:1));else if(K(E.fill)){const C=(g=(h=b_((f=m.fill)!==null&&f!==void 0?f:m.color))!==null&&h!==void 0?h:p.fill)!==null&&g!==void 0?g:w&&p.color;C&&(E.fill=et(C))}}if(E.stroke){if(i==="stroke"||!w&&i===Hn)delete E.stroke;else if(E.stroke.field||O)delete E.stroke;else if(K(E.stroke)){const C=mt(b_(m.stroke||m.color),p.stroke,w?p.color:void 0);C&&(E.stroke={value:C})}}if(i!==ws){const C=Y(t)&&p4(n,r,t);C?E.opacity=[Object.assign({test:C},et(_!=null?_:1)),et(y.legend.unselectedOpacity)]:_&&(E.opacity=et(_))}return E=Object.assign(Object.assign({},E),e),Ue(E)?void 0:E}function epe(e,{model:t,legendType:n,legendCmpt:i}){var r;if(n!=="gradient")return;const{config:s,markDef:o,encoding:a}=t;let u={};const c=((r=i.get("gradientOpacity"))!==null&&r!==void 0?r:s.legend.gradientOpacity)===void 0?h4(a.opacity)||o.opacity:void 0;return c&&(u.opacity=et(c)),u=Object.assign(Object.assign({},u),e),Ue(u)?void 0:u}function tpe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=Y(t)?p4(n,r,t):void 0,u=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s,f=Xa(c)?hA({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,h=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Ue(h)?void 0:h}function npe(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function h4(e){return g4(e,(t,n)=>Math.max(t,n.value))}function b_(e){return g4(e,(t,n)=>mt(t,n.value))}function g4(e,t){if(Dce(e))return ut(e.condition).reduce(t,e.value);if(ir(e))return e.value}function p4(e,t,n){const i=t.get("selections");if(!(i==null?void 0:i.length))return;const r=Ce(n.field);return i.map(s=>`(!length(data(${Ce(Ze(s)+Ja)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const m4={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return L6(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return I6(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return(n=(t=i.gradientLength)!==null&&t!==void 0?t:r.gradientLength)!==null&&n!==void 0?n:lpe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!==null&&i!==void 0?i:t.labelOverlap)!==null&&r!==void 0?r:cpe(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!==null&&r!==void 0?r:rpe(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Dl(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Cl(n)&&nr(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>ipe(t,e)};function ipe(e,t){const n=e.values;if(K(n))return nR(t,n);if(re(n))return n}function rpe(e,t,n,i){var r;if(t!=="shape"){const s=(r=b_(n))!==null&&r!==void 0?r:i;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function spe(e){const{legend:t}=e;return mt(t.type,ope(e))}function ope({channel:e,timeUnit:t,scaleType:n}){if(Cl(e)){if(be(["quarter","month","day"],t))return"symbol";if(nr(n))return"gradient"}return"symbol"}function ape({legendConfig:e,legendType:t,orient:n,legend:i}){var r,s;return(s=(r=i.direction)!==null&&r!==void 0?r:e[t?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:upe(n,t)}function upe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function lpe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(nr(r))return n==="horizontal"?i==="top"||i==="bottom"?y4(t,"width",o,s):o:y4(t,"height",u,a)}function y4(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function cpe(e){if(be(["quantile","threshold","log","symlog"],e))return"greedy"}function b4(e){const t=yt(e)?fpe(e):ppe(e);return e.component.legends=t,t}function fpe(e){const{encoding:t}=e,n={};for(const i of[Hn,...OR]){const r=Ot(t[i]);!r||!e.getScaleComponent(i)||i===Wn&&Y(r)&&r.type===kl||(n[i]=gpe(e,i))}return n}function dpe(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function hpe(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function gpe(e,t){var n,i,r;let s=e.legend(t);const{markDef:o,encoding:a,config:u}=e,l=u.legend,c=new Jge({},dpe(e,t));phe(e,t,c);const f=s!==void 0?!s:l.disable;if(c.set("disable",f,s!==void 0),f)return c;s=s||{};const h=e.getScaleComponent(t).get("type"),g=Ot(a[t]),p=Y(g)?(n=Cn(g.timeUnit))===null||n===void 0?void 0:n.unit:void 0,m=s.orient||u.legend.orient||"right",y=spe({legend:s,channel:t,timeUnit:p,scaleType:h}),x=ape({legend:s,legendType:y,orient:m,legendConfig:l}),w={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:g,legendConfig:l,config:u,scaleType:h,orient:m,legendType:y,direction:x};for(const _ of f4){if(y==="gradient"&&_.startsWith("symbol")||y==="symbol"&&_.startsWith("gradient"))continue;const C=_ in m4?m4[_](w):s[_];if(C!==void 0){const j=hpe(C,_,s,e.fieldDef(t));(j||u.legend[_]===void 0)&&c.set(_,C,j)}}const E=(i=s==null?void 0:s.encoding)!==null&&i!==void 0?i:{},A=c.get("selections"),S={},O={fieldOrDatumDef:g,model:e,channel:t,legendCmpt:c,legendType:y};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const C=l4((r=E[_])!==null&&r!==void 0?r:{},e),j=_ in d4?d4[_](C,O):C;j!==void 0&&!Ue(j)&&(S[_]=Object.assign(Object.assign(Object.assign({},(A==null?void 0:A.length)&&Y(g)?{name:`${Ze(g.field)}_legend_${_}`}:{}),(A==null?void 0:A.length)?{interactive:!!A}:{}),{update:j}))}return Ue(S)||c.set("encode",S,!!(s==null?void 0:s.encoding)),c}function ppe(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){b4(i);for(const r of U(i.component.legends))n.legend[r]=y_(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=v4(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of U(t))for(const r of e.children)!r.component.legends[i]||n.legend[i]==="shared"&&delete r.component.legends[i];return t}function v4(e,t){var n,i,r,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let u=!1;for(const l of f4){const c=Po(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,h)=>{switch(l){case"symbolType":return mpe(f,h);case"title":return JN(f,h);case"type":return u=!0,ci("symbol")}return m0(f,h,l,"legend")});e.setWithExplicit(l,c)}return u&&(((i=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||i===void 0?void 0:i.gradient)&&Dm(e.implicit,["encode","gradient"]),((s=(r=e.explicit)===null||r===void 0?void 0:r.encode)===null||s===void 0?void 0:s.gradient)&&Dm(e.explicit,["encode","gradient"])),e}function mpe(e,t){return t.value==="circle"?t:e}var ype=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function bpe(e,t,n,i){var r,s,o,a,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(s=(a=e.encode)[t])!==null&&s!==void 0||(a[t]={}),(o=(u=e.encode[t]).update)!==null&&o!==void 0||(u.update={}),e.encode[t].update[n]=i}function x4(e){const t=e.component.legends,n={};for(const r of U(t)){const s=e.getScaleComponent(r),o=Ye(s.get("domains"));if(n[o])for(const a of n[o])v4(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return nn(n).flat().map(r=>vpe(r,e.config)).filter(r=>r!==void 0)}function vpe(e,t){var n,i,r;const s=e.combine(),{disable:o,labelExpr:a,selections:u}=s,l=ype(s,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of OR)l[f]&&delete c[f]}if(l.title||delete l.title,a!==void 0){let c=a;((r=(i=l.encode)===null||i===void 0?void 0:i.labels)===null||r===void 0?void 0:r.update)&&re(l.encode.labels.update.text)&&(c=Ba(a,"datum.label",l.encode.labels.update.text.signal)),bpe(l,"labels","text",{signal:c})}return l}}function xpe(e){return Vl(e)||D_(e)?wpe(e):w4(e)}function wpe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),w4(e))}function w4(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const u=re(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return be(o,u)||o.push(u),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}else return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Epe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class E4 extends $s{constructor(t,n,i,r){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function A4(e){e.component.projection=yt(e)?Ape(e):Ope(e)}function Ape(e){var t;if(e.hasProjection){const n=Gn(e.specifiedProjection),i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?_pe(e):void 0,o=new E4(e.projectionName(!0),Object.assign(Object.assign({},(t=Gn(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),r,s);return o.get("type")||o.set("type","equalEarth",!1),o}}function _pe(e){const t=[],{encoding:n}=e;for(const i of[[Nr,Tr],[_i,tr]])(Ot(n[i[0]])||Ot(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Wn)&&e.typedFieldDef(Wn).type===kl&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Xe.Main)),t}function Spe(e,t){const n=CE(Epe,r=>!!(!El(e.explicit,r)&&!El(t.explicit,r)||El(e.explicit,r)&&El(t.explicit,r)&&kr(e.get(r),t.get(r))));if(kr(e.size,t.size)){if(n)return e;if(kr(e.explicit,{}))return t;if(kr(t.explicit,{}))return e}return null}function Ope(e){if(e.children.length===0)return;let t;for(const i of e.children)A4(i);const n=CE(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=Spe(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new E4(i,t.specifiedProjection,t.size,ge(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}var Cpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function $pe(e,t,n,i){var r,s;if(_d(t,n)){const o=yt(e)?(s=(r=e.axis(n))!==null&&r!==void 0?r:e.legend(n))!==null&&s!==void 0?s:{}:{},a=G(t,{expr:"datum"}),u=G(t,{expr:"datum",binSuffix:"end"});return{formulaAs:G(t,{binSuffix:"range",forAs:!0}),formula:Km(a,u,o.format,o.formatType,i)}}return{}}function _4(e,t){return`${UN(e)}_${t}`}function jpe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function v_(e,t,n){var i;const r=(i=o0(n,void 0))!==null&&i!==void 0?i:{},s=_4(r,t);return e.getName(`${s}_bins`)}function kpe(e){return"as"in e}function S4(e,t,n){let i,r;kpe(e)?i=he(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[G(e,{forAs:!0}),G(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},o0(t,void 0)),o=_4(s,e.field),{signal:a,extentSignal:u}=jpe(n,o);if(Um(s.extent)){const c=s.extent;r=Q8(n,c.param,c),delete s.extent}const l=Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[i]},a?{signal:a}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:o,binComponent:l}}class Vr extends ze{constructor(t,n){super(t);this.bins=n}clone(){return new Vr(null,ge(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Ci(s)&&Ve(s.bin)){const{key:a,binComponent:u}=S4(s,s.bin,n);r[a]=Object.assign(Object.assign(Object.assign({},u),r[a]),$pe(n,s,o,n.config))}return r},{});return Ue(i)?null:new Vr(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=S4(n,n.bin,i);return new Vr(t,{[r]:s})}merge(t,n){for(const i of U(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Fr([...this.bins[i].as,...t.bins[i].as],Ae)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(nn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(nn(this.bins).map(t=>t.field))}hash(){return`Bin ${Ae(this.bins)}`}assemble(){return nn(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,s=t.bin,{extent:o}=s,a=Cpe(s,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Ai(t.field),as:i,signal:t.signal},Um(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:Ai(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:G({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function Fpe(e,t,n,i){var r;const s=yt(i)?i.encoding[Es(t)]:void 0;if(Ci(n)&&yt(i)&&X6(n,s,i.markDef,i.config))e.add(G(n,{})),e.add(G(n,{suffix:"end"})),n.bin&&_d(n,t)&&e.add(G(n,{binSuffix:"range"}));else if(qae(t)){const o=zae(t);e.add(i.getName(o))}else e.add(G(n));return Qa(n)&&ice((r=n.scale)===null||r===void 0?void 0:r.range)&&e.add(n.scale.range.field),e}function Dpe(e,t){var n;for(const i of U(t)){const r=t[i];for(const s of U(r))i in e?e[i][s]=new Set([...(n=e[i][s])!==null&&n!==void 0?n:[],...r[s]]):e[i]={[s]:r[s]}}}class sr extends ze{constructor(t,n,i){super(t);this.dimensions=n,this.measures=i}clone(){return new sr(null,new Set(this.dimensions),ge(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{var u,l,c,f;const{aggregate:h,field:g}=o;if(h)if(h==="count")(u=r["*"])!==null&&u!==void 0||(r["*"]={}),r["*"].count=new Set([G(o,{forAs:!0})]);else{if(As(h)||ko(h)){const p=As(h)?"argmin":"argmax",m=h[p];(l=r[m])!==null&&l!==void 0||(r[m]={}),r[m][p]=new Set([G({op:p,field:m},{forAs:!0})])}else(c=r[g])!==null&&c!==void 0||(r[g]={}),r[g][h]=new Set([G(o,{forAs:!0})]);jo(a)&&n.scaleDomain(a)==="unaggregated"&&((f=r[g])!==null&&f!==void 0||(r[g]={}),r[g].min=new Set([G({field:g,aggregate:"min"},{forAs:!0})]),r[g].max=new Set([G({field:g,aggregate:"max"},{forAs:!0})]))}else Fpe(s,a,o,n)}),s.size+U(r).length===0)?null:new sr(t,s,r)}static makeFromTransform(t,n){var i,r,s;const o=new Set,a={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((i=a["*"])!==null&&i!==void 0||(a["*"]={}),a["*"].count=new Set([f||G(u,{forAs:!0})])):((r=a[c])!==null&&r!==void 0||(a[c]={}),a[c][l]=new Set([f||G(u,{forAs:!0})])))}for(const u of(s=n.groupby)!==null&&s!==void 0?s:[])o.add(u);return o.size+U(a).length===0?null:new sr(t,o,a)}merge(t){return SN(this.dimensions,t.dimensions)?(Dpe(this.measures,t.measures),!0):(wle("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...U(this.measures)])}producedFields(){const t=new Set;for(const n of U(this.measures))for(const i of U(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ae({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of U(this.measures))for(const o of U(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:Ai(s));return{type:"aggregate",groupby:[...this.dimensions].map(Ai),ops:t,fields:n,as:i}}}class Gl extends ze{constructor(t,n,i,r){super(t);this.model=n,this.name=i,this.data=r;for(const s of Si){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[G(o),...Ve(a)?[G(o,{binSuffix:"end"})]:[]]},zr(u)?{sortField:u}:K(u)?{sortIndexField:Hl(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Si)this[n]&&(t+=` ${n.charAt(0)}:${Ae(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Si)((t=this[i])===null||t===void 0?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Si)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Lr){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(rn(r)&&Do(s)){const o=R0(this.childModel,n),a=j_(o);a?t[n]=a:q(zE(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=Jm,field:f}=u;s.push(f),o.push(c),a.push(G(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of h_){for(const f of g_){const h=(n=s[c]&&s[c][f])!==null&&n!==void 0?n:[];for(const g of h)if(((i=g.axes)===null||i===void 0?void 0:i.length)>0){a[c]=!0;break}}if(a[c]){const f=`length(data("${this.facet.name}"))`,h=c==="row"?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:h}]})}}const{row:u,column:l}=a;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const i=[];let r=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:u}=this;if(o&&a&&(s.x||s.y)){r=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=s.x)!==null&&t!==void 0?t:[],(n=s.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[ys,ms])this[l]&&i.push(this.assembleRowColumnHeaderData(l,r,s));if(u){const l=this.assembleFacetHeaderData(s);l&&i.push(...l)}return i}}function O4(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function Mpe(e,t){const n=FE(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=O4(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=O4(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return q(Fue(t)),null}function Tpe(e){const t={};return Fm(e.filter,n=>{var i;if(x6(n)){let r=null;XE(n)?r=ui(n.equal):KE(n)?r=ui(n.lte):QE(n)?r=ui(n.lt):JE(n)?r=ui(n.gt):ZE(n)?r=ui(n.gte):eA(n)?r=n.range[0]:tA(n)&&(r=((i=n.oneOf)!==null&&i!==void 0?i:n.in)[0]),r&&(Ga(r)?t[n.field]="date":pt(r)?t[n.field]="number":he(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function Npe(e){const t={};function n(i){Tl(i)?t[i.field]="date":i.type==="quantitative"&&uue(i.aggregate)?t[i.field]="number":Ol(i.field)>1?i.field in t||(t[i.field]="flatten"):Qa(i)&&zr(i.sort)&&Ol(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((yt(e)||ar(e))&&e.forEachFieldDef((i,r)=>{if(Ci(i))n(i);else{const s=qa(r),o=e.fieldDef(s);n(Object.assign(Object.assign({},i),{type:o.type}))}}),yt(e)){const{mark:i,markDef:r,encoding:s}=e;if(Mo(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];Y(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function Rpe(e){const t={};if(yt(e)&&e.component.selection)for(const n of U(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Ol(r.field)>1&&(t[r.field]="flatten")}return t}class un extends ze{constructor(t,n){super(t);this._parse=n}clone(){return new un(null,ge(this._parse))}hash(){return`Parse ${Ae(this._parse)}`}static makeExplicit(t,n,i){var r;let s={};const o=n.data;return!Lo(o)&&((r=o==null?void 0:o.format)===null||r===void 0?void 0:r.parse)&&(s=o.format.parse),this.makeWithAncestors(t,s,{},i)}static makeWithAncestors(t,n,i,r){for(const a of U(i)){const u=r.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===i[a]||u.value==="derived"||i[a]==="flatten"?delete i[a]:q(s6(a,i[a],u.value)))}for(const a of U(n)){const u=r.get(a);u!==void 0&&(u===n[a]?delete n[a]:q(s6(a,n[a],u)))}const s=new $s(n,i);r.copyAll(s);const o={};for(const a of U(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return U(o).length===0||r.parseNothing?null:new un(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of U(this._parse)){const i=this._parse[n];Ol(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(U(this._parse))}dependentFields(){return new Set(U(this._parse))}assembleTransforms(t=!1){return U(this._parse).filter(n=>t?Ol(n)>1:!0).map(n=>{const i=Mpe(n,this._parse[n]);return i?{type:"formula",expr:i,as:DE(n)}:null}).filter(n=>n!==null)}}class qo extends ze{clone(){return new qo(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Od])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Od}}}class Ud extends ze{constructor(t,n){super(t);this.params=n}clone(){return new Ud(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ae(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class zd extends ze{constructor(t,n){super(t);this.params=n}clone(){return new zd(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${Ae(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class nu extends ze{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(Lo(t)||(n=t.format?Object.assign({},ai(t.format,["parse"])):{}),$d(t))this._data={values:t.values};else if(Rl(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];be(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else i8(t)?this._data={values:[{type:"Sphere"}]}:(t8(t)||Lo(t))&&(this._data={});this._generator=Lo(t),t.name&&(this._name=t.name),n&&!Ue(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var C4=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},Ppe=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},qd;function x_(e){return e instanceof nu||e instanceof Ud||e instanceof zd}class w_{constructor(){qd.set(this,void 0),C4(this,qd,!1,"f")}setModified(){C4(this,qd,!0,"f")}get modifiedFlag(){return Ppe(this,qd,"f")}}qd=new WeakMap;class iu extends w_{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class E_ extends w_{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class Lpe extends E_{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of U(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class Ipe extends E_{constructor(t){super();this.requiresSelectionId=t&&e_(t)}run(t){t instanceof qo&&(this.requiresSelectionId&&(x_(t.parent)||t.parent instanceof sr||t.parent instanceof un)||(this.setModified(),t.remove()))}}class Bpe extends w_{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof Gr&&(i=t.producedFields(),$E(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class Upe extends E_{constructor(){super()}run(t){t instanceof jn&&!t.isRequired()&&(this.setModified(),t.remove())}}class zpe extends iu{run(t){if(!x_(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof un)if(t instanceof un)this.setModified(),t.merge(n);else{if(kE(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class qpe extends iu{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof un);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const u of U(a))u in r?r[u]!==a[u]&&s.add(u):r[u]=a[u]}for(const o of s)delete r[o];if(!Ue(r)){this.setModified();const o=new un(t,r);for(const a of n){if(a instanceof un)for(const u of U(r))delete a.parse[u];t.removeChild(a),a.parent=o,a instanceof un&&U(a.parse).length===0&&a.remove()}}}}}class Hpe extends iu{run(t){t instanceof jn||t.numChildren()>0||t instanceof Gl||t instanceof nu||(this.setModified(),t.remove())}}class Wpe extends iu{run(t){const n=t.children.filter(r=>r instanceof Gr),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class Gpe extends iu{run(t){const n=t.children.filter(r=>r instanceof sr),i={};for(const r of n){const s=Ae(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of U(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class Ype extends iu{constructor(t){super();this.model=t}run(t){const n=!(x_(t)||t instanceof zl||t instanceof un||t instanceof qo),i=[],r=[];for(const s of t.children)s instanceof Vr&&(n&&!kE(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof Vr?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class Vpe extends iu{run(t){const n=[...t.children];if(!Sl(n,o=>o instanceof jn)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof jn){let a=o;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof jn)a=u;else break}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class ru extends ze{constructor(t,n){super(t);this.transform=n}clone(){return new ru(null,ge(this.transform))}addDimensions(t){this.transform.groupby=Fr(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`JoinAggregateTransform ${Ae(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function Xpe(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=G(i);return r&&t.push(r),t},[])}function Qpe(e){return K(e)&&e.every(t=>he(t))&&e.length>1}class Fs extends ze{constructor(t,n){super(t);this._stack=n}clone(){return new Fs(null,ge(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(mt(f.order,"ascending"));const l={field:a,order:u};let c;return Qpe(s)?c=s:he(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Fs(t,{stackField:i,groupby:r,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannel:s,fieldChannel:o,offset:a,impute:u}=i;let l;if(s){const g=r[s];l=Hr(g)}const c=Xpe(n),f=n.encoding.order;let h;return K(f)||Y(f)?h=XN(f):h=c.reduce((g,p)=>(g.field.push(p),g.order.push(o==="y"?"descending":"ascending"),g),{field:[],order:[]}),new Fs(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:h,offset:a,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ae(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:i}=this._stack;return t?t.bin?n?[G(t,{binSuffix:"mid"})]:[G(t,{}),G(t,{binSuffix:"end"})]:[G(t)]:i!=null?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:i,stackField:r,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;if(u&&i){const{bandPosition:c=.5,bin:f}=i;f&&t.push({type:"formula",expr:`${c}*`+G(i,{expr:"datum"})+`+${1-c}*`+G(i,{expr:"datum",binSuffix:"end"}),as:G(i,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...s,...n],key:G(i,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:l,offset:a}),t}}class Yl extends ze{constructor(t,n){super(t);this.transform=n}clone(){return new Yl(null,ge(this.transform))}addDimensions(t){this.transform.groupby=Fr(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(i.add,i),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`WindowTransform ${Ae(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],s=[];for(const h of this.transform.window)i.push(h.op),r.push(this.getDefaultName(h)),s.push(h.param===void 0?null:h.param),n.push(h.field===void 0?null:h.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&i.every(h=>LE(h)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},a!==void 0?{groupby:a}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const h of this.transform.sort)u.push(h.field),l.push((t=h.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:r,ops:i,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),a!==void 0?{groupby:a}:{}),o!==void 0?{frame:o}:{})}}function Kpe(e){function t(n){if(!(n instanceof Gl)){const i=n.clone();if(i instanceof jn){const r=__+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof sr||i instanceof Fs||i instanceof Yl||i instanceof ru)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function A_(e){if(e instanceof Gl)if(e.numChildren()===1&&!(e.children[0]instanceof jn)){const t=e.children[0];(t instanceof sr||t instanceof Fs||t instanceof Yl||t instanceof ru)&&t.addDimensions(e.fields),t.swapWithParent(),A_(e)}else{const t=e.model.component.data.main;$4(t);const n=Kpe(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(A_)}function $4(e){if(e instanceof jn&&e.type===Xe.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Gl||(t.swapWithParent(),$4(e))}}const __="scale_",N0=5;function S_(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!S_(t.children))return!1}return!0}function or(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function j4(e,t,n){let i=e.sources,r=!1;return r=or(new Upe,i)||r,r=or(new Ipe(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=or(new Hpe,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=or(new zpe,i)||r,r=or(new Ype(t),i)||r,r=or(new Bpe,i)||r,r=or(new qpe,i)||r,r=or(new Gpe,i)||r,r=or(new Wpe,i)||r,r=or(new Lpe,i)||r,r=or(new Vpe,i)||r),e.sources=i,r}function Jpe(e,t){S_(e.sources);let n=0,i=0;for(let r=0;r<N0&&j4(e,t,!0);r++)n++;e.sources.map(A_);for(let r=0;r<N0&&j4(e,t,!1);r++)i++;S_(e.sources),Math.max(n,i)===N0&&q(`Maximum optimization runs(${N0}) reached.`)}class Xn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Xn(()=>t(n))}}var Zpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function k4(e){yt(e)?eme(e):tme(e)}function eme(e){const t=e.component.scales;for(const n of U(t)){const i=ime(e,n);if(t[n].setWithExplicit("domains",i),sme(e,n),e.component.data.isFaceted){let s=e;for(;!ar(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)_s(a)&&(a.data=__+a.data.replace(__,""))}}}function tme(e){for(const n of e.children)k4(n);const t=e.component.scales;for(const n of U(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=Po(i,o.getWithExplicit("domains"),"domains","scale",$_);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&q(Cue),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function nme(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=F4(t,n);if(!r){q(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=F4(t,n);if(r)return"unaggregated"}return e}function ime(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=nme(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),t==="x"&&Ot(i.x2)?Ot(i.x)?Po(Ho(n,r,e,"x"),Ho(n,r,e,"x2"),"domain","scale",$_):Ho(n,r,e,"x2"):t==="y"&&Ot(i.y2)?Ot(i.y)?Po(Ho(n,r,e,"y"),Ho(n,r,e,"y2"),"domain","scale",$_):Ho(n,r,e,"y2"):Ho(n,r,e,t)}function rme(e,t,n){return e.map(i=>({signal:`{data: ${a0(i,{timeUnit:n,type:t})}}`}))}function O_(e,t,n){var i;const r=(i=Cn(n))===null||i===void 0?void 0:i.unit;return t==="temporal"||r?rme(e,t,r):[e]}function Ho(e,t,n,i){const{encoding:r}=n,s=Ot(r[i]),{type:o}=s,a=s.timeUnit;if(nce(t)){const f=Ho(e,void 0,n,i),h=O_(t.unionWith,o,a);return js([...f.value,...h])}else{if(re(t))return js([t]);if(t&&t!=="unaggregated"&&!_6(t))return js(O_(t,o,a))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return ci([[0,1]]);const f=n.requestDataName(Xe.Main);return ci([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=jo(i)&&Y(s)?ome(n,i,e):void 0;if(To(s)){const f=O_([s.datum],o,a);return ci(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(Xe.Main),{field:h}=s;return ci([{data:f,field:G({field:h,aggregate:"min"})},{data:f,field:G({field:h,aggregate:"max"})}])}else if(Ve(c.bin)){if(rn(e))return ci(e==="bin-ordinal"?[]:[{data:cd(l)?n.requestDataName(Xe.Main):n.requestDataName(Xe.Raw),field:n.vgField(i,_d(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!Ge(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(Ve(f)){const h=v_(n,c.field,f);return ci([new Xn(()=>{const g=n.getSignalName(h);return`[${g}.start, ${g}.stop]`})])}else return ci([{data:n.requestDataName(Xe.Main),field:n.vgField(i,{})}])}}else if(c.timeUnit&&be(["time","utc"],e)&&X6(c,yt(n)?n.encoding[Es(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(Xe.Main);return ci([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return ci(l?[{data:cd(l)?n.requestDataName(Xe.Main):n.requestDataName(Xe.Raw),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(Xe.Main),field:n.vgField(i)}])}function C_(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":Jm},i?{field:Ai(i)}:{}),r?{order:r}:{})}function sme(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,s=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=_6(r)&&r,a=Ha(s)&&Um(s.extent)&&s.extent;(o||a)&&i.set("selectionExtent",o!=null?o:a,!0)}function ome(e,t,n){if(!rn(n))return;const i=e.fieldDef(t),r=i.sort;if(W6(r))return{op:"min",field:Hl(i,t),order:"ascending"};const{stack:s}=e,o=s?[...s.groupbyField?[s.groupbyField]:[],...s.stackBy.map(a=>a.fieldDef.field)]:void 0;if(zr(r)){const a=s&&!be(o,r.field);return C_(r,a)}else if(H6(r)){const{encoding:a,order:u}=r,l=e.fieldDef(a),{aggregate:c,field:f}=l,h=s&&!be(o,f);if(As(c)||ko(c))return C_({field:G(l),order:u},h);if(LE(c)||!c)return C_({op:c,field:f,order:u},h)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(be(["ascending",void 0],r))return!0}}function F4(e,t){const{aggregate:n,type:i}=e;return n?he(n)&&!fue[n]?{valid:!1,reason:Jue(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:Zue(e)}:{valid:!0}:{valid:!1,reason:Kue(e)}}function $_(e,t,n,i){return e.explicit&&t.explicit&&q(rle(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function ame(e){const t=Fr(e.map(o=>_s(o)?Zpe(o,["sort"]):o),Ae),n=Fr(e.map(o=>{if(_s(o)){const a=o.sort;return a!==void 0&&!cd(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),Ae);if(t.length===0)return;if(t.length===1){const o=e[0];if(_s(o)&&n.length>0){let a=n[0];if(n.length>1)q(f6),a=!0;else if(Ge(a)&&"field"in a){const u=a.field;o.field===u&&(a=a.order?{order:a.order}:!0)}return Object.assign(Object.assign({},o),{sort:a})}return o}const i=Fr(n.map(o=>cd(o)||!("op"in o)||he(o.op)&&o.op in oue?o:(q(ole(o)),!0)),Ae);let r;i.length===1?r=i[0]:i.length>1&&(q(f6),r=!0);const s=Fr(e.map(o=>_s(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(a=>a.field)},r?{sort:r}:{}):Object.assign({fields:t},r?{sort:r}:{})}function j_(e){if(_s(e)&&he(e.field))return e.field;if(hue(e)){let t;for(const n of e.fields)if(_s(n)&&he(n.field)){if(!t)t=n.field;else if(t!==n.field)return q(ale),t}return q(ule),t}else if(gue(e)){q(lle);const t=e.fields[0];return he(t)?t:void 0}}function R0(e,t){const i=e.component.scales[t].get("domains").map(r=>(_s(r)&&(r.data=e.lookupDataSource(r.data)),r));return ame(i)}var ume=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function D4(e){return Vl(e)||D_(e)?e.children.reduce((t,n)=>t.concat(D4(n)),M4(e)):M4(e)}function M4(e){return U(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:u,range:l,reverse:c}=r,f=ume(r,["name","type","selectionExtent","domains","range","reverse"]),h=lme(r.range,s,n,e),g=R0(e,n),p=a?Hde(e,a,i,g):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},g?{domain:g}:{}),p?{domainRaw:p}:{}),{range:h}),c!==void 0?{reverse:c}:{}),f)),t},[])}function lme(e,t,n,i){if(Ir(n)){if(Do(e))return{step:{signal:`${t}_step`}}}else if(Ge(e)&&_s(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}class T4 extends $s{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:Sl(this.get("domains"),t=>K(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const cme=["range","scheme"];function N4(e){return e==="x"?"width":e==="y"?"height":void 0}function fme(e){const t=e.component.scales;for(const n of Bm){const i=t[n];if(!i)continue;const r=dme(n,e);i.setWithExplicit("range",r)}}function R4(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:i,field:r}=n,s=N4(t),o=e.getName(s);if(Ge(i)&&i.binned&&i.step!==void 0)return new Xn(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${u})`});if(Ve(i)){const a=v_(e,r,i);return new Xn(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(o)} / (${l})`})}}}function dme(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const l of cme)if(n[l]!==void 0){const c=oA(s,l),f=S6(e,l);if(!c)q(l6(s,l,e));else if(f)q(f);else switch(l){case"range":{const h=n.range;if(K(h)){if(Ir(e))return js(h.map(g=>{if(g==="width"||g==="height"){const p=t.getName(g),m=t.getSignalName.bind(t);return Xn.fromName(m,p)}return g}))}else if(Ge(h))return js({data:t.requestDataName(Xe.Main),field:h.field,sort:{op:"min",field:t.vgField(e)}});return js(h)}case"scheme":return js(hme(n[l]))}}if(e===nt||e===_t){const l=e===nt?"width":"height",c=i[l];if(Wr(c)){if(rn(s))return js({step:c.step});q(c6(l))}}const{rangeMin:o,rangeMax:a}=n,u=gme(e,t);return(o!==void 0||a!==void 0)&&oA(s,"rangeMin")&&K(u)&&u.length===2?js([o!=null?o:u[0],a!=null?a:u[1]]):ci(u)}function hme(e){return tce(e)?Object.assign({scheme:e.name},ai(e,["name"])):{scheme:e}}function gme(e,t){const{size:n,config:i,mark:r,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=Ot(s[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case nt:case _t:{if(be(["point","band"],l)){if(e===nt&&!n.width){const p=Cd(i.view,"width");if(Wr(p))return p}else if(e===_t&&!n.height){const p=Cd(i.view,"height");if(Wr(p))return p}}const h=N4(e),g=t.getName(h);return e===_t&&li(l)?[Xn.fromName(o,g),0]:[0,Xn.fromName(o,g)]}case xs:{const h=t.component.scales[e].get("zero"),g=P4(r,h,i),p=yme(r,n,t,i);return wd(l)?mme(g,p,pme(l,i,c,e)):[g,p]}case er:return[0,Math.PI*2];case Ua:return[0,360];case Mr:return[0,new Xn(()=>{const h=t.getSignalName("width"),g=t.getSignalName("height");return`min(${h},${g})/2`})];case So:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Oo:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Wn:return"symbol";case Hn:case Rr:case Pr:return l==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case ws:case Ao:case _o:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function pme(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&K(n)?n.length+1:(q(ble(i)),3)}}function mme(e,t,n){const i=()=>{const r=Ss(t),s=Ss(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return re(t)?new Xn(i):{signal:i()}}function P4(e,t,n){if(t)return re(t)?{signal:`${t.signal} ? 0 : ${P4(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(qm("size",e))}const L4=.95;function yme(e,t,n,i){const r={x:R4(n,"x"),y:R4(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=I4(t,r,i.view);return pt(s)?s-1:new Xn(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=I4(t,r,i.view);return pt(s)?Math.pow(L4*s,2):new Xn(()=>`pow(${L4} * ${s.signal}, 2)`)}}throw new Error(qm("size",e))}function I4(e,t,n){const i=Wr(e.width)?e.width.step:g0(n,"width"),r=Wr(e.height)?e.height.step:g0(n,"height");return t.x||t.y?new Xn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function B4(e,t){yt(e)?bme(e,t):q4(e,t)}function bme(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of U(n)){const u=o[a],l=n[a],c=e.getScaleComponent(a),f=Ot(r[a]),h=u[t],g=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),y=oA(g,t),x=S6(a,t);if(h!==void 0&&(y?x&&q(x):q(l6(g,t,a))),y&&x===void 0)if(h!==void 0){const w=f.timeUnit,E=f.type;switch(t){case"domainMax":case"domainMin":Ga(u[t])||E==="temporal"||w?l.set(t,{signal:a0(u[t],{type:E,timeUnit:w})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const w=t in U4?U4[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:g,scalePadding:p,scalePaddingInner:m,domain:u.domain,markDef:s,config:i}):i.scale[t];w!==void 0&&l.set(t,w,!1)}}}const U4={bins:({model:e,fieldOrDatumDef:t})=>Y(t)?vme(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>xme(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:i})=>wme(e,t,n,i),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>Eme(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>Ame(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:s})=>_me(e,t,n,i.type,r,s.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=Y(e)?e.sort:void 0;return Sme(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>Ome(e,t,n,i,r)};function z4(e){yt(e)?fme(e):q4(e,"range")}function q4(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?z4(i):B4(i,t);for(const i of U(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=Po(r,a,t,"scale",e8((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function vme(e,t){const n=t.bin;if(Ve(n)){const i=v_(e,t.field,n);return new Xn(()=>e.getSignalName(i))}else if(On(n)&&Ha(n)&&n.step!==void 0)return{step:n.step}}function xme(e,t){if(be([Hn,Rr,Pr],e)&&t!=="nominal")return"hcl"}function wme(e,t,n,i){var r;if(!(((r=Hr(i))===null||r===void 0?void 0:r.bin)||K(n)||be([St.TIME,St.UTC],e)))return t in $o?!0:void 0}function Eme(e,t,n,i,r,s){if(e in $o){if(nr(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(Y(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===St.POINT)return n.pointPadding}}function Ame(e,t,n,i){if(e===void 0&&t in $o){const{bandPaddingInner:r,barBandPaddingInner:s,rectBandPaddingInner:o}=i;return mt(r,n==="bar"?s:o)}}function _me(e,t,n,i,r,s){if(e===void 0&&t in $o&&n===St.BAND){const{bandPaddingOuter:o}=s;return mt(o,re(r)?{signal:`${r.signal}/2`}:r/2)}}function Sme(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return li(e)&&t==="descending"?re(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(li(e)&&t==="descending")return!0}function Ome(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&li(r)){if(K(n)){const o=n[0],a=n[n.length-1];if(o<=0&&a>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!wd(r))return!0;if(!(Y(t)&&t.bin)&&be([...Lr,...Jae],e)){const{orient:o,type:a}=i;return!(be(["bar","area","line","trail"],a)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function Cme(e,t,n,i){const r=$me(t,n,i),{type:s}=e;return jo(t)?s!==void 0?uce(t,s)?Y(n)&&!ace(s,n.type)?(q(nle(s,r)),r):s:(q(tle(t,s,r)),r):r:null}function $me(e,t,n){var i;switch(t.type){case"nominal":case"ordinal":{if(Cl(e)||PE(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&q(HE(e,"ordinal")),"ordinal";if(e in $o){if(be(["rect","bar","image","rule"],n.type))return"band"}else if(n.type==="arc"&&e in RE)return"band";const r=n[Oi(e)];return Fl(r)||vA(t)&&((i=t.axis)===null||i===void 0?void 0:i.tickBand)?"band":"point"}case"temporal":return Cl(e)?"time":PE(e)==="discrete"?(q(HE(e,"temporal")),"ordinal"):Y(t)&&t.timeUnit&&Cn(t.timeUnit).utc?"utc":"time";case"quantitative":return Cl(e)?Y(t)&&Ve(t.bin)?"bin-ordinal":"linear":PE(e)==="discrete"?(q(HE(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(a6(t.type))}function jme(e,{ignoreRange:t}={}){H4(e),k4(e);for(const n of oce)B4(e,n);t||z4(e)}function H4(e){yt(e)?e.component.scales=kme(e):e.component.scales=Dme(e)}function kme(e){const{encoding:t,mark:n,markDef:i}=e;return Bm.reduce((r,s)=>{const o=Ot(t[s]);if(o&&n===$6&&s===Wn&&o.type===kl)return r;let a=o&&o.scale;if(o&&a!==null&&a!==!1){a!=null||(a={});const u=Cme(a,s,o,i);r[s]=new T4(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}return r},{})}const Fme=e8((e,t)=>E6(e)-E6(t));function Dme(e){var t,n;const i=e.component.scales={},r={},s=e.component.resolve;for(const o of e.children){H4(o);for(const a of U(o.component.scales))if((t=(n=s.scale)[a])!==null&&t!==void 0||(n[a]=c4(a,e)),s.scale[a]==="shared"){const u=r[a],l=o.component.scales[a].getWithExplicit("type");u?zle(u.value,l.value)?r[a]=Po(u,l,"type","scale",Fme):(s.scale[a]="independent",delete r[a]):r[a]=l}}for(const o of U(r)){const a=e.scaleName(o,!0),u=r[o];i[o]=new T4(a,u);for(const l of e.children){const c=l.component.scales[o];c&&(l.renameScale(c.get("name"),a),c.merged=!0)}}return i}var k_=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class F_{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function yt(e){return(e==null?void 0:e.type)==="unit"}function ar(e){return(e==null?void 0:e.type)==="facet"}function D_(e){return(e==null?void 0:e.type)==="concat"}function Vl(e){return(e==null?void 0:e.type)==="layer"}class M_{constructor(t,n,i,r,s,o,a){var u,l;this.type=n,this.parent=i,this.config=s,this.correctDataNames=c=>{var f,h,g;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((g=(h=c.from)===null||h===void 0?void 0:h.facet)===null||g===void 0?void 0:g.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=s,this.view=Gn(a),this.name=(u=t.name)!==null&&u!==void 0?u:r,this.title=Fo(t.title)?{text:t.title}:t.title?Gn(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new F_,this.projectionNameMap=i?i.projectionNameMap:new F_,this.signalNameMap=i?i.signalNameMap:new F_,this.data=t.data,this.description=t.description,this.transforms=yde((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Afe(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:Zm(t)||i&&i.component.data.isFaceted&&t.data===void 0},layoutSize:new $s,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?ge(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){jme(this)}parseProjection(){A4(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){b4(this)}assembleEncodeFromView(t){const n=k_(t,["style"]),i={};for(const r of U(n)){const s=n[r];s!==void 0&&(i[r]=et(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=et(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):Ue(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=k_(t,["spacing"]),{component:r,config:s}=this,o=Qge(r.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Si)t[i].title&&n.push(Hge(this,i));for(const i of h_)n=n.concat(Wge(this,i));return n}assembleAxes(){return Dge(this.component.axes,this.config)}assembleLegends(){return x4(this)}assembleProjections(){return xpe(this)}assembleTitle(){var t,n,i;const r=(t=this.title)!==null&&t!==void 0?t:{},{encoding:s}=r,o=k_(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},qN(this.config.title).nonMarkTitleProperties),o),s?{encode:{update:s}}:{});if(a.text)return be(["unit","layer"],this.type)?be(["middle",void 0],a.anchor)&&((n=a.frame)!==null&&n!==void 0||(a.frame="group")):(i=a.anchor)!==null&&i!==void 0||(a.anchor="start"),Ue(a)?void 0:a}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||ar(this.parent)?D4(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return Ze((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Xe[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(ar(this.parent)){const n=u4(t),i=Im(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(rn(s)&&Do(o)){const a=r.get("name"),u=R0(this,i),l=j_(u);if(l){const c=G({aggregate:"distinct",field:l},{expr:"datum"});return{signal:a4(a,r,c)}}else return q(zE(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(NN(t)&&jo(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(Eue(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(i=>i.hasOrientSignalRef()))}}class W4 extends M_{vgField(t,n={}){const i=this.fieldDef(t);if(!!i)return G(i,n)}reduceFieldDef(t,n){return Kce(this.getMapping(),(i,r,s)=>{const o=Hr(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){_A(this.getMapping(),(i,r)=>{const s=Hr(i);s&&t(s,r)},n)}}var Mme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class P0 extends ze{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"value",(s=o[1])!==null&&s!==void 0?s:"density"]}clone(){return new P0(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ae(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=Mme(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class Hd extends ze{constructor(t,n){super(t);this.filter=n}clone(){return new Hd(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:s}=n;if(Pe("invalid",s,i)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=jo(c)&&n.getScaleComponent(c);if(f){const h=f.get("type");li(h)&&l.aggregate!=="count"&&!Mo(r)&&(u[l.field]=l)}return u},{});return U(a).length?new Hd(t,a):null}dependentFields(){return new Set(U(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ae(this.filter)}`}assemble(){const t=U(this.filter).reduce((n,i)=>{const r=this.filter[i],s=G(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):r.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class L0 extends ze{constructor(t,n){super(t);this.transform=n,this.transform=ge(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>{var a;return(a=r[o])!==null&&a!==void 0?a:s})}clone(){return new L0(this.parent,ge(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ae(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class I0 extends ze{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"key",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new I0(null,ge(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ae(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Xl extends ze{constructor(t,n,i,r){super(t);this.fields=n,this.geojson=i,this.signal=r}clone(){return new Xl(null,ge(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Nr,Tr],[_i,tr]]){const s=r.map(o=>{const a=Ot(n.encoding[o]);return Y(a)?a.field:To(a)?{expr:`${a.datum}`}:ir(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Xl(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Wn)){const r=n.typedFieldDef(Wn);r.type===kl&&(t=new Xl(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(he);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ae(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class Wd extends ze{constructor(t,n,i,r){super(t);this.projection=n,this.fields=i,this.as=r}clone(){return new Wd(null,this.projection,ge(this.fields),ge(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Nr,Tr],[_i,tr]]){const r=i.map(o=>{const a=Ot(n.encoding[o]);return Y(a)?a.field:To(a)?{expr:`${a.datum}`}:ir(a)?{expr:`${a.value}`}:void 0}),s=i[0]===_i?"2":"";(r[0]||r[1])&&(t=new Wd(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(he))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ae(this.fields)} ${Ae(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class su extends ze{constructor(t,n){super(t);this.transform=n}clone(){return new su(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new su(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(Y(r)&&Y(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,h=lR(n.mark,i);return new su(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),h.length?{groupby:h}:{}))}return null}hash(){return`Impute ${Ae(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:Zfe(i)?this.processSequence(i):i}:{}),{method:"value"}),s?{groupby:s}:{}),{value:!r||r==="value"?o:null});if(r&&r!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var Tme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class B0 extends ze{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:n.on,(s=o[1])!==null&&s!==void 0?s:n.loess]}clone(){return new B0(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ae(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=Tme(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class Gd extends ze{constructor(t,n,i){super(t);this.transform=n,this.secondary=i}clone(){return new Gd(null,ge(this.transform),this.secondary)}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(ede(o)){let u=X4(o.data,s);u||(u=new nu(o.data),s.push(u));const l=n.getName(`lookup_${r}`);a=new jn(u,l,Xe.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(tde(o)){const u=o.param;i=Object.assign({as:u},i);let l;try{l=n.getSelectionComponent(Ze(u),u)}catch{throw new Error(Sue(u))}if(a=l.materialized,!a)throw new Error(Oue(u))}return new Gd(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ut(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ae({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ut(this.transform.as)}:{});else{let n=this.transform.as;he(n)||(q(Tue),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var Nme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class U0 extends ze{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"prob",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new U0(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ae(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=Nme(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}var Rme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class z0 extends ze{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:n.on,(s=o[1])!==null&&s!==void 0?s:n.regression]}clone(){return new z0(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ae(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=Rme(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class q0 extends ze{constructor(t,n){super(t);this.transform=n}clone(){return new q0(null,ge(this.transform))}addDimensions(t){var n;this.transform.groupby=Fr(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${Ae(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),s!==void 0?{op:s}:{}),i!==void 0?{groupby:i}:{})}}class H0 extends ze{constructor(t,n){super(t);this.transform=n}clone(){return new H0(null,ge(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ae(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function G4(e){let t=0;function n(i,r){var s;if(i instanceof nu&&!i.isGenerator&&!Rl(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof un&&(i.parent instanceof nu&&!r.source?(r.format=Object.assign(Object.assign({},(s=r.format)!==null&&s!==void 0?s:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Gl){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Ud||i instanceof zd||i instanceof Hd||i instanceof zl||i instanceof ql||i instanceof Wd||i instanceof sr||i instanceof Gd||i instanceof Yl||i instanceof ru||i instanceof I0||i instanceof L0||i instanceof P0||i instanceof B0||i instanceof U0||i instanceof z0||i instanceof qo||i instanceof H0||i instanceof q0)&&r.transform.push(i.assemble()),(i instanceof Vr||i instanceof Gr||i instanceof su||i instanceof Fs||i instanceof Xl)&&r.transform.push(...i.assemble()),i instanceof jn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof jn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof jn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const a of i.children)n(a,{name:null,source:o,transform:[]});break}}}return n}function Pme(e){const t=[],n=G4(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function Lme(e,t){var n,i;const r=[],s=G4(r);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();s(u,l)}for(const u of r)u.transform.length===0&&delete u.transform;let a=0;for(const[u,l]of r.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&r.splice(a++,0,r.splice(u,1)[0]);for(const u of r)for(const l of(i=u.transform)!==null&&i!==void 0?i:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function Ime(e){return e==="top"||e==="left"||re(e)?"header":"footer"}function Bme(e){for(const t of Si)Ume(e,t);V4(e,"x"),V4(e,"y")}function Ume(e,t){var n;const{facet:i,config:r,child:s,component:o}=e;if(e.channelHasField(t)){const a=i[t],u=Wl("title",null,r,t);let l=Dl(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});s.component.layoutHeaders[t].title&&(l=K(l)?l.join(", "):l,l+=` / ${s.component.layoutHeaders[t].title}`,s.component.layoutHeaders[t].title=null);const c=Wl("labelOrient",a.header,r,t),f=a.header!==null?mt((n=a.header)===null||n===void 0?void 0:n.labels,r.header.labels,!0):!1,h=be(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[h]:t==="facet"?[]:[Y4(e,t,f)]}}}function Y4(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function V4(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:s}=e.component;if(s.axis[t]=y_(s,t),s.axis[t]==="shared"){const o=t==="x"?"column":"row",a=r[o];for(const u of i.component.axes[t]){const l=Ime(u.get("orient"));(n=a[l])!==null&&n!==void 0||(a[l]=[Y4(e,o,!1)]);const c=Bd(u,"main",e.config,{header:!0});c&&a[l][0].axes.push(c),u.mainExtracted=!0}}}}function zme(e){T_(e),W0(e,"width"),W0(e,"height")}function qme(e){T_(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";W0(e,t),W0(e,n)}function T_(e){for(const t of e.children)t.parseLayoutSize()}function W0(e,t){var n;const i=u4(t),r=Im(i),s=e.component.resolve,o=e.component.layoutSize;let a;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(i),c=(n=s.scale[r])!==null&&n!==void 0?n:c4(r,e);if(c==="independent"&&l.value==="step"){a=void 0;break}if(a){if(c==="independent"&&a.value!==l.value){a=void 0;break}a=Po(a,l,i,"")}else a=l}if(a){for(const u of e.children)e.renameSignal(u.getName(i),e.getName(t)),u.component.layoutSize.set(i,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function Hme(e){const{size:t,component:n}=e;for(const i of Lr){const r=Oi(i);if(t[r]){const s=t[r];n.layoutSize.set(r,Wr(s)?"step":s,!0)}else{const s=Wme(e,r);n.layoutSize.set(r,s,!1)}}}function Wme(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if(rn(s)){const a=Cd(i.view,t);return Do(o)||Wr(a)?"step":a}else return RA(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return RA(i.view,t);{const s=Cd(i.view,t);return Wr(s)?s.step:s}}}function N_(e,t,n){return G(t,Object.assign({suffix:`by_${G(e)}`},n!=null?n:{}))}class Yd extends W4{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve);this.child=B_(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Ad(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=U(t),i={};for(const r of n){if(![ms,ys].includes(r)){q(qm(r,"facet"));break}const s=t[r];if(s.field===void 0){q(qE(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=EA(t,n);return i.header?i.header=Gn(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=G0(this),this.child.parseData()}parseLayoutSize(){T_(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Bme(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const s of Si)for(const o of g_){const a=this.component.layoutHeaders[s],u=a[o],{facetFieldDef:l}=a;if(l){const c=Wl("titleOrient",l.header,this.config,s);if(["right","bottom"].includes(c)){const f=D0(s,c);(t=r.titleAnchor)!==null&&t!==void 0||(r.titleAnchor={}),r.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=s==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";s!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=r[f])!==null&&n!==void 0||(r[f]={}),r[f][s]=.5),a.title&&((i=r.offset)!==null&&i!==void 0||(r.offset={}),r.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Yd))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Yd?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:G(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Yd){if(this.child.channelHasField("column")){const r=G(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Lr){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(rn(o)&&Do(a)){const u=R0(this.child,r),l=j_(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):q(zE(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Si){const f=this.facet[c];if(f){u.push(G(f));const{bin:h,sort:g}=f;if(Ve(h)&&u.push(G(f,{binSuffix:"end"})),zr(g)){const{field:p,op:m=Jm}=g,y=N_(f,g);i&&r?(s.push(y),o.push("max"),a.push(y)):(s.push(p),o.push(m),a.push(y))}else if(K(g)){const p=Hl(f,c);s.push(p),o.push("max"),a.push(p)}}}const l=!!i&&!!r;return Object.assign({name:t,data:n,groupby:u},l||s.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?zr(i.sort)?[N_(i,i.sort,{expr:"datum"})]:K(i.sort)?[Hl(i,t,{expr:"datum"})]:[G(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(zr(r)?r.order:!K(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return p_(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const s of h_)if(n[s]){const o=Wl("labelOrient",(t=n[s])===null||t===void 0?void 0:t.header,i,s);if(r[s].includes(o))return p_(n[s],s,i)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=Pme(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Si.map(u=>this.facetSortFields(u)).flat(),order:Si.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(Bde(this,[])))]}getMapping(){return this.facet}}function Gme(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(zr(s.sort)){const{field:o,op:a=Jm}=s.sort;e=r=new ru(e,{joinaggregate:[{op:a,field:o,as:N_(s,s.sort,{forAs:!0})}],groupby:[G(s)]})}return r}return null}function X4(e,t){var n,i,r,s;for(const o of t){const a=o.data;if(e.name&&o.hasName()&&e.name!==o.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(i=a.format)===null||i===void 0?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)===null||r===void 0?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(s=a.format)===null||s===void 0?void 0:s.mesh;if(!((u||f)&&u!==f)){if($d(e)&&$d(a)){if(kr(e.values,a.values))return o}else if(Rl(e)&&Rl(a)){if(e.url===a.url)return o}else if(t8(e)&&e.name===o.dataName)return o}}return null}function Yme(e,t){if(e.data||!e.parent){if(e.data===null){const i=new nu({values:[]});return t.push(i),i}const n=X4(e.data,t);if(n)return Lo(e.data)||(n.data.format=_N({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new nu(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Vme(e,t,n){var i,r;let s=0;for(const o of t.transforms){let a,u;if(fde(o))u=e=new ql(e,o),a="derived";else if(UA(o)){const l=Tpe(o);u=e=(i=un.makeWithAncestors(e,{},l,n))!==null&&i!==void 0?i:e,e=new zl(e,t,o.filter)}else if(GR(o))u=e=Vr.makeFromTransform(e,o,t),a="number";else if(hde(o))a="date",n.getWithExplicit(o.field).value===void 0&&(e=new un(e,{[o.field]:a}),n.set(o.field,a,!1)),u=e=Gr.makeFromTransform(e,o);else if(gde(o))u=e=sr.makeFromTransform(e,o),a="number",e_(t)&&(e=new qo(e));else if(WR(o))u=e=Gd.make(e,t,o,s++),a="derived";else if(ude(o))u=e=new Yl(e,o),a="number";else if(lde(o))u=e=new ru(e,o),a="number";else if(pde(o))u=e=Fs.makeFromTransform(e,o),a="derived";else if(mde(o))u=e=new I0(e,o),a="derived";else if(cde(o))u=e=new L0(e,o),a="derived";else if(nde(o))u=e=new q0(e,o),a="derived";else if(ade(o))e=new H0(e,o);else if(dde(o))u=e=su.makeFromTransform(e,o),a="derived";else if(ide(o))u=e=new P0(e,o),a="derived";else if(rde(o))u=e=new U0(e,o),a="derived";else if(sde(o))u=e=new z0(e,o),a="derived";else if(ode(o))u=e=new B0(e,o),a="derived";else{q(Mue(o));continue}if(u&&a!==void 0)for(const l of(r=u.producedFields())!==null&&r!==void 0?r:[])n.set(l,a,!1)}return e}function G0(e){var t,n,i,r,s,o,a,u,l,c;let f=Yme(e,e.component.data.sources);const{outputNodes:h,outputNodeRefCounts:g}=e.component.data,p=e.data,y=!(p&&(Lo(p)||Rl(p)||$d(p)))&&e.parent?e.parent.component.data.ancestorParse.clone():new Cde;Lo(p)?(n8(p)?f=new zd(f,p.sequence):HA(p)&&(f=new Ud(f,p.graticule)),y.parseNothing=!0):((t=p==null?void 0:p.format)===null||t===void 0?void 0:t.parse)===null&&(y.parseNothing=!0),f=(n=un.makeExplicit(f,e,y))!==null&&n!==void 0?n:f,f=new qo(f);const x=e.parent&&Vl(e.parent);(yt(e)||ar(e))&&x&&(f=(i=Vr.makeFromEncoding(f,e))!==null&&i!==void 0?i:f),e.transforms.length>0&&(f=Vme(f,e,y));const w=Rpe(e),E=Npe(e);f=(r=un.makeWithAncestors(f,{},Object.assign(Object.assign({},w),E),y))!==null&&r!==void 0?r:f,yt(e)&&(f=Xl.parseAll(f,e),f=Wd.parseAll(f,e)),(yt(e)||ar(e))&&(x||(f=(s=Vr.makeFromEncoding(f,e))!==null&&s!==void 0?s:f),f=(o=Gr.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=ql.parseAllForSortIndex(f,e));const A=e.getDataName(Xe.Raw),S=new jn(f,A,Xe.Raw,g);if(h[A]=S,f=S,yt(e)){const j=sr.makeFromEncoding(f,e);j&&(f=j,e_(e)&&(f=new qo(f))),f=(a=su.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=(u=Fs.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}yt(e)&&(f=(l=Hd.make(f,e))!==null&&l!==void 0?l:f);const O=e.getDataName(Xe.Main),_=new jn(f,O,Xe.Main,g);h[O]=_,f=_,yt(e)&&kge(e,_);let C=null;if(ar(e)){const j=e.getName("facet");f=(c=Gme(f,e.facet))!==null&&c!==void 0?c:f,C=new Gl(f,e,j,_.getSource()),h[j]=C}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:g,raw:S,main:_,facetRoot:C,ancestorParse:y})}class Xme extends M_{constructor(t,n,i,r){var s,o,a,u;super(t,"concat",n,i,r,t.resolve);(((o=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||u===void 0?void 0:u.y)==="shared")&&q(kue),this.children=this.getChildren(t).map((l,c)=>B_(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=G0(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return h0(t)?t.vconcat:NA(t)?t.hconcat:t.concat}parseLayoutSize(){qme(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=m_(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function Qme(e){return e===!1||e===null}const Kme=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},sR),{labelExpr:1,encode:1}),Q4=U(Kme);class R_ extends $s{constructor(t={},n={},i=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new R_(ge(this.explicit),ge(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Qme(this.get(t))}hasOrientSignalRef(){return re(this.explicit.orient)}}function Jme(e,t,n){var i;const{encoding:r,config:s}=e,o=(i=Ot(r[t]))!==null&&i!==void 0?i:Ot(r[Es(t)]),a=e.axis(t)||{},{format:u,formatType:l}=a;return Xa(l)?Object.assign({text:hA({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:s})},n):n}function Zme(e){return Lr.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[o0e(n,e)]),t),{})}const e0e={bottom:"top",top:"bottom",left:"right",right:"left"};function t0e(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of U(s.component.axes))i.axis[o]=y_(e.component.resolve,o),i.axis[o]==="shared"&&(n[o]=n0e(n[o],s.component.axes[o]),n[o]||(i.axis[o]="independent",delete n[o]))}for(const s of Lr){for(const o of e.children)if(!!o.component.axes[s]){if(i.axis[s]==="independent"){n[s]=((t=n[s])!==null&&t!==void 0?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:u,explicit:l}=a.getWithExplicit("orient");if(!re(u)){if(r[u]>0&&!l){const c=e0e[u];r[u]>r[c]&&a.set("orient",c,!1)}r[u]++}}}delete o.component.axes[s]}if(i.axis[s]==="independent"&&n[s]&&n[s].length>1)for(const o of n[s])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function n0e(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=i0e(r,s)}}}else return t.map(n=>n.clone());return e}function i0e(e,t){for(const n of Q4){const i=Po(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return JN(r,s);case"gridScale":return{explicit:r.explicit,value:mt(r.value,s.value)}}return m0(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function r0e(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(re(n.labelAngle)?n.labelAngle:hd(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===n4(i,r))return!0}return e===n[t]}const s0e=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function o0e(e,t){var n,i,r;let s=t.axis(e);const o=new R_,a=Ot(t.encoding[e]),{mark:u,config:l}=t,c=(s==null?void 0:s.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((i=l.axis)===null||i===void 0?void 0:i.orient)||Bge(e),f=t.getScaleComponent(e).get("type"),h=Mge(e,f,c,t.config),g=s!==void 0?!s:f_("disable",l.style,s==null?void 0:s.style,h).configValue;if(o.set("disable",g,s!==void 0),g)return o;s=s||{};const p=Pge(a,s,e,l.style,h),m={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const w of Q4){const E=w in Z8?Z8[w](m):oR(w)?s[w]:void 0,A=E!==void 0,S=r0e(E,w,s,t,e);if(A&&S)o.set(w,E,S);else{const{configValue:O=void 0,configFrom:_=void 0}=oR(w)&&w!=="values"?f_(w,l.style,s.style,h):{},C=O!==void 0;A&&!C?o.set(w,E,S):(_!=="vgAxisConfig"||s0e.has(w)&&C||Sd(O)||re(O))&&o.set(w,O,!1)}}const y=(r=s.encoding)!==null&&r!==void 0?r:{},x=rR.reduce((w,E)=>{var A;if(!o.hasAxisPart(E))return w;const S=l4((A=y[E])!==null&&A!==void 0?A:{},t),O=E==="labels"?Jme(t,e,S):S;return O!==void 0&&!Ue(O)&&(w[E]={update:O}),w},{});return Ue(x)||o.set("encode",x,!!s.encoding||s.labelAngle!==void 0),o}function a0e({encoding:e,size:t}){for(const n of Lr){const i=Oi(n);Wr(t[i])&&qr(e[n])&&(delete t[i],q(c6(i)))}return t}function u0e(e,t,n){const i=Gn(e),r=Pe("orient",i,n);if(i.orient=d0e(i.type,t,r),r!==void 0&&r!==i.orient&&q(Vue(i.orient,r)),i.type==="bar"&&i.orient){const a=Pe("cornerRadiusEnd",i,n);if(a!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:vce[i.orient];for(const l of u)i[l]=a;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Pe("opacity",i,n)===void 0&&(i.opacity=c0e(i.type,t)),Pe("cursor",i,n)===void 0&&(i.cursor=l0e(i,t,n)),i}function l0e(e,t,n){return t.href||e.href||Pe("href",e,n)?"pointer":e.cursor}function c0e(e,t){if(be([Vm,aA,uA,lA],e)&&!AA(t))return .7}function f0e(e,t,{graticule:n}){if(n)return!1;const i=Wa("filled",e,t),r=e.type;return mt(i,r!==Vm&&r!==Ym&&r!==Xm)}function d0e(e,t,n){switch(e){case Vm:case uA:case lA:case C6:case cce:case lce:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case Gm:if(Y(i)&&(On(i.bin)||Y(r)&&r.aggregate&&!i.aggregate))return"vertical";if(Y(r)&&(On(r.bin)||Y(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(Y(i)&&i.type===Ya&&!Ve(i.bin)||bA(i)))return"horizontal";if(!o&&(Y(r)&&r.type===Ya&&!Ve(r.bin)||bA(r)))return"vertical"}case Xm:if(s&&!(Y(i)&&On(i.bin))&&o&&!(Y(r)&&On(r.bin)))return;case Wm:if(o)return Y(r)&&On(r.bin)?"horizontal":"vertical";if(s)return Y(i)&&On(i.bin)?"vertical":"horizontal";if(e===Xm){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case Ym:case aA:{const a=qr(i),u=qr(r);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u){const l=i,c=r,f=l.type===jl,h=c.type===jl;return f&&!h?e!=="tick"?"vertical":"horizontal":!f&&h?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const h0e={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Bo(e,"radius","arc")),Bo(e,"theta","arc"))},g0e={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),x0("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),x0("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),JA(e))},p0e={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Bo(e,"x","bar")),Bo(e,"y","bar"))},m0e={vgMark:"shape",encodeEntry:e=>Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Y(n)&&n.type===kl?{field:G(n,{expr:"datum"})}:{})]}},y0e={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Bo(e,"x","image")),Bo(e,"y","image")),QA(e,"url"))},b0e={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Tt("size",e,{vgChannel:"strokeWidth"})),JA(e))},v0e={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Tt("size",e)),JA(e))};function P_(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Tt("size",e)),Tt("angle",e)),x0e(e,n,t))}function x0e(e,t,n){return n?{shape:{value:n}}:Tt("shape",e)}const w0e={vgMark:"symbol",encodeEntry:e=>P_(e)},E0e={vgMark:"symbol",encodeEntry:e=>P_(e,"circle")},A0e={vgMark:"symbol",encodeEntry:e=>P_(e,"square")},_0e={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Bo(e,"x","rect")),Bo(e,"y","rect"))},S0e={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),x0("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),x0("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Tt("size",e,{vgChannel:"strokeWidth"}))}},O0e={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),QA(e)),Tt("size",e,{vgChannel:"fontSize"})),Tt("angle",e)),w8("align",C0e(e.markDef,n,t))),w8("baseline",$0e(e.markDef,n,t))),sn("radius",e,{defaultPos:null})),sn("theta",e,{defaultPos:null}))}};function C0e(e,t,n){if(Pe("align",e,n)===void 0)return"center"}function $0e(e,t,n){if(Pe("baseline",e,n)===void 0)return"middle"}const j0e={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",s=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$i(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid",vgChannel:"xc"})),sn("y",e,{defaultPos:"mid",vgChannel:"yc"})),Tt("size",e,{defaultValue:k0e(e),vgChannel:r})),{[s]:et(Pe("thickness",n,t))})}};function k0e(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,s=r==="horizontal"?"width":"height",o=e.getScaleComponent(r==="horizontal"?"x":"y"),a=(t=Pe("size",i,n,{vgChannel:s}))!==null&&t!==void 0?t:n.tick.bandSize;if(a!==void 0)return a;{const u=o?o.get("range"):void 0;return u&&Do(u)&&pt(u.step)?u.step*3/4:g0(n.view,s)*3/4}}const Y0={arc:h0e,area:g0e,bar:p0e,circle:E0e,geoshape:m0e,image:y0e,line:b0e,point:w0e,rect:_0e,rule:S0e,square:A0e,text:O0e,tick:j0e,trail:v0e};function F0e(e){if(be([Ym,Wm,fce],e.mark)){const t=lR(e.mark,e.encoding);if(t.length>0)return D0e(e,t)}else if(e.mark===Gm){const t=IE.some(n=>Pe(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return M0e(e)}return L_(e)}const K4="faceted_path_";function D0e(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:K4+e.requestDataName(Xe.Main),data:e.requestDataName(Xe.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:L_(e,{fromPrefix:K4})}]}const J4="stack_group_";function M0e(e){const[t]=L_(e,{fromPrefix:J4}),n=e.scaleName(e.stack.fieldChannel),i=(l={})=>e.vgField(e.stack.fieldChannel,l),r=(l,c)=>{const f=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(h=>`scale('${n}',${h})`).join(",")})`};let s,o;e.stack.fieldChannel==="x"?(s=Object.assign(Object.assign({},_l(t.encode.update,["y","yc","y2","height",...IE])),{x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},ai(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(s=Object.assign(Object.assign({},_l(t.encode.update,["x","xc","x2","width"])),{y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},ai(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of IE){const c=Wa(l,e.markDef,e.config);t.encode.update[l]?(s[l]=t.encode.update[l],delete t.encode.update[l]):c&&(s[l]=et(c)),c&&(t.encode.update[l]={value:0})}const a=[];if(e.stack.groupbyChannel){const l=e.fieldDef(e.stack.groupbyChannel),c=G(l);c&&a.push(c),((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&a.push(G(l,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return Object.assign(Object.assign({},l),{[c]:t.encode.update[c]});{const f=Wa(c,e.markDef,e.config);return f!==void 0?Object.assign(Object.assign({},l),{[c]:et(f)}):l}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Xe.Main),name:J4+e.requestDataName(Xe.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:o},marks:[t]}]}]}function T0e(e){var t;const{encoding:n,stack:i,mark:r,markDef:s,config:o}=e,a=n.order;if(!(!K(a)&&ir(a)&&OE(a.value)||!a&&OE(Pe("order",s,o)))){if((K(a)||Y(a))&&!i)return XN(a,{expr:"datum"});if(Mo(r)){const u=s.orient==="horizontal"?"y":"x",l=n[u];if(Y(l)){const c=l.sort;if(K(c))return{field:G(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(zr(c))return{field:G({aggregate:AA(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(H6(c)){const f=e.fieldDef(c.encoding);return{field:G(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:G(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function L_(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=mt(i.clip,N0e(e),R0e(e)),a=YN(i),u=r.key,l=T0e(e),c=P0e(e),f=Pe("aria",i,s),h=Y0[n].postEncodingTransform?Y0[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Y0[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(Xe.Main)},encode:{update:Y0[n].encodeEntry(e)}}),h?{transform:h}:{})]}function N0e(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function R0e(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function P0e(e){if(!e.component.selection)return null;const t=U(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=U(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class Z4 extends W4{constructor(t,n,i,r={},s){var o;super(t,"unit",n,i,s,void 0,$R(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=Ur(t.mark)?Object.assign({},t.mark):{type:t.mark},u=a.type;a.filled===void 0&&(a.filled=f0e(a,s,{graticule:t.data&&HA(t.data)}));const l=this.encoding=Xce(t.encoding||{},u,a.filled,s);this.markDef=u0e(a,l,s),this.size=a0e({encoding:l,size:$R(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=RR(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((o=t.params)!==null&&o!==void 0?o:[]).filter(c=>MA(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===$6,i=t&&Hae.some(r=>de(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return Bm.reduce((i,r)=>{var s;const o=Ot(n[r]);return o&&(i[r]=this.initScale((s=o.scale)!==null&&s!==void 0?s:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Gn(t);return K(n)&&(r.domain=n.map(ui)),K(i)&&(r.range=i.map(ui)),r}initAxes(t){return Lr.reduce((n,i)=>{const r=t[i];if(de(r)||i===nt&&de(t.x2)||i===_t&&de(t.y2)){const s=de(r)?r.axis:void 0;n[i]=s&&this.initAxis(Object.assign({},s))}return n},{})}initAxis(t){const n=U(t),i={};for(const r of n){const s=t[r];i[r]=Sd(s)?HN(s):ui(s)}return i}initLegends(t){return Zae.reduce((n,i)=>{const r=Ot(t[i]);if(r&&tue(i)){const s=r.legend;n[i]=s&&Gn(s)}return n},{})}parseData(){this.component.data=G0(this)}parseLayoutSize(){Hme(this)}parseSelections(){this.component.selection=jge(this,this.selection)}parseMarkGroup(){this.component.mark=F0e(this)}parseAxesAndHeaders(){this.component.axes=Zme(this)}assembleSelectionTopLevelSignals(t){return Ude(this,t)}assembleSignals(){return[...K8(this),...Ide(this,[])]}assembleSelectionData(t){return zde(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return m_(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!Vl(this.parent))&&(n=c8(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Ka(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Hr(n)}typedFieldDef(t){const n=this.fieldDef(t);return Ci(n)?n:null}}class I_ extends M_{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,u)=>{if(p0(a))return new I_(a,this,this.getName(`layer_${u}`),o,s);if(Os(a))return new Z4(a,this,this.getName(`layer_${u}`),o,s);throw new Error(UE(a))})}parseData(){this.component.data=G0(this);for(const t of this.children)t.parseData()}parseLayoutSize(){zme(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){t0e(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),K8(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),m_(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of ut(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return qde(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),x4(this))}}function B_(e,t,n,i,r){if(Zm(e))return new Yd(e,t,n,r);if(p0(e))return new I_(e,t,n,i,r);if(Os(e))return new Z4(e,t,n,i,r);if(xfe(e))return new Xme(e,t,n,r);throw new Error(UE(e))}var L0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function I0e(e,t={}){t.logger&&vle(t.logger),t.fieldTitle&&eR(t.fieldTitle);try{const n=TR(EN(t.config,e.config)),i=KR(e,n),r=B_(i,null,"",void 0,n);return r.parse(),Jpe(r.component.data,r),{spec:U0e(r,B0e(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&xle(),t.fieldTitle&&Ice()}}function B0e(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):he(t)&&(t={type:t}),r&&s&&_de(t.type)){if(r==="step"&&s==="step")q(t6()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";q(t6(Im(o)));const a=o==="width"?"height":"width";t.type=Sde(a)}}return Object.assign(Object.assign(Object.assign({},U(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),ZR(n,!1)),ZR(e,!0))}function U0e(e,t,n={},i){const r=e.config?Nfe(e.config):void 0,s=[].concat(e.assembleSelectionData([]),Lme(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(g=>(g.name==="width"||g.name==="height")&&g.value!==void 0?(t[g.name]=+g.value,!1):!0);const{params:f}=t,h=L0e(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),h),a?{title:a}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...CR(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const z0e=wae.version;var q0e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:z0e,compile:I0e,normalize:KR,deepEqual:kr,duplicate:ge,pick:_l,omit:ai,stringify:Ye,hash:Ae,isNullOrFalse:OE,contains:be,some:Sl,every:CE,mergeDeep:_N,unique:Fr,isEqual:Lae,setEqual:SN,hasIntersection:$E,prefixGenerator:jE,fieldIntersection:kE,isEmpty:Ue,keys:U,vals:nn,entries:Eo,isBoolean:cd,varName:Ze,logicalExpr:fd,deleteNestedProperty:Dm,titleCase:dd,accessPathWithDatum:FE,flatAccessWithDatum:ON,replacePathInField:Ai,replaceAll:Ba,removePathFromField:DE,accessPathDepth:Ol,getFirstDefined:mt,uniqueId:$N,resetIdCounter:Bae,internalField:jN,isInternalField:kN,normalizeAngle:hd,isNumeric:Mm});function e9(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var H0e="vega-themes",W0e="2.10.0",G0e="Themes for stylized Vega and Vega-Lite visualizations.",Y0e=["vega","vega-lite","themes","style"],V0e="BSD-3-Clause",X0e={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Q0e=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],K0e="build/vega-themes.js",J0e="build/vega-themes.module.js",Z0e="build/vega-themes.min.js",e1e="build/vega-themes.min.js",t1e="build/vega-themes.module.d.ts",n1e={type:"git",url:"https://github.com/vega/vega-themes.git"},i1e=["src","build"],r1e={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},s1e={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},o1e={vega:"*","vega-lite":"*"},a1e={name:H0e,version:W0e,description:G0e,keywords:Y0e,license:V0e,author:X0e,contributors:Q0e,main:K0e,module:J0e,unpkg:Z0e,jsdelivr:e1e,types:t1e,repository:n1e,files:i1e,scripts:r1e,devDependencies:s1e,peerDependencies:o1e};const Ql="#fff",u1e="#888",l1e={background:"#333",title:{color:Ql,subtitleColor:Ql},style:{"guide-label":{fill:Ql},"guide-title":{fill:Ql}},axis:{domainColor:Ql,gridColor:u1e,tickColor:Ql}},ou="#4572a7",c1e={background:"#fff",arc:{fill:ou},area:{fill:ou},line:{stroke:ou,strokeWidth:2},path:{stroke:ou},rect:{fill:ou},shape:{stroke:ou},symbol:{fill:ou,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},au="#30a2da",U_="#cbcbcb",f1e="#999",d1e="#333",t9="#f0f0f0",n9="#333",h1e={arc:{fill:au},area:{fill:au},axis:{domainColor:U_,grid:!0,gridColor:U_,gridWidth:1,labelColor:f1e,labelFontSize:10,titleColor:d1e,tickColor:U_,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:t9,group:{fill:t9},legend:{labelColor:n9,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:n9,titleFontSize:14,titlePadding:10},line:{stroke:au,strokeWidth:2},path:{stroke:au,strokeWidth:.5},rect:{fill:au},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:au},bar:{binSpacing:2,fill:au,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},uu="#000",g1e={group:{fill:"#e5e5e5"},arc:{fill:uu},area:{fill:uu},line:{stroke:uu},path:{stroke:uu},rect:{fill:uu},shape:{stroke:uu},symbol:{fill:uu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},p1e=22,m1e="normal",i9="Benton Gothic, sans-serif",r9=11.5,y1e="normal",lu="#82c6df",z_="Benton Gothic Bold, sans-serif",s9="normal",o9=13,Vd={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},b1e={background:"#ffffff",title:{anchor:"start",color:"#000000",font:z_,fontSize:p1e,fontWeight:m1e},arc:{fill:lu},area:{fill:lu},line:{stroke:lu,strokeWidth:2},path:{stroke:lu},rect:{fill:lu},shape:{stroke:lu},symbol:{fill:lu,size:30},axis:{labelFont:i9,labelFontSize:r9,labelFontWeight:y1e,titleFont:z_,titleFontSize:o9,titleFontWeight:s9},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:i9,labelFontSize:r9,symbolType:"square",titleFont:z_,titleFontSize:o9,titleFontWeight:s9},range:{category:Vd["category-6"],diverging:Vd["fireandice-6"],heatmap:Vd["fire-7"],ordinal:Vd["fire-7"],ramp:Vd["fire-7"]}},cu="#ab5787",V0="#979797",v1e={background:"#f9f9f9",arc:{fill:cu},area:{fill:cu},line:{stroke:cu},path:{stroke:cu},rect:{fill:cu},shape:{stroke:cu},symbol:{fill:cu,size:30},axis:{domainColor:V0,domainWidth:.5,gridWidth:.2,labelColor:V0,tickColor:V0,tickWidth:.2,titleColor:V0},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},fu="#3e5c69",x1e={background:"#fff",arc:{fill:fu},area:{fill:fu},line:{stroke:fu},path:{stroke:fu},rect:{fill:fu},shape:{stroke:fu},symbol:{fill:fu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ji="#1696d2",a9="#000000",w1e="#FFFFFF",X0="Lato",q_="Lato",E1e="Lato",A1e="#DEDDDD",_1e=18,Xd={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},S1e={background:w1e,title:{anchor:"start",fontSize:_1e,font:X0},axisX:{domain:!0,domainColor:a9,domainWidth:1,grid:!1,labelFontSize:12,labelFont:q_,labelAngle:0,tickColor:a9,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:X0},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:A1e,gridWidth:1,labelFontSize:12,labelFont:q_,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:X0,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:q_,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:X0,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Xd["six-groups-cat-1"],diverging:Xd["diverging-colors"],heatmap:Xd["diverging-colors"],ordinal:Xd["six-groups-seq"],ramp:Xd["shades-blue"]},area:{fill:ji},rect:{fill:ji},line:{color:ji,stroke:ji,strokeWidth:5},trail:{color:ji,stroke:ji,strokeWidth:0,size:1},path:{stroke:ji,strokeWidth:.5},point:{filled:!0},text:{font:E1e,color:ji,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ji,stroke:null}},arc:{fill:ji},shape:{stroke:ji},symbol:{fill:ji,size:30}},du="#3366CC",u9="#ccc",Q0="Arial, sans-serif",O1e={arc:{fill:du},area:{fill:du},path:{stroke:du},rect:{fill:du},shape:{stroke:du},symbol:{stroke:du},circle:{fill:du},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Q0,fontSize:12},"guide-title":{font:Q0,fontSize:12},"group-title":{font:Q0,fontSize:12}},title:{font:Q0,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:u9,tickColor:u9,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},C1e=a1e.version;var $1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:l1e,excel:c1e,fivethirtyeight:h1e,ggplot2:g1e,googlecharts:O1e,latimes:b1e,quartz:v1e,urbaninstitute:S1e,version:C1e,vox:x1e});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function j1e(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function k1e(e,t,n){if(Z(e))return`[${e.map(i=>t(Oe(i)?i:l9(i,n))).join(", ")}]`;if(fe(e)){let i="";const r=e,{title:s,image:o}=r,a=j1e(r,["title","image"]);s&&(i+=`<h2>${t(s)}</h2>`),o&&(i+=`<img src="${t(o)}">`);const u=Object.keys(a);if(u.length>0){i+="<table>";for(const l of u){let c=a[l];c!==void 0&&(fe(c)&&(c=l9(c,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function F1e(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function l9(e,t){return JSON.stringify(e,F1e(t))}var D1e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const c9="vg-tooltip-element",M1e={offsetX:10,offsetY:10,id:c9,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:T1e,maxDepth:2,formatTooltip:k1e};function T1e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function N1e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return D1e.toString().replace(c9,e)}function R1e(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let s=e.clientY+i;return s+t.height>window.innerHeight&&(s=+e.clientY-i-t.height),{x:r,y:s}}class P1e{constructor(t){this.options=Object.assign(Object.assign({},M1e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=N1e(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var s;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((s=document.fullscreenElement)!==null&&s!==void 0?s:document.body).appendChild(this.el),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:a,y:u}=R1e(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${a}px`)}}function L1e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f9(e,t,n,i,r,s,o){try{var a=e[s](o),u=a.value}catch(l){n(l);return}a.done?t(u):Promise.resolve(u).then(i,r)}function K0(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(u){f9(s,i,r,o,a,"next",u)}function a(u){f9(s,i,r,o,a,"throw",u)}o(void 0)})}}var d9=Object.prototype,hu=d9.hasOwnProperty,Xr,H_=typeof Symbol=="function"?Symbol:{},J0=H_.iterator||"@@iterator",I1e=H_.asyncIterator||"@@asyncIterator",Z0=H_.toStringTag||"@@toStringTag";function h9(e,t,n,i){var r=t&&t.prototype instanceof G_?t:G_,s=Object.create(r.prototype),o=new Q_(i||[]);return s._invoke=H1e(e,n,o),s}function W_(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var g9="suspendedStart",B1e="suspendedYield",p9="executing",e1="completed",ur={};function G_(){}function t1(){}function Kl(){}var Y_={};Y_[J0]=function(){return this};var V_=Object.getPrototypeOf,n1=V_&&V_(V_(K_([])));n1&&n1!==d9&&hu.call(n1,J0)&&(Y_=n1);var Jl=Kl.prototype=G_.prototype=Object.create(Y_);t1.prototype=Jl.constructor=Kl;Kl.constructor=t1;Kl[Z0]=t1.displayName="GeneratorFunction";function m9(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function y9(e){var t=typeof e=="function"&&e.constructor;return t?t===t1||(t.displayName||t.name)==="GeneratorFunction":!1}function U1e(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,Kl):(e.__proto__=Kl,Z0 in e||(e[Z0]="GeneratorFunction")),e.prototype=Object.create(Jl),e}function z1e(e){return{__await:e}}function i1(e,t){function n(s,o,a,u){var l=W_(e[s],e,o);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&hu.call(f,"__await")?t.resolve(f.__await).then(function(h){n("next",h,a,u)},function(h){n("throw",h,a,u)}):t.resolve(f).then(function(h){c.value=h,a(c)},function(h){return n("throw",h,a,u)})}}var i;function r(s,o){function a(){return new t(function(u,l){n(s,o,u,l)})}return i=i?i.then(a,a):a()}this._invoke=r}m9(i1.prototype);i1.prototype[I1e]=function(){return this};function q1e(e,t,n,i,r){r===void 0&&(r=Promise);var s=new i1(h9(e,t,n,i),r);return y9(t)?s:s.next().then(function(o){return o.done?o.value:s.next()})}function H1e(e,t,n){var i=g9;return function(s,o){if(i===p9)throw new Error("Generator is already running");if(i===e1){if(s==="throw")throw o;return v9()}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=b9(a,n);if(u){if(u===ur)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===g9)throw i=e1,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);i=p9;var l=W_(e,t,n);if(l.type==="normal"){if(i=n.done?e1:B1e,l.arg===ur)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(i=e1,n.method="throw",n.arg=l.arg)}}}function b9(e,t){var n=e.iterator[t.method];if(n===Xr){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=Xr,b9(e,t),t.method==="throw"))return ur;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return ur}var i=W_(n,e.iterator,t.arg);if(i.type==="throw")return t.method="throw",t.arg=i.arg,t.delegate=null,ur;var r=i.arg;if(!r)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,ur;if(r.done)t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=Xr);else return r;return t.delegate=null,ur}m9(Jl);Jl[Z0]="Generator";Jl[J0]=function(){return this};Jl.toString=function(){return"[object Generator]"};function W1e(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function X_(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Q_(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W1e,this),this.reset(!0)}function G1e(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}}function K_(e){if(e){var t=e[J0];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(hu.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=Xr,r.done=!0,r};return i.next=i}}return{next:v9}}function v9(){return{value:Xr,done:!0}}Q_.prototype={constructor:Q_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=Xr,this.done=!1,this.delegate=null,this.method="next",this.arg=Xr,this.tryEntries.forEach(X_),!t)for(var n in this)n.charAt(0)==="t"&&hu.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=Xr)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(l,c){return o.type="throw",o.arg=t,n.next=l,c&&(n.method="next",n.arg=Xr),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if(s.tryLoc==="root")return i("end");if(s.tryLoc<=this.prev){var a=hu.call(s,"catchLoc"),u=hu.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else if(u){if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&hu.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&(t==="break"||t==="continue")&&s.tryLoc<=n&&n<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=n,s?(this.method="next",this.next=s.finallyLoc,ur):this.complete(o)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),ur},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),X_(i),ur}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if(r.type==="throw"){var s=r.arg;X_(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:K_(t),resultName:n,nextLoc:i},this.method==="next"&&(this.arg=Xr),ur}};var Wo={wrap:h9,isGeneratorFunction:y9,AsyncIterator:i1,mark:U1e,awrap:z1e,async:q1e,keys:G1e,values:K_};function Y1e(e,t,n){var i=e.open(t),r=1e4,s=250,o=new URL(t),a=o.origin,u=~~(r/s);function l(f){f.source===i&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(i.postMessage(n,a),setTimeout(c,s),u-=1)}setTimeout(c,s)}var V1e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper.fit-x {
    width: 100%; }
  .vega-embed .chart-wrapper.fit-y {
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function x9(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];X1e(e,o)}return e}function X1e(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];lc(e,r,t[r],!0)}}var J_;function w9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function Go(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w9(Object(n),!0).forEach(function(i){L1e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w9(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var Yo=zoe,Qd=q0e,r1=typeof window!="undefined"?window:void 0;Qd===void 0&&r1!==null&&r1!==void 0&&(J_=r1.vl)!==null&&J_!==void 0&&J_.compile&&(Qd=r1.vl);var Q1e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},K1e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Kd={vega:"Vega","vega-lite":"Vega-Lite"},s1={vega:Yo.version,"vega-lite":Qd?Qd.version:"not available"},J1e={vega:e=>e,"vega-lite":(e,t)=>Qd.compile(e,{config:t}).spec},Z1e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,eye="chart-wrapper";function tye(e){return typeof e=="function"}function E9(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),s="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(r+e+s),o.document.title="".concat(Kd[i]," JSON Source")}function nye(e,t){if(e.$schema){var n=e9(e.$schema);if(t&&t!==n.library){var i;console.warn("The given visualization spec is written in ".concat(Kd[n.library],", but mode argument sets ").concat((i=Kd[t])!==null&&i!==void 0?i:t,"."))}var r=n.library;return qS.satisfies(s1[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(Kd[r]," ").concat(n.version,", but the current version of ").concat(Kd[r]," is v").concat(s1[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function iye(e){return!!(e&&"load"in e)}function A9(e){return iye(e)?e:Yo.loader(e)}function _9(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function Aye(e,t){return Z_.apply(this,arguments)}function Z_(){return Z_=K0(Wo.mark(function e(t,n){var i,r,s,o,a,u,l,c,f,h,g=arguments;return Wo.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=g.length>2&&g[2]!==void 0?g[2]:{},!Oe(n)){m.next=10;break}return a=A9(s.loader),m.t0=JSON,m.next=6,a.load(n);case 6:m.t1=m.sent,o=m.t0.parse.call(m.t0,m.t1),m.next=11;break;case 10:o=n;case 11:return u=_9(o).loader,(!a||u)&&(a=A9((l=s.loader)!==null&&l!==void 0?l:u)),m.next=15,S9(_9(o),a);case 15:return c=m.sent,m.next=18,S9(s,a);case 18:return f=m.sent,h=Go(Go({},x9(f,c)),{},{config:mh((i=f.config)!==null&&i!==void 0?i:{},(r=c.config)!==null&&r!==void 0?r:{})}),m.next=22,sye(t,o,h,a);case 22:return m.abrupt("return",m.sent);case 23:case"end":return m.stop()}},e)})),Z_.apply(this,arguments)}function S9(e,t){return eS.apply(this,arguments)}function eS(){return eS=K0(Wo.mark(function e(t,n){var i,r,s;return Wo.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!Oe(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=(i=t.config)!==null&&i!==void 0?i:{};case 9:if(r=a.t0,!Oe(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return s=a.t3,a.abrupt("return",Go(Go(Go({},t),s?{patch:s}:{}),r?{config:r}:{}));case 21:case"end":return a.stop()}},e)})),eS.apply(this,arguments)}function rye(e){var t=e.getRootNode?e.getRootNode():document;if(t instanceof ShadowRoot)return{root:t,rootContainer:t};var n;return{root:document,rootContainer:(n=document.head)!==null&&n!==void 0?n:document.body}}function sye(e,t){return tS.apply(this,arguments)}function tS(){return tS=K0(Wo.mark(function e(t,n){var i,r,s,o,a,u,l,c,f,h,g,p,m,y,x,w,E,A,S,O,_,C,j,$,k,M,D,I,F,L,B,W,X,ce,Te,$e,it,He,lt,cn,Di,fi,V,le,me,z,ht,we,bt,ct=arguments;return Wo.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:if(bt=function(){$e&&document.removeEventListener("click",$e),L.finalize()},c=ct.length>2&&ct[2]!==void 0?ct[2]:{},f=ct.length>3?ct[3]:void 0,h=c.theme?mh($1e[c.theme],(i=c.config)!==null&&i!==void 0?i:{}):c.config,g=q1(c.actions)?c.actions:x9({},Q1e,(r=c.actions)!==null&&r!==void 0?r:{}),p=Go(Go({},K1e),c.i18n),m=(s=c.renderer)!==null&&s!==void 0?s:"canvas",y=(o=c.logLevel)!==null&&o!==void 0?o:Yo.Warn,x=(a=c.downloadFileName)!==null&&a!==void 0?a:"visualization",w=typeof t=="string"?document.querySelector(t):t,w){Kr.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(E="vega-embed-style",A=rye(w),S=A.root,O=A.rootContainer,S.getElementById(E)||(_=document.createElement("style"),_.id=E,_.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?V1e.toString():c.defaultStyle,O.appendChild(_))),C=nye(n,c.mode),j=J1e[C](n,h),C==="vega-lite"&&j.$schema&&($=e9(j.$schema),qS.satisfies(s1.vega,"^".concat($.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat($.version,", but current version is v").concat(s1.vega,"."))),w.classList.add("vega-embed"),g&&w.classList.add("has-actions"),w.innerHTML="",k=w,g&&(M=document.createElement("div"),M.classList.add(eye),w.appendChild(M),k=M),D=c.patch,D&&(D instanceof Function?j=D(j):j=eh(j,D,!0,!1).newDocument),c.formatLocale&&Yo.formatLocale(c.formatLocale),c.timeFormatLocale&&Yo.timeFormatLocale(c.timeFormatLocale),I=c.ast,F=Yo.parse(j,C==="vega-lite"?{}:h,{ast:I}),L=new(c.viewClass||Yo.View)(F,Go({loader:f,logLevel:y,renderer:m},I?{expr:(u=(l=Yo.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:Joe}:{})),L.addSignalListener("autosize",(lr,kn)=>{var Kn=kn.type;Kn=="fit-x"?(k.classList.add("fit-x"),k.classList.remove("fit-y")):Kn=="fit-y"?(k.classList.remove("fit-x"),k.classList.add("fit-y")):Kn=="fit"?k.classList.add("fit-x","fit-y"):k.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(tye(c.tooltip)?B=c.tooltip:B=new P1e(c.tooltip===!0?{}:c.tooltip).call,L.tooltip(B)),W=c.hover,W===void 0&&(W=C==="vega"),W&&(X=typeof W=="boolean"?{}:W,ce=X.hoverSet,Te=X.updateSet,L.hover(ce,Te)),c&&(c.width!=null&&L.width(c.width),c.height!=null&&L.height(c.height),c.padding!=null&&L.padding(c.padding)),Kr.next=36,L.initialize(k,c.bind).runAsync();case 36:if(g!==!1){if(it=w,c.defaultStyle!==!1&&(He=document.createElement("details"),He.title=p.CLICK_TO_VIEW_ACTIONS,w.append(He),it=He,lt=document.createElement("summary"),lt.innerHTML=Z1e,He.append(lt),$e=lr=>{He.contains(lr.target)||He.removeAttribute("open")},document.addEventListener("click",$e)),cn=document.createElement("div"),it.append(cn),cn.classList.add("vega-actions"),g===!0||g.export!==!1)for(Di=function(){var kn=V[fi];if(g===!0||g.export===!0||g.export[kn]){var Kn=p["".concat(kn.toUpperCase(),"_ACTION")],pu=document.createElement("a");pu.text=Kn,pu.href="#",pu.target="_blank",pu.download="".concat(x,".").concat(kn),pu.addEventListener("mousedown",function(){var D9=K0(Wo.mark(function oS(M9){var aS;return Wo.wrap(function(ec){for(;;)switch(ec.prev=ec.next){case 0:return M9.preventDefault(),ec.next=3,L.toImageURL(kn,c.scaleFactor);case 3:aS=ec.sent,this.href=aS;case 5:case"end":return ec.stop()}},oS,this)}));return function(oS){return D9.apply(this,arguments)}}()),cn.append(pu)}},fi=0,V=["svg","png"];fi<V.length;fi++)Di();(g===!0||g.source!==!1)&&(le=document.createElement("a"),le.text=p.SOURCE_ACTION,le.href="#",le.addEventListener("click",function(lr){var kn,Kn;E9(x1(n),(kn=c.sourceHeader)!==null&&kn!==void 0?kn:"",(Kn=c.sourceFooter)!==null&&Kn!==void 0?Kn:"",C),lr.preventDefault()}),cn.append(le)),C==="vega-lite"&&(g===!0||g.compiled!==!1)&&(me=document.createElement("a"),me.text=p.COMPILED_ACTION,me.href="#",me.addEventListener("click",function(lr){var kn,Kn;E9(x1(j),(kn=c.sourceHeader)!==null&&kn!==void 0?kn:"",(Kn=c.sourceFooter)!==null&&Kn!==void 0?Kn:"","vega"),lr.preventDefault()}),cn.append(me)),(g===!0||g.editor!==!1)&&(ht=(z=c.editorUrl)!==null&&z!==void 0?z:"https://vega.github.io/editor/",we=document.createElement("a"),we.text=p.EDITOR_ACTION,we.href="#",we.addEventListener("click",function(lr){Y1e(window,ht,{config:h,mode:C,renderer:m,spec:x1(n)}),lr.preventDefault()}),cn.append(we))}return Kr.abrupt("return",{view:L,spec:n,vgSpec:j,finalize:bt});case 38:case"end":return Kr.stop()}},e)})),tS.apply(this,arguments)}const Qn=Symbol("data"),O9=Symbol("context");class ki{toObject(){return C9(this)}}class oye{constructor(t){this[Qn]=t}toObject(){return Object.assign({},...o1(this[Qn]))}}function gu(e,...t){return t.length===1&&Array.isArray(t[0])?e[Qn]=t[0]:t.forEach(n=>{Object.assign(e[Qn],u1(n)&&n[Qn]||n)}),e}function ln(e){return Array.isArray(e)?[].concat(...e):e}function v(e,t){return e[Qn][t]}function d(e,t,n){e[Qn][t]=aye(n)}function nS(...e){return Object.assign(Object.create(Object.getPrototypeOf(e[0])),...e)}function b(e){return nS(e,{[Qn]:Object.assign({},e[Qn])})}function Fi(e,t){e[Qn]=t||{}}function Zl(e,t){const n={[O9]:t};return Ds(e)?e.map(i=>nS(i,n)):nS(e,n)}function o1(e){return e&&e.toObject?e.toObject(e[O9]||0):C9(e)}function C9(e){if(Ds(e))return e.map(t=>o1(t));if(u1(e)){const t=e[Qn]||e;return Ds(t)?o1(t):Object.keys(t).reduce((n,i)=>(n[i]=o1(t[i]),n),{})}else return e}function Vo(e){return{[Qn]:e,toObject:()=>e}}function aye(e){return u1(e)&&!e[Qn]?{[Qn]:e||{}}:e}function qe(e,...t){const n=[].concat(...t);return new oye(e?Zl(n,e):n)}const Ds=Array.isArray;function a1(e){return u1(e)&&typeof e[Symbol.iterator]=="function"}function u1(e){return e===Object(e)&&!Ds(e)}function Qr(e){return typeof e=="string"}var uye,$9,j9;function k9(...e){const t=Object.assign({},j9);return t.view=Object.assign({},j9.view,...e),t.view.spec&&(t.spec=t.view.spec,delete t.view.spec),t}function lye(){return typeof document=="undefined"?void 0:document.createElement("div")}function iS(e){return Object.assign({$schema:"https://vega.github.io/schema/vega-lite/v5.json"},e.toObject())}function F9(e,t){throw Error('Vega / Vega-Lite not registered. Use the "register" method.')}async function l1(e){e=k9({container:e&&e.container||lye()},e);const t=await F9(this,e).runAsync(),n=t.container()||{};return n.value=t,n}function c1(e){return F9(this,k9(e))}function f1(){return iS(this)}function d1(e){return JSON.stringify(iS(this),null,e)}class cye extends ki{constructor(...t){super();Fi(this),t[0]!==void 0&&d(this,"repeat",t[0]),t[1]!==void 0&&d(this,"spec",t[1])}align(t){if(arguments.length){const n=b(this);return d(n,"align",t),n}else return v(this,"align")}autosize(t){if(arguments.length){const n=b(this);return d(n,"autosize",t),n}else return v(this,"autosize")}background(t){if(arguments.length){const n=b(this);return d(n,"background",t),n}else return v(this,"background")}bounds(t){if(arguments.length){const n=b(this);return d(n,"bounds",t),n}else return v(this,"bounds")}center(t){if(arguments.length){const n=b(this);return d(n,"center",t),n}else return v(this,"center")}columns(t){if(arguments.length){const n=b(this);return d(n,"columns",t),n}else return v(this,"columns")}config(t){if(arguments.length){const n=b(this);return d(n,"config",t),n}else return v(this,"config")}datasets(t){if(arguments.length){const n=b(this);return d(n,"datasets",t),n}else return v(this,"datasets")}description(t){if(arguments.length){const n=b(this);return d(n,"description",t),n}else return v(this,"description")}name(t){if(arguments.length){const n=b(this);return d(n,"name",t),n}else return v(this,"name")}padding(t){if(arguments.length){const n=b(this);return d(n,"padding",t),n}else return v(this,"padding")}resolve(t){if(arguments.length){const n=b(this);return d(n,"resolve",t),n}else return v(this,"resolve")}spacing(t){if(arguments.length){const n=b(this);return d(n,"spacing",t),n}else return v(this,"spacing")}spec(t){if(arguments.length){const n=b(this);return d(n,"spec",t),n}else return v(this,"spec")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}usermeta(t){if(arguments.length){const n=b(this);return d(n,"usermeta",t),n}else return v(this,"usermeta")}data(t){if(arguments.length){const n=b(this);return t=Ds(t)?{values:Vo(t)}:a1(t)?{values:Vo(t)}:Qr(t)?{url:t}:t,d(n,"data",t),n}else return v(this,"data")}params(...t){if(arguments.length){const n=b(this);return t=ln(t),t=Zl(t,1),d(n,"params",t),n}else return v(this,"params")}transform(...t){if(arguments.length){const n=b(this);return t=ln(t),d(n,"transform",t),n}else return v(this,"transform")}facet(...t){return t=t.slice(0,1),sS(...t).spec(this)}render(...t){return l1.apply(this,t)}toView(...t){return c1.apply(this,t)}toSpec(...t){return f1.apply(this,t)}toString(...t){return d1.apply(this,t)}}function rS(...e){return new cye(...e)}class fye extends ki{constructor(...t){super();Fi(this),t[0]!==void 0&&d(this,"facet",t[0]),t[1]!==void 0&&d(this,"spec",t[1])}align(t){if(arguments.length){const n=b(this);return d(n,"align",t),n}else return v(this,"align")}autosize(t){if(arguments.length){const n=b(this);return d(n,"autosize",t),n}else return v(this,"autosize")}background(t){if(arguments.length){const n=b(this);return d(n,"background",t),n}else return v(this,"background")}bounds(t){if(arguments.length){const n=b(this);return d(n,"bounds",t),n}else return v(this,"bounds")}center(t){if(arguments.length){const n=b(this);return d(n,"center",t),n}else return v(this,"center")}columns(t){if(arguments.length){const n=b(this);return d(n,"columns",t),n}else return v(this,"columns")}config(t){if(arguments.length){const n=b(this);return d(n,"config",t),n}else return v(this,"config")}datasets(t){if(arguments.length){const n=b(this);return d(n,"datasets",t),n}else return v(this,"datasets")}description(t){if(arguments.length){const n=b(this);return d(n,"description",t),n}else return v(this,"description")}name(t){if(arguments.length){const n=b(this);return d(n,"name",t),n}else return v(this,"name")}padding(t){if(arguments.length){const n=b(this);return d(n,"padding",t),n}else return v(this,"padding")}resolve(t){if(arguments.length){const n=b(this);return d(n,"resolve",t),n}else return v(this,"resolve")}spacing(t){if(arguments.length){const n=b(this);return d(n,"spacing",t),n}else return v(this,"spacing")}spec(t){if(arguments.length){const n=b(this);return d(n,"spec",t),n}else return v(this,"spec")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}usermeta(t){if(arguments.length){const n=b(this);return d(n,"usermeta",t),n}else return v(this,"usermeta")}data(t){if(arguments.length){const n=b(this);return t=Ds(t)?{values:Vo(t)}:a1(t)?{values:Vo(t)}:Qr(t)?{url:t}:t,d(n,"data",t),n}else return v(this,"data")}params(...t){if(arguments.length){const n=b(this);return t=ln(t),t=Zl(t,1),d(n,"params",t),n}else return v(this,"params")}transform(...t){if(arguments.length){const n=b(this);return t=ln(t),d(n,"transform",t),n}else return v(this,"transform")}repeat(...t){return t=t.slice(0,1),rS(...t).spec(this)}render(...t){return l1.apply(this,t)}toView(...t){return c1.apply(this,t)}toSpec(...t){return f1.apply(this,t)}toString(...t){return d1.apply(this,t)}}function sS(...e){return new fye(...e)}class dye extends ki{constructor(...t){super();Fi(this),t=t.map(n=>Qr(n)?{type:n}:n),d(this,"mark",qe(0,v(this,"mark"),t))}align(t){if(arguments.length){const n=b(this);return d(n,"align",t),n}else return v(this,"align")}autosize(t){if(arguments.length){const n=b(this);return d(n,"autosize",t),n}else return v(this,"autosize")}background(t){if(arguments.length){const n=b(this);return d(n,"background",t),n}else return v(this,"background")}bounds(t){if(arguments.length){const n=b(this);return d(n,"bounds",t),n}else return v(this,"bounds")}center(t){if(arguments.length){const n=b(this);return d(n,"center",t),n}else return v(this,"center")}config(t){if(arguments.length){const n=b(this);return d(n,"config",t),n}else return v(this,"config")}datasets(t){if(arguments.length){const n=b(this);return d(n,"datasets",t),n}else return v(this,"datasets")}description(t){if(arguments.length){const n=b(this);return d(n,"description",t),n}else return v(this,"description")}height(t){if(arguments.length){const n=b(this);return d(n,"height",t),n}else return v(this,"height")}name(t){if(arguments.length){const n=b(this);return d(n,"name",t),n}else return v(this,"name")}padding(t){if(arguments.length){const n=b(this);return d(n,"padding",t),n}else return v(this,"padding")}resolve(t){if(arguments.length){const n=b(this);return d(n,"resolve",t),n}else return v(this,"resolve")}spacing(t){if(arguments.length){const n=b(this);return d(n,"spacing",t),n}else return v(this,"spacing")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}usermeta(t){if(arguments.length){const n=b(this);return d(n,"usermeta",t),n}else return v(this,"usermeta")}view(t){if(arguments.length){const n=b(this);return d(n,"view",t),n}else return v(this,"view")}width(t){if(arguments.length){const n=b(this);return d(n,"width",t),n}else return v(this,"width")}mark(...t){if(arguments.length){t=t.map(i=>Qr(i)?{type:i}:i);const n=b(this);return d(n,"mark",qe(0,t)),n}else return v(this,"mark")}select(...t){if(arguments.length){const n=b(this);return t=ln(t),t=Zl(t,1),d(n,"params",t),n}else return v(this,"params")}project(t){if(arguments.length){const n=b(this);return d(n,"projection",t),n}else return v(this,"projection")}encode(...t){if(t.length===1&&Array.isArray(t[0])&&(t=t[0]),t.length){const n=v(this,"encoding"),i=b(this);return n&&(t=[n].concat(t)),d(i,"encoding",qe(1,t)),i}else return v(this,"encoding")}data(t){if(arguments.length){const n=b(this);return t=Ds(t)?{values:Vo(t)}:a1(t)?{values:Vo(t)}:Qr(t)?{url:t}:t,d(n,"data",t),n}else return v(this,"data")}params(...t){if(arguments.length){const n=b(this);return t=ln(t),t=Zl(t,1),d(n,"params",t),n}else return v(this,"params")}transform(...t){if(arguments.length){const n=b(this);return t=ln(t),d(n,"transform",t),n}else return v(this,"transform")}markArc(...t){t=[{type:"arc"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markArea(...t){t=[{type:"area"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markBar(...t){t=[{type:"bar"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markBoxplot(...t){t=[{type:"boxplot"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markCircle(...t){t=[{type:"circle"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markErrorband(...t){t=[{type:"errorband"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markErrorbar(...t){t=[{type:"errorbar"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markGeoshape(...t){t=[{type:"geoshape"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markImage(...t){t=[{type:"image"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markLine(...t){t=[{type:"line"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markPoint(...t){t=[{type:"point"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markRect(...t){t=[{type:"rect"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markRule(...t){t=[{type:"rule"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markSquare(...t){t=[{type:"square"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markText(...t){t=[{type:"text"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markTick(...t){t=[{type:"tick"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}markTrail(...t){t=[{type:"trail"}].concat(t);const n=b(this);return d(n,"mark",qe(0,t)),n}facet(...t){return t=t.slice(0,1),sS(...t).spec(this)}repeat(...t){return t=t.slice(0,1),rS(...t).spec(this)}render(...t){return l1.apply(this,t)}toView(...t){return c1.apply(this,t)}toSpec(...t){return f1.apply(this,t)}toString(...t){return d1.apply(this,t)}}function Jd(...e){return new dye(...e)}function _ye(...e){return Jd({type:"bar"},...e)}function Sye(...e){return Jd({type:"circle"},...e)}function Oye(...e){return Jd({type:"line"},...e)}function Cye(...e){return Jd({type:"point"},...e)}function $ye(...e){return Jd({type:"text"},...e)}class hye extends ki{constructor(...t){super();Fi(this),t=ln(t),d(this,"layer",t)}autosize(t){if(arguments.length){const n=b(this);return d(n,"autosize",t),n}else return v(this,"autosize")}background(t){if(arguments.length){const n=b(this);return d(n,"background",t),n}else return v(this,"background")}config(t){if(arguments.length){const n=b(this);return d(n,"config",t),n}else return v(this,"config")}datasets(t){if(arguments.length){const n=b(this);return d(n,"datasets",t),n}else return v(this,"datasets")}description(t){if(arguments.length){const n=b(this);return d(n,"description",t),n}else return v(this,"description")}height(t){if(arguments.length){const n=b(this);return d(n,"height",t),n}else return v(this,"height")}layer(...t){if(arguments.length){const n=b(this);return t=ln(t),d(n,"layer",t),n}else return v(this,"layer")}name(t){if(arguments.length){const n=b(this);return d(n,"name",t),n}else return v(this,"name")}padding(t){if(arguments.length){const n=b(this);return d(n,"padding",t),n}else return v(this,"padding")}resolve(t){if(arguments.length){const n=b(this);return d(n,"resolve",t),n}else return v(this,"resolve")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}usermeta(t){if(arguments.length){const n=b(this);return d(n,"usermeta",t),n}else return v(this,"usermeta")}view(t){if(arguments.length){const n=b(this);return d(n,"view",t),n}else return v(this,"view")}width(t){if(arguments.length){const n=b(this);return d(n,"width",t),n}else return v(this,"width")}project(t){if(arguments.length){const n=b(this);return d(n,"projection",t),n}else return v(this,"projection")}encode(...t){if(t.length===1&&Array.isArray(t[0])&&(t=t[0]),t.length){const n=v(this,"encoding"),i=b(this);return n&&(t=[n].concat(t)),d(i,"encoding",qe(1,t)),i}else return v(this,"encoding")}data(t){if(arguments.length){const n=b(this);return t=Ds(t)?{values:Vo(t)}:a1(t)?{values:Vo(t)}:Qr(t)?{url:t}:t,d(n,"data",t),n}else return v(this,"data")}params(...t){if(arguments.length){const n=b(this);return t=ln(t),t=Zl(t,1),d(n,"params",t),n}else return v(this,"params")}transform(...t){if(arguments.length){const n=b(this);return t=ln(t),d(n,"transform",t),n}else return v(this,"transform")}facet(...t){return t=t.slice(0,1),sS(...t).spec(this)}repeat(...t){return t=t.slice(0,1),rS(...t).spec(this)}render(...t){return l1.apply(this,t)}toView(...t){return c1.apply(this,t)}toSpec(...t){return f1.apply(this,t)}toString(...t){return d1.apply(this,t)}}function jye(...e){return new hye(...e)}class gye extends ki{constructor(...t){super();Fi(this),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}condition(...t){if(arguments.length){const n=b(this);return t.length===1&&!Array.isArray(t[0])?t=t[0]:t=ln(t),d(n,"condition",t),n}else return v(this,"condition")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}legend(t){if(arguments.length){const n=b(this);return d(n,"legend",t),n}else return v(this,"legend")}scale(t){if(arguments.length){const n=b(this);return d(n,"scale",t),n}else return v(this,"scale")}sort(t){if(arguments.length){const n=b(this);return d(n,"sort",t),n}else return v(this,"sort")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}datum(t){if(arguments.length){const n=b(this);return d(n,"datum",t),n}else return v(this,"datum")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{color:super.toObject()}:super.toObject()}}function kye(...e){return new gye(...e)}class pye extends ki{constructor(...t){super();Fi(this),t=t.map(n=>Qr(n)?{field:n,type:"ordinal"}:n),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}sort(t){if(arguments.length){const n=b(this);return d(n,"sort",t),n}else return v(this,"sort")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}condition(...t){if(arguments.length){const n=b(this);return t.length===1&&!Array.isArray(t[0])?t=t[0]:t=ln(t),d(n,"condition",t),n}else return v(this,"condition")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{order:super.toObject()}:super.toObject()}}function Fye(...e){return new pye(...e)}class mye extends ki{constructor(...t){super();Fi(this),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}condition(...t){if(arguments.length){const n=b(this);return t.length===1&&!Array.isArray(t[0])?t=t[0]:t=ln(t),d(n,"condition",t),n}else return v(this,"condition")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}legend(t){if(arguments.length){const n=b(this);return d(n,"legend",t),n}else return v(this,"legend")}scale(t){if(arguments.length){const n=b(this);return d(n,"scale",t),n}else return v(this,"scale")}sort(t){if(arguments.length){const n=b(this);return d(n,"sort",t),n}else return v(this,"sort")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}datum(t){if(arguments.length){const n=b(this);return d(n,"datum",t),n}else return v(this,"datum")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{size:super.toObject()}:super.toObject()}}function Dye(...e){return new mye(...e)}class yye extends ki{constructor(...t){super();Fi(this),t=t.map(n=>Qr(n)?{field:n,type:"nominal"}:n),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}condition(...t){if(arguments.length){const n=b(this);return t.length===1&&!Array.isArray(t[0])?t=t[0]:t=ln(t),d(n,"condition",t),n}else return v(this,"condition")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}format(t){if(arguments.length){const n=b(this);return d(n,"format",t),n}else return v(this,"format")}formatType(t){if(arguments.length){const n=b(this);return d(n,"formatType",t),n}else return v(this,"formatType")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}datum(t){if(arguments.length){const n=b(this);return d(n,"datum",t),n}else return v(this,"datum")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{text:super.toObject()}:super.toObject()}}function Mye(...e){return new yye(...e)}class bye extends ki{constructor(...t){super();Fi(this),t=t.map(n=>Ds(n)?n.map(i=>Qr(i)?{field:i,type:"nominal"}:i):Qr(n)?{field:n,type:"nominal"}:n),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}condition(...t){if(arguments.length){const n=b(this);return t.length===1&&!Array.isArray(t[0])?t=t[0]:t=ln(t),d(n,"condition",t),n}else return v(this,"condition")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}format(t){if(arguments.length){const n=b(this);return d(n,"format",t),n}else return v(this,"format")}formatType(t){if(arguments.length){const n=b(this);return d(n,"formatType",t),n}else return v(this,"formatType")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{tooltip:super.toObject()}:super.toObject()}}function Tye(...e){return new bye(...e)}class vye extends ki{constructor(...t){super();Fi(this),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}axis(t){if(arguments.length){const n=b(this);return d(n,"axis",t),n}else return v(this,"axis")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}impute(t){if(arguments.length){const n=b(this);return d(n,"impute",t),n}else return v(this,"impute")}scale(t){if(arguments.length){const n=b(this);return d(n,"scale",t),n}else return v(this,"scale")}sort(t){if(arguments.length){const n=b(this);return d(n,"sort",t),n}else return v(this,"sort")}stack(t){if(arguments.length){const n=b(this);return d(n,"stack",t),n}else return v(this,"stack")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}datum(t){if(arguments.length){const n=b(this);return d(n,"datum",t),n}else return v(this,"datum")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{x:super.toObject()}:super.toObject()}}function Nye(...e){return new vye(...e)}class xye extends ki{constructor(...t){super();Fi(this),gu(this,...t)}aggregate(t){if(arguments.length){const n=b(this);return d(n,"aggregate",t),n}else return v(this,"aggregate")}axis(t){if(arguments.length){const n=b(this);return d(n,"axis",t),n}else return v(this,"axis")}bandPosition(t){if(arguments.length){const n=b(this);return d(n,"bandPosition",t),n}else return v(this,"bandPosition")}bin(t){if(arguments.length){const n=b(this);return d(n,"bin",t),n}else return v(this,"bin")}field(t){if(arguments.length){const n=b(this);return d(n,"field",t),n}else return v(this,"field")}impute(t){if(arguments.length){const n=b(this);return d(n,"impute",t),n}else return v(this,"impute")}scale(t){if(arguments.length){const n=b(this);return d(n,"scale",t),n}else return v(this,"scale")}sort(t){if(arguments.length){const n=b(this);return d(n,"sort",t),n}else return v(this,"sort")}stack(t){if(arguments.length){const n=b(this);return d(n,"stack",t),n}else return v(this,"stack")}timeUnit(t){if(arguments.length){const n=b(this);return d(n,"timeUnit",t),n}else return v(this,"timeUnit")}title(t){if(arguments.length){const n=b(this);return d(n,"title",t),n}else return v(this,"title")}type(t){if(arguments.length){const n=b(this);return d(n,"type",t),n}else return v(this,"type")}datum(t){if(arguments.length){const n=b(this);return d(n,"datum",t),n}else return v(this,"datum")}value(t){if(arguments.length){const n=b(this);return d(n,"value",t),n}else return v(this,"value")}fieldN(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","nominal"),n}else return v(this,"field")}fieldO(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","ordinal"),n}else return v(this,"field")}fieldQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),n}else return v(this,"field")}fieldT(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),n}else return v(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=v(this,"condition")||[],i=b(this);return t=[].concat(n,qe(0,t)),d(i,"condition",t.length>1?t:t[0]),i}else return v(this,"condition")}count(){const t=b(this);return d(t,"type","quantitative"),d(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","valid"),n}else return v(this,"field")}missing(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","missing"),n}else return v(this,"field")}distinct(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","distinct"),n}else return v(this,"field")}sum(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","sum"),n}else return v(this,"field")}mean(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","mean"),n}else return v(this,"field")}product(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","product"),n}else return v(this,"field")}average(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","average"),n}else return v(this,"field")}variance(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variance"),n}else return v(this,"field")}variancep(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","variancep"),n}else return v(this,"field")}stdev(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdev"),n}else return v(this,"field")}stdevp(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stdevp"),n}else return v(this,"field")}stderr(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","stderr"),n}else return v(this,"field")}median(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","median"),n}else return v(this,"field")}q1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q1"),n}else return v(this,"field")}q3(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","q3"),n}else return v(this,"field")}ci0(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci0"),n}else return v(this,"field")}ci1(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","ci1"),n}else return v(this,"field")}min(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","min"),n}else return v(this,"field")}max(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","max"),n}else return v(this,"field")}argmin(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmin"),n}else return v(this,"field")}argmax(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","quantitative"),d(n,"aggregate","argmax"),n}else return v(this,"field")}year(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","year"),n}else return v(this,"field")}quarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quarter"),n}else return v(this,"field")}month(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","month"),n}else return v(this,"field")}day(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","day"),n}else return v(this,"field")}date(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","date"),n}else return v(this,"field")}hours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hours"),n}else return v(this,"field")}minutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutes"),n}else return v(this,"field")}seconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","seconds"),n}else return v(this,"field")}milliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","milliseconds"),n}else return v(this,"field")}yearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquarter"),n}else return v(this,"field")}timeYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearquartermonth"),n}else return v(this,"field")}timeYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonth"),n}else return v(this,"field")}timeYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdate"),n}else return v(this,"field")}timeYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehours"),n}else return v(this,"field")}timeYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutes"),n}else return v(this,"field")}timeYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return v(this,"field")}timeQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","quartermonth"),n}else return v(this,"field")}timeMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdate"),n}else return v(this,"field")}timeMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","monthdatehours"),n}else return v(this,"field")}timeHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutes"),n}else return v(this,"field")}timeHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","hoursminutesseconds"),n}else return v(this,"field")}timeMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","minutesseconds"),n}else return v(this,"field")}timeSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","secondsmilliseconds"),n}else return v(this,"field")}utcyear(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyear"),n}else return v(this,"field")}utcquarter(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquarter"),n}else return v(this,"field")}utcmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonth"),n}else return v(this,"field")}utcday(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcday"),n}else return v(this,"field")}utcdate(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcdate"),n}else return v(this,"field")}utchours(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchours"),n}else return v(this,"field")}utcminutes(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutes"),n}else return v(this,"field")}utcseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcseconds"),n}else return v(this,"field")}utcmilliseconds(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmilliseconds"),n}else return v(this,"field")}utcyearmonth(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYQ(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquarter"),n}else return v(this,"field")}utcYQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearquartermonth"),n}else return v(this,"field")}utcYM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonth"),n}else return v(this,"field")}utcYMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdate"),n}else return v(this,"field")}utcYMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehours"),n}else return v(this,"field")}utcYMDHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return v(this,"field")}utcYMDHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return v(this,"field")}utcQM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcquartermonth"),n}else return v(this,"field")}utcMD(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdate"),n}else return v(this,"field")}utcMDH(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcmonthdatehours"),n}else return v(this,"field")}utcHM(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutes"),n}else return v(this,"field")}utcHMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utchoursminutesseconds"),n}else return v(this,"field")}utcMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcminutesseconds"),n}else return v(this,"field")}utcSMS(t){if(arguments.length){const n=b(this);return d(n,"field",t),d(n,"type","temporal"),d(n,"timeUnit","utcsecondsmilliseconds"),n}else return v(this,"field")}toObject(t){return t?{y:super.toObject()}:super.toObject()}}function Rye(...e){return new xye(...e)}class wye extends ki{constructor(...t){super();Fi(this),t[0]!==void 0&&d(this,"filter",t[0])}filter(t){if(arguments.length){const n=b(this);return d(n,"filter",t),n}else return v(this,"filter")}}function Pye(...e){return new wye(...e)}export{_ye as a,Oye as b,Cye as c,kye as d,Aye as e,Pye as f,$ye as g,Mye as h,jye as l,Sye as m,Fye as o,Dye as s,Tye as t,Nye as x,Rye as y};

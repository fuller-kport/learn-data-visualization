/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var M9=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),T9=Object.prototype.hasOwnProperty;function o1(e,t){return T9.call(e,t)}function a1(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)o1(e,i)&&n.push(i);return n}function Qn(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function u1(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function qo(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function rO(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function l1(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(l1(e[t]))return!0}else if(typeof e=="object"){for(var i=a1(e),r=i.length,t=0;t<r;t++)if(l1(e[i[t]]))return!0}}return!1}function sO(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r!="undefined"&&n.push(i+": "+r)}return n.join(`
`)}var oO=function(e){M9(t,e);function t(n,i,r,s,o){var a=this.constructor,u=e.call(this,sO(n,{name:i,index:r,operation:s,tree:o}))||this;return u.name=i,u.index=r,u.operation=s,u.tree=o,Object.setPrototypeOf(u,a.prototype),u.message=sO(n,{name:i,index:r,operation:s,tree:o}),u}return t}(Error),it=oO,N9=Qn,fu={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Qd(n,this.path);i&&(i=Qn(i));var r=Wo(n,{op:"remove",path:this.from}).removed;return Wo(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Qd(n,this.from);return Wo(n,{op:"add",path:this.path,value:Qn(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:Kl(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},R9={add:function(e,t,n){return u1(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:fu.move,copy:fu.copy,test:fu.test,_get:fu._get};function Qd(e,t){if(t=="")return e;var n={op:"_get",path:t};return Wo(e,n),n.value}function Wo(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):Zd(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=Qd(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=Kl(e,t.value),o.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new it("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=Qn(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=Zd;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=rO(h)),r&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!u1(h))throw new it("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);u1(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new it("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=R9[t.op].call(t,l,h,e);if(o.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){var o=fu[t.op].call(t,l,h,e);if(o.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new it("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function Jd(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new it("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Qn(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Wo(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function L9(e,t,n){var i=Wo(e,t);if(i.test===!1)throw new it("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function Zd(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new it("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(fu[e.op]){if(typeof e.path!="string")throw new it("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new it('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new it("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new it("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&l1(e.value))throw new it("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new it("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new it("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=aO([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new it("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new it("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function aO(e,t,n){try{if(!Array.isArray(e))throw new it("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Jd(Qn(t),Qn(e),n||!0);else{n=n||Zd;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof it)return r;throw r}}function Kl(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!=0;)if(!Kl(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!=0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!=0;)if(o=a[r],!Kl(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var P9=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:it,deepClone:N9,getValueByPointer:Qd,applyOperation:Wo,applyPatch:Jd,applyReducer:L9,validator:Zd,validate:aO,_areEquals:Kl});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var c1=new WeakMap,I9=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),B9=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function z9(e){return c1.get(e)}function U9(e,t){return e.observers.get(t)}function q9(e,t){e.observers.delete(t.callback)}function W9(e,t){t.unobserve()}function H9(e,t){var n=[],i,r=z9(e);if(!r)r=new I9(e),c1.set(e,r);else{var s=U9(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=Qn(e),t){i.callback=t,i.next=null;var o=function(){f1(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){f1(i),clearTimeout(i.next),q9(r,i),typeof window!="undefined"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new B9(t,i)),i}function f1(e,t){t===void 0&&(t=!1);var n=c1.get(e.object);d1(n.value,e.object,e.patches,"",t),e.patches.length&&Jd(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function d1(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=a1(t),o=a1(e),a=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(o1(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?d1(c,f,n,i+"/"+qo(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+qo(l),value:Qn(c)}),n.push({op:"replace",path:i+"/"+qo(l),value:Qn(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+qo(l),value:Qn(c)}),n.push({op:"remove",path:i+"/"+qo(l)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var u=0;u<s.length;u++){var l=s[u];!o1(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+qo(l),value:Qn(t[l])})}}}function G9(e,t,n){n===void 0&&(n=!1);var i=[];return d1(e,t,i,"",n),i}var Y9=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:W9,observe:H9,generate:f1,compare:G9});Object.assign({},P9,Y9,{JsonPatchError:oO,deepClone:Qn,escapePathComponent:qo,unescapePathComponent:rO});var V9=/("(?:[^\\"]|\\.)*")|[:,]/g,h1=function(t,n){var i,r,s;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?1/0:n.maxLength===void 0?80:n.maxLength,s=n.replacer,function o(a,u,l){var c,f,d,h,g,p,m,y,b,x,w,_;if(a&&typeof a.toJSON=="function"&&(a=a.toJSON()),w=JSON.stringify(a,s),w===void 0)return w;if(m=r-u.length-l,w.length<=m&&(b=w.replace(V9,function(A,E){return E||A+" "}),b.length<=m))return b;if(s!=null&&(a=JSON.parse(w),s=void 0),typeof a=="object"&&a!==null){if(y=u+i,d=[],f=0,Array.isArray(a))for(x="[",c="]",m=a.length;f<m;f++)d.push(o(a[f],y,f===m-1?0:1)||"null");else for(x="{",c="}",p=Object.keys(a),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",_=o(a[h],y,g.length+(f===m-1?0:1)),_!==void 0&&d.push(g+_);if(d.length>0)return[x,i+d.join(`,
`+y),c].join(`
`+u)}return w}(t,"",0)},ks={exports:{}};const X9="2.0.0",K9=256,Q9=Number.MAX_SAFE_INTEGER||9007199254740991,J9=16;var eh={SEMVER_SPEC_VERSION:X9,MAX_LENGTH:K9,MAX_SAFE_INTEGER:Q9,MAX_SAFE_COMPONENT_LENGTH:J9};const Z9=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var th=Z9;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=eh,i=th;t=e.exports={};const r=t.re=[],s=t.src=[],o=t.t={};let a=0;const u=(l,c,f)=>{const d=a++;i(d,c),o[l]=d,s[d]=c,r[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),u("FULL",`^${s[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),u("LOOSE",`^${s[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),u("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",s[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(ks,ks.exports);const e7=["includePrerelease","loose","rtl"],t7=e=>e?typeof e!="object"?{loose:!0}:e7.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var nh=t7;const uO=/^[0-9]+$/,lO=(e,t)=>{const n=uO.test(e),i=uO.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1},n7=(e,t)=>lO(t,e);var g1={compareIdentifiers:lO,rcompareIdentifiers:n7};const ih=th,{MAX_LENGTH:cO,MAX_SAFE_INTEGER:rh}=eh,{re:fO,t:dO}=ks.exports,i7=nh,{compareIdentifiers:Ql}=g1;class Fi{constructor(t,n){if(n=i7(n),t instanceof Fi){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>cO)throw new TypeError(`version is longer than ${cO} characters`);ih("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const i=t.trim().match(n.loose?fO[dO.LOOSE]:fO[dO.FULL]);if(!i)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>rh||this.major<0)throw new TypeError("Invalid major version");if(this.minor>rh||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>rh||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const s=+r;if(s>=0&&s<rh)return s}return r}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ih("SemVer.compare",this.version,this.options,t),!(t instanceof Fi)){if(typeof t=="string"&&t===this.version)return 0;t=new Fi(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Fi||(t=new Fi(t,this.options)),Ql(this.major,t.major)||Ql(this.minor,t.minor)||Ql(this.patch,t.patch)}comparePre(t){if(t instanceof Fi||(t=new Fi(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const i=this.prerelease[n],r=t.prerelease[n];if(ih("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return Ql(i,r)}while(++n)}compareBuild(t){t instanceof Fi||(t=new Fi(t,this.options));let n=0;do{const i=this.build[n],r=t.build[n];if(ih("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return Ql(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var cn=Fi;const{MAX_LENGTH:r7}=eh,{re:hO,t:gO}=ks.exports,pO=cn,s7=nh,o7=(e,t)=>{if(t=s7(t),e instanceof pO)return e;if(typeof e!="string"||e.length>r7||!(t.loose?hO[gO.LOOSE]:hO[gO.FULL]).test(e))return null;try{return new pO(e,t)}catch{return null}};var du=o7;const a7=du,u7=(e,t)=>{const n=a7(e,t);return n?n.version:null};var l7=u7;const c7=du,f7=(e,t)=>{const n=c7(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var d7=f7;const h7=cn,g7=(e,t,n,i)=>{typeof n=="string"&&(i=n,n=void 0);try{return new h7(e,n).inc(t,i).version}catch{return null}};var p7=g7;const mO=cn,m7=(e,t,n)=>new mO(e,n).compare(new mO(t,n));var Di=m7;const y7=Di,b7=(e,t,n)=>y7(e,t,n)===0;var p1=b7;const yO=du,v7=p1,x7=(e,t)=>{if(v7(e,t))return null;{const n=yO(e),i=yO(t),r=n.prerelease.length||i.prerelease.length,s=r?"pre":"",o=r?"prerelease":"";for(const a in n)if((a==="major"||a==="minor"||a==="patch")&&n[a]!==i[a])return s+a;return o}};var w7=x7;const E7=cn,_7=(e,t)=>new E7(e,t).major;var A7=_7;const O7=cn,S7=(e,t)=>new O7(e,t).minor;var C7=S7;const $7=cn,k7=(e,t)=>new $7(e,t).patch;var F7=k7;const D7=du,j7=(e,t)=>{const n=D7(e,t);return n&&n.prerelease.length?n.prerelease:null};var M7=j7;const T7=Di,N7=(e,t,n)=>T7(t,e,n);var R7=N7;const L7=Di,P7=(e,t)=>L7(e,t,!0);var I7=P7;const bO=cn,B7=(e,t,n)=>{const i=new bO(e,n),r=new bO(t,n);return i.compare(r)||i.compareBuild(r)};var m1=B7;const z7=m1,U7=(e,t)=>e.sort((n,i)=>z7(n,i,t));var q7=U7;const W7=m1,H7=(e,t)=>e.sort((n,i)=>W7(i,n,t));var G7=H7;const Y7=Di,V7=(e,t,n)=>Y7(e,t,n)>0;var sh=V7;const X7=Di,K7=(e,t,n)=>X7(e,t,n)<0;var y1=K7;const Q7=Di,J7=(e,t,n)=>Q7(e,t,n)!==0;var vO=J7;const Z7=Di,eL=(e,t,n)=>Z7(e,t,n)>=0;var b1=eL;const tL=Di,nL=(e,t,n)=>tL(e,t,n)<=0;var v1=nL;const iL=p1,rL=vO,sL=sh,oL=b1,aL=y1,uL=v1,lL=(e,t,n,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return iL(e,n,i);case"!=":return rL(e,n,i);case">":return sL(e,n,i);case">=":return oL(e,n,i);case"<":return aL(e,n,i);case"<=":return uL(e,n,i);default:throw new TypeError(`Invalid operator: ${t}`)}};var xO=lL;const cL=cn,fL=du,{re:oh,t:ah}=ks.exports,dL=(e,t)=>{if(e instanceof cL)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(oh[ah.COERCE]);else{let i;for(;(i=oh[ah.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||i.index+i[0].length!==n.index+n[0].length)&&(n=i),oh[ah.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;oh[ah.COERCERTL].lastIndex=-1}return n===null?null:fL(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var hL=dL,gL=ke;ke.Node=Ho;ke.create=ke;function ke(e){var t=this;if(t instanceof ke||(t=new ke),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}ke.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};ke.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};ke.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};ke.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)mL(this,arguments[e]);return this.length};ke.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)yL(this,arguments[e]);return this.length};ke.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};ke.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};ke.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;n!==null;i++)e.call(t,n.value,i,this),n=n.next};ke.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;n!==null;i--)e.call(t,n.value,i,this),n=n.prev};ke.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};ke.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};ke.prototype.map=function(e,t){t=t||this;for(var n=new ke,i=this.head;i!==null;)n.push(e.call(t,i.value,this)),i=i.next;return n};ke.prototype.mapReverse=function(e,t){t=t||this;for(var n=new ke,i=this.tail;i!==null;)n.push(e.call(t,i.value,this)),i=i.prev;return n};ke.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else if(this.head)i=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=0;i!==null;r++)n=e(n,i.value,r),i=i.next;return n};ke.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else if(this.tail)i=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;i!==null;r--)n=e(n,i.value,r),i=i.prev;return n};ke.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};ke.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};ke.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new ke;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(;r!==null&&i<t;i++,r=r.next)n.push(r.value);return n};ke.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new ke;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;r!==null&&i>t;i--)r=r.prev;for(;r!==null&&i>e;i--,r=r.prev)n.push(r.value);return n};ke.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(var s=[],i=0;r&&i<t;i++)s.push(r.value),r=this.removeNode(r);r===null&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(var i=0;i<n.length;i++)r=pL(this,r,n[i]);return s};ke.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};function pL(e,t,n){var i=t===e.head?new Ho(n,null,t,e):new Ho(n,t,t.next,e);return i.next===null&&(e.tail=i),i.prev===null&&(e.head=i),e.length++,i}function mL(e,t){e.tail=new Ho(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function yL(e,t){e.head=new Ho(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ho(e,t,n,i){if(!(this instanceof Ho))return new Ho(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{require("./iterator.js")(ke)}catch{}const bL=gL,Go=Symbol("max"),Vr=Symbol("length"),hu=Symbol("lengthCalculator"),Jl=Symbol("allowStale"),Yo=Symbol("maxAge"),Xr=Symbol("dispose"),wO=Symbol("noDisposeOnSet"),Ct=Symbol("lruList"),ji=Symbol("cache"),EO=Symbol("updateAgeOnGet"),x1=()=>1;class vL{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Go]=t.max||1/0;const n=t.length||x1;if(this[hu]=typeof n!="function"?x1:n,this[Jl]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Yo]=t.maxAge||0,this[Xr]=t.dispose,this[wO]=t.noDisposeOnSet||!1,this[EO]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Go]=t||1/0,Zl(this)}get max(){return this[Go]}set allowStale(t){this[Jl]=!!t}get allowStale(){return this[Jl]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Yo]=t,Zl(this)}get maxAge(){return this[Yo]}set lengthCalculator(t){typeof t!="function"&&(t=x1),t!==this[hu]&&(this[hu]=t,this[Vr]=0,this[Ct].forEach(n=>{n.length=this[hu](n.value,n.key),this[Vr]+=n.length})),Zl(this)}get lengthCalculator(){return this[hu]}get length(){return this[Vr]}get itemCount(){return this[Ct].length}rforEach(t,n){n=n||this;for(let i=this[Ct].tail;i!==null;){const r=i.prev;_O(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(let i=this[Ct].head;i!==null;){const r=i.next;_O(this,t,i,n),i=r}}keys(){return this[Ct].toArray().map(t=>t.key)}values(){return this[Ct].toArray().map(t=>t.value)}reset(){this[Xr]&&this[Ct]&&this[Ct].length&&this[Ct].forEach(t=>this[Xr](t.key,t.value)),this[ji]=new Map,this[Ct]=new bL,this[Vr]=0}dump(){return this[Ct].map(t=>uh(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Ct]}set(t,n,i){if(i=i||this[Yo],i&&typeof i!="number")throw new TypeError("maxAge must be a number");const r=i?Date.now():0,s=this[hu](n,t);if(this[ji].has(t)){if(s>this[Go])return gu(this,this[ji].get(t)),!1;const u=this[ji].get(t).value;return this[Xr]&&(this[wO]||this[Xr](t,u.value)),u.now=r,u.maxAge=i,u.value=n,this[Vr]+=s-u.length,u.length=s,this.get(t),Zl(this),!0}const o=new xL(t,n,s,r,i);return o.length>this[Go]?(this[Xr]&&this[Xr](t,n),!1):(this[Vr]+=o.length,this[Ct].unshift(o),this[ji].set(t,this[Ct].head),Zl(this),!0)}has(t){if(!this[ji].has(t))return!1;const n=this[ji].get(t).value;return!uh(this,n)}get(t){return w1(this,t,!0)}peek(t){return w1(this,t,!1)}pop(){const t=this[Ct].tail;return t?(gu(this,t),t.value):null}del(t){gu(this,this[ji].get(t))}load(t){this.reset();const n=Date.now();for(let i=t.length-1;i>=0;i--){const r=t[i],s=r.e||0;if(s===0)this.set(r.k,r.v);else{const o=s-n;o>0&&this.set(r.k,r.v,o)}}}prune(){this[ji].forEach((t,n)=>w1(this,n,!1))}}const w1=(e,t,n)=>{const i=e[ji].get(t);if(i){const r=i.value;if(uh(e,r)){if(gu(e,i),!e[Jl])return}else n&&(e[EO]&&(i.value.now=Date.now()),e[Ct].unshiftNode(i));return r.value}},uh=(e,t)=>{if(!t||!t.maxAge&&!e[Yo])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Yo]&&n>e[Yo]},Zl=e=>{if(e[Vr]>e[Go])for(let t=e[Ct].tail;e[Vr]>e[Go]&&t!==null;){const n=t.prev;gu(e,t),t=n}},gu=(e,t)=>{if(t){const n=t.value;e[Xr]&&e[Xr](n.key,n.value),e[Vr]-=n.length,e[ji].delete(n.key),e[Ct].removeNode(t)}};class xL{constructor(t,n,i,r,s){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=s||0}}const _O=(e,t,n,i)=>{let r=n.value;uh(e,r)&&(gu(e,n),e[Jl]||(r=void 0)),r&&t.call(i,r.value,r.key,e)};var wL=vL;class ec{constructor(t,n){if(n=_L(n),t instanceof ec)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new ec(t.raw,n);if(t instanceof E1)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const i=this.set[0];if(this.set=this.set.filter(r=>!OO(r[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(const r of this.set)if(r.length===1&&$L(r[0])){this.set=[r];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const i=`parseRange:${Object.keys(this.options).join(",")}:${t}`,r=AO.get(i);if(r)return r;const s=this.options.loose,o=s?Wt[Rt.HYPHENRANGELOOSE]:Wt[Rt.HYPHENRANGE];t=t.replace(o,PL(this.options.includePrerelease)),ft("hyphen replace",t),t=t.replace(Wt[Rt.COMPARATORTRIM],OL),ft("comparator trim",t,Wt[Rt.COMPARATORTRIM]),t=t.replace(Wt[Rt.TILDETRIM],SL),t=t.replace(Wt[Rt.CARETTRIM],CL),t=t.split(/\s+/).join(" ");const a=s?Wt[Rt.COMPARATORLOOSE]:Wt[Rt.COMPARATOR],u=t.split(" ").map(f=>kL(f,this.options)).join(" ").split(/\s+/).map(f=>LL(f,this.options)).filter(this.options.loose?f=>!!f.match(a):()=>!0).map(f=>new E1(f,this.options));u.length;const l=new Map;for(const f of u){if(OO(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return AO.set(i,c),c}intersects(t,n){if(!(t instanceof ec))throw new TypeError("a Range is required");return this.set.some(i=>SO(i,n)&&t.set.some(r=>SO(r,n)&&i.every(s=>r.every(o=>s.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new AL(t,this.options)}catch{return!1}for(let n=0;n<this.set.length;n++)if(IL(this.set[n],t,this.options))return!0;return!1}}var Mi=ec;const EL=wL,AO=new EL({max:1e3}),_L=nh,E1=ch,ft=th,AL=cn,{re:Wt,t:Rt,comparatorTrimReplace:OL,tildeTrimReplace:SL,caretTrimReplace:CL}=ks.exports,OO=e=>e.value==="<0.0.0-0",$L=e=>e.value==="",SO=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();for(;n&&i.length;)n=i.every(s=>r.intersects(s,t)),r=i.pop();return n},kL=(e,t)=>(ft("comp",e,t),e=jL(e,t),ft("caret",e),e=FL(e,t),ft("tildes",e),e=TL(e,t),ft("xrange",e),e=RL(e,t),ft("stars",e),e),fn=e=>!e||e.toLowerCase()==="x"||e==="*",FL=(e,t)=>e.trim().split(/\s+/).map(n=>DL(n,t)).join(" "),DL=(e,t)=>{const n=t.loose?Wt[Rt.TILDELOOSE]:Wt[Rt.TILDE];return e.replace(n,(i,r,s,o,a)=>{ft("tilde",e,i,r,s,o,a);let u;return fn(r)?u="":fn(s)?u=`>=${r}.0.0 <${+r+1}.0.0-0`:fn(o)?u=`>=${r}.${s}.0 <${r}.${+s+1}.0-0`:a?(ft("replaceTilde pr",a),u=`>=${r}.${s}.${o}-${a} <${r}.${+s+1}.0-0`):u=`>=${r}.${s}.${o} <${r}.${+s+1}.0-0`,ft("tilde return",u),u})},jL=(e,t)=>e.trim().split(/\s+/).map(n=>ML(n,t)).join(" "),ML=(e,t)=>{ft("caret",e,t);const n=t.loose?Wt[Rt.CARETLOOSE]:Wt[Rt.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(r,s,o,a,u)=>{ft("caret",e,r,s,o,a,u);let l;return fn(s)?l="":fn(o)?l=`>=${s}.0.0${i} <${+s+1}.0.0-0`:fn(a)?s==="0"?l=`>=${s}.${o}.0${i} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.0${i} <${+s+1}.0.0-0`:u?(ft("replaceCaret pr",u),s==="0"?o==="0"?l=`>=${s}.${o}.${a}-${u} <${s}.${o}.${+a+1}-0`:l=`>=${s}.${o}.${a}-${u} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.${a}-${u} <${+s+1}.0.0-0`):(ft("no pr"),s==="0"?o==="0"?l=`>=${s}.${o}.${a}${i} <${s}.${o}.${+a+1}-0`:l=`>=${s}.${o}.${a}${i} <${s}.${+o+1}.0-0`:l=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),ft("caret return",l),l})},TL=(e,t)=>(ft("replaceXRanges",e,t),e.split(/\s+/).map(n=>NL(n,t)).join(" ")),NL=(e,t)=>{e=e.trim();const n=t.loose?Wt[Rt.XRANGELOOSE]:Wt[Rt.XRANGE];return e.replace(n,(i,r,s,o,a,u)=>{ft("xRange",e,i,r,s,o,a,u);const l=fn(s),c=l||fn(o),f=c||fn(a),d=f;return r==="="&&d&&(r=""),u=t.includePrerelease?"-0":"",l?r===">"||r==="<"?i="<0.0.0-0":i="*":r&&d?(c&&(o=0),a=0,r===">"?(r=">=",c?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):r==="<="&&(r="<",c?s=+s+1:o=+o+1),r==="<"&&(u="-0"),i=`${r+s}.${o}.${a}${u}`):c?i=`>=${s}.0.0${u} <${+s+1}.0.0-0`:f&&(i=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),ft("xRange return",i),i})},RL=(e,t)=>(ft("replaceStars",e,t),e.trim().replace(Wt[Rt.STAR],"")),LL=(e,t)=>(ft("replaceGTE0",e,t),e.trim().replace(Wt[t.includePrerelease?Rt.GTE0PRE:Rt.GTE0],"")),PL=e=>(t,n,i,r,s,o,a,u,l,c,f,d,h)=>(fn(i)?n="":fn(r)?n=`>=${i}.0.0${e?"-0":""}`:fn(s)?n=`>=${i}.${r}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,fn(l)?u="":fn(c)?u=`<${+l+1}.0.0-0`:fn(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),IL=(e,t,n)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let i=0;i<e.length;i++)if(ft(e[i].semver),e[i].semver!==E1.ANY&&e[i].semver.prerelease.length>0){const r=e[i].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0},tc=Symbol("SemVer ANY");class lh{static get ANY(){return tc}constructor(t,n){if(n=BL(n),t instanceof lh){if(t.loose===!!n.loose)return t;t=t.value}A1("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===tc?this.value="":this.value=this.operator+this.semver.version,A1("comp",this)}parse(t){const n=this.options.loose?CO[$O.COMPARATORLOOSE]:CO[$O.COMPARATOR],i=t.match(n);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new kO(i[2],this.options.loose):this.semver=tc}toString(){return this.value}test(t){if(A1("Comparator.test",t,this.options.loose),this.semver===tc||t===tc)return!0;if(typeof t=="string")try{t=new kO(t,this.options)}catch{return!1}return _1(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof lh))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new FO(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new FO(this.value,n).test(t.semver);const i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),r=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),a=_1(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=_1(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return i||r||s&&o||a||u}}var ch=lh;const BL=nh,{re:CO,t:$O}=ks.exports,_1=xO,A1=th,kO=cn,FO=Mi,zL=Mi,UL=(e,t,n)=>{try{t=new zL(t,n)}catch{return!1}return t.test(e)};var fh=UL;const qL=Mi,WL=(e,t)=>new qL(e,t).set.map(n=>n.map(i=>i.value).join(" ").trim().split(" "));var HL=WL;const GL=cn,YL=Mi,VL=(e,t,n)=>{let i=null,r=null,s=null;try{s=new YL(t,n)}catch{return null}return e.forEach(o=>{s.test(o)&&(!i||r.compare(o)===-1)&&(i=o,r=new GL(i,n))}),i};var XL=VL;const KL=cn,QL=Mi,JL=(e,t,n)=>{let i=null,r=null,s=null;try{s=new QL(t,n)}catch{return null}return e.forEach(o=>{s.test(o)&&(!i||r.compare(o)===1)&&(i=o,r=new KL(i,n))}),i};var ZL=JL;const O1=cn,eP=Mi,DO=sh,tP=(e,t)=>{e=new eP(e,t);let n=new O1("0.0.0");if(e.test(n)||(n=new O1("0.0.0-0"),e.test(n)))return n;n=null;for(let i=0;i<e.set.length;++i){const r=e.set[i];let s=null;r.forEach(o=>{const a=new O1(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||DO(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!n||DO(n,s))&&(n=s)}return n&&e.test(n)?n:null};var nP=tP;const iP=Mi,rP=(e,t)=>{try{return new iP(e,t).range||"*"}catch{return null}};var sP=rP;const oP=cn,jO=ch,{ANY:aP}=jO,uP=Mi,lP=fh,MO=sh,TO=y1,cP=v1,fP=b1,dP=(e,t,n,i)=>{e=new oP(e,i),t=new uP(t,i);let r,s,o,a,u;switch(n){case">":r=MO,s=cP,o=TO,a=">",u=">=";break;case"<":r=TO,s=fP,o=MO,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(lP(e,t,i))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===aP&&(h=new jO(">=0.0.0")),f=f||h,d=d||h,r(h.semver,f.semver,i)?f=h:o(h.semver,d.semver,i)&&(d=h)}),f.operator===a||f.operator===u||(!d.operator||d.operator===a)&&s(e,d.semver))return!1;if(d.operator===u&&o(e,d.semver))return!1}return!0};var S1=dP;const hP=S1,gP=(e,t,n)=>hP(e,t,">",n);var pP=gP;const mP=S1,yP=(e,t,n)=>mP(e,t,"<",n);var bP=yP;const NO=Mi,vP=(e,t,n)=>(e=new NO(e,n),t=new NO(t,n),e.intersects(t));var xP=vP;const wP=fh,EP=Di;var _P=(e,t,n)=>{const i=[];let r=null,s=null;const o=e.sort((c,f)=>EP(c,f,n));for(const c of o)wP(c,t,n)?(s=c,r||(r=c)):(s&&i.push([r,s]),s=null,r=null);r&&i.push([r,null]);const a=[];for(const[c,f]of i)c===f?a.push(c):!f&&c===o[0]?a.push("*"):f?c===o[0]?a.push(`<=${f}`):a.push(`${c} - ${f}`):a.push(`>=${c}`);const u=a.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const RO=Mi,dh=ch,{ANY:C1}=dh,nc=fh,$1=Di,AP=(e,t,n={})=>{if(e===t)return!0;e=new RO(e,n),t=new RO(t,n);let i=!1;e:for(const r of e.set){for(const s of t.set){const o=OP(r,s,n);if(i=i||o!==null,o)continue e}if(i)return!1}return!0},OP=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===C1){if(t.length===1&&t[0].semver===C1)return!0;n.includePrerelease?e=[new dh(">=0.0.0-0")]:e=[new dh(">=0.0.0")]}if(t.length===1&&t[0].semver===C1){if(n.includePrerelease)return!0;t=[new dh(">=0.0.0")]}const i=new Set;let r,s;for(const h of e)h.operator===">"||h.operator===">="?r=LO(r,h,n):h.operator==="<"||h.operator==="<="?s=PO(s,h,n):i.add(h.semver);if(i.size>1)return null;let o;if(r&&s){if(o=$1(r.semver,s.semver,n),o>0)return null;if(o===0&&(r.operator!==">="||s.operator!=="<="))return null}for(const h of i){if(r&&!nc(h,String(r),n)||s&&!nc(h,String(s),n))return null;for(const g of t)if(!nc(h,String(g),n))return!1;return!0}let a,u,l,c,f=s&&!n.includePrerelease&&s.semver.prerelease.length?s.semver:!1,d=r&&!n.includePrerelease&&r.semver.prerelease.length?r.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",r){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(a=LO(r,h,n),a===h&&a!==r)return!1}else if(r.operator===">="&&!nc(r.semver,String(h),n))return!1}if(s){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=PO(s,h,n),u===h&&u!==s)return!1}else if(s.operator==="<="&&!nc(s.semver,String(h),n))return!1}if(!h.operator&&(s||r)&&o!==0)return!1}return!(r&&l&&!s&&o!==0||s&&c&&!r&&o!==0||d||f)},LO=(e,t,n)=>{if(!e)return t;const i=$1(e.semver,t.semver,n);return i>0?e:i<0||t.operator===">"&&e.operator===">="?t:e},PO=(e,t,n)=>{if(!e)return t;const i=$1(e.semver,t.semver,n);return i<0?e:i>0||t.operator==="<"&&e.operator==="<="?t:e};var SP=AP;const k1=ks.exports;var IO={re:k1.re,src:k1.src,tokens:k1.t,SEMVER_SPEC_VERSION:eh.SEMVER_SPEC_VERSION,SemVer:cn,compareIdentifiers:g1.compareIdentifiers,rcompareIdentifiers:g1.rcompareIdentifiers,parse:du,valid:l7,clean:d7,inc:p7,diff:w7,major:A7,minor:C7,patch:F7,prerelease:M7,compare:Di,rcompare:R7,compareLoose:I7,compareBuild:m1,sort:q7,rsort:G7,gt:sh,lt:y1,eq:p1,neq:vO,gte:b1,lte:v1,cmp:xO,coerce:hL,Comparator:ch,Range:Mi,satisfies:fh,toComparators:HL,maxSatisfying:XL,minSatisfying:ZL,minVersion:nP,validRange:sP,outside:S1,gtr:pP,ltr:bP,intersects:xP,simplifyRange:_P,subset:SP};function Fn(e,t,n){return e.fields=t||[],e.fname=n,e}function rt(e){return e==null?null:e.fname}function Ht(e){return e==null?null:e.fields}function BO(e){return e.length===1?CP(e[0]):$P(e)}const CP=e=>function(t){return t[e]},$P=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function L(e){throw Error(e)}function hh(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||L("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&L("Access path missing closing bracket: "+e),i&&L("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Dn(e,t,n){const i=hh(e);return e=i.length===1?i[0]:e,Fn((n&&n.get||BO)(i),[e],t||e)}const ic=Dn("id"),dn=Fn(e=>e,[],"identity"),Fs=Fn(()=>0,[],"zero"),pu=Fn(()=>1,[],"one"),fi=Fn(()=>!0,[],"true"),Ds=Fn(()=>!1,[],"false");function kP(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const zO=0,F1=1,UO=2,qO=3,WO=4;function HO(e,t,n=kP){let i=e||zO;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=F1&&n(t||"error","ERROR",arguments),this},warn(){return i>=UO&&n(t||"warn","WARN",arguments),this},info(){return i>=qO&&n(t||"log","INFO",arguments),this},debug(){return i>=WO&&n(t||"log","DEBUG",arguments),this}}}var Z=Array.isArray;function fe(e){return e===Object(e)}const GO=e=>e!=="__proto__";function gh(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=FP(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;rc(t,i,n[i],r)}return t},{})}function rc(e,t,n,i){if(!GO(t))return;let r,s;if(fe(n)&&!Z(n)){s=fe(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?rc(s,r,n[r]):GO(r)&&(s[r]=n[r])}else e[t]=n}function FP(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function Ee(e){return e[e.length-1]}function Gt(e){return e==null||e===""?null:+e}const YO=e=>t=>e*Math.exp(t),VO=e=>t=>Math.log(e*t),XO=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),KO=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,ph=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function mh(e,t,n,i){const r=n(e[0]),s=n(Ee(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function QO(e,t){return mh(e,t,Gt,dn)}function JO(e,t){var n=Math.sign(e[0]);return mh(e,t,VO(n),YO(n))}function ZO(e,t,n){return mh(e,t,ph(n),ph(1/n))}function eS(e,t,n){return mh(e,t,XO(n),KO(n))}function yh(e,t,n,i,r){const s=i(e[0]),o=i(Ee(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function D1(e,t,n){return yh(e,t,n,Gt,dn)}function j1(e,t,n){const i=Math.sign(e[0]);return yh(e,t,n,VO(i),YO(i))}function bh(e,t,n,i){return yh(e,t,n,ph(i),ph(1/i))}function M1(e,t,n,i){return yh(e,t,n,XO(i),KO(i))}function tS(e){return 1+~~(new Date(e).getMonth()/3)}function nS(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ae(e){return e!=null?Z(e)?e:[e]:[]}function iS(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function ye(e){return typeof e=="function"}const DP="descending";function T1(e,t,n){n=n||{},t=ae(t)||[];const i=[],r=[],s={},o=n.comparator||jP;return ae(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===DP?-1:1),r.push(a=ye(a)?a:Dn(a,null,n)),(Ht(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:Fn(o(r,i),Object.keys(s))}const vh=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),jP=(e,t)=>e.length===1?MP(e[0],t[0]):TP(e,t,e.length),MP=(e,t)=>function(n,i){return vh(e(n),e(i))*t},TP=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=vh(s(i),s(r));return o*t[a]});function Yt(e){return ye(e)?e:()=>e}function N1(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function pe(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function ar(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function rS(e,t){const n=e.length;let i=-1,r,s,o,a,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}return[a,u]}const NP=Object.prototype.hasOwnProperty;function ue(e,t){return NP.call(e,t)}const xh={};function mu(e){let t={},n;function i(s){return ue(t,s)&&t[s]!==xh}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===xh&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=xh),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==xh&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function sS(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=Ee(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?i:c<=o?r:s}function W(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),pe(i,n)}function yu(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function R1(e){return typeof e=="boolean"}function js(e){return Object.prototype.toString.call(e)==="[object Date]"}function oS(e){return e&&ye(e[Symbol.iterator])}function Ms(e){return typeof e=="number"}function aS(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Se(e){return typeof e=="string"}function L1(e,t,n){e&&(e=t?ae(e).map(a=>a.replace(/\\(.)/g,"$1")):ae(e));const i=e&&e.length,r=n&&n.get||BO,s=a=>r(t?[a]:hh(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return Fn(o,e,"key")}function uS(e,t){const n=e[0],i=Ee(e),r=+t;return r?r===1?i:n+r*(i-n):n}const RP=1e4;function lS(e){e=+e||RP;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>ue(t,o)||ue(n,o),get:o=>ue(t,o)?t[o]:ue(n,o)?s(o,n[o]):void 0,set:(o,a)=>ue(t,o)?t[o]=a:s(o,a)}}function cS(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,u=0,l=0;for(;a<r&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function sc(e,t){let n="";for(;--t>=0;)n+=e;return n}function fS(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?sc(r,o)+s:i==="center"?sc(r,~~(o/2))+s+sc(r,Math.ceil(o/2)):s+sc(r,o)}function oc(e){return e&&Ee(e)-e[0]||0}function ie(e){return Z(e)?"["+e.map(ie)+"]":fe(e)||Se(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function P1(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const LP=e=>Ms(e)||js(e)?e:Date.parse(e);function I1(e,t){return t=t||LP,e==null||e===""?null:t(e)}function B1(e){return e==null||e===""?null:e+""}function Ti(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function dS(e,t,n,i){const r=i!=null?i:"\u2026",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function Ts(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}var hS={},z1={},U1=34,ac=10,q1=13;function gS(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function PP(e,t){var n=gS(e);return function(i,r){return t(n(i),r,e)}}function pS(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function jn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function IP(e){return e<0?"-"+jn(-e,6):e>9999?"+"+jn(e,6):jn(e,4)}function BP(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":IP(e.getUTCFullYear())+"-"+jn(e.getUTCMonth()+1,2)+"-"+jn(e.getUTCDate(),2)+(r?"T"+jn(t,2)+":"+jn(n,2)+":"+jn(i,2)+"."+jn(r,3)+"Z":i?"T"+jn(t,2)+":"+jn(n,2)+":"+jn(i,2)+"Z":n||t?"T"+jn(t,2)+":"+jn(n,2)+"Z":"")}function zP(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,g,p=r(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?PP(m,d):gS(m)});return p.columns=g||[],p}function r(f,d){var h=[],g=f.length,p=0,m=0,y,b=g<=0,x=!1;f.charCodeAt(g-1)===ac&&--g,f.charCodeAt(g-1)===q1&&--g;function w(){if(b)return z1;if(x)return x=!1,hS;var A,E=p,S;if(f.charCodeAt(E)===U1){for(;p++<g&&f.charCodeAt(p)!==U1||f.charCodeAt(++p)===U1;);return(A=p)>=g?b=!0:(S=f.charCodeAt(p++))===ac?x=!0:S===q1&&(x=!0,f.charCodeAt(p)===ac&&++p),f.slice(E+1,A-1).replace(/""/g,'"')}for(;p<g;){if((S=f.charCodeAt(A=p++))===ac)x=!0;else if(S===q1)x=!0,f.charCodeAt(p)===ac&&++p;else if(S!==n)continue;return f.slice(E,A)}return b=!0,f.slice(E,g)}for(;(y=w())!==z1;){for(var _=[];y!==hS&&y!==z1;)_.push(y),y=w();d&&(_=d(_,m++))==null||h.push(_)}return h}function s(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function o(f,d){return d==null&&(d=pS(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=pS(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?BP(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function UP(e){return e}function qP(e){if(e==null)return UP;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+s,f[1]=(n+=a[1])*r+o;l<c;)f[l]=a[l],++l;return f}}function WP(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function HP(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return mS(e,n)})}:mS(e,t)}function mS(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=yS(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function yS(e,t){var n=qP(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&WP(f,g)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function GP(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,g;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,g=i[d]){delete i[g.start];var p=g===h?h:h.concat(g);i[p.start=h.start]=r[p.end=g.end]=p}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,g=r[f]){delete r[g.end];var m=g===h?h:g.concat(h);i[m.start=g.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function YP(e){return yS(e,VP.apply(this,arguments))}function VP(e,t,n){var i,r,s;if(arguments.length>1)i=XP(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:GP(e,i)}}function XP(e,t,n){var i=[],r=[],s;function o(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function bu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function uc(e){let t=e,n=e;e.length===1&&(t=(o,a)=>e(o)-a,n=KP(e));function i(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)<0?u=c+1:l=c}return u}function r(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)>0?l=c:u=c+1}return u}function s(o,a,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=i(o,a,u,l-1);return c>u&&t(o[c-1],a)>-t(o[c],a)?c-1:c}return{left:i,center:s,right:r}}function KP(e){return(t,n)=>bu(e(t),n)}function bS(e){return e===null?NaN:+e}function*QP(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const vS=uc(bu),wh=vS.right,JP=vS.left;uc(bS).center;var lc=wh;function ZP(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function eI(e,t){const n=ZP(e,t);return n&&Math.sqrt(n)}class hn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}function tI(e,t){return Array.from(t,n=>e[n])}var W1=Math.sqrt(50),H1=Math.sqrt(10),G1=Math.sqrt(2);function Y1(e,t,n){var i,r=-1,s,o,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(s=e,e=t,t=s),(a=xS(e,t,n))===0||!isFinite(a))return[];if(a>0){let u=Math.round(e/a),l=Math.round(t/a);for(u*a<e&&++u,l*a>t&&--l,o=new Array(s=l-u+1);++r<s;)o[r]=(u+r)*a}else{a=-a;let u=Math.round(e*a),l=Math.round(t*a);for(u/a<e&&++u,l/a>t&&--l,o=new Array(s=l-u+1);++r<s;)o[r]=(u+r)/a}return i&&o.reverse(),o}function xS(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=W1?10:s>=H1?5:s>=G1?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=W1?10:s>=H1?5:s>=G1?2:1)}function Ns(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=W1?r*=10:s>=H1?r*=5:s>=G1&&(r*=2),t<e?-r:r}function Vo(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function V1(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function wS(e,t,n=0,i=e.length-1,r=bu){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(i,Math.floor(t+(u-l)*f/u+d));wS(e,t,h,g,r)}const s=e[t];let o=n,a=i;for(cc(e,n,t),r(e[i],s)>0&&cc(e,n,i);o<a;){for(cc(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?cc(e,n,a):(++a,cc(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function cc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function X1(e,t,n){if(e=Float64Array.from(QP(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return V1(e);if(t>=1)return Vo(e);var i,r=(i-1)*t,s=Math.floor(r),o=Vo(wS(e,s).subarray(0,s+1)),a=V1(e.subarray(s+1));return o+(a-o)*(r-s)}}function ES(e,t,n=bS){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function nI(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function _S(e,t){return X1(e,.5,t)}function*iI(e){for(const t of e)yield*t}function AS(e){return Array.from(iI(e))}function Jn(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function OS(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function rI(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Eh(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function vu(e){return e=Eh(Math.abs(e)),e?e[1]:NaN}function sI(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function oI(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var aI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xu(e){if(!(t=aI.exec(e)))throw new Error("invalid format: "+e);var t;return new K1({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}xu.prototype=K1.prototype;function K1(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}K1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uI(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var SS;function lI(e,t){var n=Eh(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(SS=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Eh(e,Math.max(0,t+s-1))[0]}function CS(e,t){var n=Eh(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var $S={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rI,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>CS(e*100,t),r:CS,s:lI,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function kS(e){return e}var FS=Array.prototype.map,DS=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function jS(e){var t=e.grouping===void 0||e.thousands===void 0?kS:sI(FS.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?kS:oI(FS.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=xu(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,b=f.comma,x=f.precision,w=f.trim,_=f.type;_==="n"?(b=!0,_="g"):$S[_]||(x===void 0&&(x=12),w=!0,_="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var A=p==="$"?n:p==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",E=p==="$"?i:/[%p]/.test(_)?o:"",S=$S[_],k=/[defgprs%]/.test(_);x=x===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function $(F){var M=A,j=E,I,D,P;if(_==="c")j=S(F)+j,F="";else{F=+F;var B=F<0||1/F<0;if(F=isNaN(F)?u:S(Math.abs(F),x),w&&(F=uI(F)),B&&+F==0&&g!=="+"&&(B=!1),M=(B?g==="("?g:a:g==="-"||g==="("?"":g)+M,j=(_==="s"?DS[8+SS/3]:"")+j+(B&&g==="("?")":""),k){for(I=-1,D=F.length;++I<D;)if(P=F.charCodeAt(I),48>P||P>57){j=(P===46?r+F.slice(I+1):F.slice(I))+j,F=F.slice(0,I);break}}}b&&!m&&(F=t(F,1/0));var H=M.length+F.length+j.length,X=H<y?new Array(y-H+1).join(d):"";switch(b&&m&&(F=t(X+F,X.length?y-j.length:1/0),X=""),h){case"<":F=M+F+j+X;break;case"=":F=M+X+F+j;break;case"^":F=X.slice(0,H=X.length>>1)+M+F+j+X.slice(H);break;default:F=X+M+F+j;break}return s(F)}return $.toString=function(){return f+""},$}function c(f,d){var h=l((f=xu(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(vu(d)/3)))*3,p=Math.pow(10,-g),m=DS[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var _h,Ah,Q1;cI({thousands:",",grouping:[3],currency:["$",""]});function cI(e){return _h=jS(e),Ah=_h.format,Q1=_h.formatPrefix,_h}function MS(e){return Math.max(0,-vu(Math.abs(e)))}function TS(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vu(t)/3)))*3-vu(Math.abs(e)))}function NS(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,vu(t)-vu(e))+1}var J1=new Date,Z1=new Date;function $t(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=function(s){return e(s=new Date(+s)),s},r.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},r.round=function(s){var o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=function(s,o){return t(s=new Date(+s),o==null?1:Math.floor(o)),s},r.range=function(s,o,a){var u=[],l;if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},r.filter=function(s){return $t(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(r.count=function(s,o){return J1.setTime(+s),Z1.setTime(+o),e(J1),e(Z1),Math.floor(n(J1,Z1))},r.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?function(o){return i(o)%s==0}:function(o){return r.count(0,o)%s==0}):r}),r}var ey=$t(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});ey.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?$t(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):ey};var ty=ey;const Kr=1e3,di=Kr*60,Qr=di*60,Xo=Qr*24,ny=Xo*7,RS=Xo*30,iy=Xo*365;var fI=$t(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Kr)},function(e,t){return(t-e)/Kr},function(e){return e.getUTCSeconds()}),Rs=fI,dI=$t(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Kr)},function(e,t){e.setTime(+e+t*di)},function(e,t){return(t-e)/di},function(e){return e.getMinutes()}),ry=dI,hI=$t(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Kr-e.getMinutes()*di)},function(e,t){e.setTime(+e+t*Qr)},function(e,t){return(t-e)/Qr},function(e){return e.getHours()}),sy=hI,gI=$t(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*di)/Xo,e=>e.getDate()-1),Ls=gI;function Ko(e){return $t(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*di)/ny})}var fc=Ko(0),oy=Ko(1);Ko(2);Ko(3);var dc=Ko(4);Ko(5);Ko(6);var pI=$t(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),Oh=pI,LS=$t(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});LS.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:$t(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var Ps=LS,mI=$t(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*di)},function(e,t){return(t-e)/di},function(e){return e.getUTCMinutes()}),ay=mI,yI=$t(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Qr)},function(e,t){return(t-e)/Qr},function(e){return e.getUTCHours()}),uy=yI,bI=$t(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Xo},function(e){return e.getUTCDate()-1}),Is=bI;function Qo(e){return $t(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/ny})}var hc=Qo(0),ly=Qo(1);Qo(2);Qo(3);var gc=Qo(4);Qo(5);Qo(6);var vI=$t(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),Sh=vI,PS=$t(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});PS.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:$t(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var Bs=PS;function IS(e,t,n,i,r,s){const o=[[Rs,1,Kr],[Rs,5,5*Kr],[Rs,15,15*Kr],[Rs,30,30*Kr],[s,1,di],[s,5,5*di],[s,15,15*di],[s,30,30*di],[r,1,Qr],[r,3,3*Qr],[r,6,6*Qr],[r,12,12*Qr],[i,1,Xo],[i,2,2*Xo],[n,1,ny],[t,1,RS],[t,3,3*RS],[e,1,iy]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=uc(([,,m])=>m).right(o,d);if(h===o.length)return e.every(Ns(l/iy,c/iy,f));if(h===0)return ty.every(Math.max(Ns(l,c,f),1));const[g,p]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return g.every(p)}return[a,u]}const[xI,wI]=IS(Bs,Sh,hc,Is,uy,ay),[EI,_I]=IS(Ps,Oh,fc,Ls,sy,ry),Lt="year",Mn="quarter",Vt="month",vt="week",Tn="date",Xt="day",ur="dayofyear",Zn="hours",ei="minutes",hi="seconds",Ni="milliseconds",cy=[Lt,Mn,Vt,vt,Tn,Xt,ur,Zn,ei,hi,Ni],fy=cy.reduce((e,t,n)=>(e[t]=1+n,e),{});function dy(e){const t=ae(e).slice(),n={};return t.length||L("Missing time unit."),t.forEach(r=>{ue(fy,r)?n[r]=1:L("Invalid time unit: ".concat(r,"."))}),(n[vt]||n[Xt]?1:0)+(n[Mn]||n[Vt]||n[Tn]?1:0)+(n[ur]?1:0)>1&&L("Incompatible time units: ".concat(e)),t.sort((r,s)=>fy[r]-fy[s]),t}const AI={[Lt]:"%Y ",[Mn]:"Q%q ",[Vt]:"%b ",[Tn]:"%d ",[vt]:"W%U ",[Xt]:"%a ",[ur]:"%j ",[Zn]:"%H:00",[ei]:"00:%M",[hi]:":%S",[Ni]:".%L",["".concat(Lt,"-").concat(Vt)]:"%Y-%m ",["".concat(Lt,"-").concat(Vt,"-").concat(Tn)]:"%Y-%m-%d ",["".concat(Zn,"-").concat(ei)]:"%H:%M"};function BS(e,t){const n=pe({},AI,t),i=dy(e),r=i.length;let s="",o=0,a,u;for(o=0;o<r;)for(a=i.length;a>o;--a)if(u=i.slice(o,a).join("-"),n[u]!=null){s+=n[u],o=a;break}return s.trim()}const Jo=new Date;function hy(e){return Jo.setFullYear(e),Jo.setMonth(0),Jo.setDate(1),Jo.setHours(0,0,0,0),Jo}function zS(e){return qS(new Date(e))}function US(e){return gy(new Date(e))}function qS(e){return Ls.count(hy(e.getFullYear())-1,e)}function gy(e){return fc.count(hy(e.getFullYear())-1,e)}function py(e){return hy(e).getDay()}function OI(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function WS(e){return GS(new Date(e))}function HS(e){return my(new Date(e))}function GS(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Is.count(t-1,e)}function my(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return hc.count(t-1,e)}function yy(e){return Jo.setTime(Date.UTC(e,0,1)),Jo.getUTCDay()}function SI(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function YS(e,t,n,i,r){const s=t||1,o=Ee(e),a=(y,b,x)=>(x=x||y,CI(n[x],i[x],y===o&&s,b)),u=new Date,l=Ti(e),c=l[Lt]?a(Lt):Yt(2012),f=l[Vt]?a(Vt):l[Mn]?a(Mn):Fs,d=l[vt]&&l[Xt]?a(Xt,1,vt+Xt):l[vt]?a(vt,1):l[Xt]?a(Xt,1):l[Tn]?a(Tn,1):l[ur]?a(ur,1):pu,h=l[Zn]?a(Zn):Fs,g=l[ei]?a(ei):Fs,p=l[hi]?a(hi):Fs,m=l[Ni]?a(Ni):Fs;return function(y){u.setTime(+y);const b=c(u);return r(b,f(u),d(u,b),h(u),g(u),p(u),m(u))}}function CI(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function wu(e,t,n){return t+e*7-(n+6)%7}const $I={[Lt]:e=>e.getFullYear(),[Mn]:e=>Math.floor(e.getMonth()/3),[Vt]:e=>e.getMonth(),[Tn]:e=>e.getDate(),[Zn]:e=>e.getHours(),[ei]:e=>e.getMinutes(),[hi]:e=>e.getSeconds(),[Ni]:e=>e.getMilliseconds(),[ur]:e=>qS(e),[vt]:e=>gy(e),[vt+Xt]:(e,t)=>wu(gy(e),e.getDay(),py(t)),[Xt]:(e,t)=>wu(1,e.getDay(),py(t))},kI={[Mn]:e=>3*e,[vt]:(e,t)=>wu(e,0,py(t))};function VS(e,t){return YS(e,t||1,$I,kI,OI)}const FI={[Lt]:e=>e.getUTCFullYear(),[Mn]:e=>Math.floor(e.getUTCMonth()/3),[Vt]:e=>e.getUTCMonth(),[Tn]:e=>e.getUTCDate(),[Zn]:e=>e.getUTCHours(),[ei]:e=>e.getUTCMinutes(),[hi]:e=>e.getUTCSeconds(),[Ni]:e=>e.getUTCMilliseconds(),[ur]:e=>GS(e),[vt]:e=>my(e),[Xt]:(e,t)=>wu(1,e.getUTCDay(),yy(t)),[vt+Xt]:(e,t)=>wu(my(e),e.getUTCDay(),yy(t))},DI={[Mn]:e=>3*e,[vt]:(e,t)=>wu(e,0,yy(t))};function XS(e,t){return YS(e,t||1,FI,DI,SI)}const jI={[Lt]:Ps,[Mn]:Oh.every(3),[Vt]:Oh,[vt]:fc,[Tn]:Ls,[Xt]:Ls,[ur]:Ls,[Zn]:sy,[ei]:ry,[hi]:Rs,[Ni]:ty},MI={[Lt]:Bs,[Mn]:Sh.every(3),[Vt]:Sh,[vt]:hc,[Tn]:Is,[Xt]:Is,[ur]:Is,[Zn]:uy,[ei]:ay,[hi]:Rs,[Ni]:ty};function Eu(e){return jI[e]}function _u(e){return MI[e]}function KS(e,t,n){return e?e.offset(t,n):void 0}function QS(e,t,n){return KS(Eu(e),t,n)}function JS(e,t,n){return KS(_u(e),t,n)}function ZS(e,t,n,i){return e?e.range(t,n,i):void 0}function eC(e,t,n,i){return ZS(Eu(e),t,n,i)}function tC(e,t,n,i){return ZS(_u(e),t,n,i)}const pc=1e3,mc=pc*60,yc=mc*60,Ch=yc*24,TI=Ch*7,nC=Ch*30,by=Ch*365,iC=[Lt,Vt,Tn,Zn,ei,hi,Ni],bc=iC.slice(0,-1),vc=bc.slice(0,-1),xc=vc.slice(0,-1),NI=xc.slice(0,-1),RI=[Lt,vt],rC=[Lt,Vt],sC=[Lt],wc=[[bc,1,pc],[bc,5,5*pc],[bc,15,15*pc],[bc,30,30*pc],[vc,1,mc],[vc,5,5*mc],[vc,15,15*mc],[vc,30,30*mc],[xc,1,yc],[xc,3,3*yc],[xc,6,6*yc],[xc,12,12*yc],[NI,1,Ch],[RI,1,TI],[rC,1,nC],[rC,3,3*nC],[sC,1,by]];function oC(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(oc(t))/n;let r=uc(a=>a[2]).right(wc,i),s,o;return r===wc.length?(s=sC,o=Ns(t[0]/by,t[1]/by,n)):r?(r=wc[i/wc[r-1][2]<wc[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=iC,o=Math.max(Ns(t[0],t[1],n),1)),{units:s,step:o}}function vy(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function xy(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ec(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function aC(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=_c(r),c=Ac(r),f=_c(s),d=Ac(s),h=_c(o),g=Ac(o),p=_c(a),m=Ac(a),y=_c(u),b=Ac(u),x={a:B,A:H,b:X,B:ce,c:null,d:hC,e:hC,f:sB,g:pB,G:yB,H:nB,I:iB,j:rB,L:gC,m:oB,M:aB,p:Te,q:$e,Q:xC,s:wC,S:uB,u:lB,U:cB,V:fB,w:dB,W:hB,x:null,X:null,y:gB,Y:mB,Z:bB,"%":vC},w={a:nt,A:qe,b:lt,B:ln,c:null,d:mC,e:mC,f:EB,g:jB,G:TB,H:vB,I:xB,j:wB,L:yC,m:_B,M:AB,p:ki,q:ci,Q:xC,s:wC,S:OB,u:SB,U:CB,V:$B,w:kB,W:FB,x:null,X:null,y:DB,Y:MB,Z:NB,"%":vC},_={a:$,A:F,b:M,B:j,c:I,d:fC,e:fC,f:JI,g:cC,G:lC,H:dC,I:dC,j:VI,L:QI,m:YI,M:XI,p:k,q:GI,Q:eB,s:tB,S:KI,u:zI,U:UI,V:qI,w:BI,W:WI,x:D,X:P,y:cC,Y:lC,Z:HI,"%":ZI};x.x=A(n,x),x.X=A(i,x),x.c=A(t,x),w.x=A(n,w),w.X=A(i,w),w.c=A(t,w);function A(V,le){return function(me){var U=[],ht=-1,we=0,bt=V.length,ct,$s,Yr;for(me instanceof Date||(me=new Date(+me));++ht<bt;)V.charCodeAt(ht)===37&&(U.push(V.slice(we,ht)),($s=uC[ct=V.charAt(++ht)])!=null?ct=V.charAt(++ht):$s=ct==="e"?" ":"0",(Yr=le[ct])&&(ct=Yr(me,$s)),U.push(ct),we=ht+1);return U.push(V.slice(we,ht)),U.join("")}}function E(V,le){return function(me){var U=Ec(1900,void 0,1),ht=S(U,V,me+="",0),we,bt;if(ht!=me.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(le&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(we=xy(Ec(U.y,0,1)),bt=we.getUTCDay(),we=bt>4||bt===0?ly.ceil(we):ly(we),we=Is.offset(we,(U.V-1)*7),U.y=we.getUTCFullYear(),U.m=we.getUTCMonth(),U.d=we.getUTCDate()+(U.w+6)%7):(we=vy(Ec(U.y,0,1)),bt=we.getDay(),we=bt>4||bt===0?oy.ceil(we):oy(we),we=Ls.offset(we,(U.V-1)*7),U.y=we.getFullYear(),U.m=we.getMonth(),U.d=we.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),bt="Z"in U?xy(Ec(U.y,0,1)).getUTCDay():vy(Ec(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(bt+5)%7:U.w+U.U*7-(bt+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,xy(U)):vy(U)}}function S(V,le,me,U){for(var ht=0,we=le.length,bt=me.length,ct,$s;ht<we;){if(U>=bt)return-1;if(ct=le.charCodeAt(ht++),ct===37){if(ct=le.charAt(ht++),$s=_[ct in uC?le.charAt(ht++):ct],!$s||(U=$s(V,me,U))<0)return-1}else if(ct!=me.charCodeAt(U++))return-1}return U}function k(V,le,me){var U=l.exec(le.slice(me));return U?(V.p=c.get(U[0].toLowerCase()),me+U[0].length):-1}function $(V,le,me){var U=h.exec(le.slice(me));return U?(V.w=g.get(U[0].toLowerCase()),me+U[0].length):-1}function F(V,le,me){var U=f.exec(le.slice(me));return U?(V.w=d.get(U[0].toLowerCase()),me+U[0].length):-1}function M(V,le,me){var U=y.exec(le.slice(me));return U?(V.m=b.get(U[0].toLowerCase()),me+U[0].length):-1}function j(V,le,me){var U=p.exec(le.slice(me));return U?(V.m=m.get(U[0].toLowerCase()),me+U[0].length):-1}function I(V,le,me){return S(V,t,le,me)}function D(V,le,me){return S(V,n,le,me)}function P(V,le,me){return S(V,i,le,me)}function B(V){return o[V.getDay()]}function H(V){return s[V.getDay()]}function X(V){return u[V.getMonth()]}function ce(V){return a[V.getMonth()]}function Te(V){return r[+(V.getHours()>=12)]}function $e(V){return 1+~~(V.getMonth()/3)}function nt(V){return o[V.getUTCDay()]}function qe(V){return s[V.getUTCDay()]}function lt(V){return u[V.getUTCMonth()]}function ln(V){return a[V.getUTCMonth()]}function ki(V){return r[+(V.getUTCHours()>=12)]}function ci(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var le=A(V+="",x);return le.toString=function(){return V},le},parse:function(V){var le=E(V+="",!1);return le.toString=function(){return V},le},utcFormat:function(V){var le=A(V+="",w);return le.toString=function(){return V},le},utcParse:function(V){var le=E(V+="",!0);return le.toString=function(){return V},le}}}var uC={"-":"",_:" ","0":"0"},kt=/^\s*\d+/,LI=/^%/,PI=/[\\^$*+?|[\]().{}]/g;function Fe(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function II(e){return e.replace(PI,"\\$&")}function _c(e){return new RegExp("^(?:"+e.map(II).join("|")+")","i")}function Ac(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function BI(e,t,n){var i=kt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function zI(e,t,n){var i=kt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function UI(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function qI(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function WI(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function lC(e,t,n){var i=kt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function cC(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function HI(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function GI(e,t,n){var i=kt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function YI(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function fC(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function VI(e,t,n){var i=kt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function dC(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function XI(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function KI(e,t,n){var i=kt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function QI(e,t,n){var i=kt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function JI(e,t,n){var i=kt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function ZI(e,t,n){var i=LI.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function eB(e,t,n){var i=kt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function tB(e,t,n){var i=kt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function hC(e,t){return Fe(e.getDate(),t,2)}function nB(e,t){return Fe(e.getHours(),t,2)}function iB(e,t){return Fe(e.getHours()%12||12,t,2)}function rB(e,t){return Fe(1+Ls.count(Ps(e),e),t,3)}function gC(e,t){return Fe(e.getMilliseconds(),t,3)}function sB(e,t){return gC(e,t)+"000"}function oB(e,t){return Fe(e.getMonth()+1,t,2)}function aB(e,t){return Fe(e.getMinutes(),t,2)}function uB(e,t){return Fe(e.getSeconds(),t,2)}function lB(e){var t=e.getDay();return t===0?7:t}function cB(e,t){return Fe(fc.count(Ps(e)-1,e),t,2)}function pC(e){var t=e.getDay();return t>=4||t===0?dc(e):dc.ceil(e)}function fB(e,t){return e=pC(e),Fe(dc.count(Ps(e),e)+(Ps(e).getDay()===4),t,2)}function dB(e){return e.getDay()}function hB(e,t){return Fe(oy.count(Ps(e)-1,e),t,2)}function gB(e,t){return Fe(e.getFullYear()%100,t,2)}function pB(e,t){return e=pC(e),Fe(e.getFullYear()%100,t,2)}function mB(e,t){return Fe(e.getFullYear()%1e4,t,4)}function yB(e,t){var n=e.getDay();return e=n>=4||n===0?dc(e):dc.ceil(e),Fe(e.getFullYear()%1e4,t,4)}function bB(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Fe(t/60|0,"0",2)+Fe(t%60,"0",2)}function mC(e,t){return Fe(e.getUTCDate(),t,2)}function vB(e,t){return Fe(e.getUTCHours(),t,2)}function xB(e,t){return Fe(e.getUTCHours()%12||12,t,2)}function wB(e,t){return Fe(1+Is.count(Bs(e),e),t,3)}function yC(e,t){return Fe(e.getUTCMilliseconds(),t,3)}function EB(e,t){return yC(e,t)+"000"}function _B(e,t){return Fe(e.getUTCMonth()+1,t,2)}function AB(e,t){return Fe(e.getUTCMinutes(),t,2)}function OB(e,t){return Fe(e.getUTCSeconds(),t,2)}function SB(e){var t=e.getUTCDay();return t===0?7:t}function CB(e,t){return Fe(hc.count(Bs(e)-1,e),t,2)}function bC(e){var t=e.getUTCDay();return t>=4||t===0?gc(e):gc.ceil(e)}function $B(e,t){return e=bC(e),Fe(gc.count(Bs(e),e)+(Bs(e).getUTCDay()===4),t,2)}function kB(e){return e.getUTCDay()}function FB(e,t){return Fe(ly.count(Bs(e)-1,e),t,2)}function DB(e,t){return Fe(e.getUTCFullYear()%100,t,2)}function jB(e,t){return e=bC(e),Fe(e.getUTCFullYear()%100,t,2)}function MB(e,t){return Fe(e.getUTCFullYear()%1e4,t,4)}function TB(e,t){var n=e.getUTCDay();return e=n>=4||n===0?gc(e):gc.ceil(e),Fe(e.getUTCFullYear()%1e4,t,4)}function NB(){return"+0000"}function vC(){return"%"}function xC(e){return+e}function wC(e){return Math.floor(+e/1e3)}var Au,wy,EC,Ey,_C;RB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function RB(e){return Au=aC(e),wy=Au.format,EC=Au.parse,Ey=Au.utcFormat,_C=Au.utcParse,Au}function Oc(e){const t={};return n=>t[n]||(t[n]=e(n))}function LB(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=PB(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function PB(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function AC(e){const t=Oc(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=xu(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return LB(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=xu(o==null?",f":o);const a=Ns(i,r,s),u=Math.max(Math.abs(i),Math.abs(r));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=TS(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=NS(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=MS(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let _y;OC();function OC(){return _y=AC({format:Ah,formatPrefix:Q1})}function SC(e){return AC(jS(e))}function $h(e){return arguments.length?_y=SC(e):_y}function CC(e,t,n){n=n||{},fe(n)||L("Invalid time multi-format specifier: ".concat(n));const i=t(hi),r=t(ei),s=t(Zn),o=t(Tn),a=t(vt),u=t(Vt),l=t(Mn),c=t(Lt),f=e(n[Ni]||".%L"),d=e(n[hi]||":%S"),h=e(n[ei]||"%I:%M"),g=e(n[Zn]||"%I %p"),p=e(n[Tn]||n[Xt]||"%a %d"),m=e(n[vt]||"%b %d"),y=e(n[Vt]||"%B"),b=e(n[Mn]||"%B"),x=e(n[Lt]||"%Y");return w=>(i(w)<w?f:r(w)<w?d:s(w)<w?h:o(w)<w?g:u(w)<w?a(w)<w?p:m:c(w)<w?l(w)<w?y:b:x)(w)}function $C(e){const t=Oc(e.format),n=Oc(e.utcFormat);return{timeFormat:i=>Se(i)?t(i):CC(t,Eu,i),utcFormat:i=>Se(i)?n(i):CC(n,_u,i),timeParse:Oc(e.parse),utcParse:Oc(e.utcParse)}}let Ay;kC();function kC(){return Ay=$C({format:wy,parse:EC,utcFormat:Ey,utcParse:_C})}function FC(e){return $C(aC(e))}function Sc(e){return arguments.length?Ay=FC(e):Ay}const Oy=(e,t)=>pe({},e,t);function DC(e,t){const n=e?SC(e):$h(),i=t?FC(t):Sc();return Oy(n,i)}function Sy(e,t){const n=arguments.length;return n&&n!==2&&L("defaultLocale expects either zero or two arguments."),n?Oy($h(e),Sc(t)):Oy($h(),Sc())}function IB(){return OC(),kC(),Sy()}const BB=/^(data:|([A-Za-z]+:)?\/\/)/,zB=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,UB=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,jC="file://";function qB(e,t){return n=>({options:n||{},sanitize:HB,load:WB,fileAccess:!!t,file:GB(t),http:VB(e)})}async function WB(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function HB(e,t){t=pe({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=zB.test(e.replace(UB,""));(e==null||typeof e!="string"||!a)&&L("Sanitize failure, invalid URI: "+ie(e));const u=BB.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(jC))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(jC.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function GB(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):YB}async function YB(){L("No file system access.")}function VB(e){return e?async function(t,n){const i=pe({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?ye(s[r])?s[r]():s.text():L(s.status+""+s.statusText)}:XB}async function XB(){L("No HTTP fetch method available.")}const KB=e=>e!=null&&e===e,QB=e=>e==="true"||e==="false"||e===!0||e===!1,JB=e=>!Number.isNaN(Date.parse(e)),MC=e=>!Number.isNaN(+e)&&!(e instanceof Date),ZB=e=>MC(e)&&Number.isInteger(+e),Cy={boolean:P1,integer:Gt,number:Gt,date:I1,string:B1,unknown:dn},kh=[QB,ZB,MC,JB],ez=["boolean","integer","number","date"];function TC(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=kh.length,r=kh.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&KB(u)&&!kh[a](u)&&(r[a]=0,++o,o===kh.length))return"string";return ez[r.reduce((s,o)=>s===0?o:s,0)-1]}function NC(e,t){return t.reduce((n,i)=>(n[i]=TC(e,i),n),{})}function RC(e){const t=function(n,i){const r={delimiter:e};return $y(n,i?pe(i,r):r)};return t.responseType="text",t}function $y(e,t){return t.header&&(e=t.header.map(ie).join(t.delimiter)+`
`+e),zP(t.delimiter).parse(e+"")}$y.responseType="text";function tz(e){return typeof Buffer=="function"&&ye(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function ky(e,t){const n=t&&t.property?Dn(t.property):dn;return fe(e)&&!tz(e)?nz(n(e),t):n(JSON.parse(e))}ky.responseType="json";function nz(e,t){return!Z(e)&&oS(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const iz={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function LC(e,t){let n,i,r,s;return e=ky(e,t),t&&t.feature?(n=HP,r=t.feature):t&&t.mesh?(n=YP,r=t.mesh,s=iz[t.filter]):L("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):L("Invalid TopoJSON object: "+r),i&&i.features||[i]}LC.responseType="json";const Fh={dsv:$y,csv:RC(","),tsv:RC("	"),json:ky,topojson:LC};function Fy(e,t){return arguments.length>1?(Fh[e]=t,this):ue(Fh,e)?Fh[e]:null}function PC(e){const t=Fy(e);return t&&t.responseType||"text"}function IC(e,t,n,i){t=t||{};const r=Fy(t.type||"json");return r||L("Unknown data format type: "+t.type),e=r(e,t),t.parse&&rz(e,t.parse,n,i),ue(e,"columns")&&delete e.columns,e}function rz(e,t,n,i){if(!e.length)return;const r=Sc();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=NC(e,s)),s=Object.keys(t);const d=s.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:n)(m);if(!Cy[g])throw Error("Illegal format pattern: "+h+":"+g);return Cy[g]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=d[l](o[a])}const Dh=qB(typeof fetch!="undefined"&&fetch,null);function jh(e){const t=e||dn,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function Mh(e,t){try{await t(e)}catch(n){e.error(n)}}const BC=Symbol("vega_id");let sz=1;function Th(e){return!!(e&&ee(e))}function ee(e){return e[BC]}function zC(e,t){return e[BC]=t,e}function Ne(e){const t=e===Object(e)?e:{data:e};return ee(t)?t:zC(t,sz++)}function Dy(e){return Nh(e,Ne({}))}function Nh(e,t){for(const n in e)t[n]=e[n];return t}function UC(e,t){return zC(t,ee(e))}function Zo(e,t){return e?t?(n,i)=>e(n,i)||ee(t(n))-ee(t(i)):(n,i)=>e(n,i)||ee(n)-ee(i):null}function qC(e){return e&&e.constructor===ea}function ea(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:ea,insert(a){const u=ae(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=ye(a)?i:t,l=ae(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:Yt(l)};return ye(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return ye(a)?r.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[ee(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[ee(p)]=-1;for(f=0,d=i.length;f<d;++f)g=i[f],u.forEach(b=>{g(b)&&(l[ee(b)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=ee(p),l[m]?l[m]=1:a.add.push(Ne(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[ee(p)]<0&&a.rem.push(p);function y(b,x,w){w?b[x]=w(b):a.encode=x,o||(c[ee(b)]=b)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[ee(p)],m>0&&(y(p,g,h.value),a.modifies(g));for(f=0,d=r.length;f<d;++f)h=r[f],g=h.filter,u.forEach(b=>{g(b)&&l[ee(b)]>0&&y(b,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?u.filter(b=>l[ee(b)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const Rh="_:mod:_";function Lh(){Object.defineProperty(this,Rh,{writable:!0,value:{}})}Lh.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[Rh];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=Z(n)?1+n.length:-1),r},modified(e,t){const n=this[Rh];if(arguments.length){if(Z(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Rh]={},this}};let oz=0;const az="pulse",uz=new Lh,lz=1,cz=2;function We(e,t,n,i){this.id=++oz,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function WC(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}We.prototype={targets(){return this._targets||(this._targets=jh(ic))},set(e){return this.value!==e?(this.value=e,1):0},skip:WC(lz),modified:WC(cz),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Lh,r=this._argops=this._argops||[],s=[];let o,a,u,l;const c=(f,d,h)=>{h instanceof We?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(o in e)if(a=e[o],o===az)ae(a).forEach(f=>{f instanceof We?f!==this&&(f.targets().add(this),s.push(f)):L("Pulse parameters must be operator instances.")}),this.source=a;else if(Z(a))for(i.set(o,-1,Array(u=a.length)),l=0;l<u;++l)c(o,l,a[l]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||uz,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function fz(e,t,n,i){let r=1,s;return e instanceof We?s=e:e&&e.prototype instanceof We?s=new e:ye(e)?s=new We(null,e):(r=0,s=new We(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function dz(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let hz=0;function Ph(e,t,n){this.id=++hz,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function zs(e,t,n){return new Ph(e,t,n)}Ph.prototype={_filter:fi,_apply:dn,targets(){return this._targets||(this._targets=jh(ic))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=zs(e);return this.targets().add(t),t},apply(e){const t=zs(null,e);return this.targets().add(t),t},merge(){const e=zs();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=zs();return this.targets().add(zs(null,null,N1(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(zs(null,null,()=>n=!0)),t.targets().add(zs(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=fi,this._targets=null}};function gz(e,t,n,i){const r=this,s=zs(n,i),o=function(l){l.dataflow=r;try{s.receive(l)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document!="undefined"?a=document.querySelectorAll(e):a=ae(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,o);return s}function pz(e,t){const n=this.locale();return IC(e,t,n.timeParse,n.utcParse)}function mz(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function yz(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:PC(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function bz(e,t,n){const i=this,r=i._pending||vz(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(fi).insert(s.data||[])),r.done(),s}function vz(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const xz={skip:!0};function wz(e,t,n,i,r){return(e instanceof We?_z:Ez)(this,e,t,n,i,r),this}function Ez(e,t,n,i,r,s){const o=pe({},s,xz);let a,u;ye(n)||(n=Yt(n)),i===void 0?a=l=>e.touch(n(l)):ye(i)?(u=new We(null,i,r,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;qC(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=l=>e.update(n(l),i,o),t.apply(a)}function _z(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new We(null,Az(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function Az(e,t){return t=ye(t)?t:Yt(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function Oz(e){e.rank=++this._rank}function Sz(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&L("Cycle detected in dataflow graph.")}const Ih={},lr=1<<0,Us=1<<1,Jr=1<<2,Cz=lr|Us,HC=lr|Jr,Ou=lr|Us|Jr,GC=1<<3,Cc=1<<4,YC=1<<5,VC=1<<6;function qs(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function jy(e,t){const n=[];return Ts(e,t,i=>n.push(i)),n}function XC(e,t){const n={};return e.visit(t,i=>{n[ee(i)]=1}),i=>n[ee(i)]?null:i}function Bh(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}qs.prototype={StopPropagation:Ih,ADD:lr,REM:Us,MOD:Jr,ADD_REM:Cz,ADD_MOD:HC,ALL:Ou,REFLOW:GC,SOURCE:Cc,NO_SOURCE:YC,NO_FIELDS:VC,fork(e){return new qs(this.dataflow).init(this,e)},clone(){const e=this.fork(Ou);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Ou|Cc)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new qs(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&VC)&&(n.fields=e.fields),t&lr?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Us?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Jr?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&YC?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Ou;return t&lr&&this.add.length||t&Us&&this.rem.length||t&Jr&&this.mod.length},reflow(e){if(e)return this.fork(Ou).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Jr,XC(this,lr))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Z(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Z(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&lr&&(n.addF=Bh(n.addF,t)),e&Us&&(n.remF=Bh(n.remF,t)),e&Jr&&(n.modF=Bh(n.modF,t)),e&Cc&&(n.srcF=Bh(n.srcF,t)),n},materialize(e){e=e||Ou;const t=this;return e&lr&&t.addF&&(t.add=jy(t.add,t.addF),t.addF=null),e&Us&&t.remF&&(t.rem=jy(t.rem,t.remF),t.remF=null),e&Jr&&t.modF&&(t.mod=jy(t.mod,t.modF),t.modF=null),e&Cc&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&Cc)return Ts(n.source,n.srcF,i),n;e&lr&&Ts(n.add,n.addF,i),e&Us&&Ts(n.rem,n.remF,i),e&Jr&&Ts(n.mod,n.modF,i);const r=n.source;if(e&GC&&r){const s=n.add.length+n.mod.length;s===r.length||(s?Ts(r,XC(n,HC),i):Ts(r,n.srcF,i))}return n}};function My(e,t,n,i){const r=this,s=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let a=0;a<s;++a){const u=n[a];if(u.stamp===t){if(u.fields){const l=r.fields||(r.fields={});for(const c in u.fields)l[c]=1}u.changed(r.ADD)&&(o|=r.ADD),u.changed(r.REM)&&(o|=r.REM),u.changed(r.MOD)&&(o|=r.MOD)}}this.changes=o}W(My,qs,{fork(e){const t=new qs(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Z(e)?e.some(i=>n[i]):n[e]:0},filter(){L("MultiPulse does not support filtering.")},materialize(){L("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function $z(e,t,n){const i=this,r=[];if(i._pulse)return KC(i);if(i._pending&&await i._pending,t&&await Mh(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new qs(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=jh(ic);let o=0,a,u,l;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}u=a.run(i._getPulse(a,e)),u.then?u=await u:u.async&&(r.push(u.async),u=Ih),u!==Ih&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Mh(i,c[f].callback)}return n&&await Mh(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function kz(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function Fz(e,t,n){return this._pulse?KC(this):(this.evaluate(e,t,n),this)}function Dz(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function KC(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function jz(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function Mz(e,t){const n=e.source,i=this._clock;return n&&Z(n)?new My(this,i,n.map(r=>r.pulse),t):this._input[e.id]||Tz(this._pulse,n&&n.pulse)}function Tz(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Ih&&(e.source=t.source),e)}const Ty={skip:!1,force:!1};function Nz(e,t){const n=t||Ty;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Rz(e,t,n){const i=n||Ty;return(e.set(t)||i.force)&&this.touch(e,i),this}function Lz(e,t,n){this.touch(e,n||Ty);const i=new qs(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function Pz(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),QC(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,Iz(t,0,e)):i=n,i}}}function QC(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function Iz(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,QC(e,i,t,n)}function Su(){this.logger(HO()),this.logLevel(F1),this._clock=0,this._rank=0,this._locale=Sy();try{this._loader=Dh()}catch{}this._touched=jh(ic),this._input={},this._pulse=null,this._heap=Pz((e,t)=>e.qrank-t.qrank),this._postrun=[]}function $c(e){return function(){return this._log[e].apply(this,arguments)}}Su.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:$c("error"),warn:$c("warn"),info:$c("info"),debug:$c("debug"),logLevel:$c("level"),cleanThreshold:1e4,add:fz,connect:dz,rank:Oz,rerank:Sz,pulse:Lz,touch:Nz,update:Rz,changeset:ea,ingest:mz,parse:pz,preload:bz,request:yz,events:gz,on:wz,evaluate:$z,run:Fz,runAsync:kz,runAfter:Dz,_enqueue:jz,_getPulse:Mz};function T(e,t){We.call(this,e,null,t)}W(T,We,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Cu={};function JC(e){const t=ZC(e);return t&&t.Definition||null}function ZC(e){return e=e&&e.toLowerCase(),ue(Cu,e)?Cu[e]:null}function*e$(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function Ny(e,t,n){const i=Float64Array.from(e$(e,n));return i.sort(bu),t.map(r=>ES(i,r))}function Ry(e,t){return Ny(e,[.25,.5,.75],t)}function Ly(e,t){const n=e.length,i=eI(e,t),r=Ry(e,t),s=(r[2]-r[0])/1.34,o=Math.min(i,s)||i||Math.abs(r[0])||1;return 1.06*o*Math.pow(n,-.2)}function t$(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,d;const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=r.length;f<d;++f)c=a/r[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const g=c>=0?0:~~(-c/i)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+p)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var gi=Math.random;function Bz(e){gi=e}function n$(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(e$(e,i)),s=r.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=r[~~(gi()*s)];c[l]=a/s}return c.sort(bu),[X1(c,n/2),X1(c,1-n/2)]}function i$(e,t,n,i){i=i||(d=>d);const r=e.length,s=new Float64Array(r);let o=0,a=1,u=i(e[0]),l=u,c=u+t,f;for(;a<r;++a){if(f=i(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?zz(s,t+t/4):s}function zz(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}function Uz(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function qz(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample(){return n+Math.floor(r*gi())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return s.min(e).max(t)}const r$=Math.sqrt(2*Math.PI),Wz=Math.SQRT2;let kc=NaN;function zh(e,t){e=e||0,t=t==null?1:t;let n=0,i=0,r,s;if(kc===kc)n=kc,kc=NaN;else{do n=gi()*2-1,i=gi()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,kc=i*s}return e+n*t}function Py(e,t,n){n=n==null?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*r$)}function Uh(e,t,n){t=t||0,n=n==null?1:n;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function qh(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*Wz*Hz(2*e-1)}function Hz(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Iy(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s==null?1:s,r):i},sample:()=>zh(n,i),pdf:s=>Py(s,n,i),cdf:s=>Uh(s,n,i),icdf:s=>qh(s,n,i)};return r.mean(e).stdev(t)}function By(e,t){const n=Iy();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=Ly(e)),r):t},sample(){return e[~~(gi()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function zy(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+zh()*t)}function Uy(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*r$*e)}function qy(e,t,n){return Uh(Math.log(e),t,n)}function Wy(e,t,n){return Math.exp(qh(e,t,n))}function s$(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s==null?1:s,r):i},sample:()=>zy(n,i),pdf:s=>Uy(s,n,i),cdf:s=>qy(s,n,i),icdf:s=>Wy(s,n,i)};return r.mean(e).stdev(t)}function o$(e,t){let n=0,i;function r(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=gi();let a=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function Hy(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*gi()}function Gy(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function Yy(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Vy(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function a$(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s==null?1:s,r):i},sample:()=>Hy(n,i),pdf:s=>Gy(s,n,i),cdf:s=>Yy(s,n,i),icdf:s=>Vy(s,n,i)};return t==null&&(t=e==null?1:e,e=0),r.min(e).max(t)}function Fc(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function Wh(e,t,n,i){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),i&&e.sort((h,g)=>t(h)-t(g));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,u=0,l=0,c,f,d;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<r;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function Dc(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function $u(e,t,n,i,r){let s=0,o=0;return Dc(e,t,n,(a,u)=>{const l=u-r(a),c=u-i;s+=l*l,o+=c*c}),1-s/o}function Xy(e,t,n){let i=0,r=0,s=0,o=0,a=0;Dc(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=Fc(i,r,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:$u(e,t,n,r,l)}}function u$(e,t,n){let i=0,r=0,s=0,o=0,a=0;Dc(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=Fc(i,r,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:$u(e,t,n,r,l)}}function l$(e,t,n){const[i,r,s,o]=Wh(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,g;Dc(e,t,n,(b,x)=>{d=i[f++],h=Math.log(x),g=d*x,a+=(x*h-a)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=Fc(u/o,a/o,l/o,c/o),y=b=>Math.exp(p+m*(b-s));return{coef:[Math.exp(p-m*s),m],predict:y,rSquared:$u(e,t,n,o,y)}}function c$(e,t,n){let i=0,r=0,s=0,o=0,a=0,u=0;Dc(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,i+=(h-i)/u,r+=(g-r)/u,s+=(h*g-s)/u,o+=(h*h-o)/u,a+=(d-a)/u});const l=Fc(i,r,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:$u(e,t,n,a,c)}}function Ky(e,t,n){const[i,r,s,o]=Wh(e,t,n),a=i.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<a;)g=i[h],p=r[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,b=u*y-l*l,x=(d*u-f*l)/b,w=(f*y-d*l)/b,_=-x*u,A=E=>(E=E-s,x*E*E+w*E+_+o);return{coef:[_-w*s+x*s*s+o,w-2*x*s,x],predict:A,rSquared:$u(e,t,n,o,A)}}function f$(e,t,n,i){if(i===1)return Xy(e,t,n);if(i===2)return Ky(e,t,n);const[r,s,o,a]=Wh(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d)*s[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=Yz(c),b=x=>{x-=o;let w=a+y[0]+y[1]*x+y[2]*x*x;for(d=3;d<f;++d)w+=y[d]*Math.pow(x,d);return w};return{coef:Gz(f,y,-o,a),predict:b,rSquared:$u(e,t,n,a,b)}}function Gz(e,t,n,i){const r=Array(e);let s,o,a,u;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,r[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*u;return r[0]+=i,r}function Yz(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const d$=2,h$=1e-12;function g$(e,t,n,i){const[r,s,o,a]=Wh(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=d$;){const g=[0,l-1];for(let m=0;m<u;++m){const y=r[m],b=g[0],x=g[1],w=y-r[b]>r[x]-y?b:x;let _=0,A=0,E=0,S=0,k=0;const $=1/Math.abs(r[w]-y||1);for(let j=b;j<=x;++j){const I=r[j],D=s[j],P=Vz(Math.abs(y-I)*$)*d[j],B=I*P;_+=P,A+=B,E+=D*P,S+=D*B,k+=I*B}const[F,M]=Fc(A/_,E/_,S/_,k/_);c[m]=F+M*y,f[m]=Math.abs(s[m]-c[m]),Xz(r,m+1,g)}if(h===d$)break;const p=_S(f);if(Math.abs(p)<h$)break;for(let m=0,y,b;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?h$:(b=1-y*y)*b}return Kz(r,c,o,a)}function Vz(e){return(e=1-e*e*e)*e*e}function Xz(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function Kz(e,t,n,i){const r=e.length,s=[];let o=0,a=0,u=[],l;for(;o<r;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=i,u=[l,t[o]],s.push(u));return u[1]+=i,s}const Qz=.5*Math.PI/180;function Hh(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=p=>[p,e(p)],s=t[0],o=t[1],a=o-s,u=a/i,l=[r(s)],c=[];if(n===i){for(let p=1;p<i;++p)l.push(r(s+p/n*a));return l.push(r(o)),l}else{c.push(r(o));for(let p=n;--p>0;)c.push(r(s+p/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,g=Jz(f[1],c);for(;d;){const p=r((f[0]+d[0])/2);p[0]-f[0]>=u&&Zz(f,p,d,h,g)>Qz?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function Jz(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function Zz(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function eU(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function Qy(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:eU(e)}function p$(e,t,n){return n||e+(t?"_"+t:"")}const Jy=()=>{},tU={init:Jy,add:Jy,rem:Jy,idx:0},jc={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Mc=Object.keys(jc);function nU(e,t){return n=>pe({name:e,out:n||e},tU,t)}Mc.forEach(e=>{jc[e]=nU(e,jc[e])});function m$(e,t){return jc[e](t)}function y$(e,t){return e.idx-t.idx}function iU(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=jc[r]())})};return e.forEach(n),Object.values(t).sort(y$)}function rU(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function sU(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function oU(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function aU(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function b$(e,t){const n=t||dn,i=iU(e),r=e.slice().sort(y$);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=rU,s.prototype.add=sU,s.prototype.rem=oU,s.prototype.set=aU,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function Zy(e){this._key=e?Dn(e):ee,this.reset()}const Pt=Zy.prototype;Pt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Pt.add=function(e){this._add.push(e)};Pt.rem=function(e){this._rem.push(e)};Pt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,u,l;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,u=0;a<i;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};Pt.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",ue(n,s)||(n[s]=1,++r);return r};Pt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=rS(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Pt.argmin=function(e){return this.extent(e)[0]||{}};Pt.argmax=function(e){return this.extent(e)[1]||{}};Pt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Pt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Pt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Ry(this.values(),e),this._get=e),this._q};Pt.q1=function(e){return this.quartile(e)[0]};Pt.q2=function(e){return this.quartile(e)[1]};Pt.q3=function(e){return this.quartile(e)[2]};Pt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=n$(this.values(),1e3,.05,e),this._get=e),this._ci};Pt.ci0=function(e){return this.ci(e)[0]};Pt.ci1=function(e){return this.ci(e)[1]};function Ws(e){T.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Ws.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Mc},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};W(Ws,T,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){const c=n[l],f=i[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<r?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const y=ae(Ht(m)),b=y.length;let x=0,w;for(;x<b;++x)i[w=y[x]]||(i[w]=1,t.push(w))}this._dims=ae(e.groupby),this._dnames=this._dims.map(m=>{const y=rt(m);return r(m),n.push(y),y}),this.cellkey=e.key?e.key:Qy(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],u=s.length,l={};let c,f,d,h,g,p;for(u!==o.length&&L("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=s[p],f=o[p],c==null&&f!=="count"&&L("Null aggregate field specified."),h=rt(c),g=p$(f,h,a[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(r(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(m$(f,g))}return this._measures=this._measures.map(m=>b$(m,m.field)),{}},cellkey:Qy(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new Zy),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?UC(t.tuple,s):Ne(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const uU=1e-14;function eb(e){T.call(this,null,e)}eb.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};W(eb,T,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Ht(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[a]=f,c[u]=f==null?null:r+s*(1+(f-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=t$(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const u=function(l){let c=Gt(t(l));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(uU+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=Fn(u,Ht(t),e.name||"bin_"+rt(t))}});function v$(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:u=>s.push(u),remove:u=>o[i(u)]=++a,size:()=>r.length,data:(u,l)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),l&&u&&r.sort(u),s.length&&(r=u?cS(u,r,s.sort(u)):r.concat(s),s=[]),r)}}function tb(e){T.call(this,[],e)}tb.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};W(tb,T,{transform(e,t){const n=t.fork(t.ALL),i=v$(ee,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(Zo(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function x$(e){We.call(this,null,lU,e)}W(x$,We);function lU(e){return this.value&&!e.modified()?this.value:T1(e.fields,e.orders)}function nb(e){T.call(this,null,e)}nb.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function cU(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}W(nb,T,{transform(e,t){const n=f=>d=>{for(var h=cU(a(d),e.case,s)||[],g,p=0,m=h.length;p<m;++p)o.test(g=h[p])||f(g)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=i[a],l=n[a]||0,!u&&l?(i[a]=u=Ne({}),u[r]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,i[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)}});function ib(e){T.call(this,null,e)}ib.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};W(ib,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=fU(a,r,s,e.filter||fi)):n.mod=a,n.source=this.value,n.modifies(i)}});function fU(e,t,n,i){for(var r=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],i(s)&&(r.push(Ne(s)),s={},s[t]=l);return r}const w$={kde:By,mixture:o$,normal:Iy,lognormal:s$,uniform:a$},dU="distributions",E$="function",hU="field";function _$(e,t){const n=e[E$];ue(w$,n)||L("Unknown distribution function: "+n);const i=w$[n]();for(const r in e)r===hU?i.data((e.from||t()).map(e[r])):r===dU?i[r](e[r].map(s=>_$(s,t))):typeof i[r]===E$&&i[r](e[r]);return i}function rb(e){T.call(this,null,e)}const A$=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],gU={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:A$},{name:"weights",type:"number",array:!0}]};rb.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:A$.concat(gU)},{name:"as",type:"string",array:!0,default:["value","density"]}]};W(rb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=_$(e.distribution,pU(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&L("Invalid density method: "+o),!e.extent&&!i.data&&L("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=e.extent||ar(i.data()),l=Hh(o,u,r,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],Ne(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function pU(e){return()=>e.materialize(e.SOURCE).source}function O$(e,t){return e?e.map((n,i)=>t[i]||rt(n)):null}function sb(e,t,n){const i=[],r=f=>f(u);let s,o,a,u,l,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)u=e[o],l=t.map(r),c=s[l],c||(s[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const S$="bin";function ob(e){T.call(this,null,e)}ob.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:S$}]};const mU=(e,t)=>oc(ar(e,t))/30;W(ob,T,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=sb(t.source,e.groupby,dn),r=e.smooth||!1,s=e.field,o=e.step||mU(n,s),a=Zo((g,p)=>s(g)-s(p)),u=e.as||S$,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=i[d].sort(a);h=-1;for(const p of i$(g,o,r,s))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function C$(e){We.call(this,null,yU,e),this.modified(!0)}W(C$,We);function yU(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Fn(n=>t(n,e),Ht(t),rt(t))}function ab(e){T.call(this,[void 0,void 0],e)}ab.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};W(ab,T,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const u=Gt(i(a));u!=null&&(u<s&&(s=u),u>o&&(o=u))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=rt(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function ub(e,t){We.call(this,e),this.parent=t,this.count=0}W(ub,We,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Gh(e){T.call(this,{},e),this._keys=mu();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}W(Gh,T,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=ue(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new ub(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ee(u),c=s.get(l);c!==void 0&&(s.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);s.set(ee(u),l),a(l).add(u)}),o||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ee(u),c=s.get(l),f=i(u);c===f?a(f).mod(u):(s.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(s.get(ee(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=ee(u),c=s.get(l),f=i(u);c!==f&&(s.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function $$(e){We.call(this,null,bU,e)}W($$,We);function bU(e){return this.value&&!e.modified()?this.value:Z(e.name)?ae(e.name).map(t=>Dn(t)):Dn(e.name,e.as)}function lb(e){T.call(this,mu(),e)}lb.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};W(lb,T,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ee(f);i.has(d)?i.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):i.set(ee(f),1)});function c(f){const d=ee(f),h=u(f,e),g=i.get(d);h&&g?(i.delete(d),s.push(f)):!h&&!g?(i.set(d,1),o.push(f)):l&&h&&!g&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function cb(e){T.call(this,[],e)}cb.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};W(cb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=O$(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=i.map(g=>g(a)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Dy(a),f=0;f<o;++f)d[r[f]]=(h=u[f][c])==null?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function fb(e){T.call(this,[],e)}fb.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};W(fb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(rt),s=e.as||["key","value"],o=s[0],a=s[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Dy(l),f[o]=r[c],f[a]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function db(e){T.call(this,null,e)}db.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};W(db,T,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function k$(e){T.call(this,[],e)}W(k$,T,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,u;if(s>0){for(o=[];--s>=0;)o.push(u=Ne(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const Yh={value:"value",median:_S,mean:nI,min:V1,max:Vo},vU=[];function hb(e){T.call(this,[],e)}hb.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function xU(e){var t=e.method||Yh.value,n;if(Yh[t]==null)L("Unrecognized imputation method: "+t);else return t===Yh.value?(n=e.value!==void 0?e.value:0,()=>n):Yh[t]}function wU(e){const t=e.field;return n=>n?t(n):NaN}W(hb,T,{transform(e,t){var n=t.fork(t.ALL),i=xU(e),r=wU(e),s=rt(e.field),o=rt(e.key),a=(e.groupby||[]).map(rt),u=EU(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,b,x,w,_;for(m=0,x=u.length;m<x;++m)for(d=u[m],g=d.values,h=NaN,b=0;b<f;++b)if(d[b]==null){for(p=u.domain[b],_={_impute:!0},y=0,w=g.length;y<w;++y)_[a[y]]=g[y];_[o]=p,_[s]=Number.isNaN(h)?h=i(d,r):h,l.push(Ne(_))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function EU(e,t,n,i){var r=y=>y(m),s=[],o=i?i.slice():[],a={},u={},l,c,f,d,h,g,p,m;for(o.forEach((y,b)=>a[y]=b+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=a[g]||(a[g]=o.push(g)),c=(l=t?t.map(r):vU)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[h-1]=m;return s.domain=o,s}function gb(e){Ws.call(this,e)}gb.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Mc},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};W(gb,Ws,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{pe(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function pb(e){T.call(this,null,e)}pb.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};W(pb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=sb(i,e.groupby,e.field),s=(e.groupby||[]).map(rt),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&L("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=ar(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const g=By(h,o)[a],p=e.counts?h.length:1,m=c||ar(h);Hh(g,m,f,d).forEach(y=>{const b={};for(let x=0;x<s.length;++x)b[s[x]]=h.dims[x];b[u[0]]=y[0],b[u[1]]=y[1]*p,l.push(Ne(b))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function F$(e){We.call(this,null,_U,e)}W(F$,We);function _U(e){return this.value&&!e.modified()?this.value:L1(e.fields,e.flat)}function D$(e){T.call(this,[],e),this._pending=null}W(D$,T,{transform(e,t){const n=t.dataflow;return this._pending?mb(this,t,this._pending):AU(e)?t.StopPropagation:e.values?mb(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=ae(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>mb(this,t,ae(i.data)))}});function AU(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function mb(e,t,n){n.forEach(Ne);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function yb(e){T.call(this,{},e)}yb.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};W(yb,T,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,a>1&&!c&&L('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&L('The "as" parameter has too few output field names.'),c=c||r.map(rt),f=function(g){for(var p=0,m=0,y,b;p<a;++p)if(b=i.get(n[p](g)),b==null)for(y=0;y<d;++y,++m)g[c[m]]=s;else for(y=0;y<d;++y,++m)g[c[m]]=r[y](b)}):(c||L("Missing output field names."),f=function(g){for(var p=0,m;p<a;++p)m=i.get(n[p](g)),g[c[p]]=m==null?s:m}),o?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function j$(e){We.call(this,null,OU,e)}W(j$,We);function OU(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function M$(e){We.call(this,null,SU,e)}W(M$,We);function SU(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function T$(e){T.call(this,null,e)}W(T$,T,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function bb(e){Ws.call(this,e)}bb.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Mc,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};W(bb,Ws,{_transform:Ws.prototype.transform,transform(e,t){return this._transform(CU(e,t),t)}});function CU(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=Ht(n).concat(Ht(i)),o=kU(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>$U(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function $U(e,t,n,i){return Fn(r=>t(r)===e?n(r):NaN,i,e+"")}function kU(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(vh),t?r.slice(0,t):r}function N$(e){Gh.call(this,e)}W(N$,Gh,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(ee(s),n,t,s);return(e.modified("field")||i&&t.modified(Ht(i)))&&L("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(Ne(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function vb(e){T.call(this,null,e)}vb.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};W(vb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=O$(e.fields,e.as||[]),s=i?(a,u)=>FU(a,u,i,r):Nh;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const u=ee(a);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,a=>{const u=s(a,Ne({}));o[ee(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[ee(a)]))}),n}});function FU(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function R$(e){T.call(this,null,e)}W(R$,T,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function xb(e){T.call(this,null,e)}xb.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const DU=1e-14;W(xb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=sb(r,e.groupby,e.field),o=(e.groupby||[]).map(rt),a=[],u=e.step||.01,l=e.probs||Jn(u/2,1-DU,u),c=l.length;return s.forEach(f=>{const d=Ny(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<o.length;++p)g[o[p]]=f.dims[p];g[i[0]]=l[h],g[i[1]]=d[h],a.push(Ne(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function L$(e){T.call(this,null,e)}W(L$,T,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=ee(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=Dy(r);i[ee(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[ee(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function wb(e){T.call(this,[],e),this.count=0}wb.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};W(wb,T,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[ee(f)]=1,c),{});let o=this.value,a=this.count,u=0;function l(c){let f,d;o.length<r?o.push(c):(d=~~((a+1)*gi()),d<o.length&&d>=u&&(f=o[d],s[ee(f)]&&n.rem.push(f),o[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ee(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[ee(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(u=a=o.length,t.visit(t.SOURCE,c=>{s[ee(c)]||l(c)}),u=-1),i&&o.length>r){const c=o.length-r;for(let f=0;f<c;++f)s[ee(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[ee(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!s[ee(c)])),this.count=a,this.value=n.source=o,n}});function Eb(e){T.call(this,null,e)}Eb.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};W(Eb,T,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Jn(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,Ne(s)}),n.add=t.add.concat(this.value),n}});function P$(e){T.call(this,null,e),this.modified(!0)}W(P$,T,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function _b(e){T.call(this,null,e)}const I$=["unit0","unit1"];_b.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:cy,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:I$}]};W(_b,T,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?_u:Eu)(s.unit).offset,a=e.as||I$,u=a[0],l=a[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Ht(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,i&&(g[l]=null)):(g[u]=m=y=s(p),i&&(g[l]=y=o(m,c)),m<f&&(f=m),y>d&&(d=y))}),s.start=f,s.stop=d,t.modifies(i?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:oC({extent:e.extent||ar(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=dy(i),o=this.value||{},a=(n?XS:VS)(s,r);return a.unit=Ee(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function B$(e){T.call(this,mu(),e)}W(B$,T,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function z$(e){T.call(this,null,e)}W(z$,T,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Zo(e.sort)):t.source).map(e.field))}});function jU(e,t,n,i){const r=Tc[e](t,n);return{init:r.init||Fs,update:function(s,o){o[i]=r.next(s)}}}const Tc={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Tc.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||L("ntile num must be greater than zero.");const n=Tc.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||L("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=MU(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function MU(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const TU=Object.keys(Tc);function U$(e){const t=ae(e.ops),n=ae(e.fields),i=ae(e.params),r=ae(e.as),s=this.outputs=[],o=this.windows=[],a={},u={},l=[],c=[];let f=!0;function d(h){ae(Ht(h)).forEach(g=>a[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=rt(p),y=p$(h,m,r[g]);if(d(p),s.push(y),ue(Tc,h))o.push(jU(h,n[g],i[g],y));else{if(p==null&&h!=="count"&&L("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let b=u[m];b||(b=u[m]=[],b.field=p,c.push(b)),b.push(m$(h,y))}}),(l.length||c.length)&&(this.cell=NU(c,l,f)),this.inputs=Object.keys(a)}const q$=U$.prototype;q$.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};q$.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function NU(e,t,n){e=e.map(u=>b$(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new Zy;return i.add=function(u){if(i.num+=1,!n){a&&a.add(u);for(let l=0;l<r;++l)s[l].add(s[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){a&&a.rem(u);for(let l=0;l<r;++l)s[l].rem(s[l].get(u),u)}},i.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},i.init=function(){i.num=0,a&&a.reset();for(let u=0;u<r;++u)s[u].init()},i}function Ab(e){T.call(this,{},e),this._mlen=0,this._mods=[]}Ab.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:TU.concat(Mc)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};W(Ab,T,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Zo(e.sort),r=Qy(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new U$(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)RU(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=v$(ee),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function RU(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),u=a.length,l=s?uc(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||Yt(-1)};t.init();for(let f=0;f<u;++f)LU(c,o,f,u),s&&PU(c,l),t.update(c,a[f])}function LU(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function PU(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}var IU=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Ws,bin:eb,collect:tb,compare:x$,countpattern:nb,cross:ib,density:rb,dotbin:ob,expression:C$,extent:ab,facet:Gh,field:$$,filter:lb,flatten:cb,fold:fb,formula:db,generate:k$,impute:hb,joinaggregate:gb,kde:pb,key:F$,load:D$,lookup:yb,multiextent:j$,multivalues:M$,params:T$,pivot:bb,prefacet:N$,project:vb,proxy:R$,quantile:xb,relay:L$,sample:wb,sequence:Eb,sieve:P$,subflow:ub,timeunit:_b,tupleindex:B$,values:z$,window:Ab});const Ob=Math.PI,Sb=2*Ob,ta=1e-6,BU=Sb-ta;function Cb(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function na(){return new Cb}Cb.prototype=na.prototype={constructor:Cb,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var s=this._x1,o=this._y1,a=n-e,u=i-t,l=s-e,c=o-t,f=l*l+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>ta)if(!(Math.abs(c*a-u*l)>ta)||!r)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-s,h=i-o,g=a*a+u*u,p=d*d+h*h,m=Math.sqrt(g),y=Math.sqrt(f),b=r*Math.tan((Ob-Math.acos((g+f-p)/(2*m*y)))/2),x=b/y,w=b/m;Math.abs(x-1)>ta&&(this._+="L"+(e+x*l)+","+(t+x*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+w*a)+","+(this._y1=t+w*u)}},arc:function(e,t,n,i,r,s){e=+e,t=+t,n=+n,s=!!s;var o=n*Math.cos(i),a=n*Math.sin(i),u=e+o,l=t+a,c=1^s,f=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>ta||Math.abs(this._y1-l)>ta)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Sb+Sb),f>BU?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>ta&&(this._+="A"+n+","+n+",0,"+ +(f>=Ob)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Re(e){return function(){return e}}var W$=Math.abs,Kt=Math.atan2,ia=Math.cos,zU=Math.max,$b=Math.min,cr=Math.sin,ku=Math.sqrt,Qt=1e-12,Fu=Math.PI,Vh=Fu/2,H$=2*Fu;function UU(e){return e>1?0:e<-1?Fu:Math.acos(e)}function G$(e){return e>=1?Vh:e<=-1?-Vh:Math.asin(e)}function qU(e){return e.innerRadius}function WU(e){return e.outerRadius}function HU(e){return e.startAngle}function GU(e){return e.endAngle}function YU(e){return e&&e.padAngle}function VU(e,t,n,i,r,s,o,a){var u=n-e,l=i-t,c=o-r,f=a-s,d=f*u-c*l;if(!(d*d<Qt))return d=(c*(t-s)-f*(e-r))/d,[e+d*u,t+d*l]}function Xh(e,t,n,i,r,s,o){var a=e-n,u=t-i,l=(o?s:-s)/ku(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,g=n+c,p=i+f,m=(d+g)/2,y=(h+p)/2,b=g-d,x=p-h,w=b*b+x*x,_=r-s,A=d*p-g*h,E=(x<0?-1:1)*ku(zU(0,_*_*w-A*A)),S=(A*x-b*E)/w,k=(-A*b-x*E)/w,$=(A*x+b*E)/w,F=(-A*b+x*E)/w,M=S-m,j=k-y,I=$-m,D=F-y;return M*M+j*j>I*I+D*D&&(S=$,k=F),{cx:S,cy:k,x01:-c,y01:-f,x11:S*(r/_-1),y11:k*(r/_-1)}}function XU(){var e=qU,t=WU,n=Re(0),i=null,r=HU,s=GU,o=YU,a=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=r.apply(this,arguments)-Vh,g=s.apply(this,arguments)-Vh,p=W$(g-h),m=g>h;if(a||(a=l=na()),d<f&&(c=d,d=f,f=c),!(d>Qt))a.moveTo(0,0);else if(p>H$-Qt)a.moveTo(d*ia(h),d*cr(h)),a.arc(0,0,d,h,g,!m),f>Qt&&(a.moveTo(f*ia(g),f*cr(g)),a.arc(0,0,f,g,h,m));else{var y=h,b=g,x=h,w=g,_=p,A=p,E=o.apply(this,arguments)/2,S=E>Qt&&(i?+i.apply(this,arguments):ku(f*f+d*d)),k=$b(W$(d-f)/2,+n.apply(this,arguments)),$=k,F=k,M,j;if(S>Qt){var I=G$(S/f*cr(E)),D=G$(S/d*cr(E));(_-=I*2)>Qt?(I*=m?1:-1,x+=I,w-=I):(_=0,x=w=(h+g)/2),(A-=D*2)>Qt?(D*=m?1:-1,y+=D,b-=D):(A=0,y=b=(h+g)/2)}var P=d*ia(y),B=d*cr(y),H=f*ia(w),X=f*cr(w);if(k>Qt){var ce=d*ia(b),Te=d*cr(b),$e=f*ia(x),nt=f*cr(x),qe;if(p<Fu&&(qe=VU(P,B,$e,nt,ce,Te,H,X))){var lt=P-qe[0],ln=B-qe[1],ki=ce-qe[0],ci=Te-qe[1],V=1/cr(UU((lt*ki+ln*ci)/(ku(lt*lt+ln*ln)*ku(ki*ki+ci*ci)))/2),le=ku(qe[0]*qe[0]+qe[1]*qe[1]);$=$b(k,(f-le)/(V-1)),F=$b(k,(d-le)/(V+1))}}A>Qt?F>Qt?(M=Xh($e,nt,P,B,d,F,m),j=Xh(ce,Te,H,X,d,F,m),a.moveTo(M.cx+M.x01,M.cy+M.y01),F<k?a.arc(M.cx,M.cy,F,Kt(M.y01,M.x01),Kt(j.y01,j.x01),!m):(a.arc(M.cx,M.cy,F,Kt(M.y01,M.x01),Kt(M.y11,M.x11),!m),a.arc(0,0,d,Kt(M.cy+M.y11,M.cx+M.x11),Kt(j.cy+j.y11,j.cx+j.x11),!m),a.arc(j.cx,j.cy,F,Kt(j.y11,j.x11),Kt(j.y01,j.x01),!m))):(a.moveTo(P,B),a.arc(0,0,d,y,b,!m)):a.moveTo(P,B),!(f>Qt)||!(_>Qt)?a.lineTo(H,X):$>Qt?(M=Xh(H,X,ce,Te,f,-$,m),j=Xh(P,B,$e,nt,f,-$,m),a.lineTo(M.cx+M.x01,M.cy+M.y01),$<k?a.arc(M.cx,M.cy,$,Kt(M.y01,M.x01),Kt(j.y01,j.x01),!m):(a.arc(M.cx,M.cy,$,Kt(M.y01,M.x01),Kt(M.y11,M.x11),!m),a.arc(0,0,f,Kt(M.cy+M.y11,M.cx+M.x11),Kt(j.cy+j.y11,j.cx+j.x11),m),a.arc(j.cx,j.cy,$,Kt(j.y11,j.x11),Kt(j.y01,j.x01),!m))):a.arc(0,0,f,w,x,m)}if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Fu/2;return[ia(c)*l,cr(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Re(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Re(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Re(+l),u):n},u.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:Re(+l),u):i},u.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:Re(+l),u):r},u.endAngle=function(l){return arguments.length?(s=typeof l=="function"?l:Re(+l),u):s},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Re(+l),u):o},u.context=function(l){return arguments.length?(a=l==null?null:l,u):a},u}function Y$(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function V$(e){this._context=e}V$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function kb(e){return new V$(e)}function X$(e){return e[0]}function K$(e){return e[1]}function Q$(e,t){var n=Re(!0),i=null,r=kb,s=null;e=typeof e=="function"?e:e===void 0?X$:Re(e),t=typeof t=="function"?t:t===void 0?K$:Re(t);function o(a){var u,l=(a=Y$(a)).length,c,f=!1,d;for(i==null&&(s=r(d=na())),u=0;u<=l;++u)!(u<l&&n(c=a[u],u,a))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,u,a),+t(c,u,a));if(d)return s=null,d+""||null}return o.x=function(a){return arguments.length?(e=typeof a=="function"?a:Re(+a),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:Re(+a),o):t},o.defined=function(a){return arguments.length?(n=typeof a=="function"?a:Re(!!a),o):n},o.curve=function(a){return arguments.length?(r=a,i!=null&&(s=r(i)),o):r},o.context=function(a){return arguments.length?(a==null?i=s=null:s=r(i=a),o):i},o}function J$(e,t,n){var i=null,r=Re(!0),s=null,o=kb,a=null;e=typeof e=="function"?e:e===void 0?X$:Re(+e),t=typeof t=="function"?t:Re(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?K$:Re(+n);function u(c){var f,d,h,g=(c=Y$(c)).length,p,m=!1,y,b=new Array(g),x=new Array(g);for(s==null&&(a=o(y=na())),f=0;f<=g;++f){if(!(f<g&&r(p=c[f],f,c))===m)if(m=!m)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=d;--h)a.point(b[h],x[h]);a.lineEnd(),a.areaEnd()}m&&(b[f]=+e(p,f,c),x[f]=+t(p,f,c),a.point(i?+i(p,f,c):b[f],n?+n(p,f,c):x[f]))}if(y)return a=null,y+""||null}function l(){return Q$().defined(r).curve(o).context(s)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Re(+c),i=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Re(+c),u):e},u.x1=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Re(+c),u):i},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Re(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Re(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Re(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(i).y(t)},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Re(!!c),u):r},u.curve=function(c){return arguments.length?(o=c,s!=null&&(a=o(s)),u):o},u.context=function(c){return arguments.length?(c==null?s=a=null:a=o(s=c),u):s},u}var KU={draw:function(e,t){var n=Math.sqrt(t/Fu);e.moveTo(n,0),e.arc(0,0,n,0,H$)}};function QU(e,t){var n=null;e=typeof e=="function"?e:Re(e||KU),t=typeof t=="function"?t:Re(t===void 0?64:+t);function i(){var r;if(n||(n=r=na()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(e=typeof r=="function"?r:Re(r),i):e},i.size=function(r){return arguments.length?(t=typeof r=="function"?r:Re(+r),i):t},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function Hs(){}function Kh(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Qh(e){this._context=e}Qh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Kh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JU(e){return new Qh(e)}function Z$(e){this._context=e}Z$.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZU(e){return new Z$(e)}function ek(e){this._context=e}ek.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eq(e){return new ek(e)}function tk(e,t){this._basis=new Qh(e),this._beta=t}tk.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+u*s),this._beta*t[a]+(1-this._beta)*(r+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var tq=function e(t){function n(i){return t===1?new Qh(i):new tk(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function Jh(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Fb(e,t){this._context=e,this._k=(1-t)/6}Fb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Jh(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var nq=function e(t){function n(i){return new Fb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Db(e,t){this._context=e,this._k=(1-t)/6}Db.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var iq=function e(t){function n(i){return new Db(i,t)}return n.tension=function(i){return e(+i)},n}(0);function jb(e,t){this._context=e,this._k=(1-t)/6}jb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Jh(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rq=function e(t){function n(i){return new jb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Mb(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>Qt){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Qt){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function nk(e,t){this._context=e,this._alpha=t}nk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Mb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sq=function e(t){function n(i){return t?new nk(i,t):new Fb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function ik(e,t){this._context=e,this._alpha=t}ik.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Mb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oq=function e(t){function n(i){return t?new ik(i,t):new Db(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function rk(e,t){this._context=e,this._alpha=t}rk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Mb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var aq=function e(t){function n(i){return t?new rk(i,t):new jb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function sk(e){this._context=e}sk.prototype={areaStart:Hs,areaEnd:Hs,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function uq(e){return new sk(e)}function ok(e){return e<0?-1:1}function ak(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(ok(s)+ok(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function uk(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Tb(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function Zh(e){this._context=e}Zh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tb(this,this._t0,uk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Tb(this,uk(this,n=ak(this,e,t)),n);break;default:Tb(this,this._t0,n=ak(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function lk(e){this._context=new ck(e)}(lk.prototype=Object.create(Zh.prototype)).point=function(e,t){Zh.prototype.point.call(this,t,e)};function ck(e){this._context=e}ck.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function lq(e){return new Zh(e)}function cq(e){return new lk(e)}function fk(e){this._context=e}fk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=dk(e),r=dk(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function dk(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function fq(e){return new fk(e)}function eg(e,t){this._context=e,this._t=t}eg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function dq(e){return new eg(e,.5)}function hq(e){return new eg(e,0)}function gq(e){return new eg(e,1)}function Du(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const pq=()=>typeof Image!="undefined"?Image:null;function fr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Nb=Symbol("implicit");function Rb(){var e=new Map,t=[],n=[],i=Nb;function r(s){var o=s+"",a=e.get(o);if(!a){if(i!==Nb)return i;e.set(o,a=t.push(s))}return n[(a-1)%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of s){const a=o+"";e.has(a)||e.set(a,t.push(o))}return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return Rb(t,n).unknown(i)},fr.apply(r,arguments),r}function ju(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Nc(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Ys(){}var ra=.7,Mu=1/ra,Tu="\\s*([+-]?\\d+)\\s*",Rc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",dr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mq=/^#([0-9a-f]{3,8})$/,yq=new RegExp("^rgb\\("+[Tu,Tu,Tu]+"\\)$"),bq=new RegExp("^rgb\\("+[dr,dr,dr]+"\\)$"),vq=new RegExp("^rgba\\("+[Tu,Tu,Tu,Rc]+"\\)$"),xq=new RegExp("^rgba\\("+[dr,dr,dr,Rc]+"\\)$"),wq=new RegExp("^hsl\\("+[Rc,dr,dr]+"\\)$"),Eq=new RegExp("^hsla\\("+[Rc,dr,dr,Rc]+"\\)$"),hk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ju(Ys,Lc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:gk,formatHex:gk,formatHsl:_q,formatRgb:pk,toString:pk});function gk(){return this.rgb().formatHex()}function _q(){return xk(this).formatHsl()}function pk(){return this.rgb().formatRgb()}function Lc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=mq.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?mk(t):n===3?new It(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?tg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?tg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yq.exec(e))?new It(t[1],t[2],t[3],1):(t=bq.exec(e))?new It(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vq.exec(e))?tg(t[1],t[2],t[3],t[4]):(t=xq.exec(e))?tg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wq.exec(e))?vk(t[1],t[2]/100,t[3]/100,1):(t=Eq.exec(e))?vk(t[1],t[2]/100,t[3]/100,t[4]):hk.hasOwnProperty(e)?mk(hk[e]):e==="transparent"?new It(NaN,NaN,NaN,0):null}function mk(e){return new It(e>>16&255,e>>8&255,e&255,1)}function tg(e,t,n,i){return i<=0&&(e=t=n=NaN),new It(e,t,n,i)}function Lb(e){return e instanceof Ys||(e=Lc(e)),e?(e=e.rgb(),new It(e.r,e.g,e.b,e.opacity)):new It}function Vs(e,t,n,i){return arguments.length===1?Lb(e):new It(e,t,n,i==null?1:i)}function It(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}ju(It,Vs,Nc(Ys,{brighter:function(e){return e=e==null?Mu:Math.pow(Mu,e),new It(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?ra:Math.pow(ra,e),new It(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yk,formatHex:yk,formatRgb:bk,toString:bk}));function yk(){return"#"+Pb(this.r)+Pb(this.g)+Pb(this.b)}function bk(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Pb(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function vk(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new hr(e,t,n,i)}function xk(e){if(e instanceof hr)return new hr(e.h,e.s,e.l,e.opacity);if(e instanceof Ys||(e=Lc(e)),!e)return new hr;if(e instanceof hr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,u=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+r:2-s-r,o*=60):a=u>0&&u<1?0:o,new hr(o,a,u,e.opacity)}function ng(e,t,n,i){return arguments.length===1?xk(e):new hr(e,t,n,i==null?1:i)}function hr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}ju(hr,ng,Nc(Ys,{brighter:function(e){return e=e==null?Mu:Math.pow(Mu,e),new hr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ra:Math.pow(ra,e),new hr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new It(Ib(e>=240?e-240:e+120,r,i),Ib(e,r,i),Ib(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Ib(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const wk=Math.PI/180,Ek=180/Math.PI,ig=18,_k=.96422,Ak=1,Ok=.82521,Sk=4/29,Nu=6/29,Ck=3*Nu*Nu,Aq=Nu*Nu*Nu;function $k(e){if(e instanceof gr)return new gr(e.l,e.a,e.b,e.opacity);if(e instanceof Zr)return kk(e);e instanceof It||(e=Lb(e));var t=qb(e.r),n=qb(e.g),i=qb(e.b),r=Bb((.2225045*t+.7168786*n+.0606169*i)/Ak),s,o;return t===n&&n===i?s=o=r:(s=Bb((.4360747*t+.3850649*n+.1430804*i)/_k),o=Bb((.0139322*t+.0971045*n+.7141733*i)/Ok)),new gr(116*r-16,500*(s-r),200*(r-o),e.opacity)}function rg(e,t,n,i){return arguments.length===1?$k(e):new gr(e,t,n,i==null?1:i)}function gr(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}ju(gr,rg,Nc(Ys,{brighter:function(e){return new gr(this.l+ig*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new gr(this.l-ig*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=_k*zb(t),e=Ak*zb(e),n=Ok*zb(n),new It(Ub(3.1338561*t-1.6168667*e-.4906146*n),Ub(-.9787684*t+1.9161415*e+.033454*n),Ub(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Bb(e){return e>Aq?Math.pow(e,1/3):e/Ck+Sk}function zb(e){return e>Nu?e*e*e:Ck*(e-Sk)}function Ub(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function qb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Oq(e){if(e instanceof Zr)return new Zr(e.h,e.c,e.l,e.opacity);if(e instanceof gr||(e=$k(e)),e.a===0&&e.b===0)return new Zr(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Ek;return new Zr(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function sg(e,t,n,i){return arguments.length===1?Oq(e):new Zr(e,t,n,i==null?1:i)}function Zr(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function kk(e){if(isNaN(e.h))return new gr(e.l,0,0,e.opacity);var t=e.h*wk;return new gr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ju(Zr,sg,Nc(Ys,{brighter:function(e){return new Zr(this.h,this.c,this.l+ig*(e==null?1:e),this.opacity)},darker:function(e){return new Zr(this.h,this.c,this.l-ig*(e==null?1:e),this.opacity)},rgb:function(){return kk(this).rgb()}}));var Fk=-.14861,Wb=1.78277,Hb=-.29227,og=-.90649,Pc=1.97294,Dk=Pc*og,jk=Pc*Wb,Mk=Wb*Hb-og*Fk;function Sq(e){if(e instanceof sa)return new sa(e.h,e.s,e.l,e.opacity);e instanceof It||(e=Lb(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(Mk*i+Dk*t-jk*n)/(Mk+Dk-jk),s=i-r,o=(Pc*(n-r)-Hb*s)/og,a=Math.sqrt(o*o+s*s)/(Pc*r*(1-r)),u=a?Math.atan2(o,s)*Ek-120:NaN;return new sa(u<0?u+360:u,a,r,e.opacity)}function Gb(e,t,n,i){return arguments.length===1?Sq(e):new sa(e,t,n,i==null?1:i)}function sa(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}ju(sa,Gb,Nc(Ys,{brighter:function(e){return e=e==null?Mu:Math.pow(Mu,e),new sa(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ra:Math.pow(ra,e),new sa(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*wk,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new It(255*(t+n*(Fk*i+Wb*r)),255*(t+n*(Hb*i+og*r)),255*(t+n*(Pc*i)),this.opacity)}}));function Tk(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function Nk(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return Tk((n-i/t)*t,o,r,s,a)}}function Rk(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return Tk((n-i/t)*t,r,s,o,a)}}var ag=e=>()=>e;function Lk(e,t){return function(n){return e+n*t}}function Cq(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function ug(e,t){var n=t-e;return n?Lk(e,n>180||n<-180?n-360*Math.round(n/360):n):ag(isNaN(e)?t:e)}function $q(e){return(e=+e)==1?Ft:function(t,n){return n-t?Cq(t,n,e):ag(isNaN(t)?n:t)}}function Ft(e,t){var n=t-e;return n?Lk(e,n):ag(isNaN(e)?t:e)}var Yb=function e(t){var n=$q(t);function i(r,s){var o=n((r=Vs(r)).r,(s=Vs(s)).r),a=n(r.g,s.g),u=n(r.b,s.b),l=Ft(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function Pk(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Vs(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(u){return a.r=i(u),a.g=r(u),a.b=s(u),a+""}}}var kq=Pk(Nk),Fq=Pk(Rk);function Vb(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function Ik(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Dq(e,t){return(Ik(t)?Vb:Bk)(e,t)}function Bk(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=Xs(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function zk(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function Ri(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Uk(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Xs(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var Xb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Kb=new RegExp(Xb.source,"g");function jq(e){return function(){return e}}function Mq(e){return function(t){return e(t)+""}}function qk(e,t){var n=Xb.lastIndex=Kb.lastIndex=0,i,r,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(i=Xb.exec(e))&&(r=Kb.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,u.push({i:o,x:Ri(i,r)})),n=Kb.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?Mq(u[0].x):jq(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function Xs(e,t){var n=typeof t,i;return t==null||n==="boolean"?ag(t):(n==="number"?Ri:n==="string"?(i=Lc(t))?(t=i,Yb):qk:t instanceof Lc?Yb:t instanceof Date?zk:Ik(t)?Vb:Array.isArray(t)?Bk:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Uk:Ri)(e,t)}function Tq(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Nq(e,t){var n=ug(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function Ic(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Wk=180/Math.PI,Qb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hk(e,t,n,i,r,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*Wk,skewX:Math.atan(u)*Wk,scaleX:o,scaleY:a}}var lg;function Rq(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Qb:Hk(t.a,t.b,t.c,t.d,t.e,t.f)}function Lq(e){return e==null||(lg||(lg=document.createElementNS("http://www.w3.org/2000/svg","g")),lg.setAttribute("transform",e),!(e=lg.transform.baseVal.consolidate()))?Qb:(e=e.matrix,Hk(e.a,e.b,e.c,e.d,e.e,e.f))}function Gk(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:Ri(l,f)},{i:p-2,x:Ri(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:Ri(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:Ri(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(r(h)+"scale(",null,",",null,")");g.push({i:p-4,x:Ri(l,f)},{i:p-2,x:Ri(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var Pq=Gk(Rq,"px, ","px)","deg)"),Iq=Gk(Lq,", ",")",")"),Bq=1e-12;function Yk(e){return((e=Math.exp(e))+1/e)/2}function zq(e){return((e=Math.exp(e))-1/e)/2}function Uq(e){return((e=Math.exp(2*e))-1)/(e+1)}var qq=function e(t,n,i){function r(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,g=f-u,p=h*h+g*g,m,y;if(p<Bq)y=Math.log(d/l)/t,m=function(E){return[a+E*h,u+E*g,l*Math.exp(t*E*y)]};else{var b=Math.sqrt(p),x=(d*d-l*l+i*p)/(2*l*n*b),w=(d*d-l*l-i*p)/(2*d*n*b),_=Math.log(Math.sqrt(x*x+1)-x),A=Math.log(Math.sqrt(w*w+1)-w);y=(A-_)/t,m=function(E){var S=E*y,k=Yk(_),$=l/(n*b)*(k*Uq(t*S+_)-zq(_));return[a+$*h,u+$*g,l*k/Yk(t*S+_)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},r}(Math.SQRT2,2,4);function Vk(e){return function(t,n){var i=e((t=ng(t)).h,(n=ng(n)).h),r=Ft(t.s,n.s),s=Ft(t.l,n.l),o=Ft(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}var Wq=Vk(ug),Hq=Vk(Ft);function Gq(e,t){var n=Ft((e=rg(e)).l,(t=rg(t)).l),i=Ft(e.a,t.a),r=Ft(e.b,t.b),s=Ft(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function Xk(e){return function(t,n){var i=e((t=sg(t)).h,(n=sg(n)).h),r=Ft(t.c,n.c),s=Ft(t.l,n.l),o=Ft(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}var Yq=Xk(ug),Vq=Xk(Ft);function Kk(e){return function t(n){n=+n;function i(r,s){var o=e((r=Gb(r)).h,(s=Gb(s)).h),a=Ft(r.s,s.s),u=Ft(r.l,s.l),l=Ft(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}var Xq=Kk(ug),Kq=Kk(Ft);function Jb(e,t){t===void 0&&(t=e,e=Xs);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function Qq(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var Jq=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:Xs,interpolateArray:Dq,interpolateBasis:Nk,interpolateBasisClosed:Rk,interpolateDate:zk,interpolateDiscrete:Tq,interpolateHue:Nq,interpolateNumber:Ri,interpolateNumberArray:Vb,interpolateObject:Uk,interpolateRound:Ic,interpolateString:qk,interpolateTransformCss:Pq,interpolateTransformSvg:Iq,interpolateZoom:qq,interpolateRgb:Yb,interpolateRgbBasis:kq,interpolateRgbBasisClosed:Fq,interpolateHsl:Wq,interpolateHslLong:Hq,interpolateLab:Gq,interpolateHcl:Yq,interpolateHclLong:Vq,interpolateCubehelix:Xq,interpolateCubehelixLong:Kq,piecewise:Jb,quantize:Qq});function Zq(e){return function(){return e}}function Zb(e){return+e}var Qk=[0,1];function Nn(e){return e}function ev(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Zq(isNaN(t)?NaN:.5)}function eW(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function tW(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=ev(r,i),s=n(o,s)):(i=ev(i,r),s=n(s,o)),function(a){return s(i(a))}}function nW(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=ev(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=lc(e,a,1,i)-1;return s[u](r[u](a))}}function Bc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function cg(){var e=Qk,t=Qk,n=Xs,i,r,s,o=Nn,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==Nn&&(o=eW(e[0],e[d-1])),a=d>2?nW:tW,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(i),t,n)))(i(o(d)))}return f.invert=function(d){return o(r((l||(l=a(t,e.map(i),Ri)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Zb),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Ic,c()},f.clamp=function(d){return arguments.length?(o=d?!0:Nn,c()):o!==Nn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return i=d,r=h,c()}}function Jk(){return cg()(Nn,Nn)}function Zk(e,t,n,i){var r=Ns(e,t,n),s;switch(i=xu(i==null?",f":i),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=TS(r,o))&&(i.precision=s),Q1(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=NS(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=MS(r))&&(i.precision=s-(i.type==="%")*2);break}}return Ah(i)}function oa(e){var t=e.domain;return e.ticks=function(n){var i=t();return Y1(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var r=t();return Zk(r[0],r[r.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=r,r=s,s=l);c-- >0;){if(l=xS(o,a,n),l===u)return i[r]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function eF(){var e=Jk();return e.copy=function(){return Bc(e,eF())},fr.apply(e,arguments),oa(e)}function tF(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,Zb),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return tF(e).unknown(t)},e=arguments.length?Array.from(e,Zb):[0,1],oa(n)}function nF(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function iF(e){return Math.log(e)}function rF(e){return Math.exp(e)}function iW(e){return-Math.log(-e)}function rW(e){return-Math.exp(-e)}function sW(e){return isFinite(e)?+("1e"+e):e<0?0:e}function oW(e){return e===10?sW:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function aW(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function sF(e){return function(t){return-e(-t)}}function tv(e){var t=e(iF,rF),n=t.domain,i=10,r,s;function o(){return r=aW(i),s=oW(i),n()[0]<0?(r=sF(r),s=sF(s),e(iW,rW)):e(iF,rF),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=function(a){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=r(l),h=r(c),g,p,m,y=a==null?10:+a,b=[];if(!(i%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1,g=s(d);p<i;++p)if(m=g*p,!(m<l)){if(m>c)break;b.push(m)}}else for(;d<=h;++d)for(p=i-1,g=s(d);p>=1;--p)if(m=g*p,!(m<l)){if(m>c)break;b.push(m)}b.length*2<y&&(b=Y1(l,c,y))}else b=Y1(d,h,Math.min(h-d,y)).map(s);return f?b.reverse():b},t.tickFormat=function(a,u){if(u==null&&(u=i===10?".0e":","),typeof u!="function"&&(u=Ah(u)),a===1/0)return u;a==null&&(a=10);var l=Math.max(1,i*a/t.ticks().length);return function(c){var f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=function(){return n(nF(n(),{floor:function(a){return s(Math.floor(r(a)))},ceil:function(a){return s(Math.ceil(r(a)))}}))},t}function oF(){var e=tv(cg()).domain([1,10]);return e.copy=function(){return Bc(e,oF()).base(e.base())},fr.apply(e,arguments),e}function aF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function uF(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function nv(e){var t=1,n=e(aF(t),uF(t));return n.constant=function(i){return arguments.length?e(aF(t=+i),uF(t)):t},oa(n)}function lF(){var e=nv(cg());return e.copy=function(){return Bc(e,lF()).constant(e.constant())},fr.apply(e,arguments)}function cF(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function uW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function lW(e){return e<0?-e*e:e*e}function iv(e){var t=e(Nn,Nn),n=1;function i(){return n===1?e(Nn,Nn):n===.5?e(uW,lW):e(cF(n),cF(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},oa(t)}function rv(){var e=iv(cg());return e.copy=function(){return Bc(e,rv()).exponent(e.exponent())},fr.apply(e,arguments),e}function cW(){return rv.apply(null,arguments).exponent(.5)}function fF(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=ES(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[lc(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(bu),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return fF().domain(e).range(t).unknown(i)},fr.apply(s,arguments)}function dF(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(u){return u!=null&&u<=u?r[lc(i,u,0,n)]:s}function a(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,a()):r.slice()},o.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return i.slice()},o.copy=function(){return dF().domain([e,t]).range(r).unknown(s)},fr.apply(oa(o),arguments)}function hF(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[lc(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return hF().domain(e).range(t).unknown(n)},fr.apply(r,arguments)}function fW(e){return new Date(e)}function dW(e){return e instanceof Date?+e:+new Date(+e)}function sv(e,t,n,i,r,s,o,a,u,l){var c=Jk(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),b=l("%b %d"),x=l("%B"),w=l("%Y");function _(A){return(u(A)<A?h:a(A)<A?g:o(A)<A?p:s(A)<A?m:i(A)<A?r(A)<A?y:b:n(A)<A?x:w)(A)}return c.invert=function(A){return new Date(f(A))},c.domain=function(A){return arguments.length?d(Array.from(A,dW)):d().map(fW)},c.ticks=function(A){var E=d();return e(E[0],E[E.length-1],A==null?10:A)},c.tickFormat=function(A,E){return E==null?_:l(E)},c.nice=function(A){var E=d();return(!A||typeof A.range!="function")&&(A=t(E[0],E[E.length-1],A==null?10:A)),A?d(nF(E,A)):c},c.copy=function(){return Bc(c,sv(e,t,n,i,r,s,o,a,u,l))},c}function hW(){return fr.apply(sv(EI,_I,Ps,Oh,fc,Ls,sy,ry,Rs,wy).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function gW(){return fr.apply(sv(xI,wI,Bs,Sh,hc,Is,uy,ay,Rs,Ey).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function fg(){var e=0,t=1,n,i,r,s,o=Nn,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(r===0?.5:(f=(s(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,o=f(h,g),l):[o(0),o(1)]}}return l.range=c(Xs),l.rangeRound=c(Ic),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function Ks(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ov(){var e=oa(fg()(Nn));return e.copy=function(){return Ks(e,ov())},Gs.apply(e,arguments)}function gF(){var e=tv(fg()).domain([1,10]);return e.copy=function(){return Ks(e,gF()).base(e.base())},Gs.apply(e,arguments)}function pF(){var e=nv(fg());return e.copy=function(){return Ks(e,pF()).constant(e.constant())},Gs.apply(e,arguments)}function av(){var e=iv(fg());return e.copy=function(){return Ks(e,av()).exponent(e.exponent())},Gs.apply(e,arguments)}function pW(){return av.apply(null,arguments).exponent(.5)}function dg(){var e=0,t=.5,n=1,i=1,r,s,o,a,u,l=Nn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-s)*(i*p<i*s?a:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,b,x;return arguments.length?([y,b,x]=m,l=Jb(p,[y,b,x]),h):[l(0),l(.5),l(1)]}}return h.range=g(Xs),h.rangeRound=g(Ic),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,r=p(e),s=p(t),o=p(n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function mF(){var e=oa(dg()(Nn));return e.copy=function(){return Ks(e,mF())},Gs.apply(e,arguments)}function yF(){var e=tv(dg()).domain([.1,1,10]);return e.copy=function(){return Ks(e,yF()).base(e.base())},Gs.apply(e,arguments)}function bF(){var e=nv(dg());return e.copy=function(){return Ks(e,bF()).constant(e.constant())},Gs.apply(e,arguments)}function uv(){var e=iv(dg());return e.copy=function(){return Ks(e,uv()).exponent(e.exponent())},Gs.apply(e,arguments)}function mW(){return uv.apply(null,arguments).exponent(.5)}function lv(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const yW="identity",Ru="linear",es="log",zc="pow",Uc="sqrt",hg="symlog",aa="time",ua="utc",pr="sequential",Lu="diverging",Pu="quantile",gg="quantize",pg="threshold",cv="ordinal",fv="point",vF="band",dv="bin-ordinal",xt="continuous",qc="discrete",Wc="discretizing",pi="interpolating",hv="temporal";function bW(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function vW(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,u,l;for(r<i&&(a=i,i=r,r=a),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(s<0&&(s=u),o=u);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function gv(){const e=Rb().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],g=lv(f,a,u);let p=i[d-0];r=(h-p)/(g||1),o&&(r=Math.floor(r)),p+=(h-p-r*(f-a))*l,s=r*(1-a),o&&(p=Math.round(p),s=Math.round(s));const m=Jn(f).map(y=>p+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,b,x;if(!(p!==p||m!==m)&&(m<p&&(x=p,p=m,m=x),!(m<h[0]||p>i[1-d])))return y=Math.max(0,wh(h,p)-1),b=p===m?y:wh(h,m)-1,p-h[y]>s+1e-10&&++y,d&&(x=y,y=g-b,b=g-x),y>b?void 0:t().slice(y,b+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return gv().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function xF(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return xF(t())},e}function xW(){return xF(gv().paddingInner(1))}var wW=Array.prototype.map;function EW(e){return wW.call(e,Gt)}const _W=Array.prototype.slice;function wF(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(lc(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=EW(i),n):e.slice()},n.range=function(i){return arguments.length?(t=_W.call(i),n):t.slice()},n.tickFormat=function(i,r){return Zk(e[0],Ee(e),i==null?10:i,r)},n.copy=function(){return wF().domain(n.domain()).range(n.range())},n}const mg={};function AW(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?bW(s):s.invertExtent?vW(s):void 0),s.type=e,s};return i.metadata=Ti(ae(n)),i}function De(e,t,n){return arguments.length>1?(mg[e]=AW(e,t,n),this):EF(e)?mg[e]:void 0}De(yW,tF);De(Ru,eF,xt);De(es,oF,[xt,es]);De(zc,rv,xt);De(Uc,cW,xt);De(hg,lF,xt);De(aa,hW,[xt,hv]);De(ua,gW,[xt,hv]);De(pr,ov,[xt,pi]);De("".concat(pr,"-").concat(Ru),ov,[xt,pi]);De("".concat(pr,"-").concat(es),gF,[xt,pi,es]);De("".concat(pr,"-").concat(zc),av,[xt,pi]);De("".concat(pr,"-").concat(Uc),pW,[xt,pi]);De("".concat(pr,"-").concat(hg),pF,[xt,pi]);De("".concat(Lu,"-").concat(Ru),mF,[xt,pi]);De("".concat(Lu,"-").concat(es),yF,[xt,pi,es]);De("".concat(Lu,"-").concat(zc),uv,[xt,pi]);De("".concat(Lu,"-").concat(Uc),mW,[xt,pi]);De("".concat(Lu,"-").concat(hg),bF,[xt,pi]);De(Pu,fF,[Wc,Pu]);De(gg,dF,Wc);De(pg,hF,Wc);De(dv,wF,[qc,Wc]);De(cv,Rb,qc);De(vF,gv,qc);De(fv,xW,qc);function EF(e){return ue(mg,e)}function la(e,t){const n=mg[e];return n&&n.metadata[t]}function pv(e){return la(e,xt)}function Iu(e){return la(e,qc)}function mv(e){return la(e,Wc)}function _F(e){return la(e,es)}function OW(e){return la(e,hv)}function AF(e){return la(e,pi)}function OF(e){return la(e,Pu)}const SW=["clamp","base","constant","exponent"];function SF(e,t){const n=t[0],i=Ee(t)-n;return function(r){return e(n+r*i)}}function yg(e,t,n){return Jb(yv(t||"rgb",n),e)}function CF(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function $F(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?Yt(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=De(s)().domain([t,n]).range([0,1]),SW.forEach(a=>e[a]?o[a](e[a]()):0),o)}function yv(e,t){const n=Jq[CW(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function CW(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const $W={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},kW={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function kF(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function FF(e,t){for(const n in e)bv(n,t(e[n]))}const DF={};FF(kW,kF);FF($W,e=>yg(kF(e)));function bv(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(DF[e]=t,this):DF[e]}const bg="symbol",FW="discrete",DW="gradient",jW=e=>Z(e)?e.map(t=>String(t)):String(e),MW=(e,t)=>e[1]-t[1],TW=(e,t)=>t[1]-e[1];function vv(e,t,n){let i;return Ms(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(oc(e.domain())/n||1)))),fe(t)&&(i=t.step,t=t.interval),Se(t)&&(t=e.type===aa?Eu(t):e.type==ua?_u(t):L("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function jF(e,t,n){let i=e.range(),r=i[0],s=Ee(i),o=MW;if(r>s&&(i=s,s=r,r=i,o=TW),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],Ee(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function xv(e,t){return e.bins?jF(e,e.bins):e.ticks?e.ticks(t):e.domain()}function MF(e,t,n,i,r,s){const o=t.type;let a=jW;if(o===aa||r===aa)a=e.timeFormat(i);else if(o===ua||r===ua)a=e.utcFormat(i);else if(_F(o)){const u=e.formatFloat(i);if(s||t.bins)a=u;else{const l=TF(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(a=e.format(i));return a}function TF(e,t,n){const i=xv(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/s));return l*r<r-.5&&(l*=r),l<=o};return n?i.filter(a):a}const wv={[Pu]:"quantiles",[gg]:"thresholds",[pg]:"domain"},NF={[Pu]:"quantiles",[gg]:"domain"};function RF(e,t){return e.bins?LW(e.bins):e.type===es?TF(e,t,!0):wv[e.type]?RW(e[wv[e.type]]()):xv(e,t)}function NW(e,t,n){const i=t[NF[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,3*10,n)}function RW(e){const t=[-1/0].concat(e);return t.max=1/0,t}function LW(e){const t=e.slice(0,-1);return t.max=Ee(e),t}const PW=e=>wv[e.type]||e.bins;function LF(e,t,n,i,r,s,o){const a=NF[t.type]&&s!==aa&&s!==ua?NW(e,t,r):MF(e,t,n,r,s,o);return i===bg&&PW(t)?IW(a):i===FW?BW(a):zW(a)}const IW=e=>(t,n,i)=>{const r=PF(i[n+1],PF(i.max,1/0)),s=IF(t,e),o=IF(r,e);return s&&o?s+" \u2013 "+o:o?"< "+o:"\u2265 "+s},PF=(e,t)=>e!=null?e:t,BW=e=>(t,n)=>n?e(t):null,zW=e=>t=>e(t),IF=(e,t)=>Number.isFinite(e)?t(e):null;function UW(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Ee(t),s=r-i;if(e.type===pg){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function qW(e,t,n,i){const r=i||t.type;return Se(n)&&OW(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===aa?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===ua?e.utcFormat("%A, %d %B %Y, %X UTC"):LF(e,t,5,null,n,i,!0)}function BF(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=qW(e,t,n.format,n.formatType);if(mv(t.type)){const s=RF(t).slice(1).map(r),o=s.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(s.join(", "))}else if(Iu(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(a)}else{const s=t.domain();return"values from ".concat(r(s[0])," to ").concat(r(Ee(s)))}}let zF=0;function WW(){zF=0}const vg="p_";function Ev(e){return e&&e.gradient}function UF(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?vg:"";return r||(r=e.id="gradient_"+zF++,i==="radial"?(e.x1=mr(e.x1,.5),e.y1=mr(e.y1,.5),e.r1=mr(e.r1,0),e.x2=mr(e.x2,.5),e.y2=mr(e.y2,.5),e.r2=mr(e.r2,.5),s=vg):(e.x1=mr(e.x1,0),e.y1=mr(e.y1,0),e.x2=mr(e.x2,1),e.y2=mr(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function mr(e,t){return e!=null?e:t}function qF(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const WF={basis:{curve:JU},"basis-closed":{curve:ZU},"basis-open":{curve:eq},bundle:{curve:tq,tension:"beta",value:.85},cardinal:{curve:nq,tension:"tension",value:0},"cardinal-open":{curve:rq,tension:"tension",value:0},"cardinal-closed":{curve:iq,tension:"tension",value:0},"catmull-rom":{curve:sq,tension:"alpha",value:.5},"catmull-rom-closed":{curve:oq,tension:"alpha",value:.5},"catmull-rom-open":{curve:aq,tension:"alpha",value:.5},linear:{curve:kb},"linear-closed":{curve:uq},monotone:{horizontal:cq,vertical:lq},natural:{curve:fq},step:{curve:dq},"step-after":{curve:gq},"step-before":{curve:hq}};function _v(e,t,n){var i=ue(WF,e)&&WF[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const HW={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Hc=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Bu(e){const t=[];let n,i,r,s,o,a,u,l,c,f;const d=e.slice().replace(Hc[0],"###$1").split(Hc[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],i=n.slice(1).trim().replace(Hc[2],"$1###$2").replace(Hc[3],"$1###$2").split(Hc[4]),o=n.charAt(0),r=[o],l=0,f=i.length;l<f;++l)(s=+i[l])===s&&r.push(s);if(a=HW[o.toLowerCase()],r.length-1>a){const h=r.length;for(l=1,t.push([o].concat(r.slice(l,l+=a))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=a)t.push([o].concat(r.slice(l,l+a)))}else t.push(r)}return t}const Qs=Math.PI/180,GW=1e-14,ca=Math.PI/2,yr=Math.PI*2,zu=Math.sqrt(3)/2;var Av={},Ov={},HF=[].join;function YW(e,t,n,i,r,s,o,a,u){const l=HF.call(arguments);if(Av[l])return Av[l];const c=o*Qs,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(a-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(a-e)*.5;let p=h*h/(n*n)+g*g/(i*i);p>1&&(p=Math.sqrt(p),n*=p,i*=p);const m=d/n,y=f/n,b=-f/i,x=d/i,w=m*a+y*u,_=b*a+x*u,A=m*e+y*t,E=b*e+x*t,S=(A-w)*(A-w)+(E-_)*(E-_);let k=1/S-.25;k<0&&(k=0);let $=Math.sqrt(k);s==r&&($=-$);const F=.5*(w+A)-$*(E-_),M=.5*(_+E)+$*(A-w),j=Math.atan2(_-M,w-F);let D=Math.atan2(E-M,A-F)-j;D<0&&s===1?D+=yr:D>0&&s===0&&(D-=yr);const P=Math.ceil(Math.abs(D/(ca+.001))),B=[];for(let H=0;H<P;++H){const X=j+H*D/P,ce=j+(H+1)*D/P;B[H]=[F,M,X,ce,n,i,f,d]}return Av[l]=B}function VW(e){const t=HF.call(e);if(Ov[t])return Ov[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,d=u*o,h=l*a,g=Math.cos(r),p=Math.sin(r),m=Math.cos(s),y=Math.sin(s),b=.5*(s-r),x=Math.sin(b*.5),w=8/3*x*x/Math.sin(b),_=n+g-w*p,A=i+p+w*g,E=n+m,S=i+y,k=E+w*y,$=S-w*m;return Ov[t]=[c*_+f*A,d*_+h*A,c*k+f*$,d*k+h*$,c*E+f*S,d*E+h*S]}const mi=["l",0,0,0,0,0,0,0];function XW(e,t,n){const i=mi[0]=e[0];if(i==="a"||i==="A")mi[1]=t*e[1],mi[2]=n*e[2],mi[3]=e[3],mi[4]=e[4],mi[5]=e[5],mi[6]=t*e[6],mi[7]=n*e[7];else if(i==="h"||i==="H")mi[1]=t*e[1];else if(i==="v"||i==="V")mi[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)mi[r]=(r%2==1?t:n)*e[r];return mi}function Gc(e,t,n,i,r,s){var o,a=null,u=0,l=0,c=0,f=0,d,h,g,p;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(o=t[m],(r!==1||s!==1)&&(o=XW(o,r,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+i);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+i);break;case"h":u+=o[1],e.lineTo(u+n,l+i);break;case"H":u=o[1],e.lineTo(u+n,l+i);break;case"v":l+=o[1],e.lineTo(u+n,l+i);break;case"V":l=o[1],e.lineTo(u+n,l+i);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+i);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+i);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+o[1]+n,l+o[2]+i,d+n,h+i),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-g,f=2*l-p):a[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":GF(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+i]),u+=o[6],l+=o[7];break;case"A":GF(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}a=o}}function GF(e,t,n,i){const r=YW(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=VW(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const YF=.5773502691896257,VF={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,yr)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=zu*n,r=i-n*YF,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=zu*n,r=i-n*YF;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=zu*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=zu*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=zu*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=zu*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function XF(e){return ue(VF,e)?VF[e]:KW(e)}var Sv={};function KW(e){if(!ue(Sv,e)){const t=Bu(e);Sv[e]={draw:function(n,i){Gc(n,t,0,0,Math.sqrt(i)/2)}}}return Sv[e]}const Js=.448084975506;function QW(e){return e.x}function JW(e){return e.y}function ZW(e){return e.width}function eH(e){return e.height}function ts(e){return typeof e=="function"?e:()=>+e}function xg(e,t,n){return Math.max(t,Math.min(e,n))}function KF(){var e=QW,t=JW,n=ZW,i=eH,r=ts(0),s=r,o=r,a=r,u=null;function l(c,f,d){var h,g=f!=null?f:+e.call(this,c),p=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),b=Math.min(m,y)/2,x=xg(+r.call(this,c),0,b),w=xg(+s.call(this,c),0,b),_=xg(+o.call(this,c),0,b),A=xg(+a.call(this,c),0,b);if(u||(u=h=na()),x<=0&&w<=0&&_<=0&&A<=0)u.rect(g,p,m,y);else{var E=g+m,S=p+y;u.moveTo(g+x,p),u.lineTo(E-w,p),u.bezierCurveTo(E-Js*w,p,E,p+Js*w,E,p+w),u.lineTo(E,S-A),u.bezierCurveTo(E,S-Js*A,E-Js*A,S,E-A,S),u.lineTo(g+_,S),u.bezierCurveTo(g+Js*_,S,g,S-Js*_,g,S-_),u.lineTo(g,p+x),u.bezierCurveTo(g,p+Js*x,g+Js*x,p,g+x,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=ts(c),l):e},l.y=function(c){return arguments.length?(t=ts(c),l):t},l.width=function(c){return arguments.length?(n=ts(c),l):n},l.height=function(c){return arguments.length?(i=ts(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=ts(c),s=f!=null?ts(f):r,a=d!=null?ts(d):r,o=h!=null?ts(h):s,l):r},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function QF(){var e,t,n,i,r=null,s,o,a,u;function l(f,d,h){const g=h/2;if(s){var p=a-d,m=f-o;if(p||m){var y=Math.sqrt(p*p+m*m),b=(p/=y)*u,x=(m/=y)*u,w=Math.atan2(m,p);r.moveTo(o-b,a-x),r.lineTo(f-p*g,d-m*g),r.arc(f,d,g,w-Math.PI,w),r.lineTo(o+b,a+x),r.arc(o,a,u,w,w+Math.PI)}else r.arc(f,d,g,0,yr);r.closePath()}else s=1;o=f,a=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(r==null&&(r=m=na()),d=0;d<=h;++d)!(d<h&&i(g=f[d],d,f))===p&&(p=!p)&&(s=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function Yc(e,t){return e!=null?e:t}const Vc=e=>e.x||0,Xc=e=>e.y||0,tH=e=>e.width||0,nH=e=>e.height||0,iH=e=>(e.x||0)+(e.width||0),rH=e=>(e.y||0)+(e.height||0),sH=e=>e.startAngle||0,oH=e=>e.endAngle||0,aH=e=>e.padAngle||0,uH=e=>e.innerRadius||0,lH=e=>e.outerRadius||0,cH=e=>e.cornerRadius||0,fH=e=>Yc(e.cornerRadiusTopLeft,e.cornerRadius)||0,dH=e=>Yc(e.cornerRadiusTopRight,e.cornerRadius)||0,hH=e=>Yc(e.cornerRadiusBottomRight,e.cornerRadius)||0,gH=e=>Yc(e.cornerRadiusBottomLeft,e.cornerRadius)||0,pH=e=>Yc(e.size,64),mH=e=>e.size||1,wg=e=>e.defined!==!1,yH=e=>XF(e.shape||"circle"),bH=XU().startAngle(sH).endAngle(oH).padAngle(aH).innerRadius(uH).outerRadius(lH).cornerRadius(cH),vH=J$().x(Vc).y1(Xc).y0(rH).defined(wg),xH=J$().y(Xc).x1(Vc).x0(iH).defined(wg),wH=Q$().x(Vc).y(Xc).defined(wg),EH=KF().x(Vc).y(Xc).width(tH).height(nH).cornerRadius(fH,dH,hH,gH),_H=QU().type(yH).size(pH),AH=QF().x(Vc).y(Xc).defined(wg).size(mH);function Cv(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function OH(e,t){return bH.context(e)(t)}function SH(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?xH:vH).curve(_v(i,n.orient,n.tension)).context(e)(t)}function CH(e,t){const n=t[0],i=n.interpolate||"linear";return wH.curve(_v(i,n.orient,n.tension)).context(e)(t)}function Uu(e,t,n,i){return EH.context(e)(t,n,i)}function $H(e,t){return(t.mark.shape||t.shape).context(e)(t)}function kH(e,t){return _H.context(e)(t)}function FH(e,t){return AH.context(e)(t)}var JF=1;function ZF(){JF=1}function $v(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+JF++),o=r.clipping[s]||(r.clipping[s]={id:s});return ye(i)?o.path=i(null):Cv(n)?o.path=Uu(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function wt(e){this.clear(),e&&this.union(e)}wt.prototype={clone(){return new wt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*i-u*r+l,u*i+a*r+c,a*i-u*o+l,u*i+a*o+c,a*s-u*r+l,u*s+a*r+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Eg(e){this.mark=e,this.bounds=this.bounds||new wt}function _g(e){Eg.call(this,e),this.items=this.items||[]}W(_g,Eg);function kv(e){this._pending=0,this._loader=e||Dh()}function eD(e){e._pending+=1}function Kc(e){e._pending-=1}kv.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return eD(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Kc(t),n)).catch(()=>(Kc(t),null))},loadImage(e){const t=this,n=pq();return eD(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=ue(i,"crossOrigin")?i.crossOrigin:"anonymous";return o!=null&&(s.crossOrigin=o),s.onload=()=>Kc(t),s.onerror=()=>Kc(t),s.src=r,s}).catch(i=>(Kc(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function ns(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?DH(t,i):0))}return e}function DH(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const jH=yr-1e-8;let Ag,Og,Sg,fa,Fv,Cg,Dv,jv;const Zs=(e,t)=>Ag.add(e,t),$g=(e,t)=>Zs(Og=e,Sg=t),tD=e=>Zs(e,Ag.y1),nD=e=>Zs(Ag.x1,e),da=(e,t)=>Fv*e+Dv*t,ha=(e,t)=>Cg*e+jv*t,Mv=(e,t)=>Zs(da(e,t),ha(e,t)),Tv=(e,t)=>$g(da(e,t),ha(e,t));function Qc(e,t){return Ag=e,t?(fa=t*Qs,Fv=jv=Math.cos(fa),Cg=Math.sin(fa),Dv=-Cg):(Fv=jv=1,fa=Cg=Dv=0),MH}const MH={beginPath(){},closePath(){},moveTo:Tv,lineTo:Tv,rect(e,t,n,i){fa?(Mv(e+n,t),Mv(e+n,t+i),Mv(e,t+i),Tv(e,t)):(Zs(e+n,t+i),$g(e,t))},quadraticCurveTo(e,t,n,i){const r=da(e,t),s=ha(e,t),o=da(n,i),a=ha(n,i);iD(Og,r,o,tD),iD(Sg,s,a,nD),$g(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=da(e,t),a=ha(e,t),u=da(n,i),l=ha(n,i),c=da(r,s),f=ha(r,s);rD(Og,o,u,c,tD),rD(Sg,a,l,f,nD),$g(c,f)},arc(e,t,n,i,r,s){if(i+=fa,r+=fa,Og=n*Math.cos(r)+e,Sg=n*Math.sin(r)+t,Math.abs(r-i)>jH)Zs(e-n,t-n),Zs(e+n,t+n);else{const o=l=>Zs(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(i),o(r),r!==i)if(i=i%yr,i<0&&(i+=yr),r=r%yr,r<0&&(r+=yr),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=yr,a=i-i%ca,u=0;u<4&&a>r;++u,a-=ca)o(a);else for(a=i-i%ca+ca,u=0;u<4&&a<r;++u,a=a+ca)o(a)}}};function iD(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function rD(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>GW?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&r(sD(u,e,t,n,i)),0<l&&l<1&&r(sD(l,e,t,n,i))}function sD(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var eo=(eo=Du(1,1))?eo.getContext("2d"):null;const Nv=new wt;function Rv(e){return function(t,n){if(!eo)return!0;e(eo,t),Nv.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=Nv;for(let a=r;a<=o;++a)for(let u=i;u<=s;++u)if(eo.isPointInPath(u,a))return!0;return!1}}function Lv(e,t){return t.contains(e.x||0,e.y||0)}function oD(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(Nv.set(n,i,n+r,i+s))}function aD(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return qu(t,n,i,r,s)}function qu(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(s-t)),m===1&&(h=l,g=a-t),m===2&&(h=-c,g=-(o-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function Wu(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Li(e,t){return e==null?t:e}function uD(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function TH(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+Li(t.x1,.5)*i,n.y1+Li(t.y1,.5)*r,Math.max(i,r)*Li(t.r1,0),n.x1+Li(t.x2,.5)*i,n.y1+Li(t.y2,.5)*r,Math.max(i,r)*Li(t.r2,.5));else{const o=Li(t.x1,0),a=Li(t.y1,0),u=Li(t.x2,1),l=Li(t.y2,0);if(o===u||a===l||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+u*i,n.y1+l*r);else{const c=Du(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=uD(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return uD(s,t.stops)}function lD(e,t,n){return Ev(n)?TH(e,n,t.bounds):n}function kg(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=lD(e,t,t.fill),!0):!1}var NH=[];function Hu(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=lD(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||NH),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function RH(e,t){return e.zindex-t.zindex||e.index-t.index}function Pv(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(RH)}function Pi(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=Pv(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function Fg(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=Pv(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function Iv(e){return function(t,n,i){Pi(n,r=>{(!i||i.intersects(r.bounds))&&cD(e,t,r,r)})}}function LH(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&cD(e,t,n.items[0],n.items)}}function cD(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Wu(t,n),n.fill&&kg(t,n,r)&&t.fill(),n.stroke&&Hu(t,n,r)&&t.stroke()))}function Dg(e){return e=e||fi,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,Fg(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,i,r,s,o))return a})}}function Jc(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t==null?o.fill:t,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||u&&n.isPointInStroke(r,s)}}function Bv(e){return Dg(Jc(e))}function ga(e,t){return"translate("+e+","+t+")"}function zv(e){return"rotate("+e+")"}function PH(e,t){return"scale("+e+","+t+")"}function fD(e){return ga(e.x||0,e.y||0)}function IH(e){return ga(e.x||0,e.y||0)+(e.angle?" "+zv(e.angle):"")}function BH(e){return ga(e.x||0,e.y||0)+(e.angle?" "+zv(e.angle):"")+(e.scaleX||e.scaleY?" "+PH(e.scaleX||1,e.scaleY||1):"")}function Uv(e,t,n){function i(o,a){o("transform",IH(a)),o("d",t(null,a))}function r(o,a){return t(Qc(o,a.angle),a),ns(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=Qs),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:Iv(s),pick:Bv(s),isect:n||Rv(s)}}var zH=Uv("arc",OH);function UH(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function qH(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function WH(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function qv(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(Qc(u),c),ns(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=Jc(s);function a(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:LH(s),pick:a,isect:Lv,tip:n}}var HH=qv("area",SH,UH);function GH(e,t){var n=t.clip;e.save(),ye(n)?(e.beginPath(),n(e),e.clip()):dD(e,t.group)}function dD(e,t){e.beginPath(),Cv(t)?Uu(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function hD(e){const t=Li(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function YH(e,t){e("transform",fD(t))}function gD(e,t){const n=hD(t);e("d",Uu(null,t,n,n))}function VH(e,t){e("class","background"),e("aria-hidden",!0),gD(e,t)}function XH(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?gD(e,t):e("d","")}function KH(e,t,n){const i=t.clip?$v(n,t,t):null;e("clip-path",i)}function QH(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),ns(e,t),e.translate(t.x||0,t.y||0)}function Zc(e,t,n,i){const r=hD(t);e.beginPath(),Uu(e,t,(n||0)+r,(i||0)+r)}const JH=Jc(Zc),ZH=Jc(Zc,!1),eG=Jc(Zc,!0);function tG(e,t,n){Pi(t,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,a=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&a&&(Zc(e,i,r,s),Wu(e,i),i.fill&&kg(e,i,a)&&e.fill(),i.stroke&&!o&&Hu(e,i,a)&&e.stroke()),e.save(),e.translate(r,s),i.clip&&dD(e,i),n&&n.translate(-r,-s),Pi(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,s),e.restore(),o&&i.stroke&&a&&(Zc(e,i,r,s),Wu(e,i),Hu(e,i,a)&&e.stroke())})}function nG(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return Fg(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,s))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(r<c||r>h||s<f||s>g))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,p&&Cv(u)&&!eG(e,u,o,a))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&ZH(e,u,o,a)?(e.restore(),u):(l=Fg(u,b=>iG(b,c,f)?this.pick(b,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&JH(e,u,o,a)&&(l=u),e.restore(),l||null)})}function iG(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var rG={type:"group",tag:"g",nested:!1,attr:YH,bound:QH,draw:tG,pick:nG,isect:oD,content:KH,background:VH,foreground:XH},ef={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Wv(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function Hv(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function Gv(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function jg(e,t){return e==="center"?t/2:e==="right"?t:0}function Mg(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function sG(e,t,n){const i=Wv(t,n),r=Hv(t,i),s=Gv(t,i),o=(t.x||0)-jg(t.align,r),a=(t.y||0)-Mg(t.baseline,s),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,ef["xmlns:xlink"],"xlink:href"),e("transform",ga(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function oG(e,t){const n=t.image,i=Hv(t,n),r=Gv(t,n),s=(t.x||0)-jg(t.align,i),o=(t.y||0)-Mg(t.baseline,r);return e.set(s,o,s+i,o+r)}function aG(e,t,n){Pi(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=Wv(i,this);let s=Hv(i,r),o=Gv(i,r);if(s===0||o===0)return;let a=(i.x||0)-jg(i.align,s),u=(i.y||0)-Mg(i.baseline,o),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(r.complete||r.toDataURL)&&(Wu(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,u,s,o))})}var uG={type:"image",tag:"image",nested:!1,attr:sG,bound:oG,draw:aG,pick:Dg(),isect:fi,get:Wv,xOffset:jg,yOffset:Mg},lG=qv("line",CH,qH);function cG(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",BH(t)),e("d",t.path)}function Tg(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*Qs,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Bu(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Gc(e,u,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Gc(e,u,i,r,s,o)}function fG(e,t){return Tg(Qc(e,t.angle),t)?e.set(0,0,0,0):ns(e,t,!0)}var dG={type:"path",tag:"path",nested:!1,attr:cG,bound:fG,draw:Iv(Tg),pick:Bv(Tg),isect:Rv(Tg)};function hG(e,t){e("d",Uu(null,t))}function gG(e,t){var n,i;return ns(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function pD(e,t){e.beginPath(),Uu(e,t)}var pG={type:"rect",tag:"path",nested:!1,attr:hG,bound:gG,draw:Iv(pD),pick:Bv(pD),isect:oD};function mG(e,t){e("transform",fD(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function yG(e,t){var n,i;return ns(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function mD(e,t,n){var i,r,s,o;return t.stroke&&Hu(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function bG(e,t,n){Pi(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&mD(e,i,r)&&(Wu(e,i),e.stroke())}})}function vG(e,t,n,i){return e.isPointInStroke?mD(e,t,1)&&e.isPointInStroke(n,i):!1}var xG={type:"rule",tag:"line",nested:!1,attr:mG,bound:yG,draw:bG,pick:Dg(vG),isect:aD},wG=Uv("shape",$H),EG=Uv("symbol",kH,Lv);const yD=lS();var br={height:vr,measureWidth:Vv,estimateWidth:Yv,width:Yv,canvas:bD};bD(!0);function bD(e){br.width=e&&eo?Vv:Yv}function Yv(e,t){return vD(no(e,t),vr(e))}function vD(e,t){return~~(.8*e.length*t)}function Vv(e,t){return vr(e)<=0||!(t=no(e,t))?0:xD(t,Ng(e))}function xD(e,t){const n=`(${t}) ${e}`;let i=yD.get(n);return i===void 0&&(eo.font=t,i=eo.measureText(e).width,yD.set(n,i)),i}function vr(e){return e.fontSize!=null?+e.fontSize||0:11}function to(e){return e.lineHeight!=null?e.lineHeight:vr(e)+2}function _G(e){return Z(e)?e.length>1?e:e[0]:e}function tf(e){return _G(e.lineBreak&&e.text&&!Z(e.text)?e.text.split(e.lineBreak):e.text)}function Xv(e){const t=tf(e);return(Z(t)?t.length-1:0)*to(e)}function no(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?OG(e,n):n}function AG(e){if(br.width===Vv){const t=Ng(e);return n=>xD(n,t)}else{const t=vr(e);return n=>vD(n,t)}}function OG(e,t){var n=+e.limit,i=AG(e);if(i(t)<n)return t;var r=e.ellipsis||"\u2026",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=i(r),s){for(;o<a;)u=o+a>>>1,i(t.slice(u))>n?o=u+1:a=u;return r+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),i(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+r}}function nf(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Ng(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+vr(e)+"px "+nf(e,t)}function Kv(e){var t=e.baseline,n=vr(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*to(e):t==="line-bottom"?.29*n-.5*to(e):0)}const SG={left:"start",center:"middle",right:"end"},rf=new wt;function Rg(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-ca,t+=i*Math.cos(r),n+=i*Math.sin(r)),rf.x1=t,rf.y1=n,rf}function CG(e,t){var n=t.dx||0,i=(t.dy||0)+Kv(t),r=Rg(t),s=r.x1,o=r.y1,a=t.angle||0,u;e("text-anchor",SG[t.align]||"start"),a?(u=ga(s,o)+" "+zv(a),(n||i)&&(u+=" "+ga(n,i))):u=ga(s+n,o+i),e("transform",u)}function Qv(e,t,n){var i=br.height(t),r=t.align,s=Rg(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+Kv(t)-Math.round(.8*i),c=tf(t),f;if(Z(c)?(i+=to(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,br.width(t,h)),0)):f=br.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Qs,o,a);else if(n===2)return e.rotatedPoints(t.angle*Qs,o,a);return e}function $G(e,t,n){Pi(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Ng(i),e.textAlign=i.align||"left",s=Rg(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*Qs),o=a=0),o+=i.dx||0,a+=(i.dy||0)+Kv(i),c=tf(i),Wu(e,i),Z(c))for(l=to(i),u=0;u<c.length;++u)f=no(i,c[u]),i.fill&&kg(e,i,r)&&e.fillText(f,o,a),i.stroke&&Hu(e,i,r)&&e.strokeText(f,o,a),a+=l;else f=no(i,c),i.fill&&kg(e,i,r)&&e.fillText(f,o,a),i.stroke&&Hu(e,i,r)&&e.strokeText(f,o,a);i.angle&&e.restore()}})}function kG(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Rg(t),a=o.x1,u=o.y1,l=Qv(rf,t,1),c=-t.angle*Qs,f=Math.cos(c),d=Math.sin(c),h=f*r-d*s+(a-f*a+d*u),g=d*r+f*s+(u-d*a-f*u);return l.contains(h,g)}function FG(e,t){const n=Qv(rf,e,2);return qu(t,n[0],n[1],n[2],n[3])||qu(t,n[0],n[1],n[4],n[5])||qu(t,n[4],n[5],n[6],n[7])||qu(t,n[2],n[3],n[6],n[7])}var DG={type:"text",tag:"text",nested:!1,attr:CG,bound:Qv,draw:$G,pick:Dg(kG),isect:FG},jG=qv("trail",FH,WH),ti={arc:zH,area:HH,group:rG,image:uG,line:lG,path:dG,rect:pG,rule:xG,shape:wG,symbol:EG,text:DG,trail:jG};function Jv(e,t,n){var i=ti[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new wt),e,n)}var wD={mark:null};function ED(e,t,n){var i=ti[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,u,l,c;if(i.nested)return o?l=s[0]:(wD.mark=e,l=wD),c=Jv(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new wt,o)for(a=0,u=s.length;a<u;++a)t.union(Jv(s[a],r,n));return e.bounds=t}const MG=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function _D(e,t){return JSON.stringify(e,MG,t)}function AD(e){const t=typeof e=="string"?JSON.parse(e):e;return OD(t)}function OD(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&OD(n[r]);return t&&ED(e),e}function Zv(e){arguments.length?this.root=AD(e):(this.root=SD({marktype:"group",name:"root",role:"frame"}),this.root.items=[new _g(this.root)])}Zv.prototype={toJSON(e){return _D(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=SD(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function SD(e,t){const n={bounds:new wt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function io(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function ex(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Rn(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=io(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function Ii(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function CD(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Lg(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function TG(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=ti[r.marktype]).tip){for(o=Lg(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}function ro(e,t){this._active=null,this._handlers={},this._loader=e||Dh(),this._tooltip=t||NG}function NG(e,t,n,i){e.element().setAttribute("title",i||"")}ro.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),s=io(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=TG(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:s,height:o,left:a,top:u,right:a+s,bottom:u+o}}};function xr(e){this._el=null,this._bgcolor=null,this._loader=new kv(e)}xr.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const RG="keydown",LG="keypress",PG="keyup",$D="dragenter",Pg="dragleave",kD="dragover",tx="mousedown",IG="mouseup",Ig="mousemove",sf="mouseout",FD="mouseover",Bg="click",BG="dblclick",zG="wheel",DD="mousewheel",zg="touchstart",Ug="touchmove",qg="touchend",UG=[RG,LG,PG,$D,Pg,kD,tx,IG,Ig,sf,FD,Bg,BG,zG,DD,zg,Ug,qg],nx=Ig,of=sf,ix=Bg;function af(e,t){ro.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const qG=e=>e===zg||e===Ug||e===qg?[zg,Ug,qg]:[e];function jD(e,t){qG(t).forEach(n=>WG(e,n))}function WG(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function MD(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(t,i),this.fire(e,i))}}function TD(e){return function(t){this.fire(e,t),this._active=null}}W(af,ro,{initialize(e,t,n){return this._canvas=e&&ex(e,"canvas"),[Bg,tx,Ig,sf,Pg].forEach(i=>jD(this,i)),ro.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:UG,DOMMouseScroll(e){this.fire(DD,e)},mousemove:MD(Ig,FD,sf),dragover:MD(kD,$D,Pg),mouseout:TD(sf),dragleave:TD(Pg),mousedown(e){this._down=this._active,this.fire(tx,e)},click(e){this._down===this._active&&(this.fire(Bg,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(zg,e,!0)},touchmove(e){this.fire(Ug,e,!0)},touchend(e){this.fire(qg,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===ix&&i&&i.href?this.handleHref(t,i,i.href):(e===nx||e===of)&&this.handleTooltip(t,i,e!==of),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(jD(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=Lg(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const s=this.context();return ti[e.marktype].pick.call(this,s,e,t,n,i,r)}});function HG(){return typeof window!="undefined"&&window.devicePixelRatio||1}var GG=HG();function YG(e,t,n,i,r,s){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=o?GG:r;e.width=t*u,e.height=n*u;for(const l in s)a[l]=s[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function Wg(e){xr.call(this,e),this._options={},this._redraw=!1,this._dirty=new wt,this._tempb=new wt}const ND=xr.prototype,VG=(e,t,n)=>new wt().set(0,0,t,n).translate(-e[0],-e[1]);function XG(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}W(Wg,xr,{initialize(e,t,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Du(1,1,this._options.type),e&&this._canvas&&(Ii(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),ND.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(ND.resize.call(this,e,t,n,i),this._canvas)YG(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||L("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=VG(n,i,r);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):XG(t,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const i=ti[t.marktype];t.clip&&GH(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,s=this.context();r.type!=="pdf"&&!r.externalContext&&s.clearRect(e,t,n,i),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,i))}});function rx(e,t){ro.call(this,e,t);const n=this;n._hrefHandler=sx(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=sx(n,(i,r)=>{n.handleTooltip(i,r,i.type!==of)})}const sx=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};W(rx,ro,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(ix,this._hrefHandler),i.removeEventListener(nx,this._tooltipHandler),i.removeEventListener(of,this._tooltipHandler)),this._svg=i=e&&ex(e,"svg"),i&&(i.addEventListener(ix,this._hrefHandler),i.addEventListener(nx,this._tooltipHandler),i.addEventListener(of,this._tooltipHandler)),ro.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const s={type:e,handler:t,listener:sx(this,t)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const RD="aria-hidden",ox="aria-label",ax="role",ux="aria-roledescription",LD="graphics-object",lx="graphics-symbol",PD=(e,t,n)=>({[ax]:e,[ux]:t,[ox]:n||void 0}),KG=Ti(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),ID={axis:{desc:"axis",caption:ZG},legend:{desc:"legend",caption:eY},"title-text":{desc:"title",caption:e=>`Title text '${qD(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${qD(e)}'`}},BD={ariaRole:ax,ariaRoleDescription:ux,description:ox};function zD(e,t){const n=t.aria===!1;if(e(RD,n||void 0),n||t.description==null)for(const i in BD)e(BD[i],void 0);else{const i=t.mark.marktype;e(ox,t.description),e(ax,t.ariaRole||(i==="group"?LD:lx)),e(ux,t.ariaRoleDescription||`${i} mark`)}}function UD(e){return e.aria===!1?{[RD]:!0}:KG[e.role]?null:ID[e.role]?JG(e,ID[e.role]):QG(e)}function QG(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return PD(n?LD:lx,`${t} mark container`,e.description)}function JG(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return PD(t.role||lx,t.desc,n.description||i(n))}catch{return null}}function qD(e){return ae(e.text).join(" ")}function ZG(e){const t=e.datum,n=e.orient,i=t.title?WD(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Iu(a)?"discrete":a} scale with ${BF(o,s,e)}`}function eY(e){const t=e.datum,n=t.title?WD(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,u=o.dataflow.locale();return nY(i)+(n?` titled '${n}'`:"")+` for ${tY(s)} with ${BF(u,a,e)}`}function WD(e){try{return ae(Ee(e.items).items[0].text).join(" ")}catch{return null}}function tY(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Ee(e)}function nY(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const HD=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),iY=e=>HD(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function cx(){let e="",t="",n="";const i=[],r=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${iY(l)}"`),a),a={open(u,...l){s(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return a},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),a},attr:o,text:u=>(n+=HD(u),a),toString:()=>e};return a}const GD=e=>YD(cx(),e)+"";function YD(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes,i=n.length;for(let r=0;r<i;r++){const s=n[r];s.nodeType===3?e.text(s.nodeValue):YD(e,s)}}return e.close()}const Hg={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},VD={fill:"none","stroke-miterlimit":10},uf=0,XD="http://www.w3.org/2000/xmlns/",Et=ef.xmlns;function fx(e){xr.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const dx=xr.prototype;W(fx,xr,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=Rn(e,0,"svg",Et),this._svg.setAttributeNS(XD,"xmlns",Et),this._svg.setAttributeNS(XD,"xmlns:xlink",ef["xmlns:xlink"]),this._svg.setAttribute("version",ef.version),this._svg.setAttribute("class","marks"),Ii(e,1),this._root=Rn(this._svg,uf,"g",Et),so(this._root,VD),Ii(this._svg,uf+1)),this.background(this._bgcolor),dx.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),dx.background.apply(this,arguments)},resize(e,t,n,i){return dx.resize.call(this,e,t,n,i),this._svg&&(so(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Rn(e,uf,"rect",Et),so(n,{width:this._width,height:this._height,fill:t}));const i=GD(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Ii(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,s,o,a,u;for(o=0,a=e.length;o<a;++o)if(n=e[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=ti[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,KD(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){s.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(s,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=s.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,KD(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=ti[t.marktype],s=t.interactive===!1?"none":null,o=r.tag==="g";let a=null,u=0;const l=QD(t,e,n,"g",i);l.setAttribute("class",CD(t));const c=UD(t);for(const d in c)gn(l,d,c[d]);o||gn(l,"pointer-events",s),gn(l,"clip-path",t.clip?$v(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),g=QD(d,l,a,r.tag,i);h&&(this._update(r,g,d),o&&oY(this,g,d)),a=g,++u};return r.nested?t.items.length&&f(t.items[0]):Pi(t,f),Ii(l,u),l},_update(e,t,n){is=t,Jt=t.__values__,zD(lf,n),e.attr(lf,n,this);const i=uY[e.type];i&&i.call(this,e,t,n),is&&this.style(is,n)},style(e,t){if(t!=null)for(const n in Hg){let i=n==="font"?nf(t):t[n];if(i===Jt[n])continue;const r=Hg[n];i==null?e.removeAttribute(r):(Ev(i)&&(i=UF(i,this._defs.gradient,JD())),e.setAttribute(r,i+"")),Jt[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=Rn(e,uf+1,"defs",Et)),i=rY(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=Rn(e,uf+1,"defs",Et)),i=sY(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):Ii(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function KD(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function rY(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=Rn(e,n++,"pattern",Et);so(o,{id:vg+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=Rn(o,0,"rect",Et),so(o,{width:1,height:1,fill:`url(${JD()}#${t.id})`}),e=Rn(e,n++,"radialGradient",Et),so(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Rn(e,n++,"linearGradient",Et),so(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=Rn(e,i,"stop",Et),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return Ii(e,i),n}function sY(e,t,n){let i;return e=Rn(e,n,"clipPath",Et),e.setAttribute("id",t.id),t.path?(i=Rn(e,0,"path",Et),i.setAttribute("d",t.path)):(i=Rn(e,0,"rect",Et),so(i,{x:0,y:0,width:t.width,height:t.height})),Ii(e,1),n+1}function oY(e,t,n){t=t.lastChild.previousSibling;let i,r=0;Pi(n,s=>{i=e.mark(t,s,i),++r}),Ii(t,1+r)}function QD(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=io(o,i,Et),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=io(o,"path",Et);s.appendChild(a),a.__data__=e;const u=io(o,"g",Et);s.appendChild(u),u.__data__=e;const l=io(o,"path",Et);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==r||aY(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function aY(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let is=null,Jt=null;const uY={group(e,t,n){const i=is=t.childNodes[2];Jt=i.__values__,e.foreground(lf,n,this),Jt=t.__values__,is=t.childNodes[1],e.content(lf,n,this);const r=is=t.childNodes[0];e.background(lf,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==Jt.events&&(gn(i,"pointer-events",s),gn(r,"pointer-events",s),Jt.events=s),n.strokeForeground&&n.stroke){const o=n.fill;gn(i,"display",null),this.style(r,n),gn(r,"stroke",null),o&&(n.fill=null),Jt=i.__values__,this.style(i,n),o&&(n.fill=o),is=null}else gn(i,"display","none")},image(e,t,n){n.smooth===!1?(hx(t,"image-rendering","optimizeSpeed"),hx(t,"image-rendering","pixelated")):hx(t,"image-rendering",null)},text(e,t,n){const i=tf(n);let r,s,o,a;Z(i)?(s=i.map(u=>no(n,u)),r=s.join(`
`),r!==Jt.text&&(Ii(t,0),o=t.ownerDocument,a=to(n),s.forEach((u,l)=>{const c=io(o,"tspan",Et);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Jt.text=r)):(s=no(n,i),s!==Jt.text&&(t.textContent=s,Jt.text=s)),gn(t,"font-family",nf(n)),gn(t,"font-size",vr(n)+"px"),gn(t,"font-style",n.fontStyle),gn(t,"font-variant",n.fontVariant),gn(t,"font-weight",n.fontWeight)}};function lf(e,t,n){t!==Jt[e]&&(n?lY(is,e,t,n):gn(is,e,t),Jt[e]=t)}function hx(e,t,n){n!==Jt[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),Jt[t]=n)}function so(e,t){for(const n in t)gn(e,n,t[n])}function gn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function lY(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function JD(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function gx(e){xr.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}W(gx,xr,{svg(){return this._text},_render(e){const t=cx();t.open("svg",pe({},ef,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",VD,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=ti[t.marktype],i=n.tag,r=[zD,n.attr];e.open("g",{class:CD(t),"clip-path":t.clip?$v(this,t,t.group):null},UD(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(i,this.attr(t,o,r,i!=="g"?i:null)),i==="text"){const u=tf(o);if(Z(u)){const l={x:0,dy:to(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(no(o,u[c])).close()}else e.text(no(o,u))}else if(i==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Pi(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Pi(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},s=(o,a,u,l)=>{r[l||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),i&&cY(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const s=t[r],o=s.stops;s.gradient==="radial"?(e.open("pattern",{id:vg+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const r in n){const s=n[r];e.open("clipPath",{id:r}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function cY(e,t,n,i,r){if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(e["font-family"]=nf(t),e["font-size"]=vr(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in Hg){let o=t[s];const a=Hg[s];o==="transparent"&&(a==="fill"||a==="stroke")||o!=null&&(Ev(o)&&(o=UF(o,r.gradient,"")),e[a]=o)}return e}const ZD="canvas",e3="png",t3="svg",n3="none",oo={Canvas:ZD,PNG:e3,SVG:t3,None:n3},Gu={};Gu[ZD]=Gu[e3]={renderer:Wg,headless:Wg,handler:af};Gu[t3]={renderer:fx,headless:gx,handler:rx};Gu[n3]={};function Gg(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Gu[e]=t,this):Gu[e]}function i3(e,t,n){const i=[],r=new wt().union(t),s=e.marktype;return s?r3(e,r,n,i):s==="group"?s3(e,r,n,i):L("Intersect scene must be mark node or group item.")}function r3(e,t,n,i){if(fY(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)s3(r[a],t,n,i);else for(const u=ti[s].isect;a<o;++a){const l=r[a];o3(l,t,u)&&i.push(l)}}return i}function fY(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function s3(e,t,n,i){n&&n(e.mark)&&o3(e,t,ti.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let u=0;u<s;++u)r3(r[u],t,n,i);t.translate(o,a)}return i}function o3(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const px=new wt;function a3(e){const t=e.clip;if(ye(t))t(Qc(px.clear()));else if(t)px.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(px)}const dY=1e-9;function mx(e,t,n){return e===t?!0:n==="path"?u3(e,t):e instanceof Date&&t instanceof Date?+e==+t:Ms(e)&&Ms(t)?Math.abs(e-t)<=dY:!e||!t||!fe(e)&&!fe(t)?e==t:hY(e,t)}function u3(e,t){return mx(Bu(e),Bu(t))}function hY(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!mx(e[r],t[r],r))return!1;return typeof e==typeof t}function gY(){ZF(),WW()}const Yu="top",Bi="left",zi="right",ao="bottom",pY="top-left",mY="top-right",yY="bottom-left",bY="bottom-right",yx="start",bx="middle",pn="end",vY="x",xY="y",Yg="group",vx="axis",xx="title",wY="frame",EY="scope",wx="legend",l3="row-header",c3="row-footer",f3="row-title",d3="column-header",h3="column-footer",g3="column-title",_Y="padding",AY="symbol",p3="fit",OY="fit-x",SY="fit-y",CY="pad",Ex="none",Vg="all",_x="each",Ax="flush",uo="column",lo="row";function m3(e){T.call(this,null,e)}W(m3,T,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=ti[r],o=s.bound;let a=i.bounds,u;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=Xg(i,o),i.items.forEach(l=>{l.bounds.clear().union(a)});else if(r===Yg||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),i.items.forEach(l=>a.union(Xg(l,o))),i.role){case vx:case wx:case xx:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(Xg(l,o))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(Xg(l,o))}),u&&(a.clear(),i.items.forEach(l=>a.union(l.bounds)));return a3(i),t.modifies("bounds")}});function Xg(e,t,n){return t(e.bounds.clear(),e,n)}const y3=":vega_identifier:";function Ox(e){T.call(this,0,e)}Ox.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};W(Ox,T,{transform(e,t){const n=$Y(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function $Y(e){return e._signals[y3]||(e._signals[y3]=e.add(0))}function b3(e){T.call(this,null,e)}W(b3,T,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,kY(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===Yg?_g:Eg;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function kY(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function v3(e){T.call(this,null,e)}const x3={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!w3(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},w3=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),E3=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(w3(r,s=e[n].bounds,t))return!0},FY=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},DY=(e,t,n)=>{var i=e.range(),r=new wt;return t===Yu||t===ao?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},_3=e=>(e.forEach(t=>t.opacity=1),e),A3=(e,t)=>e.reflow(t.modified()).modifies("opacity");W(v3,T,{transform(e,t){const n=x3[e.method]||x3.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(_3(r),t=A3(t,e)),t;if(r=r.filter(FY),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=_3(r),t=A3(t,e),s.length>=3&&E3(s,i)){do s=n(s,i);while(s.length>=3&&E3(s,i));s.length<3&&!Ee(r).opacity&&(s.length>1&&(Ee(s).opacity=0),Ee(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=DY(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{o(u)||(u.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function O3(e){T.call(this,null,e)}W(O3,T,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Zt=new wt;function Vu(e,t,n){return e[t]===n?0:(e[t]=n,1)}function jY(e){var t=e.items[0].orient;return t===Bi||t===zi}function MY(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function TY(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,u=MY(s),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,g=s.title&&r.items[u[2]].items[0],p=r.titlePadding,m=r.bounds,y=g&&Xv(g),b=0,x=0,w,_;switch(Zt.clear().union(m),m.clear(),(w=u[0])>-1&&m.union(r.items[w].bounds),(w=u[1])>-1&&m.union(r.items[w].bounds),a){case Yu:b=f||0,x=-c,_=Math.max(d,Math.min(h,-m.y1)),m.add(0,-_).add(l,0),g&&Kg(e,g,_,p,y,0,-1,m);break;case Bi:b=-c,x=f||0,_=Math.max(d,Math.min(h,-m.x1)),m.add(-_,0).add(0,l),g&&Kg(e,g,_,p,y,1,-1,m);break;case zi:b=n+c,x=f||0,_=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(_,l),g&&Kg(e,g,_,p,y,1,1,m);break;case ao:b=f||0,x=i+c,_=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,_),g&&Kg(e,g,_,p,0,0,1,m);break;default:b=r.x,x=r.y}return ns(m.translate(b,x),r),Vu(r,"x",b+o)|Vu(r,"y",x+o)&&(r.bounds=Zt,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function Kg(e,t,n,i,r,s,o,a){const u=t.bounds;if(t.auto){const l=o*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const S3=(e,t)=>Math.floor(Math.min(e,t)),C3=(e,t)=>Math.ceil(Math.max(e,t));function NY(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===Yg)switch(r.role){case vx:case wx:case xx:break;case l3:o.rowheaders.push(...s);break;case c3:o.rowfooters.push(...s);break;case d3:o.colheaders.push(...s);break;case h3:o.colfooters.push(...s);break;case f3:o.rowtitle=s[0];break;case g3:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function RY(e){return new wt().set(0,0,e.width||0,e.height||0)}function LY(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Qe(e,t,n){const i=fe(e)?e[t]:e;return i!=null?i:n!==void 0?n:0}function $3(e){return e<0?Math.ceil(-e):0}function k3(e,t,n){var i=!n.nodirty,r=n.bounds===Ax?RY:LY,s=Zt.set(0,0,0,0),o=Qe(n.align,uo),a=Qe(n.align,lo),u=Qe(n.padding,uo),l=Qe(n.padding,lo),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),b=0,x=Array(d),w=Array(d),_=Array(d),A,E,S,k,$,F,M,j,I,D,P;for(E=0;E<c;++E)g[E]=0;for(E=0;E<f;++E)y[E]=0;for(E=0;E<d;++E)F=t[E],$=_[E]=r(F),F.x=F.x||0,x[E]=0,F.y=F.y||0,w[E]=0,S=E%c,k=~~(E/c),p=Math.max(p,M=Math.ceil($.x2)),b=Math.max(b,j=Math.ceil($.y2)),g[S]=Math.max(g[S],M),y[k]=Math.max(y[k],j),h[E]=u+$3($.x1),m[E]=l+$3($.y1),i&&e.dirty(t[E]);for(E=0;E<d;++E)E%c==0&&(h[E]=0),E<c&&(m[E]=0);if(o===_x)for(S=1;S<c;++S){for(P=0,E=S;E<d;E+=c)P<h[E]&&(P=h[E]);for(E=S;E<d;E+=c)h[E]=P+g[S-1]}else if(o===Vg){for(P=0,E=0;E<d;++E)E%c&&P<h[E]&&(P=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=P+p)}else for(o=!1,S=1;S<c;++S)for(E=S;E<d;E+=c)h[E]+=g[S-1];if(a===_x)for(k=1;k<f;++k){for(P=0,E=k*c,A=E+c;E<A;++E)P<m[E]&&(P=m[E]);for(E=k*c;E<A;++E)m[E]=P+y[k-1]}else if(a===Vg){for(P=0,E=c;E<d;++E)P<m[E]&&(P=m[E]);for(E=c;E<d;++E)m[E]=P+b}else for(a=!1,k=1;k<f;++k)for(E=k*c,A=E+c;E<A;++E)m[E]+=y[k-1];for(I=0,E=0;E<d;++E)I=h[E]+(E%c?I:0),x[E]+=I-t[E].x;for(S=0;S<c;++S)for(D=0,E=S;E<d;E+=c)D+=m[E],w[E]+=D-t[E].y;if(o&&Qe(n.center,uo)&&f>1)for(E=0;E<d;++E)$=o===Vg?p:g[E%c],I=$-_[E].x2-t[E].x-x[E],I>0&&(x[E]+=I/2);if(a&&Qe(n.center,lo)&&c!==1)for(E=0;E<d;++E)$=a===Vg?b:y[~~(E/c)],D=$-_[E].y2-t[E].y-w[E],D>0&&(w[E]+=D/2);for(E=0;E<d;++E)s.union(_[E].translate(x[E],w[E]));switch(I=Qe(n.anchor,vY),D=Qe(n.anchor,xY),Qe(n.anchor,uo)){case pn:I-=s.width();break;case bx:I-=s.width()/2}switch(Qe(n.anchor,lo)){case pn:D-=s.height();break;case bx:D-=s.height()/2}for(I=Math.round(I),D=Math.round(D),s.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)F=t[E],F.x+=x[E]+=I,F.y+=w[E]+=D,s.union(F.mark.bounds.union(F.bounds.translate(x[E],w[E]))),i&&e.dirty(F);return s}function PY(e,t,n){var i=NY(t),r=i.marks,s=n.bounds===Ax?IY:BY,o=n.offset,a=n.columns||r.length,u=a<=0?1:Math.ceil(r.length/a),l=u*a,c,f,d,h,g,p,m;const y=k3(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(p=Qe(n.headerBand,lo,null),c=Qg(e,i.rowheaders,r,a,u,-Qe(o,"rowHeader"),S3,0,s,"x1",0,a,1,p)),i.colheaders&&(p=Qe(n.headerBand,uo,null),f=Qg(e,i.colheaders,r,a,a,-Qe(o,"columnHeader"),S3,1,s,"y1",0,1,a,p)),i.rowfooters&&(p=Qe(n.footerBand,lo,null),d=Qg(e,i.rowfooters,r,a,u,Qe(o,"rowFooter"),C3,0,s,"x2",a-1,a,1,p)),i.colfooters&&(p=Qe(n.footerBand,uo,null),h=Qg(e,i.colfooters,r,a,a,Qe(o,"columnFooter"),C3,1,s,"y2",l-a,1,a,p)),i.rowtitle&&(g=Qe(n.titleAnchor,lo),m=Qe(o,"rowTitle"),m=g===pn?d+m:c-m,p=Qe(n.titleBand,lo,.5),F3(e,i.rowtitle,m,0,y,p)),i.coltitle&&(g=Qe(n.titleAnchor,uo),m=Qe(o,"columnTitle"),m=g===pn?h+m:f-m,p=Qe(n.titleBand,uo,.5),F3(e,i.coltitle,m,1,y,p))}function IY(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function BY(e,t){return e.bounds[t]}function Qg(e,t,n,i,r,s,o,a,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,b,x,w,_,A,E,S,k;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=o(p,u(n[y],l)));if(!t.length)return p;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),p+=s,b=0,w=t.length;b<w;++b)e.dirty(t[b]),t[b].mark.bounds.clear();for(y=c,b=0,w=t.length;b<w;++b,y+=f){for(A=t[b],_=A.mark.bounds,x=y;x>=0&&(E=n[x])==null;x-=d);a?(S=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),k=p):(S=p,k=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),_.union(A.bounds.translate(S-(A.x||0),k-(A.y||0))),A.x=S,A.y=k,e.dirty(A),m=o(m,_[l])}return m}function F3(e,t,n,i,r,s){if(!!t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function zY(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function UY(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function qY(e,t,n,i,r,s,o){const a=zY(n,t),u=UY(e,a("offset",0)),l=a("anchor",yx),c=l===pn?1:l===bx?.5:0,f={align:_x,bounds:a("bounds",Ax),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Bi:f.anchor={x:Math.floor(i.x1)-u,column:pn,y:c*(o||i.height()+2*i.y1),row:l};break;case zi:f.anchor={x:Math.ceil(i.x2)+u,y:c*(o||i.height()+2*i.y1),row:l};break;case Yu:f.anchor={y:Math.floor(r.y1)-u,row:pn,x:c*(s||r.width()+2*r.x1),column:l};break;case ao:f.anchor={y:Math.ceil(r.y2)+u,x:c*(s||r.width()+2*r.x1),column:l};break;case pY:f.anchor={x:u,y:u};break;case mY:f.anchor={x:s-u,y:u,column:pn};break;case yY:f.anchor={x:u,y:o-u,row:pn};break;case bY:f.anchor={x:s-u,y:o-u,column:pn,row:pn};break}return f}function WY(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),GY(e,n,n.items[0].items[0]),s=HY(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),i.type===AY&&YY(n.items[0].items[0].items[0].items),r!==Ex&&(n.x=o=0,n.y=a=0),n.width=u,n.height=l,ns(s.set(o,a,o+u,a+l),n),n.mark.bounds.clear().union(s),n}function HY(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function GY(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&cf(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,u=t.titlePadding||0,l=i-o.x,c=i-o.y;switch(o.orient){case Bi:r+=Math.ceil(o.bounds.width())+u;break;case zi:case ao:break;default:s+=o.bounds.height()+u}switch((r||s)&&cf(e,n,r,s),o.orient){case Bi:c+=Xu(t,n,o,a,1,1);break;case zi:l+=Xu(t,n,o,pn,0,0)+u,c+=Xu(t,n,o,a,1,1);break;case ao:l+=Xu(t,n,o,a,0,0),c+=Xu(t,n,o,pn,-1,0,1)+u;break;default:l+=Xu(t,n,o,a,0,0)}(l||c)&&cf(e,o,l,c),(l=Math.round(o.bounds.x1-i))<0&&(cf(e,n,-l,0),cf(e,o,-l,0))}}function Xu(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(s||!u)&&!o?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&s?c:0,d=u&&s?0:c,h=r<=0?0:Xv(n);return Math.round(i===yx?f:i===pn?d-h:.5*(c-h))}function cf(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function YY(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function VY(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=a===Bi||a===zi?i:n,g=0,p=0,m=0,y=0,b=0,x;if(o!==Yg?a===Bi?(g=r.y2,h=r.y1):a===zi?(g=r.y1,h=r.y2):(g=r.x1,h=r.x2):a===Bi&&(g=i,h=0),x=u===yx?g:u===pn?h:(g+h)/2,d&&d.text){switch(a){case Yu:case ao:b=f.bounds.height()+c;break;case Bi:y=f.bounds.width()+c;break;case zi:y=-f.bounds.width()-c;break}Zt.clear().union(d.bounds),Zt.translate(y-(d.x||0),b-(d.y||0)),Vu(d,"x",y)|Vu(d,"y",b)&&(e.dirty(d),d.bounds.clear().union(Zt),d.mark.bounds.clear().union(Zt),e.dirty(d)),Zt.clear().union(d.bounds)}else Zt.clear();switch(Zt.union(f.bounds),a){case Yu:p=x,m=r.y1-Zt.height()-l;break;case Bi:p=r.x1-Zt.width()-l,m=x;break;case zi:p=r.x2+Zt.width()+l,m=x;break;case ao:p=x,m=r.y2+l;break;default:p=s.x,m=s.y}return Vu(s,"x",p)|Vu(s,"y",m)&&(Zt.translate(p,m),e.dirty(s),s.bounds.clear().union(Zt),t.bounds.clear().union(Zt),e.dirty(s)),s.bounds}function D3(e){T.call(this,null,e)}W(D3,T,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&PY(n,i,e.layout),KY(n,i,e)}),XY(e.mark.group)?t.reflow():t}});function XY(e){return e&&e.mark.role!=="legend-entry"}function KY(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new wt().set(0,0,r,s),a=o.clone(),u=o.clone(),l=[],c,f,d,h,g,p;for(g=0,p=i.length;g<p;++g)switch(f=i[g],f.role){case vx:h=jY(f)?a:u,h.union(TY(e,f,r,s));break;case xx:c=f;break;case wx:l.push(WY(e,f));break;case wY:case EY:case l3:case c3:case f3:case d3:case h3:case g3:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||zi,d!==Ex&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const b=m[y];k3(e,b,qY(b,y,n.legends,a,u,r,s))}l.forEach(y=>{const b=y.bounds;if(b.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=b,e.dirty(y)),n.autosize&&n.autosize.type===p3)switch(y.orient){case Bi:case zi:o.add(b.x1,0).add(b.x2,0);break;case Yu:case ao:o.add(0,b.y1).add(0,b.y2)}else o.union(b)})}o.union(a).union(u),c&&o.union(VY(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),QY(e,t,o,n)}function QY(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===_Y){const g=e.padding();o-=g.left+g.right,a-=g.top+g.bottom}s===Ex?(l=0,f=0,u=o,c=a):s===p3?(u=Math.max(0,o-l-d),c=Math.max(0,a-f-h)):s===OY?(u=Math.max(0,o-l-d),a=c+f+h):s===SY?(o=u+l+d,c=Math.max(0,a-f-h)):s===CY&&(o=u+l+d,a=c+f+h),e._resizeView(o,a,u,c,[l,f],r.resize)}var JY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:m3,identifier:Ox,mark:b3,overlap:v3,render:O3,viewlayout:D3});function j3(e){T.call(this,null,e)}W(j3,T,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=vv(s,o,e.minstep),u=e.format||MF(n,s,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?jF(s,e.values,a):xv(s,a);return r&&(i.rem=r),r=l.map((c,f)=>Ne({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Ne({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function M3(e){T.call(this,null,e)}function ZY(){return Ne({})}function eV(e){const t=mu().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}W(M3,T,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||ZY,s=e.key||ee,o=this.value;return Z(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&L("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=eV(s)),t.visit(t.ADD,a=>{const u=s(a);let l=o.get(u);l?l.exit?(o.empty--,i.add.push(l)):i.mod.push(l):(l=r(a),o.set(u,l),i.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=s(a),l=o.get(u);l&&(l.datum=a,i.mod.push(l))}),t.visit(t.REM,a=>{const u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function T3(e){T.call(this,null,e)}W(T3,T,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(Z(s))if(n.changed()||s.every(f=>r[f]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||Ds,u=r.enter||Ds,l=r.exit||Ds,c=(s&&!o?r[s]:a)||Ds;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==Ds&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Ds&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Ds){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function N3(e){T.call(this,[],e)}W(N3,T,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||bg,o=e.scale,a=+e.limit,u=vv(o,e.count==null?5:e.count,e.minstep),l=!!e.values||s===bg,c=e.format||LF(n,o,u,s,e.formatSpecifier,e.formatType,l),f=e.values||RF(o,u),d,h,g,p,m;return r&&(i.rem=r),s===bg?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),m=!0):r=f,ye(g=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),p=r.reduce((y,b)=>Math.max(y,g(b,e)),0)):g=Yt(p=g||8),r=r.map((y,b)=>Ne({index:b,label:c(y,b,r),value:y,offset:p,size:g(y,e)})),m&&(m=f[r.length],r.push(Ne({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:m,offset:p,size:g(m,e)})))):s===DW?(d=o.domain(),h=$F(o,d[0],Ee(d)),f.length<3&&!e.values&&d[0]!==Ee(d)&&(f=[d[0],Ee(d)]),r=f.map((y,b)=>Ne({index:b,label:c(y,b,f),value:y,perc:h(y)}))):(g=f.length-1,h=UW(o),r=f.map((y,b)=>Ne({index:b,label:c(y,b,f),value:y,perc:b?h(y):0,perc2:b===g?1:h(f[b+1])}))),i.source=r,i.add=r,this.value=r,i}});const tV=e=>e.source.x,nV=e=>e.source.y,iV=e=>e.target.x,rV=e=>e.target.y;function Sx(e){T.call(this,{},e)}Sx.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};W(Sx,T,{transform(e,t){var n=e.sourceX||tV,i=e.sourceY||nV,r=e.targetX||iV,s=e.targetY||rV,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=I3.get(u+"-"+a)||I3.get(u);return l||L("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const R3=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,sV=(e,t,n,i)=>R3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),L3=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.sqrt(r*r+s*s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},oV=(e,t,n,i)=>L3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),P3=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},aV=(e,t,n,i)=>P3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),uV=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,lV=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,cV=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},fV=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},dV=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},hV=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*s+"C"+u*r+","+u*s+" "+u*o+","+u*a+" "+i*o+","+i*a},I3=mu({line:R3,"line-radial":sV,arc:L3,"arc-radial":oV,curve:P3,"curve-radial":aV,"orthogonal-horizontal":uV,"orthogonal-vertical":lV,"orthogonal-radial":cV,"diagonal-horizontal":fV,"diagonal-vertical":dV,"diagonal-radial":hV});function Cx(e){T.call(this,null,e)}Cx.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};W(Cx,T,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||pu,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,d=(a-o)/OS(l),h=Jn(c),g,p,m;for(e.sort&&h.sort((y,b)=>l[y]-l[b]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[i]=f,p[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const gV=5;function pV(e){const t=e.type;return!e.bins&&(t===Ru||t===zc||t===Uc)}function B3(e){return pv(e)&&e!==pr}const mV=Ti(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function z3(e){T.call(this,null,e),this.modified(!0)}W(z3,T,{transform(e,t){var n=t.dataflow,i=this.value,r=yV(e);(!i||r!==i.type)&&(this.value=i=De(r)());for(r in e)if(!mV[r]){if(r==="padding"&&B3(i.type))continue;ye(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return _V(i,e,EV(i,e,vV(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function yV(e){var t=e.type,n="",i;return t===pr?pr+"-"+Ru:(bV(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?pr+"-":i===3?Lu+"-":""),(n+t||Ru).toLowerCase())}function bV(e){const t=e.type;return pv(t)&&t!==aa&&t!==ua&&(e.scheme||e.range&&e.range.length&&e.range.every(Se))}function vV(e,t,n){const i=xV(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&pV(e),a,u;if(!r)return 0;if(B3(s)&&t.padding&&r[0]!==Ee(r)&&(r=wV(s,r,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[a]?a+1:u<r[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain(U3(s,r,n)),s===cv&&e.unknown(t.domainImplicit?Nb:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&vv(e,t.nice)||null),r.length}function xV(e,t,n){return t?(e.domain(U3(e.type,t,n)),t.length):-1}function wV(e,t,n,i,r,s){var o=Math.abs(Ee(n)-n[0]),a=o/(o-2*i),u=e===es?j1(t,null,a):e===Uc?bh(t,null,a,.5):e===zc?bh(t,null,a,r||1):e===hg?M1(t,null,a,s||1):D1(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function U3(e,t,n){if(_F(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+ie(t))}return t}function EV(e,t,n){let i=t.bins;if(i&&!Z(i)){const r=e.domain(),s=r[0],o=Ee(r),a=i.step;let u=i.start==null?s:i.start,l=i.stop==null?o:i.stop;a||L("Scale bins parameter missing step property."),u<s&&(u=a*Math.ceil(s/a)),l>o&&(l=a*Math.floor(o/a)),i=Jn(u,l+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===dv&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function _V(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=AV(i,t,n);else if(t.scheme&&(s=OV(i,t,n),ye(s))){if(e.interpolator)return e.interpolator(s);L("Scale type ".concat(i," does not support interpolating color schemes."))}if(s&&AF(i))return e.interpolator(yg($x(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(yv(t.interpolate,t.interpolateGamma)):ye(e.round)?e.round(r):ye(e.rangeRound)&&e.interpolate(r?Ic:Xs),s&&e.range($x(s,t.reverse))}function AV(e,t,n){e!==vF&&e!==fv&&L("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===fv?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*lv(n,r,i)]}function OV(e,t,n){var i=t.schemeExtent,r,s;return Z(t.scheme)?s=yg(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=bv(r),s||L("Unrecognized scheme name: ".concat(t.scheme))),n=e===pg?n+1:e===dv?n-1:e===Pu||e===gg?+t.schemeCount||gV:n,AF(e)?q3(s,i,t.reverse):ye(s)?CF(q3(s,i),n):e===cv?s:s.slice(0,n)}function q3(e,t,n){return ye(e)&&(t||n)?SF(e,$x(t||[0,1],n)):e}function $x(e,t){return t?e.slice().reverse():e}function W3(e){T.call(this,null,e)}W(W3,T,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Zo(e.sort)),this.modified(n),t}});const H3="zero",G3="center",Y3="normalize",V3=["y0","y1"];function kx(e){T.call(this,null,e)}kx.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:H3,values:[H3,G3,Y3]},{name:"as",type:"string",array:!0,length:2,default:V3}]};W(kx,T,{transform(e,t){var n=e.as||V3,i=n[0],r=n[1],s=Zo(e.sort),o=e.field||pu,a=e.offset===G3?SV:e.offset===Y3?CV:$V,u,l,c,f;for(u=kV(t.source,e.groupby,s,o),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,o,i,r);return t.reflow(e.modified()).modifies(n)}});function SV(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[i]=s,u[r]=s+=Math.abs(n(u))}function CV(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[i]=o,c[r]=o=s*(l+=Math.abs(n(c)))}function $V(e,t,n,i,r){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[i]=o,c[r]=o+=l):(c[i]=s,c[r]=s+=l)}function kV(e,t,n,i){var r=[],s=p=>p(c),o,a,u,l,c,f,d,h,g;if(t==null)r.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),d=o[f],d||(o[f]=d=[],r.push(d)),d.push(c);for(f=0,g=0,l=r.length;f<l;++f){for(d=r[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(i(d[a]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return r.max=g,r}var FV=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:j3,datajoin:M3,encode:T3,legendentries:N3,linkpath:Sx,pie:Cx,scale:z3,sortitems:W3,stack:kx}),se=1e-6,Jg=1e-12,ve=Math.PI,st=ve/2,Zg=ve/4,mn=ve*2,dt=180/ve,xe=ve/180,Ae=Math.abs,Ku=Math.atan,yi=Math.atan2,oe=Math.cos,ep=Math.ceil,X3=Math.exp,Fx=Math.hypot,tp=Math.log,Dx=Math.pow,te=Math.sin,bi=Math.sign||function(e){return e>0?1:e<0?-1:0},yn=Math.sqrt,jx=Math.tan;function K3(e){return e>1?0:e<-1?ve:Math.acos(e)}function Ln(e){return e>1?st:e<-1?-st:Math.asin(e)}function Bt(){}function np(e,t){e&&J3.hasOwnProperty(e.type)&&J3[e.type](e,t)}var Q3={Feature:function(e,t){np(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)np(n[i].geometry,t)}},J3={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Mx(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Mx(n[i],t,0)},Polygon:function(e,t){Z3(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Z3(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)np(n[i],t)}};function Mx(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function Z3(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Mx(e[n],t,1);t.polygonEnd()}function rs(e,t){e&&Q3.hasOwnProperty(e.type)?Q3[e.type](e,t):np(e,t)}var ip=new hn,rp=new hn,ej,tj,Tx,Nx,Rx,wr={point:Bt,lineStart:Bt,lineEnd:Bt,polygonStart:function(){ip=new hn,wr.lineStart=DV,wr.lineEnd=jV},polygonEnd:function(){var e=+ip;rp.add(e<0?mn+e:e),this.lineStart=this.lineEnd=this.point=Bt},sphere:function(){rp.add(mn)}};function DV(){wr.point=MV}function jV(){nj(ej,tj)}function MV(e,t){wr.point=nj,ej=e,tj=t,e*=xe,t*=xe,Tx=e,Nx=oe(t=t/2+Zg),Rx=te(t)}function nj(e,t){e*=xe,t*=xe,t=t/2+Zg;var n=e-Tx,i=n>=0?1:-1,r=i*n,s=oe(t),o=te(t),a=Rx*o,u=Nx*s+a*oe(r),l=a*i*te(r);ip.add(yi(l,u)),Tx=e,Nx=s,Rx=o}function TV(e){return rp=new hn,rs(e,wr),rp*2}function sp(e){return[yi(e[1],e[0]),Ln(e[2])]}function pa(e){var t=e[0],n=e[1],i=oe(n);return[i*oe(t),i*te(t),te(n)]}function op(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Qu(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Lx(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ap(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function up(e){var t=yn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var et,Pn,ot,ni,ma,ij,rj,Ju,ff,co,ss,os={point:Px,lineStart:oj,lineEnd:aj,polygonStart:function(){os.point=uj,os.lineStart=NV,os.lineEnd=RV,ff=new hn,wr.polygonStart()},polygonEnd:function(){wr.polygonEnd(),os.point=Px,os.lineStart=oj,os.lineEnd=aj,ip<0?(et=-(ot=180),Pn=-(ni=90)):ff>se?ni=90:ff<-se&&(Pn=-90),ss[0]=et,ss[1]=ot},sphere:function(){et=-(ot=180),Pn=-(ni=90)}};function Px(e,t){co.push(ss=[et=e,ot=e]),t<Pn&&(Pn=t),t>ni&&(ni=t)}function sj(e,t){var n=pa([e*xe,t*xe]);if(Ju){var i=Qu(Ju,n),r=[i[1],-i[0],0],s=Qu(r,i);up(s),s=sp(s);var o=e-ma,a=o>0?1:-1,u=s[0]*dt*a,l,c=Ae(o)>180;c^(a*ma<u&&u<a*e)?(l=s[1]*dt,l>ni&&(ni=l)):(u=(u+360)%360-180,c^(a*ma<u&&u<a*e)?(l=-s[1]*dt,l<Pn&&(Pn=l)):(t<Pn&&(Pn=t),t>ni&&(ni=t))),c?e<ma?ii(et,e)>ii(et,ot)&&(ot=e):ii(e,ot)>ii(et,ot)&&(et=e):ot>=et?(e<et&&(et=e),e>ot&&(ot=e)):e>ma?ii(et,e)>ii(et,ot)&&(ot=e):ii(e,ot)>ii(et,ot)&&(et=e)}else co.push(ss=[et=e,ot=e]);t<Pn&&(Pn=t),t>ni&&(ni=t),Ju=n,ma=e}function oj(){os.point=sj}function aj(){ss[0]=et,ss[1]=ot,os.point=Px,Ju=null}function uj(e,t){if(Ju){var n=e-ma;ff.add(Ae(n)>180?n+(n>0?360:-360):n)}else ij=e,rj=t;wr.point(e,t),sj(e,t)}function NV(){wr.lineStart()}function RV(){uj(ij,rj),wr.lineEnd(),Ae(ff)>se&&(et=-(ot=180)),ss[0]=et,ss[1]=ot,Ju=null}function ii(e,t){return(t-=e)<0?t+360:t}function LV(e,t){return e[0]-t[0]}function lj(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function PV(e){var t,n,i,r,s,o,a;if(ni=ot=-(et=Pn=1/0),co=[],rs(e,os),n=co.length){for(co.sort(LV),t=1,i=co[0],s=[i];t<n;++t)r=co[t],lj(i,r[0])||lj(i,r[1])?(ii(i[0],r[1])>ii(i[0],i[1])&&(i[1]=r[1]),ii(r[0],i[1])>ii(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=ii(i[1],r[0]))>o&&(o=a,et=r[0],ot=i[1])}return co=ss=null,et===1/0||Pn===1/0?[[NaN,NaN],[NaN,NaN]]:[[et,Pn],[ot,ni]]}var df,lp,cp,fp,dp,hp,gp,pp,Ix,Bx,zx,cj,fj,bn,vn,xn,Ui={sphere:Bt,point:Ux,lineStart:dj,lineEnd:hj,polygonStart:function(){Ui.lineStart=zV,Ui.lineEnd=UV},polygonEnd:function(){Ui.lineStart=dj,Ui.lineEnd=hj}};function Ux(e,t){e*=xe,t*=xe;var n=oe(t);hf(n*oe(e),n*te(e),te(t))}function hf(e,t,n){++df,cp+=(e-cp)/df,fp+=(t-fp)/df,dp+=(n-dp)/df}function dj(){Ui.point=IV}function IV(e,t){e*=xe,t*=xe;var n=oe(t);bn=n*oe(e),vn=n*te(e),xn=te(t),Ui.point=BV,hf(bn,vn,xn)}function BV(e,t){e*=xe,t*=xe;var n=oe(t),i=n*oe(e),r=n*te(e),s=te(t),o=yi(yn((o=vn*s-xn*r)*o+(o=xn*i-bn*s)*o+(o=bn*r-vn*i)*o),bn*i+vn*r+xn*s);lp+=o,hp+=o*(bn+(bn=i)),gp+=o*(vn+(vn=r)),pp+=o*(xn+(xn=s)),hf(bn,vn,xn)}function hj(){Ui.point=Ux}function zV(){Ui.point=qV}function UV(){gj(cj,fj),Ui.point=Ux}function qV(e,t){cj=e,fj=t,e*=xe,t*=xe,Ui.point=gj;var n=oe(t);bn=n*oe(e),vn=n*te(e),xn=te(t),hf(bn,vn,xn)}function gj(e,t){e*=xe,t*=xe;var n=oe(t),i=n*oe(e),r=n*te(e),s=te(t),o=vn*s-xn*r,a=xn*i-bn*s,u=bn*r-vn*i,l=Fx(o,a,u),c=Ln(l),f=l&&-c/l;Ix.add(f*o),Bx.add(f*a),zx.add(f*u),lp+=c,hp+=c*(bn+(bn=i)),gp+=c*(vn+(vn=r)),pp+=c*(xn+(xn=s)),hf(bn,vn,xn)}function WV(e){df=lp=cp=fp=dp=hp=gp=pp=0,Ix=new hn,Bx=new hn,zx=new hn,rs(e,Ui);var t=+Ix,n=+Bx,i=+zx,r=Fx(t,n,i);return r<Jg&&(t=hp,n=gp,i=pp,lp<se&&(t=cp,n=fp,i=dp),r=Fx(t,n,i),r<Jg)?[NaN,NaN]:[yi(n,t)*dt,Ln(i/r)*dt]}function qx(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Wx(e,t){return[Ae(e)>ve?e+Math.round(-e/mn)*mn:e,t]}Wx.invert=Wx;function pj(e,t,n){return(e%=mn)?t||n?qx(yj(e),bj(t,n)):yj(e):t||n?bj(t,n):Wx}function mj(e){return function(t,n){return t+=e,[t>ve?t-mn:t<-ve?t+mn:t,n]}}function yj(e){var t=mj(e);return t.invert=mj(-e),t}function bj(e,t){var n=oe(e),i=te(e),r=oe(t),s=te(t);function o(a,u){var l=oe(u),c=oe(a)*l,f=te(a)*l,d=te(u),h=d*n+c*i;return[yi(f*r-h*s,c*n-d*i),Ln(h*r+f*s)]}return o.invert=function(a,u){var l=oe(u),c=oe(a)*l,f=te(a)*l,d=te(u),h=d*r-f*s;return[yi(f*r+d*s,c*n+h*i),Ln(h*n-c*i)]},o}function HV(e){e=pj(e[0]*xe,e[1]*xe,e.length>2?e[2]*xe:0);function t(n){return n=e(n[0]*xe,n[1]*xe),n[0]*=dt,n[1]*=dt,n}return t.invert=function(n){return n=e.invert(n[0]*xe,n[1]*xe),n[0]*=dt,n[1]*=dt,n},t}function GV(e,t,n,i,r,s){if(!!n){var o=oe(t),a=te(t),u=i*n;r==null?(r=t+i*mn,s=t-u/2):(r=vj(o,r),s=vj(o,s),(i>0?r<s:r>s)&&(r+=i*mn));for(var l,c=r;i>0?c>s:c<s;c-=u)l=sp([o,-a*oe(c),-a*te(c)]),e.point(l[0],l[1])}}function vj(e,t){t=pa(t),t[0]-=e,up(t);var n=K3(-t[1]);return((-t[2]<0?-n:n)+mn-se)%mn}function xj(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Bt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function mp(e,t){return Ae(e[0]-t[0])<se&&Ae(e[1]-t[1])<se}function yp(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function wj(e,t,n,i,r){var s=[],o=[],a,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],b;if(mp(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),a=0;a<p;++a)r.point((m=g[a])[0],m[1]);r.lineEnd();return}y[0]+=2*se}s.push(b=new yp(m,g,null,!0)),o.push(b.o=new yp(m,null,b,!1)),s.push(b=new yp(y,g,null,!1)),o.push(b.o=new yp(y,null,b,!0))}}),!!s.length){for(o.sort(t),Ej(s),Ej(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)r.point((f=c[a])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function Ej(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function Hx(e){return Ae(e[0])<=ve?e[0]:bi(e[0])*((Ae(e[0])+ve)%mn-ve)}function YV(e,t){var n=Hx(t),i=t[1],r=te(i),s=[te(n),-oe(n),0],o=0,a=0,u=new hn;r===1?i=st+se:r===-1&&(i=-st-se);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=Hx(h),p=h[1]/2+Zg,m=te(p),y=oe(p),b=0;b<d;++b,g=w,m=A,y=E,h=x){var x=f[b],w=Hx(x),_=x[1]/2+Zg,A=te(_),E=oe(_),S=w-g,k=S>=0?1:-1,$=k*S,F=$>ve,M=m*A;if(u.add(yi(M*k*te($),y*E+M*oe($))),o+=F?S+k*mn:S,F^g>=n^w>=n){var j=Qu(pa(h),pa(x));up(j);var I=Qu(s,j);up(I);var D=(F^S>=0?-1:1)*Ln(I[2]);(i>D||i===D&&(j[0]||j[1]))&&(a+=F^S>=0?1:-1)}}return(o<-se||o<se&&u<-Jg)^a&1}function _j(e,t,n,i){return function(r){var s=t(r),o=xj(),a=t(o),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=b,d.lineEnd=x,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=AS(c);var w=YV(l,i);c.length?(u||(r.polygonStart(),u=!0),wj(c,XV,w,n,r)):w&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(w,_){e(w,_)&&r.point(w,_)}function g(w,_){s.point(w,_)}function p(){d.point=g,s.lineStart()}function m(){d.point=h,s.lineEnd()}function y(w,_){f.push([w,_]),a.point(w,_)}function b(){a.lineStart(),f=[]}function x(){y(f[0][0],f[0][1]),a.lineEnd();var w=a.clean(),_=o.result(),A,E=_.length,S,k,$;if(f.pop(),l.push(f),f=null,!!E){if(w&1){if(k=_[0],(S=k.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),A=0;A<S;++A)r.point(($=k[A])[0],$[1]);r.lineEnd()}return}E>1&&w&2&&_.push(_.pop().concat(_.shift())),c.push(_.filter(VV))}}return d}}function VV(e){return e.length>1}function XV(e,t){return((e=e.x)[0]<0?e[1]-st-se:st-e[1])-((t=t.x)[0]<0?t[1]-st-se:st-t[1])}var Aj=_j(function(){return!0},KV,JV,[-ve,-st]);function KV(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?ve:-ve,u=Ae(s-t);Ae(u-ve)<se?(e.point(t,n=(n+o)/2>0?st:-st),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&u>=ve&&(Ae(t-i)<se&&(t-=i*se),Ae(s-a)<se&&(s-=a*se),n=QV(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function QV(e,t,n,i){var r,s,o=te(e-n);return Ae(o)>se?Ku((te(t)*(s=oe(i))*te(n)-te(i)*(r=oe(t))*te(e))/(r*s*o)):(t+i)/2}function JV(e,t,n,i){var r;if(e==null)r=n*st,i.point(-ve,r),i.point(0,r),i.point(ve,r),i.point(ve,0),i.point(ve,-r),i.point(0,-r),i.point(-ve,-r),i.point(-ve,0),i.point(-ve,r);else if(Ae(e[0]-t[0])>se){var s=e[0]<t[0]?ve:-ve;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function ZV(e){var t=oe(e),n=6*xe,i=t>0,r=Ae(t)>se;function s(c,f,d,h){GV(h,e,n,d,c,f)}function o(c,f){return oe(c)*oe(f)>t}function a(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var b=[m,y],x,w=o(m,y),_=i?w?0:l(m,y):w?l(m+(m<0?ve:-ve),y):0;if(!f&&(g=h=w)&&c.lineStart(),w!==h&&(x=u(f,b),(!x||mp(f,x)||mp(b,x))&&(b[2]=1)),w!==h)p=0,w?(c.lineStart(),x=u(b,f),c.point(x[0],x[1])):(x=u(f,b),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(r&&f&&i^w){var A;!(_&d)&&(A=u(b,f,!0))&&(p=0,i?(c.lineStart(),c.point(A[0][0],A[0][1]),c.point(A[1][0],A[1][1]),c.lineEnd()):(c.point(A[1][0],A[1][1]),c.lineEnd(),c.lineStart(),c.point(A[0][0],A[0][1],3)))}w&&(!f||!mp(f,b))&&c.point(b[0],b[1]),f=b,h=w,d=_},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=pa(c),g=pa(f),p=[1,0,0],m=Qu(h,g),y=op(m,m),b=m[0],x=y-b*b;if(!x)return!d&&c;var w=t*y/x,_=-t*b/x,A=Qu(p,m),E=ap(p,w),S=ap(m,_);Lx(E,S);var k=A,$=op(E,k),F=op(k,k),M=$*$-F*(op(E,E)-1);if(!(M<0)){var j=yn(M),I=ap(k,(-$-j)/F);if(Lx(I,E),I=sp(I),!d)return I;var D=c[0],P=f[0],B=c[1],H=f[1],X;P<D&&(X=D,D=P,P=X);var ce=P-D,Te=Ae(ce-ve)<se,$e=Te||ce<se;if(!Te&&H<B&&(X=B,B=H,H=X),$e?Te?B+H>0^I[1]<(Ae(I[0]-D)<se?B:H):B<=I[1]&&I[1]<=H:ce>ve^(D<=I[0]&&I[0]<=P)){var nt=ap(k,(-$+j)/F);return Lx(nt,E),[I,sp(nt)]}}}function l(c,f){var d=i?e:ve-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return _j(o,a,s,i?[0,-e]:[-ve,e-ve])}function eX(e,t,n,i,r,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-a,g;if(g=n-o,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=r-o,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=i-a,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=s-a,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}var gf=1e9,bp=-gf;function Oj(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function s(l,c,f,d){var h=0,g=0;if(l==null||(h=o(l,f))!==(g=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function o(l,c){return Ae(l[0]-e)<se?c>0?0:3:Ae(l[0]-n)<se?c>0?2:1:Ae(l[1]-t)<se?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=xj(),d,h,g,p,m,y,b,x,w,_,A,E={point:S,lineStart:M,lineEnd:j,polygonStart:$,polygonEnd:F};function S(D,P){r(D,P)&&c.point(D,P)}function k(){for(var D=0,P=0,B=h.length;P<B;++P)for(var H=h[P],X=1,ce=H.length,Te=H[0],$e,nt,qe=Te[0],lt=Te[1];X<ce;++X)$e=qe,nt=lt,Te=H[X],qe=Te[0],lt=Te[1],nt<=i?lt>i&&(qe-$e)*(i-nt)>(lt-nt)*(e-$e)&&++D:lt<=i&&(qe-$e)*(i-nt)<(lt-nt)*(e-$e)&&--D;return D}function $(){c=f,d=[],h=[],A=!0}function F(){var D=k(),P=A&&D,B=(d=AS(d)).length;(P||B)&&(l.polygonStart(),P&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),B&&wj(d,a,D,s,l),l.polygonEnd()),c=l,d=h=g=null}function M(){E.point=I,h&&h.push(g=[]),_=!0,w=!1,b=x=NaN}function j(){d&&(I(p,m),y&&w&&f.rejoin(),d.push(f.result())),E.point=S,w&&c.lineEnd()}function I(D,P){var B=r(D,P);if(h&&g.push([D,P]),_)p=D,m=P,y=B,_=!1,B&&(c.lineStart(),c.point(D,P));else if(B&&w)c.point(D,P);else{var H=[b=Math.max(bp,Math.min(gf,b)),x=Math.max(bp,Math.min(gf,x))],X=[D=Math.max(bp,Math.min(gf,D)),P=Math.max(bp,Math.min(gf,P))];eX(H,X,e,t,n,i)?(w||(c.lineStart(),c.point(H[0],H[1])),c.point(X[0],X[1]),B||c.lineEnd(),A=!1):B&&(c.lineStart(),c.point(D,P),A=!1)}b=D,x=P,w=B}return E}}function Sj(e,t,n){var i=Jn(e,t-se,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function Cj(e,t,n){var i=Jn(e,t-se,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function tX(){var e,t,n,i,r,s,o,a,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return Jn(ep(i/c)*c,n,c).map(g).concat(Jn(ep(a/f)*f,o,f).map(p)).concat(Jn(ep(t/u)*u,e,u).filter(function(x){return Ae(x%c)>se}).map(d)).concat(Jn(ep(s/l)*l,r,l).filter(function(x){return Ae(x%f)>se}).map(h))}return y.lines=function(){return b().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(p(o).slice(1),g(n).reverse().slice(1),p(a).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(i=+x[0][0],n=+x[1][0],a=+x[0][1],o=+x[1][1],i>n&&(x=i,i=n,n=x),a>o&&(x=a,a=o,o=x),y.precision(m)):[[i,a],[n,o]]},y.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],s=+x[0][1],r=+x[1][1],t>e&&(x=t,t=e,e=x),s>r&&(x=s,s=r,r=x),y.precision(m)):[[t,s],[e,r]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],y):[c,f]},y.stepMinor=function(x){return arguments.length?(u=+x[0],l=+x[1],y):[u,l]},y.precision=function(x){return arguments.length?(m=+x,d=Sj(s,r,90),h=Cj(t,e,m),g=Sj(a,o,90),p=Cj(i,n,m),y):m},y.extentMajor([[-180,-90+se],[180,90-se]]).extentMinor([[-180,-80-se],[180,80+se]])}var pf=e=>e,Gx=new hn,Yx=new hn,$j,kj,Vx,Xx,fo={point:Bt,lineStart:Bt,lineEnd:Bt,polygonStart:function(){fo.lineStart=nX,fo.lineEnd=rX},polygonEnd:function(){fo.lineStart=fo.lineEnd=fo.point=Bt,Gx.add(Ae(Yx)),Yx=new hn},result:function(){var e=Gx/2;return Gx=new hn,e}};function nX(){fo.point=iX}function iX(e,t){fo.point=Fj,$j=Vx=e,kj=Xx=t}function Fj(e,t){Yx.add(Xx*e-Vx*t),Vx=e,Xx=t}function rX(){Fj($j,kj)}var Dj=fo,Zu=1/0,vp=Zu,mf=-Zu,xp=mf,sX={point:oX,lineStart:Bt,lineEnd:Bt,polygonStart:Bt,polygonEnd:Bt,result:function(){var e=[[Zu,vp],[mf,xp]];return mf=xp=-(vp=Zu=1/0),e}};function oX(e,t){e<Zu&&(Zu=e),e>mf&&(mf=e),t<vp&&(vp=t),t>xp&&(xp=t)}var wp=sX,Kx=0,Qx=0,yf=0,Ep=0,_p=0,el=0,Jx=0,Zx=0,bf=0,jj,Mj,Er,_r,qi={point:ya,lineStart:Tj,lineEnd:Nj,polygonStart:function(){qi.lineStart=lX,qi.lineEnd=cX},polygonEnd:function(){qi.point=ya,qi.lineStart=Tj,qi.lineEnd=Nj},result:function(){var e=bf?[Jx/bf,Zx/bf]:el?[Ep/el,_p/el]:yf?[Kx/yf,Qx/yf]:[NaN,NaN];return Kx=Qx=yf=Ep=_p=el=Jx=Zx=bf=0,e}};function ya(e,t){Kx+=e,Qx+=t,++yf}function Tj(){qi.point=aX}function aX(e,t){qi.point=uX,ya(Er=e,_r=t)}function uX(e,t){var n=e-Er,i=t-_r,r=yn(n*n+i*i);Ep+=r*(Er+e)/2,_p+=r*(_r+t)/2,el+=r,ya(Er=e,_r=t)}function Nj(){qi.point=ya}function lX(){qi.point=fX}function cX(){Rj(jj,Mj)}function fX(e,t){qi.point=Rj,ya(jj=Er=e,Mj=_r=t)}function Rj(e,t){var n=e-Er,i=t-_r,r=yn(n*n+i*i);Ep+=r*(Er+e)/2,_p+=r*(_r+t)/2,el+=r,r=_r*e-Er*t,Jx+=r*(Er+e),Zx+=r*(_r+t),bf+=r*3,ya(Er=e,_r=t)}var Lj=qi;function Pj(e){this._context=e}Pj.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,mn);break}}},result:Bt};var e2=new hn,t2,Ij,Bj,vf,xf,Ap={point:Bt,lineStart:function(){Ap.point=dX},lineEnd:function(){t2&&zj(Ij,Bj),Ap.point=Bt},polygonStart:function(){t2=!0},polygonEnd:function(){t2=null},result:function(){var e=+e2;return e2=new hn,e}};function dX(e,t){Ap.point=zj,Ij=vf=e,Bj=xf=t}function zj(e,t){vf-=e,xf-=t,e2.add(yn(vf*vf+xf*xf)),vf=e,xf=t}var Uj=Ap;function qj(){this._string=[]}qj.prototype={_radius:4.5,_circle:Wj(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=Wj(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function Wj(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Hj(e,t){var n=4.5,i,r;function s(o){return o&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),rs(o,i(r))),r.result()}return s.area=function(o){return rs(o,i(Dj)),Dj.result()},s.measure=function(o){return rs(o,i(Uj)),Uj.result()},s.bounds=function(o){return rs(o,i(wp)),wp.result()},s.centroid=function(o){return rs(o,i(Lj)),Lj.result()},s.projection=function(o){return arguments.length?(i=o==null?(e=null,pf):(e=o).stream,s):e},s.context=function(o){return arguments.length?(r=o==null?(t=null,new qj):new Pj(t=o),typeof n!="function"&&r.pointRadius(n),s):t},s.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(r.pointRadius(+o),+o),s):n},s.projection(e).context(t)}function Op(e){return function(t){var n=new n2;for(var i in e)n[i]=e[i];return n.stream=t,n}}function n2(){}n2.prototype={constructor:n2,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function i2(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),rs(n,e.stream(wp)),t(wp.result()),i!=null&&e.clipExtent(i),e}function Sp(e,t,n){return i2(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function r2(e,t,n){return Sp(e,[[0,0],t],n)}function s2(e,t,n){return i2(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function o2(e,t,n){return i2(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var Gj=16,hX=oe(30*xe);function Yj(e,t){return+t?pX(e,t):gX(e)}function gX(e){return Op({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function pX(e,t){function n(i,r,s,o,a,u,l,c,f,d,h,g,p,m){var y=l-i,b=c-r,x=y*y+b*b;if(x>4*t&&p--){var w=o+d,_=a+h,A=u+g,E=yn(w*w+_*_+A*A),S=Ln(A/=E),k=Ae(Ae(A)-1)<se||Ae(s-f)<se?(s+f)/2:yi(_,w),$=e(k,S),F=$[0],M=$[1],j=F-i,I=M-r,D=b*j-y*I;(D*D/x>t||Ae((y*j+b*I)/x-.5)>.3||o*d+a*h+u*g<hX)&&(n(i,r,s,o,a,u,F,M,k,w/=E,_/=E,A,p,m),m.point(F,M),n(F,M,k,w,_,A,l,c,f,d,h,g,p,m))}}return function(i){var r,s,o,a,u,l,c,f,d,h,g,p,m={point:y,lineStart:b,lineEnd:w,polygonStart:function(){i.polygonStart(),m.lineStart=_},polygonEnd:function(){i.polygonEnd(),m.lineStart=b}};function y(S,k){S=e(S,k),i.point(S[0],S[1])}function b(){f=NaN,m.point=x,i.lineStart()}function x(S,k){var $=pa([S,k]),F=e(S,k);n(f,d,c,h,g,p,f=F[0],d=F[1],c=S,h=$[0],g=$[1],p=$[2],Gj,i),i.point(f,d)}function w(){m.point=y,i.lineEnd()}function _(){b(),m.point=A,m.lineEnd=E}function A(S,k){x(r=S,k),s=f,o=d,a=h,u=g,l=p,m.point=x}function E(){n(f,d,c,h,g,p,s,o,r,a,u,l,Gj,i),m.lineEnd=w,w()}return m}}var mX=Op({point:function(e,t){this.stream.point(e*xe,t*xe)}});function yX(e){return Op({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function bX(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function Vj(e,t,n,i,r,s){if(!s)return bX(e,t,n,i,r);var o=oe(s),a=te(s),u=o*e,l=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function g(p,m){return p*=i,m*=r,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[i*(c*p-f*m+d),r*(h-f*p-c*m)]},g}function Ar(e){return Xj(function(){return e})()}function Xj(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=Aj,m=null,y,b,x,w=pf,_=.5,A,E,S,k,$;function F(D){return S(D[0]*xe,D[1]*xe)}function M(D){return D=S.invert(D[0],D[1]),D&&[D[0]*dt,D[1]*dt]}F.stream=function(D){return k&&$===D?k:k=mX(yX(c)(p(A(w($=D)))))},F.preclip=function(D){return arguments.length?(p=D,g=void 0,I()):p},F.postclip=function(D){return arguments.length?(w=D,m=y=b=x=null,I()):w},F.clipAngle=function(D){return arguments.length?(p=+D?ZV(g=D*xe):(g=null,Aj),I()):g*dt},F.clipExtent=function(D){return arguments.length?(w=D==null?(m=y=b=x=null,pf):Oj(m=+D[0][0],y=+D[0][1],b=+D[1][0],x=+D[1][1]),I()):m==null?null:[[m,y],[b,x]]},F.scale=function(D){return arguments.length?(n=+D,j()):n},F.translate=function(D){return arguments.length?(i=+D[0],r=+D[1],j()):[i,r]},F.center=function(D){return arguments.length?(s=D[0]%360*xe,o=D[1]%360*xe,j()):[s*dt,o*dt]},F.rotate=function(D){return arguments.length?(a=D[0]%360*xe,u=D[1]%360*xe,l=D.length>2?D[2]%360*xe:0,j()):[a*dt,u*dt,l*dt]},F.angle=function(D){return arguments.length?(f=D%360*xe,j()):f*dt},F.reflectX=function(D){return arguments.length?(d=D?-1:1,j()):d<0},F.reflectY=function(D){return arguments.length?(h=D?-1:1,j()):h<0},F.precision=function(D){return arguments.length?(A=Yj(E,_=D*D),I()):yn(_)},F.fitExtent=function(D,P){return Sp(F,D,P)},F.fitSize=function(D,P){return r2(F,D,P)},F.fitWidth=function(D,P){return s2(F,D,P)},F.fitHeight=function(D,P){return o2(F,D,P)};function j(){var D=Vj(n,0,0,d,h,f).apply(null,t(s,o)),P=Vj(n,i-D[0],r-D[1],d,h,f);return c=pj(a,u,l),E=qx(t,P),S=qx(c,E),A=Yj(E,_),I()}function I(){return k=$=null,F}return function(){return t=e.apply(this,arguments),F.invert=t.invert&&M,j()}}function a2(e){var t=0,n=ve/3,i=Xj(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*xe,n=s[1]*xe):[t*dt,n*dt]},r}function vX(e){var t=oe(e);function n(i,r){return[i*t,te(r)/t]}return n.invert=function(i,r){return[i/t,Ln(r*t)]},n}function xX(e,t){var n=te(e),i=(n+te(t))/2;if(Ae(i)<se)return vX(e);var r=1+n*(2*i-n),s=yn(r)/i;function o(a,u){var l=yn(r-2*i*te(u))/i;return[l*te(a*=i),s-l*oe(a)]}return o.invert=function(a,u){var l=s-u,c=yi(a,Ae(l))*bi(l);return l*i<0&&(c-=ve*bi(a)*bi(l)),[c/i,Ln((r-(a*a+l*l)*i*i)/(2*i))]},o}function Cp(){return a2(xX).scale(155.424).center([0,33.6442])}function Kj(){return Cp().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function wX(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function EX(){var e,t,n=Kj(),i,r=Cp().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=Cp().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,i.point(h,g),u||(s.point(h,g),u)||(a.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?r:m>=.166&&m<.234&&p>=-.214&&p<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=wX([n.stream(t=d),r.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return i=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),s=r.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+se,p+.12*h+se],[g-.214*h-se,p+.234*h-se]]).stream(l),a=o.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+se,p+.166*h+se],[g-.115*h-se,p+.234*h-se]]).stream(l),f()},c.fitExtent=function(d,h){return Sp(c,d,h)},c.fitSize=function(d,h){return r2(c,d,h)},c.fitWidth=function(d,h){return s2(c,d,h)},c.fitHeight=function(d,h){return o2(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Qj(e){return function(t,n){var i=oe(t),r=oe(n),s=e(i*r);return s===1/0?[2,0]:[s*r*te(t),s*te(n)]}}function wf(e){return function(t,n){var i=yn(t*t+n*n),r=e(i),s=te(r),o=oe(r);return[yi(t*s,i*o),Ln(i&&n*s/i)]}}var Jj=Qj(function(e){return yn(2/(1+e))});Jj.invert=wf(function(e){return 2*Ln(e/2)});function _X(){return Ar(Jj).scale(124.75).clipAngle(180-.001)}var Zj=Qj(function(e){return(e=K3(e))&&e/te(e)});Zj.invert=wf(function(e){return e});function AX(){return Ar(Zj).scale(79.4188).clipAngle(180-.001)}function $p(e,t){return[e,tp(jx((st+t)/2))]}$p.invert=function(e,t){return[e,2*Ku(X3(t))-st]};function OX(){return eM($p).scale(961/mn)}function eM(e){var t=Ar(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=ve*i(),d=t(HV(t.rotate()).invert([0,0]));return s(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===$p?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function kp(e){return jx((st+e)/2)}function SX(e,t){var n=oe(e),i=e===t?te(e):tp(n/oe(t))/tp(kp(t)/kp(e)),r=n*Dx(kp(e),i)/i;if(!i)return $p;function s(o,a){r>0?a<-st+se&&(a=-st+se):a>st-se&&(a=st-se);var u=r/Dx(kp(a),i);return[u*te(i*o),r-u*oe(i*o)]}return s.invert=function(o,a){var u=r-a,l=bi(i)*yn(o*o+u*u),c=yi(o,Ae(u))*bi(u);return u*i<0&&(c-=ve*bi(o)*bi(u)),[c/i,2*Ku(Dx(r/l,1/i))-st]},s}function CX(){return a2(SX).scale(109.5).parallels([30,30])}function Fp(e,t){return[e,t]}Fp.invert=Fp;function $X(){return Ar(Fp).scale(152.63)}function kX(e,t){var n=oe(e),i=e===t?te(e):(n-oe(t))/(t-e),r=n/i+e;if(Ae(i)<se)return Fp;function s(o,a){var u=r-a,l=i*o;return[u*te(l),r-u*oe(l)]}return s.invert=function(o,a){var u=r-a,l=yi(o,Ae(u))*bi(u);return u*i<0&&(l-=ve*bi(o)*bi(u)),[l/i,r-bi(i)*yn(o*o+u*u)]},s}function FX(){return a2(kX).scale(131.154).center([0,13.9389])}var Ef=1.340264,_f=-.081106,Af=893e-6,Of=.003796,Dp=yn(3)/2,DX=12;function tM(e,t){var n=Ln(Dp*te(t)),i=n*n,r=i*i*i;return[e*oe(n)/(Dp*(Ef+3*_f*i+r*(7*Af+9*Of*i))),n*(Ef+_f*i+r*(Af+Of*i))]}tM.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,u;s<DX&&(a=n*(Ef+_f*i+r*(Af+Of*i))-t,u=Ef+3*_f*i+r*(7*Af+9*Of*i),n-=o=a/u,i=n*n,r=i*i*i,!(Ae(o)<Jg));++s);return[Dp*e*(Ef+3*_f*i+r*(7*Af+9*Of*i))/oe(n),Ln(te(n)/Dp)]};function jX(){return Ar(tM).scale(177.158)}function nM(e,t){var n=oe(t),i=oe(e)*n;return[n*te(e)/i,te(t)/i]}nM.invert=wf(Ku);function MX(){return Ar(nM).scale(144.049).clipAngle(60)}function TX(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,u=null,l,c,f,d=1,h=1,g=Op({point:function(w,_){var A=x([w,_]);this.stream.point(A[0],A[1])}}),p=pf,m,y;function b(){return d=e*i,h=e*r,m=y=null,x}function x(w){var _=w[0]*d,A=w[1]*h;if(s){var E=A*o-_*a;_=_*o+A*a,A=E}return[_+t,A+n]}return x.invert=function(w){var _=w[0]-t,A=w[1]-n;if(s){var E=A*o+_*a;_=_*o-A*a,A=E}return[_/d,A/h]},x.stream=function(w){return m&&y===w?m:m=g(p(y=w))},x.postclip=function(w){return arguments.length?(p=w,u=l=c=f=null,b()):p},x.clipExtent=function(w){return arguments.length?(p=w==null?(u=l=c=f=null,pf):Oj(u=+w[0][0],l=+w[0][1],c=+w[1][0],f=+w[1][1]),b()):u==null?null:[[u,l],[c,f]]},x.scale=function(w){return arguments.length?(e=+w,b()):e},x.translate=function(w){return arguments.length?(t=+w[0],n=+w[1],b()):[t,n]},x.angle=function(w){return arguments.length?(s=w%360*xe,a=te(s),o=oe(s),b()):s*dt},x.reflectX=function(w){return arguments.length?(i=w?-1:1,b()):i<0},x.reflectY=function(w){return arguments.length?(r=w?-1:1,b()):r<0},x.fitExtent=function(w,_){return Sp(x,w,_)},x.fitSize=function(w,_){return r2(x,w,_)},x.fitWidth=function(w,_){return s2(x,w,_)},x.fitHeight=function(w,_){return o2(x,w,_)},x}function iM(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}iM.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Ae(r)>se&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function NX(){return Ar(iM).scale(175.295)}function rM(e,t){return[oe(t)*te(e),te(t)]}rM.invert=wf(Ln);function RX(){return Ar(rM).scale(249.5).clipAngle(90+se)}function sM(e,t){var n=oe(t),i=1+oe(e)*n;return[n*te(e)/i,te(t)/i]}sM.invert=wf(function(e){return 2*Ku(e)});function LX(){return Ar(sM).scale(250).clipAngle(142)}function oM(e,t){return[tp(jx((st+t)/2)),-e]}oM.invert=function(e,t){return[-t,2*Ku(X3(e))-st]};function PX(){var e=eM(oM),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var IX=Math.abs,u2=Math.cos,jp=Math.sin,BX=1e-6,aM=Math.PI,l2=aM/2,uM=zX(2);function lM(e){return e>1?l2:e<-1?-l2:Math.asin(e)}function zX(e){return e>0?Math.sqrt(e):0}function UX(e,t){var n=e*jp(t),i=30,r;do t-=r=(t+jp(t)-n)/(1+u2(t));while(IX(r)>BX&&--i>0);return t/2}function qX(e,t,n){function i(r,s){return[e*r*u2(s=UX(n,s)),t*jp(s)]}return i.invert=function(r,s){return s=lM(s/t),[r/(e*u2(s)),lM((2*s+jp(2*s))/n)]},i}var WX=qX(uM/l2,uM,aM);function HX(){return Ar(WX).scale(169.529)}const GX=Hj(),c2=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function YX(e,t){return function n(){const i=t();return i.type=e,i.path=Hj().projection(i),i.copy=i.copy||function(){const r=n();return c2.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function f2(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Mp[e]=YX(e,t),this):Mp[e]||null}function cM(e){return e&&e.path||GX}const Mp={albers:Kj,albersusa:EX,azimuthalequalarea:_X,azimuthalequidistant:AX,conicconformal:CX,conicequalarea:Cp,conicequidistant:FX,equalEarth:jX,equirectangular:$X,gnomonic:MX,identity:TX,mercator:OX,mollweide:HX,naturalEarth1:NX,orthographic:RX,stereographic:LX,transversemercator:PX};for(const e in Mp)f2(e,Mp[e]);function VX(){}const as=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function fM(){var e=1,t=1,n=a;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return s(u,l,d=>{n(d,u,l),XX(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(KX((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,b;for(h=g=-1,m=u[0]>=l,as[m<<1].forEach(x);++h<e-1;)p=m,m=u[h+1]>=l,as[p|m<<1].forEach(x);for(as[m<<0].forEach(x);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,as[m<<1|y<<2].forEach(x);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,b=y,y=u[g*e+h+1]>=l,as[p|m<<1|y<<2|b<<3].forEach(x);as[m|y<<3].forEach(x)}for(h=-1,y=u[g*e]>=l,as[y<<2].forEach(x);++h<e-1;)b=y,y=u[g*e+h+1]>=l,as[y<<2|b<<3].forEach(x);as[y<<3].forEach(x);function x(w){var _=[w[0][0]+h,w[0][1]+g],A=[w[1][0]+h,w[1][1]+g],E=o(_),S=o(A),k,$;(k=d[E])?($=f[S])?(delete d[k.end],delete f[$.start],k===$?(k.ring.push(A),c(k.ring)):f[k.start]=d[$.end]={start:k.start,end:$.end,ring:k.ring.concat($.ring)}):(delete d[k.end],k.ring.push(A),d[k.end=S]=k):(k=f[S])?($=d[E])?(delete f[k.start],delete d[$.end],k===$?(k.ring.push(A),c(k.ring)):f[$.start]=d[k.end]={start:$.start,end:k.end,ring:$.ring.concat(k.ring)}):(delete f[k.start],k.ring.unshift(_),f[k.start=E]=k):f[E]=d[S]={start:E,end:S,ring:[_,A]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||L("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?a:VX,i):n===a},i}function XX(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function KX(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=QX(e,t[n]))return r;return 0}function QX(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(JX(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function JX(e,t,n){var i;return ZX(e,t,n)&&eK(e[i=+(e[0]===t[0])],n[i],t[i])}function ZX(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function eK(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function dM(e,t,n){return function(i){var r=ar(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,u=t?Ns(s,o,e):a/(e+1);return Jn(s+u,o,u)}}function d2(e){T.call(this,null,e)}d2.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};W(d2,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||dn,s=fM().smooth(e.smooth!==!1),o=e.thresholds||tK(i,r,e),a=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=s.size([c.width,c.height])(c.values,Z(o)?o:o(c.values));nK(f,c,l,e),f.forEach(d=>{u.push(Nh(l,Ne(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function tK(e,t,n){const i=dM(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Vo(t(r).values)))}function nK(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(ye(r)&&(r=r(n,i)),ye(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(Ms(r)?r:r[0])||1,a=(Ms(r)?r:r[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(hM(t,o,a,u,l))}function hM(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-o)*n+r}return function(f){return f.coordinates.forEach(u),f}}function gM(e,t,n){const i=e>=0?e:Ly(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function h2(e){return ye(e)?e:Yt(+e)}function pM(){var e=u=>u[0],t=u=>u[1],n=pu,i=[-1,-1],r=960,s=500,o=2;function a(u,l){const c=gM(i[0],u,e)>>o,f=gM(i[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,g=2*d+(r>>o),p=2*h+(s>>o),m=new Float32Array(g*p),y=new Float32Array(g*p);let b=m;u.forEach(w=>{const _=d+(+e(w)>>o),A=h+(+t(w)>>o);_>=0&&_<g&&A>=0&&A<p&&(m[_+A*g]+=+n(w))}),c>0&&f>0?(tl(g,p,m,y,c),nl(g,p,y,m,f),tl(g,p,m,y,c),nl(g,p,y,m,f),tl(g,p,m,y,c),nl(g,p,y,m,f)):c>0?(tl(g,p,m,y,c),tl(g,p,y,m,c),tl(g,p,m,y,c),b=y):f>0&&(nl(g,p,m,y,f),nl(g,p,y,m,f),nl(g,p,m,y,f),b=y);const x=l?Math.pow(2,-2*o):1/OS(b);for(let w=0,_=g*p;w<_;++w)b[w]*=x;return{values:b,scale:1<<o,width:g,height:p,x1:d,y1:h,x2:d+(r>>o),y2:h+(s>>o)}}return a.x=function(u){return arguments.length?(e=h2(u),a):e},a.y=function(u){return arguments.length?(t=h2(u),a):t},a.weight=function(u){return arguments.length?(n=h2(u),a):n},a.size=function(u){if(!arguments.length)return[r,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||L("invalid size"),r=l,s=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||L("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),a):1<<o},a.bandwidth=function(u){return arguments.length?(u=ae(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&L("invalid bandwidth"),i=u,a):i},a}function tl(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,u=0;a<e+r;++a)a<e&&(u+=n[a+o*e]),a>=r&&(a>=s&&(u-=n[a-s+o*e]),i[a-r+o*e]=u/Math.min(a+1,e-1+s-a,s))}function nl(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,u=0;a<t+r;++a)a<t&&(u+=n[o+a*e]),a>=r&&(a>=s&&(u-=n[o+(a-s)*e]),i[o+(a-r)*e]=u/Math.min(a+1,t-1+s-a,s))}function g2(e){T.call(this,null,e)}g2.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const iK=["x","y","weight","size","cellSize","bandwidth"];function mM(e,t){return iK.forEach(n=>t[n]!=null?e[n](t[n]):0),e}W(g2,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=rK(i,e.groupby),s=(e.groupby||[]).map(rt),o=mM(pM(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return u=r.map(c=>Ne(l({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function rK(e,t){var n=[],i=c=>c(a),r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function p2(e){T.call(this,null,e)}p2.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};W(p2,T,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=fM().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||dM(e.count||10,e.nice,!!r),o=e.size,a,u;return r||(r=t.materialize(t.SOURCE).source,a=mM(pM(),e)(r,!0),u=hM(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=Z(s)?s:s(r),r=i.size(o)(r,s),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ne),n}});const m2="Feature",y2="FeatureCollection",sK="MultiPoint";function b2(e){T.call(this,null,e)}b2.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};W(b2,T,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&dn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Ht(a))||s&&t.modified(Ht(s))||o&&t.modified(Ht(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(u,c=>n.push(a(c))),s&&o&&(t.visit(u,c=>{var f=s(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:m2,geometry:{type:sK,coordinates:i}})),this.value={type:y2,features:n}}});function v2(e){T.call(this,null,e)}v2.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};W(v2,T,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||dn,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=cM(e.projection),n.materialize().reflow()):o=r===dn||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=oK(i,e.pointRadius);return n.visit(o,u=>u[s]=i(r(u))),i.pointRadius(a),n.modifies(s)}});function oK(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function x2(e){T.call(this,null,e)}x2.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};W(x2,T,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function w2(e){T.call(this,null,e)}w2.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};W(w2,T,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=aK(cM(e.projection),e.field||Dn("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function aK(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function E2(e){T.call(this,[],e),this.generator=tX()}E2.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};W(E2,T,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)ye(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(UC(n[0],r)):t.add.push(Ne(r)),n[0]=r,t}});function _2(e){T.call(this,null,e)}_2.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};W(_2,T,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||dn,s=lK(e.opacity,e),o=uK(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?Vo(n.map(l=>Vo(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=pe({},l,u);i||(f.$max=Vo(c.values||[])),l[a]=cK(c,f,o.dep?o:Yt(o(f)),s.dep?s:Yt(s(f)))}),t.reflow(!0).modifies(a)}});function uK(e,t){let n;return ye(e)?(n=i=>Vs(e(i,t)),n.dep=yM(e)):n=Yt(Vs(e||"#888")),n}function lK(e,t){let n;return ye(e)?(n=i=>e(i,t),n.dep=yM(e)):e?n=Yt(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function yM(e){if(!ye(e))return!1;const t=Ti(Ht(e));return t.$x||t.$y||t.$value||t.$max}function cK(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,u=e.x2||r,l=e.y2||s,c=e.values,f=c?m=>c[m]:Fs,d=Du(u-o,l-a),h=d.getContext("2d"),g=h.getImageData(0,0,u-o,l-a),p=g.data;for(let m=a,y=0;m<l;++m){t.$y=m-a;for(let b=o,x=m*r;b<u;++b,y+=4){t.$x=b-o,t.$value=f(b+x);const w=n(t);p[y+0]=w.r,p[y+1]=w.g,p[y+2]=w.b,p[y+3]=~~(255*i(t))}}return h.putImageData(g,0,0),d}function bM(e){T.call(this,null,e),this.modified(!0)}W(bM,T,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=dK(e.type),c2.forEach(i=>{e[i]!=null&&vM(n,i,e[i])})):c2.forEach(i=>{e.modified(i)&&vM(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&fK(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function fK(e,t){const n=hK(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function dK(e){const t=f2((e||"mercator").toLowerCase());return t||L("Unrecognized projection type: "+e),t()}function vM(e,t,n){ye(e[t])&&e[t](n)}function hK(e){return e=ae(e),e.length===1?e[0]:{type:y2,features:e.reduce((t,n)=>t.concat(gK(n)),[])}}function gK(e){return e.type===y2?e.features:ae(e).filter(t=>t!=null).map(t=>t.type===m2?t:{type:m2,geometry:t})}var pK=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:p2,geojson:b2,geopath:v2,geopoint:x2,geoshape:w2,graticule:E2,heatmap:_2,isocontour:d2,kde2d:g2,projection:bM});function mK(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,u=0,l=0;for(s=0;s<o;++s)a=n[s],u+=a.x,l+=a.y;for(u=(u/o-e)*i,l=(l/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=u,a.y-=l}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function yK(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return xM(this.cover(t,n),t,n,e)}function xM(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,b;if(!s)return e._root=o,e;for(;s.length;)if((p=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=s,!(s=s[y=m<<1|p]))return r[y]=o,e;if(h=+e._x.call(null,s.data),g=+e._y.call(null,s.data),t===h&&n===g)return o.next=s,r?r[y]=o:e._root=o,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)==(b=(g>=d)<<1|h>=f));return r[b]=s,r[y]=o,e}function bK(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<u&&(u=r),r>c&&(c=r),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)xM(this,o[n],a[n],e[n]);return this}function vK(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,u,l;n>e||e>=r||i>t||t>=s;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function xK(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function wK(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function wn(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function EK(e,t,n){var i,r=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new wn(h,r,s,c,f)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(o=g.x0)>c||(a=g.y0)>f||(u=g.x1)<r||(l=g.y1)<s))if(h.length){var m=(o+u)/2,y=(a+l)/2;d.push(new wn(h[3],m,y,u,l),new wn(h[2],o,y,m,l),new wn(h[1],m,a,u,y),new wn(h[0],o,a,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var b=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),w=b*b+x*x;if(w<n){var _=Math.sqrt(n=w);r=e-_,s=t-_,c=e+_,f=t+_,i=h.data}}return i}function _K(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(o+u)/2))?o=d:u=d,(p=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=s,this)}function AK(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function OK(){return this._root}function SK(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function CK(e){var t=[],n,i=this._root,r,s,o,a,u;for(i&&t.push(new wn(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&i.length){var l=(s+a)/2,c=(o+u)/2;(r=i[3])&&t.push(new wn(r,l,c,a,u)),(r=i[2])&&t.push(new wn(r,s,c,l,u)),(r=i[1])&&t.push(new wn(r,l,o,a,c)),(r=i[0])&&t.push(new wn(r,s,o,l,c))}return this}function $K(e){var t=[],n=[],i;for(this._root&&t.push(new wn(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,u=i.x1,l=i.y1,c=(o+u)/2,f=(a+l)/2;(s=r[0])&&t.push(new wn(s,o,a,c,f)),(s=r[1])&&t.push(new wn(s,c,a,u,f)),(s=r[2])&&t.push(new wn(s,o,f,c,l)),(s=r[3])&&t.push(new wn(s,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function kK(e){return e[0]}function FK(e){return arguments.length?(this._x=e,this):this._x}function DK(e){return e[1]}function jK(e){return arguments.length?(this._y=e,this):this._y}function A2(e,t,n){var i=new O2(t==null?kK:t,n==null?DK:n,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function O2(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function wM(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var En=A2.prototype=O2.prototype;En.copy=function(){var e=new O2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=wM(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=wM(i));return e};En.add=yK;En.addAll=bK;En.cover=vK;En.data=xK;En.extent=wK;En.find=EK;En.remove=_K;En.removeAll=AK;En.root=OK;En.size=SK;En.visit=CK;En.visitAfter=$K;En.x=FK;En.y=jK;function _n(e){return function(){return e}}function ho(e){return(e()-.5)*1e-6}function MK(e){return e.x+e.vx}function TK(e){return e.y+e.vy}function NK(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=_n(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<s;++y)for(f=A2(t,MK,TK).visitAfter(a),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(b);function b(x,w,_,A,E){var S=x.data,k=x.r,$=p+k;if(S){if(S.index>d.index){var F=h-S.x-S.vx,M=g-S.y-S.vy,j=F*F+M*M;j<$*$&&(F===0&&(F=ho(i),j+=F*F),M===0&&(M=ho(i),j+=M*M),j=($-(j=Math.sqrt(j)))/j*r,d.vx+=(F*=j)*($=(k*=k)/(m+k)),d.vy+=(M*=j)*$,S.vx-=F*($=1-$),S.vy-=M*$)}return}return w>h+$||A<h-$||_>g+$||E<g-$}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,i=c,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(r=+l,o):r},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:_n(+l),u(),o):e},o}function RK(e){return e.index}function EM(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function LK(e){var t=RK,n=f,i,r=_n(30),s,o,a,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function d(m){for(var y=0,b=e.length;y<c;++y)for(var x=0,w,_,A,E,S,k,$;x<b;++x)w=e[x],_=w.source,A=w.target,E=A.x+A.vx-_.x-_.vx||ho(l),S=A.y+A.vy-_.y-_.vy||ho(l),k=Math.sqrt(E*E+S*S),k=(k-s[x])/k*m*i[x],E*=k,S*=k,A.vx-=E*($=u[x]),A.vy-=S*$,_.vx+=E*($=1-$),_.vy+=S*$}function h(){if(!!o){var m,y=o.length,b=e.length,x=new Map(o.map((_,A)=>[t(_,A,o),_])),w;for(m=0,a=new Array(y);m<b;++m)w=e[m],w.index=m,typeof w.source!="object"&&(w.source=EM(x,w.source)),typeof w.target!="object"&&(w.target=EM(x,w.target)),a[w.source.index]=(a[w.source.index]||0)+1,a[w.target.index]=(a[w.target.index]||0)+1;for(m=0,u=new Array(b);m<b;++m)w=e[m],u[m]=a[w.source.index]/(a[w.source.index]+a[w.target.index]);i=new Array(b),g(),s=new Array(b),p()}}function g(){if(!!o)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function p(){if(!!o)for(var m=0,y=e.length;m<y;++m)s[m]=+r(e[m],m,e)}return d.initialize=function(m,y){o=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:_n(+m),g(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:_n(+m),p(),d):r},d}var PK={value:()=>{}};function _M(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Tp(n)}function Tp(e){this._=e}function IK(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Tp.prototype=_M.prototype={constructor:Tp,on:function(e,t){var n=this._,i=IK(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=BK(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=AM(n[r],e.name,t);else if(t==null)for(r in n)n[r]=AM(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Tp(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function BK(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function AM(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=PK,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var il=0,Sf=0,Cf=0,OM=1e3,Np,$f,Rp=0,ba=0,Lp=0,kf=typeof performance=="object"&&performance.now?performance:Date,SM=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function S2(){return ba||(SM(zK),ba=kf.now()+Lp)}function zK(){ba=0}function Pp(){this._call=this._time=this._next=null}Pp.prototype=CM.prototype={constructor:Pp,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?S2():+n)+(t==null?0:+t),!this._next&&$f!==this&&($f?$f._next=this:Np=this,$f=this),this._call=e,this._time=n,C2()},stop:function(){this._call&&(this._call=null,this._time=1/0,C2())}};function CM(e,t,n){var i=new Pp;return i.restart(e,t,n),i}function UK(){S2(),++il;for(var e=Np,t;e;)(t=ba-e._time)>=0&&e._call.call(null,t),e=e._next;--il}function $M(){ba=(Rp=kf.now())+Lp,il=Sf=0;try{UK()}finally{il=0,WK(),ba=0}}function qK(){var e=kf.now(),t=e-Rp;t>OM&&(Lp-=t,Rp=e)}function WK(){for(var e,t=Np,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Np=n);$f=e,C2(i)}function C2(e){if(!il){Sf&&(Sf=clearTimeout(Sf));var t=e-ba;t>24?(e<1/0&&(Sf=setTimeout($M,e-kf.now()-Lp)),Cf&&(Cf=clearInterval(Cf))):(Cf||(Rp=kf.now(),Cf=setInterval(qK,OM)),il=1,SM($M))}}function HK(e,t,n){var i=new Pp,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?S2():+a,i._restart(function u(l){l+=r,i._restart(u,r+=o,a),s(l)},o,a)},i.restart(e,t,n),i)}const GK=1664525,YK=1013904223,kM=4294967296;function VK(){let e=1;return()=>(e=(GK*e+YK)%kM)/kM}function XK(e){return e.x}function KK(e){return e.y}var QK=10,JK=Math.PI*(3-Math.sqrt(5));function ZK(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,u=CM(f),l=_M("tick","end"),c=VK();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,b;p===void 0&&(p=1);for(var x=0;x<p;++x)for(n+=(s-n)*r,a.forEach(function(w){w(n)}),m=0;m<y;++m)b=e[m],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var b=QK*Math.sqrt(.5+p),x=p*JK;y.x=b*Math.cos(x),y.y=b*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),a.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(i=+p,t):i},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(s=+p,t):s},velocityDecay:function(p){return arguments.length?(o=1-p,t):1-o},randomSource:function(p){return arguments.length?(c=p,a.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?a.delete(p):a.set(p,g(m)),t):a.get(p)},find:function(p,m,y){var b=0,x=e.length,w,_,A,E,S;for(y==null?y=1/0:y*=y,b=0;b<x;++b)E=e[b],w=p-E.x,_=m-E.y,A=w*w+_*_,A<y&&(S=E,y=A);return S},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function eQ(){var e,t,n,i,r=_n(-30),s,o=1,a=1/0,u=.81;function l(h){var g,p=e.length,m=A2(e,XK,KK).visitAfter(f);for(i=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(!!e){var h,g=e.length,p;for(s=new Array(g),h=0;h<g;++h)p=e[h],s[p.index]=+r(p,h,e)}}function f(h){var g=0,p,m,y=0,b,x,w;if(h.length){for(b=x=w=0;w<4;++w)(p=h[w])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,b+=m*p.x,x+=m*p.y);h.x=b/y,h.y=x/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=s[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,b=h.y-t.y,x=m-g,w=y*y+b*b;if(x*x/u<w)return w<a&&(y===0&&(y=ho(n),w+=y*y),b===0&&(b=ho(n),w+=b*b),w<o&&(w=Math.sqrt(o*w)),t.vx+=y*h.value*i/w,t.vy+=b*h.value*i/w),!0;if(h.length||w>=a)return;(h.data!==t||h.next)&&(y===0&&(y=ho(n),w+=y*y),b===0&&(b=ho(n),w+=b*b),w<o&&(w=Math.sqrt(o*w)));do h.data!==t&&(x=s[h.data.index]*i/w,t.vx+=y*x,t.vy+=b*x);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:_n(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function tQ(e){var t=_n(.1),n,i,r;typeof e!="function"&&(e=_n(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*a}function o(){if(!!n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:_n(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:_n(+a),o(),s):e},s}function nQ(e){var t=_n(.1),n,i,r;typeof e!="function"&&(e=_n(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*a}function o(){if(!!n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:_n(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:_n(+a),o(),s):e},s}const FM={center:mK,collide:NK,nbody:eQ,link:LK,x:tQ,y:nQ},Ff="forces",$2=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],iQ=["static","iterations"],DM=["x","y","vx","vy"];function k2(e){T.call(this,null,e)}k2.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:DM}]};W(k2,T,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified($2),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&jM(n,e,0,t)):(this.value=n=sQ(t.source,e),n.on("tick",rQ(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(iQ)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Ff||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(DM)}});function rQ(e,t){return()=>e.touch(t).run()}function sQ(e,t){const n=ZK(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),jM(n,t,!0).on("end",()=>s=!0)}function jM(e,t,n,i){var r=ae(t.forces),s,o,a,u;for(s=0,o=$2.length;s<o;++s)a=$2[s],a!==Ff&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)u=Ff+s,a=n||t.modified(Ff,s)?aQ(r[s]):i&&oQ(r[s],i)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(Ff+s,null);return e.numForces=r.length,e}function oQ(e,t){var n,i;for(n in e)if(ye(i=e[n])&&t.modified(Ht(i)))return 1;return 0}function aQ(e){var t,n;ue(FM,e.force)||L("Unrecognized force: "+e.force),t=FM[e.force]();for(n in e)ye(t[n])&&uQ(t[n],e[n],e);return t}function uQ(e,t,n){e(ye(t)?i=>t(i,n):t)}var lQ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:k2});function cQ(e,t){return e.parent===t.parent?1:2}function fQ(e){return e.reduce(dQ,0)/e.length}function dQ(e,t){return e+t.x}function hQ(e){return 1+e.reduce(gQ,0)}function gQ(e,t){return Math.max(e,t.y)}function pQ(e){for(var t;t=e.children;)e=t[0];return e}function mQ(e){for(var t;t=e.children;)e=t[t.length-1];return e}function yQ(){var e=cQ,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=fQ(h),d.y=hQ(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var u=pQ(s),l=mQ(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(i?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function bQ(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function vQ(){return this.eachAfter(bQ)}function xQ(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function wQ(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function EQ(e,t){for(var n=this,i=[n],r=[],s,o,a,u=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function _Q(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function AQ(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function OQ(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function SQ(e){for(var t=this,n=CQ(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function CQ(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function $Q(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function kQ(){return Array.from(this)}function FQ(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function DQ(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*jQ(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function F2(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=NQ)):t===void 0&&(t=TQ);for(var n=new rl(e),i,r=[n],s,o,a,u;i=r.pop();)if((o=t(i.data))&&(u=(o=Array.from(o)).length))for(i.children=o,a=u-1;a>=0;--a)r.push(s=o[a]=new rl(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(MM)}function MQ(){return F2(this).eachBefore(RQ)}function TQ(e){return e.children}function NQ(e){return Array.isArray(e)?e[1]:null}function RQ(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function MM(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function rl(e){this.data=e,this.depth=this.height=0,this.parent=null}rl.prototype=F2.prototype={constructor:rl,count:vQ,each:xQ,eachAfter:EQ,eachBefore:wQ,find:_Q,sum:AQ,sort:OQ,path:SQ,ancestors:$Q,descendants:kQ,leaves:FQ,links:DQ,copy:MQ,[Symbol.iterator]:jQ};function LQ(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function PQ(e){for(var t=e.length,n,i;t;)i=Math.random()*t--|0,n=e[t],e[t]=e[i],e[i]=n;return e}function IQ(e){for(var t=0,n=(e=PQ(Array.from(e))).length,i=[],r,s;t<n;)r=e[t],s&&TM(s,r)?++t:(s=zQ(i=BQ(i,r)),t=0);return s}function BQ(e,t){var n,i;if(D2(t,e))return[t];for(n=0;n<e.length;++n)if(Ip(t,e[n])&&D2(Df(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(Ip(Df(e[n],e[i]),t)&&Ip(Df(e[n],t),e[i])&&Ip(Df(e[i],t),e[n])&&D2(NM(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function Ip(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function TM(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function D2(e,t){for(var n=0;n<t.length;++n)if(!TM(e,t[n]))return!1;return!0}function zQ(e){switch(e.length){case 1:return UQ(e[0]);case 2:return Df(e[0],e[1]);case 3:return NM(e[0],e[1],e[2])}}function UQ(e){return{x:e.x,y:e.y,r:e.r}}function Df(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-i,c=a-r,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(i+o+l/f*c)/2,r:(f+r+a)/2}}function NM(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-o,h=i-l,g=r-a,p=r-c,m=u-s,y=f-s,b=i*i+r*r-s*s,x=b-o*o-a*a+u*u,w=b-l*l-c*c+f*f,_=h*g-d*p,A=(g*w-p*x)/(_*2)-i,E=(p*m-g*y)/_,S=(h*x-d*w)/(_*2)-r,k=(d*y-h*m)/_,$=E*E+k*k-1,F=2*(s+A*E+S*k),M=A*A+S*S-s*s,j=-($?(F+Math.sqrt(F*F-4*$*M))/(2*$):M/F);return{x:i+A+E*j,y:r+S+k*j,r:j}}function RM(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,u,l=i*i+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(r=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function LM(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function PM(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function Bp(e){this._=e,this.next=null,this.previous=null}function qQ(e){if(!(r=(e=LQ(e)).length))return 0;var t,n,i,r,s,o,a,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;RM(n,t,i=e[2]),t=new Bp(t),n=new Bp(n),i=new Bp(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(a=3;a<r;++a){RM(t._,n._,i=e[a]),i=new Bp(i),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(LM(u._,i._)){n=u,t.next=n,n.previous=t,--a;continue e}c+=u._.r,u=u.next}else{if(LM(l._,i._)){t=l,t.next=n,n.previous=t,--a;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,s=PM(t);(i=i.next)!==n;)(o=PM(i))<s&&(t=i,s=o);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=IQ(t),a=0;a<r;++a)t=e[a],t.x-=i.x,t.y-=i.y;return i.r}function WQ(e){return e==null?null:zp(e)}function zp(e){if(typeof e!="function")throw new Error;return e}function va(){return 0}function sl(e){return function(){return e}}function HQ(e){return Math.sqrt(e.value)}function GQ(){var e=null,t=1,n=1,i=va;function r(s){return s.x=t/2,s.y=n/2,e?s.eachBefore(IM(e)).eachAfter(j2(i,.5)).eachBefore(BM(1)):s.eachBefore(IM(HQ)).eachAfter(j2(va,1)).eachAfter(j2(i,s.r/Math.min(t,n))).eachBefore(BM(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=WQ(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:sl(+s),r):i},r}function IM(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function j2(e,t){return function(n){if(i=n.children){var i,r,s=i.length,o=e(n)*t||0,a;if(o)for(r=0;r<s;++r)i[r].r+=o;if(a=qQ(i),o)for(r=0;r<s;++r)i[r].r-=o;n.r=a+o}}}function BM(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function zM(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function jf(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*l}function YQ(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(zM),o}function s(o,a){return function(u){u.children&&jf(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var VQ={depth:-1},UM={};function XQ(e){return e.id}function KQ(e){return e.parentId}function qM(){var e=XQ,t=KQ;function n(i){var r=Array.from(i),s=r.length,o,a,u,l,c,f,d,h=new Map;for(a=0;a<s;++a)o=r[a],c=r[a]=new rl(o),(f=e(o,a,i))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?UM:c)),(f=t(o,a,i))!=null&&(f+="")&&(c.parent=f);for(a=0;a<s;++a)if(c=r[a],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===UM)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=VQ,u.eachBefore(function(g){g.depth=g.parent.depth+1,--s}).eachBefore(MM),u.parent=null,s>0)throw new Error("cycle");return u}return n.id=function(i){return arguments.length?(e=zp(i),n):e},n.parentId=function(i){return arguments.length?(t=zp(i),n):t},n}function QQ(e,t){return e.parent===t.parent?1:2}function M2(e){var t=e.children;return t?t[0]:e.t}function T2(e){var t=e.children;return t?t[t.length-1]:e.t}function JQ(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function ZQ(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function eJ(e,t,n){return e.a.parent===t.parent?e.a:n}function Up(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Up.prototype=Object.create(rl.prototype);function tJ(e){for(var t=new Up(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new Up(s[o],o)),r.parent=n;return(t.parent=new Up(null,0)).children=[t],t}function nJ(){var e=QQ,t=1,n=1,i=null;function r(l){var c=tJ(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(b){b.x<f.x&&(f=b),b.x>d.x&&(d=b),b.depth>h.depth&&(h=b)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(b){b.x=(b.x+p)*m,b.y=b.depth*y})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){ZQ(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,b=g.m,x=p.m,w;g=T2(g),d=M2(d),g&&d;)p=M2(p),h=T2(h),h.a=l,w=g.z+b-d.z-m+e(g._,d._),w>0&&(JQ(eJ(g,l,f),l,w),m+=w,y+=w),b+=g.m,m+=d.m,x+=p.m,y+=h.m;g&&!T2(h)&&(h.t=g,h.m+=b-y),d&&!M2(p)&&(p.t=d,p.m+=m-x,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function qp(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*l}var WM=(1+Math.sqrt(5))/2;function HM(e,t,n,i,r,s){for(var o=[],a=t.children,u,l,c=0,f=0,d=a.length,h,g,p=t.value,m,y,b,x,w,_,A;c<d;){h=r-n,g=s-i;do m=a[f++].value;while(!m&&f<d);for(y=b=m,_=Math.max(g/h,h/g)/(p*e),A=m*m*_,w=Math.max(b/A,A/y);f<d;++f){if(m+=l=a[f].value,l<y&&(y=l),l>b&&(b=l),A=m*m*_,x=Math.max(b/A,A/y),x>w){m-=l;break}w=x}o.push(u={value:m,dice:h<g,children:a.slice(c,f)}),u.dice?jf(u,n,i,r,p?i+=g*m/p:s):qp(u,n,i,p?n+=h*m/p:r,s),p-=m,c=f}return o}var GM=function e(t){function n(i,r,s,o,a){HM(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(WM);function iJ(){var e=GM,t=!1,n=1,i=1,r=[0],s=va,o=va,a=va,u=va,l=va;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(zM),d}function f(d){var h=r[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=s(d)/2,g+=l(d)-h,p+=o(d)-h,m-=a(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=zp(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:sl(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:sl(+d),c):o},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:sl(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:sl(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:sl(+d),c):l},c}function rJ(e,t,n,i,r){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,i,r);function c(f,d,h,g,p,m,y){if(f>=d-1){var b=s[f];b.x0=g,b.y0=p,b.x1=m,b.y1=y;return}for(var x=l[f],w=h/2+x,_=f+1,A=d-1;_<A;){var E=_+A>>>1;l[E]<w?_=E+1:A=E}w-l[_-1]<l[_]-w&&f+1<_&&--_;var S=l[_]-x,k=h-S;if(m-g>y-p){var $=h?(g*k+m*S)/h:m;c(f,_,S,g,p,$,y),c(_,d,k,$,p,m,y)}else{var F=h?(p*k+y*S)/h:y;c(f,_,S,g,p,m,F),c(_,d,k,g,F,m,y)}}}function sJ(e,t,n,i,r){(e.depth&1?qp:jf)(e,t,n,i,r)}var oJ=function e(t){function n(i,r,s,o,a){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=i.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?jf(l,r,s,o,p?s+=(a-s)*l.value/p:a):qp(l,r,s,p?r+=(o-r)*l.value/p:o,a),p-=l.value}else i._squarify=u=HM(t,i,r,s,o,a),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(WM);function N2(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function R2(e){T.call(this,null,e)}R2.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const aJ=e=>e.values;W(R2,T,{transform(e,t){t.source||L("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&Th(o.data)&&r.rem.push(o.data)}),this.value=s=F2({values:ae(e.keys).reduce((o,a)=>(o.key(a),o),uJ()).entries(r.source)},aJ),n&&s.each(o=>{o.children&&(o=Ne(o.data),r.add.push(o),r.source.push(o))}),N2(s,ee,ee)),r.source.root=s,r}});function uJ(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=a(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],s);return l}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function us(e){T.call(this,null,e)}const lJ=(e,t)=>e.parent===t.parent?1:2;W(us,T,{transform(e,t){(!t.source||!t.source.root)&&L(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Zo(e.sort,o=>o.data)),cJ(n,this.params,e),n.separation&&n.separation(e.separation!==!1?lJ:pu);try{this.value=n(r)}catch(o){L(o)}return r.each(o=>fJ(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function cJ(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function fJ(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const L2=["x","y","r","depth","children"];function P2(e){us.call(this,e)}P2.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:L2.length,default:L2}]};W(P2,us,{layout:GQ,params:["radius","size","padding"],fields:L2});const I2=["x0","y0","x1","y1","depth","children"];function B2(e){us.call(this,e)}B2.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:I2.length,default:I2}]};W(B2,us,{layout:YQ,params:["size","round","padding"],fields:I2});function z2(e){T.call(this,null,e)}z2.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};W(z2,T,{transform(e,t){t.source||L("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?N2(qM().id(e.key).parentId(e.parentKey)(r.source),e.key,fi):N2(qM()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const YM={tidy:nJ,cluster:yQ},U2=["x","y","depth","children"];function q2(e){us.call(this,e)}q2.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:U2.length,default:U2}]};W(q2,us,{layout(e){const t=e||"tidy";if(ue(YM,t))return YM[t]();L("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:U2});function W2(e){T.call(this,[],e)}W2.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};W(W2,T,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||L("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[ee(o)]=1),i.each(o=>{const a=o.data,u=o.parent&&o.parent.data;u&&s[ee(a)]&&s[ee(u)]&&r.add.push(Ne({source:u,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[ee(o)]=1),n.forEach(o=>{(s[ee(o.source)]||s[ee(o.target)])&&r.mod.push(o)})),r}});const VM={binary:rJ,dice:jf,slice:qp,slicedice:sJ,squarify:GM,resquarify:oJ},H2=["x0","y0","x1","y1","depth","children"];function G2(e){us.call(this,e)}G2.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:H2.length,default:H2}]};W(G2,us,{layout(){const e=iJ();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ue(VM,t)?e.tile(VM[t]):L("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:H2});var dJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:R2,pack:P2,partition:B2,stratify:z2,tree:q2,treelinks:W2,treemap:G2});const hJ=4278190080,gJ=268435456,pJ=.0625;function mJ(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function yJ(e,t,n,i){const r=e.width,s=e.height,o=n||i,a=Du(r,s).getContext("2d");t.forEach(m=>XM(a,m,o));const u=new Uint32Array(a.getImageData(0,0,r,s).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,g,p;for(d=0;d<s;++d)for(f=0;f<r;++f)p=u[d*r+f]&hJ,p&&(h=e(f),g=e(d),i||l.set(h,g),o&&p^gJ&&c.set(h,g));return[l,c]}function XM(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>XM(e,s.items,n))}):ti[i].draw(e,{items:n?t.map(bJ):t})}function bJ(e){const t=Nh(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=pJ,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const ls=5,An=31,Mf=32,go=new Uint32Array(Mf+1),Wi=new Uint32Array(Mf+1);Wi[0]=0;go[0]=~Wi[0];for(let e=1;e<=Mf;++e)Wi[e]=Wi[e-1]<<1|1,go[e]=~Wi[e];function vJ(e,t){const n=new Uint32Array(~~((e*t+Mf)/Mf));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>ls]&1<<(a&An)},set:(s,o)=>{const a=o*e+s;i(a>>>ls,1<<(a&An))},clear:(s,o)=>{const a=o*e+s;r(a>>>ls,~(1<<(a&An)))},getRange:(s,o,a,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+s,f=l*e+a,d=c>>>ls,h=f>>>ls,d===h){if(n[d]&go[c&An]&Wi[(f&An)+1])return!0}else{if(n[d]&go[c&An]||n[h]&Wi[(f&An)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>ls,d=c>>>ls,f===d)i(f,go[l&An]&Wi[(c&An)+1]);else for(i(f,go[l&An]),i(d,Wi[(c&An)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>ls,d=c>>>ls,f===d)r(f,Wi[l&An]|go[(c&An)+1]);else for(r(f,Wi[l&An]),r(d,go[(c&An)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(s,o,a,u)=>s<0||o<0||u>=t||a>=e}}function xJ(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>vJ(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function wJ(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,u=a.length,l=o.datum.fontSize,c=br.width(o.datum,o.datum.text);let f=0,d,h,g,p,m,y,b;for(let x=0;x<u;++x)d=a[x].x,g=a[x].y,h=a[x].x2===void 0?d:a[x].x2,p=a[x].y2===void 0?g:a[x].y2,m=(d+h)/2,y=(g+p)/2,b=Math.abs(h-d+p-g),b>=f&&(f=b,o.x=m,o.y=y);return m=c/2,y=l/2,d=o.x-m,h=o.x+m,g=o.y-y,p=o.y+y,o.align="center",d<0&&h<=r?o.align="left":0<=d&&r<h&&(o.align="right"),o.baseline="middle",g<0&&p<=s?o.baseline="top":0<=g&&s<p&&(o.baseline="bottom"),!0}}function EJ(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function _J(){return!1}function AJ(e,t,n,i,r,s,o,a){const u=r*s/(i*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function OJ(e,t,n,i,r,s,o,a){const u=r*s/(i*2);let l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,o.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function KM(e){return e?[OJ,_J]:[AJ,EJ]}function SJ(e,t,n,i,r){const s=e.width,o=e.height,[a,u]=KM(r),l=t[0],c=t[1];function f(d,h,g,p,m){const y=e.invert(d),b=e.invert(h);let x=g,w=o,_;if(!u(y,b,p,m,s,o)&&!a(e,y,b,m,p,x,l,c)&&!a(e,y,b,m,p,m,l,null)){for(;w-x>=1;)_=(x+w)/2,a(e,y,b,m,p,_,l,c)?w=_:x=_;if(x>g)return[y,b,x,!0]}}return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=br.width(d.datum,d.datum.text);let y=n?p:0,b=!1,x=!1,w=0,_,A,E,S,k,$,F,M,j,I,D,P,B,H,X,ce,Te;for(let $e=0;$e<g;++$e){for(_=h[$e].x,E=h[$e].y,A=h[$e].x2===void 0?_:h[$e].x2,S=h[$e].y2===void 0?E:h[$e].y2,_>A&&(Te=_,_=A,A=Te),E>S&&(Te=E,E=S,S=Te),j=e(_),D=e(A),I=~~((j+D)/2),P=e(E),H=e(S),B=~~((P+H)/2),F=I;F>=j;--F)for(M=B;M>=P;--M)ce=f(F,M,y,m,p),ce&&([d.x,d.y,y,b]=ce);for(F=I;F<=D;++F)for(M=B;M<=H;++M)ce=f(F,M,y,m,p),ce&&([d.x,d.y,y,b]=ce);!b&&!n&&(X=Math.abs(A-_+S-E),k=(_+A)/2,$=(E+S)/2,X>=w&&!u(k,$,m,p,s,o)&&!a(e,k,$,p,m,p,l,null)&&(w=X,d.x=k,d.y=$,x=!0))}return b||x?(k=m/2,$=p/2,l.setRange(e(d.x-k),e(d.y-$),e(d.x+k),e(d.y+$)),d.align="center",d.baseline="middle",!0):!1}}const CJ=[-1,-1,1,1],$J=[-1,1,-1,1];function kJ(e,t,n,i,r){const s=e.width,o=e.height,[a,u]=KM(r),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=br.width(d.datum,d.datum.text),y=[];let b=n?p:0,x=!1,w=!1,_=0,A,E,S,k,$,F,M,j,I,D,P,B;for(let H=0;H<g;++H){for(A=h[H].x,S=h[H].y,E=h[H].x2===void 0?A:h[H].x2,k=h[H].y2===void 0?S:h[H].y2,y.push([e((A+E)/2),e((S+k)/2)]);y.length;)if([M,j]=y.pop(),!(l.get(M,j)||c.get(M,j)||f.get(M,j))){f.set(M,j);for(let X=0;X<4;++X)$=M+CJ[X],F=j+$J[X],f.outOfBounds($,F,$,F)||y.push([$,F]);if($=e.invert(M),F=e.invert(j),I=b,D=o,!u($,F,m,p,s,o)&&!a(e,$,F,p,m,I,l,c)&&!a(e,$,F,p,m,p,l,null)){for(;D-I>=1;)P=(I+D)/2,a(e,$,F,p,m,P,l,c)?D=P:I=P;I>b&&(d.x=$,d.y=F,b=I,x=!0)}}!x&&!n&&(B=Math.abs(E-A+k-S),$=(A+E)/2,F=(S+k)/2,B>=_&&!u($,F,m,p,s,o)&&!a(e,$,F,p,m,p,l,null)&&(_=B,d.x=$,d.y=F,w=!0))}return x||w?($=m/2,F=p/2,l.setRange(e(d.x-$),e(d.y-F),e(d.x+$),e(d.y+F)),d.align="center",d.baseline="middle",!0):!1}}const FJ=["right","center","left"],DJ=["bottom","middle","top"];function jJ(e,t,n,i,r){const s=e.width,o=e.height,a=t[0],u=t[1],l=i.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!r&&(f[2]<0||f[5]<0||f[0]>s||f[3]>o))return!1;let h=0,g,p,m,y,b,x,w,_,A,E,S,k,$,F,M;for(let j=0;j<l;++j){if(g=(n[j]&3)-1,p=(n[j]>>>2&3)-1,m=g===0&&p===0||i[j]<0,y=g&&p?Math.SQRT1_2:1,b=i[j]<0?-1:1,x=f[1+g]+i[j]*g*y,S=f[4+p]+b*d*p/2+i[j]*p*y,_=S-d/2,A=S+d/2,k=e(x),F=e(_),M=e(A),r&&(k=k<0?0:k,F=F<0?0:F,M=M>=e.height?e.height-1:M),!h)if(QM(k,k,F,M,a,u,x,x,_,A,f,m))h=br.width(c.datum,c.datum.text);else continue;if(E=x+b*h*g/2,x=E-h/2,w=E+h/2,k=e(x),$=e(w),r&&(k=k<0?0:k,$=$>=e.width?e.width-1:$),QM(k,$,F,M,a,u,x,w,_,A,f,m))return c.x=g?g*b<0?w:x:E,c.y=p?p*b<0?A:_:S,c.align=FJ[g*b+1],c.baseline=DJ[p*b+1],a.setRange(k,F,$,M),!0}return!1}}function QM(e,t,n,i,r,s,o,a,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s?s.getRange(e,n,t,i)||!MJ(o,u,a,l,c):r.getRange(e,n,t,i)))}function MJ(e,t,n,i,r){return r[0]<=e&&n<=r[2]&&r[3]<=t&&i<=r[5]}const Y2=0,V2=4,X2=8,K2=0,Q2=1,J2=2,TJ={"top-left":Y2+K2,top:Y2+Q2,"top-right":Y2+J2,left:V2+K2,middle:V2+Q2,right:V2+J2,"bottom-left":X2+K2,bottom:X2+Q2,"bottom-right":X2+J2},NJ={naive:wJ,"reduced-search":SJ,floodfill:kJ};function RJ(e,t,n,i,r,s,o,a,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=LJ(i,f),h=PJ(r,f),g=IJ(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=BJ(g,p,a,u),b=l===null||l===1/0,x=xJ(t[0],t[1],b?0:l),w=m&&c==="naive",_=e.map(S=>({datum:S,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(S)}));let A;if(!w){n&&_.sort((k,$)=>n(k.datum,$.datum));let S=!1;for(let k=0;k<h.length&&!S;++k)S=h[k]===5||d[k]<0;g&&(o||m)&&(s=[e.map(k=>k.datum)].concat(s)),A=s.length?yJ(x,s,S,m):mJ(x,o&&_)}const E=m?NJ[c](x,A,o,u,b):jJ(x,A,h,d,b);return _.forEach(S=>S.opacity=+E(S)),_}function LJ(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function PJ(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=TJ[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function IJ(e){return e&&e.mark&&e.mark.marktype}function BJ(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const Z2=["x","y","opacity","align","baseline"],JM=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function ew(e){T.call(this,null,e)}ew.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:JM},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Z2.length,default:Z2}]};W(ew,T,{transform(e,t){function n(s){const o=e[s];return ye(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&L("Size parameter should be specified as a [width, height] array.");const r=e.as||Z2;return RJ(t.materialize(t.SOURCE).source||[],e.size,e.sort,ae(e.offset==null?1:e.offset),ae(e.anchor||JM),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});var zJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:ew});function ZM(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function tw(e){T.call(this,null,e)}tw.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};W(tw,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=ZM(i,e.groupby),s=(e.groupby||[]).map(rt),o=s.length,a=e.as||[rt(e.x),rt(e.y)],u=[];r.forEach(l=>{g$(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[s[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Ne(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const nw={linear:Xy,log:u$,exp:l$,pow:c$,quad:Ky,poly:f$},UJ=(e,t)=>e==="poly"?t:e==="quad"?2:1;function iw(e){T.call(this,null,e)}iw.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(nw)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};W(iw,T,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=ZM(i,e.groupby),s=(e.groupby||[]).map(rt),o=e.method||"linear",a=e.order||3,u=UJ(o,a),l=e.as||[rt(e.x),rt(e.y)],c=nw[o],f=[];let d=e.extent;ue(nw,o)||L("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,a);if(e.params){f.push(Ne({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||ar(h,e.x),y=b=>{const x={};for(let w=0;w<s.length;++w)x[s[w]]=h.dims[w];x[l[0]]=b[0],x[l[1]]=b[1],f.push(Ne(x))};o==="linear"?m.forEach(b=>y([b,p.predict(b)])):Hh(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var qJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:tw,regression:iw});const e5=Math.pow(2,-52),Wp=new Uint32Array(512);class Hp{static from(t,n=VJ,i=XJ){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new Hp(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let $=0;$<o;$++){const F=t[2*$],M=t[2*$+1];F<a&&(a=F),M<u&&(u=M),F>l&&(l=F),M>c&&(c=M),this._ids[$]=$}const f=(a+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let $=0;$<o;$++){const F=rw(f,d,t[2*$],t[2*$+1]);F<h&&(g=$,h=F)}const y=t[2*g],b=t[2*g+1];h=1/0;for(let $=0;$<o;$++){if($===g)continue;const F=rw(y,b,t[2*$],t[2*$+1]);F<h&&F>0&&(p=$,h=F)}let x=t[2*p],w=t[2*p+1],_=1/0;for(let $=0;$<o;$++){if($===g||$===p)continue;const F=GJ(y,b,x,w,t[2*$],t[2*$+1]);F<_&&(m=$,_=F)}let A=t[2*m],E=t[2*m+1];if(_===1/0){for(let M=0;M<o;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];ol(this._ids,this._dists,0,o-1);const $=new Uint32Array(o);let F=0;for(let M=0,j=-1/0;M<o;M++){const I=this._ids[M];this._dists[I]>j&&($[F++]=I,j=this._dists[I])}this.hull=$.subarray(0,F),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Gp(y,b,x,w,A,E)){const $=p,F=x,M=w;p=m,x=A,w=E,m=$,A=F,E=M}const S=YJ(y,b,x,w,A,E);this._cx=S.x,this._cy=S.y;for(let $=0;$<o;$++)this._dists[$]=rw(t[2*$],t[2*$+1],S.x,S.y);ol(this._ids,this._dists,0,o-1),this._hullStart=g;let k=3;i[g]=n[m]=p,i[p]=n[g]=m,i[m]=n[p]=g,r[g]=0,r[p]=1,r[m]=2,s.fill(-1),s[this._hashKey(y,b)]=g,s[this._hashKey(x,w)]=p,s[this._hashKey(A,E)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let $=0,F,M;$<this._ids.length;$++){const j=this._ids[$],I=t[2*j],D=t[2*j+1];if($>0&&Math.abs(I-F)<=e5&&Math.abs(D-M)<=e5||(F=I,M=D,j===g||j===p||j===m))continue;let P=0;for(let Te=0,$e=this._hashKey(I,D);Te<this._hashSize&&(P=s[($e+Te)%this._hashSize],!(P!==-1&&P!==i[P]));Te++);P=n[P];let B=P,H;for(;H=i[B],!Gp(I,D,t[2*B],t[2*B+1],t[2*H],t[2*H+1]);)if(B=H,B===P){B=-1;break}if(B===-1)continue;let X=this._addTriangle(B,j,i[B],-1,-1,r[B]);r[j]=this._legalize(X+2),r[B]=X,k++;let ce=i[B];for(;H=i[ce],Gp(I,D,t[2*ce],t[2*ce+1],t[2*H],t[2*H+1]);)X=this._addTriangle(ce,j,H,r[j],-1,r[ce]),r[j]=this._legalize(X+2),i[ce]=ce,k--,ce=H;if(B===P)for(;H=n[B],Gp(I,D,t[2*H],t[2*H+1],t[2*B],t[2*B+1]);)X=this._addTriangle(H,j,B,-1,r[B],r[H]),this._legalize(X+2),r[H]=X,i[B]=B,k--,B=H;this._hullStart=n[j]=B,i[B]=n[ce]=j,i[j]=ce,s[this._hashKey(I,D)]=j,s[this._hashKey(t[2*B],t[2*B+1])]=B}this.hull=new Uint32Array(k);for(let $=0,F=this._hullStart;$<k;$++)this.hull[$]=F,F=i[F];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(WJ(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(s===0)break;t=Wp[--s];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[o],h=n[t],g=n[c],p=n[f];if(HJ(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*g],r[2*g+1],r[2*p],r[2*p+1])){n[t]=p,n[a]=d;const y=i[f];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,y),this._link(a,i[o]),this._link(o,f);const b=l+(a+1)%3;s<Wp.length&&(Wp[s++]=b)}else{if(s===0)break;t=Wp[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function WJ(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function rw(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function sw(e,t,n,i,r,s){const o=(i-t)*(r-e),a=(n-e)*(s-t);return Math.abs(o-a)>=33306690738754716e-32*Math.abs(o+a)?o-a:0}function Gp(e,t,n,i,r,s){return(sw(r,s,e,t,n,i)||sw(e,t,n,i,r,s)||sw(n,i,r,s,e,t))<0}function HJ(e,t,n,i,r,s,o,a){const u=e-o,l=t-a,c=n-o,f=i-a,d=r-o,h=s-a,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function GJ(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=(l*c-a*f)*d,g=(o*f-u*c)*d;return h*h+g*g}function YJ(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=e+(l*c-a*f)*d,g=t+(o*f-u*c)*d;return{x:h,y:g}}function ol(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;Tf(e,r,s),t[e[n]]>t[e[i]]&&Tf(e,n,i),t[e[s]]>t[e[i]]&&Tf(e,s,i),t[e[n]]>t[e[s]]&&Tf(e,n,s);const a=e[s],u=t[a];for(;;){do s++;while(t[e[s]]<u);do o--;while(t[e[o]]>u);if(o<s)break;Tf(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(ol(e,t,s,i),ol(e,t,n,o-1)):(ol(e,t,n,o-1),ol(e,t,s,i))}}function Tf(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function VJ(e){return e[0]}function XJ(e){return e[1]}const t5=1e-6;class xa{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>t5||Math.abs(this._y1-s)>t5)&&(this._+="L"+r+","+s),!!i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class ow{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class KJ{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let h=0,g=0,p=i.length,m,y;h<p;h+=3,g+=2){const b=i[h]*2,x=i[h+1]*2,w=i[h+2]*2,_=t[b],A=t[b+1],E=t[x],S=t[x+1],k=t[w],$=t[w+1],F=E-_,M=S-A,j=k-_,I=$-A,D=F*F+M*M,P=j*j+I*I,B=(F*I-M*j)*2;if(!B)m=(_+k)/2-1e8*I,y=(A+$)/2+1e8*j;else if(Math.abs(B)<1e-8)m=(_+k)/2,y=(A+$)/2;else{const H=1/B;m=_+(I*D-M*P)*H,y=A+(F*P-j*D)*H}s[g]=m,s[g+1]=y}let o=n[n.length-1],a,u=o*4,l,c=t[2*o],f,d=t[2*o+1];r.fill(0);for(let h=0;h<n.length;++h)o=n[h],a=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],r[a+2]=r[u]=f-d,r[a+3]=r[u+1]=c-l}render(t){const n=t==null?t=new xa:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=o[h],m=o[h+1],y=o[g],b=o[g+1];this._renderSegment(p,m,y,b,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(r[l]/3)*2,d=o[f],h=o[f+1],g=u*4,p=this._project(d,h,a[g+2],a[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new xa:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new xa:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new ow;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),u=this._regioncode(i,r);a===0&&u===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,u))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,u=r.length;a<u;a+=2)if(n[s]==r[a]&&n[s+1]==r[a+1]&&n[(s+2)%o]==r[(a+u-2)%u]&&n[(s+3)%o]==r[(a+u-1)%u]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let u=o;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,s[u]!==t)break;u=r[u]}while(u!==o&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],u=n[i-1],l,c=this._regioncode(a,u),f,d;for(let h=0;h<i;h+=2)if(s=a,o=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,r?r.push(a,u):r=[a,u];else{let g,p,m,y,b;if(l===0){if((g=this._clipSegment(s,o,a,u,l,c))===null)continue;[p,m,y,b]=g}else{if((g=this._clipSegment(a,u,s,o,c,l))===null)continue;[y,b,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(p,m):r=[p,m]}f=d,d=this._edgecode(y,b),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,b):r=[y,b]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){for(;;){if(s===0&&o===0)return[t,n,i,r];if(s&o)return null;let a,u,l=s||o;l&8?(a=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):l&4?(a=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):l&2?(u=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),s?(t=a,n=u,s=this._regioncode(t,n)):(i=a,r=u,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),u;if((u=this._project(a[0],a[1],i,r))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const a=(o+2)%r.length,u=(o+4)%r.length;(r[o]===r[a]&&r[a]===r[u]||r[o+1]===r[a+1]&&r[a+1]===r[u+1])&&(r.splice(a,2),o-=2)}return s}_project(t,n,i,r){let s=1/0,o,a,u;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(u=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(u=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,u=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,u=n+(s=o)*r)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const QJ=2*Math.PI,al=Math.pow;function JJ(e){return e[0]}function ZJ(e){return e[1]}function eZ(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function tZ(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class aw{static from(t,n=JJ,i=ZJ,r){return new aw("length"in t?nZ(t,n,i,r):Float64Array.from(iZ(t,n,i,r)))}constructor(t){this._delaunator=new Hp(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&eZ(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=tZ(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new Hp(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=s[u%3==2?u-2:u+1];(i[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=r.length;u<l;++u)a[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,r.length===2&&(o[r[1]]=0))}voronoi(t){return new KJ(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=al(n-l[t*2],2)+al(i-l[t*2+1],2);const d=r[t];let h=d;do{let g=u[h];const p=al(n-l[g*2],2)+al(i-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=s[(o[t]+1)%s.length],h!==g&&al(n-l[h*2],2)+al(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new xa:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u<o)continue;const l=s[o]*2,c=s[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const i=t==null?t=new xa:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],u=r[s+1];t.moveTo(a+n,u),t.arc(a,u,n,0,QJ)}return i&&i.value()}renderHull(t){const n=t==null?t=new xa:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const u=2*i[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new ow;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new xa:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,u=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new ow;return this.renderTriangle(t,n),n.value()}}function nZ(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*iZ(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function uw(e){T.call(this,null,e)}uw.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const rZ=[-1e5,-1e5,1e5,1e5];W(uw,T,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:rZ;const s=this.value=aw.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const u=s.cellPolygon(o);i[o][n]=u?sZ(u):null}return t.reflow(e.modified()).modifies(n)}});function sZ(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}var oZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:uw}),lw=Math.PI/180,Nf=1<<11>>5,Yp=1<<11;function aZ(){var e=[256,256],t,n,i,r,s,o,a,u=n5,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(Du()),p=hZ((e[0]>>5)*e[1]),m=null,y=l.length,b=-1,x=[],w=l.map(A=>({text:t(A),font:n(A),style:r(A),weight:s(A),rotate:o(A),size:~~(i(A)+1e-14),padding:a(A),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:A})).sort((A,E)=>E.size-A.size);++b<y;){var _=w[b];_.x=e[0]*(c()+.5)>>1,_.y=e[1]*(c()+.5)>>1,uZ(g,_,w,b),_.hasText&&h(p,_,m)&&(x.push(_),m?cZ(m,_):m=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}],_.x-=e[0]>>1,_.y-=e[1]>>1)}return x};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(Nf<<5)/p,g.height=Yp/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,b=p.y,x=Math.sqrt(e[0]*e[0]+e[1]*e[1]),w=u(e),_=c()<.5?1:-1,A=-_,E,S,k;(E=w(A+=_))&&(S=~~E[0],k=~~E[1],!(Math.min(Math.abs(S),Math.abs(k))>=x));)if(p.x=y+S,p.y=b+k,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!lZ(p,g,e[0]))&&(!m||fZ(p,m))){for(var $=p.sprite,F=p.width>>5,M=e[0]>>5,j=p.x-(F<<4),I=j&127,D=32-I,P=p.y1-p.y0,B=(p.y+p.y0)*M+(j>>5),H,X=0;X<P;X++){H=0;for(var ce=0;ce<=F;ce++)g[B+ce]|=H<<D|(ce<F?(H=$[X*F+ce])>>>I:0);B+=M}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=wa(g),f):n},f.fontStyle=function(g){return arguments.length?(r=wa(g),f):r},f.fontWeight=function(g){return arguments.length?(s=wa(g),f):s},f.rotate=function(g){return arguments.length?(o=wa(g),f):o},f.text=function(g){return arguments.length?(t=wa(g),f):t},f.spiral=function(g){return arguments.length?(u=gZ[g]||g,f):u},f.fontSize=function(g){return arguments.length?(i=wa(g),f):i},f.padding=function(g){return arguments.length?(a=wa(g),f):a},f.random=function(g){return arguments.length?(c=g,f):c},f}function uZ(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(Nf<<5)/s,Yp/s);var o=0,a=0,u=0,l=n.length,c,f,d,h,g;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*lw),m=Math.cos(t.rotate*lw),y=c*m,b=c*p,x=d*m,w=d*p;c=Math.max(Math.abs(y+w),Math.abs(y-w))+31>>5<<5,d=~~Math.max(Math.abs(b+x),Math.abs(b-x))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=Nf<<5&&(o=0,a+=u,u=0),a+d>=Yp)break;r.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&r.rotate(t.rotate*lw),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var _=r.getImageData(0,0,(Nf<<5)/s,Yp/s).data,A=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)A[h]=0;if(o=t.xoff,o==null)return;a=t.yoff;var E=0,S=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var k=f*g+(h>>5),$=_[(a+g)*(Nf<<5)+(o+h)<<2]?1<<31-h%32:0;A[k]|=$,E|=$}E?S=g:(t.y0++,d--,g--,a++)}t.y1=t.y0+S,t.sprite=A.slice(0,(t.y1-t.y0)*f)}}}function lZ(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<a|(d<r?(c=i[f*r+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function cZ(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function fZ(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function n5(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function dZ(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function hZ(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function wa(e){return typeof e=="function"?e:function(){return e}}var gZ={archimedean:n5,rectangular:dZ};const i5=["x","y","font","fontSize","fontStyle","fontWeight","angle"],pZ=["text","font","rotate","fontSize","fontStyle","fontWeight"];function cw(e){T.call(this,aZ(),e)}cw.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:i5}]};W(cw,T,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&L("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return ye(p)&&t.modified(p.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||pZ.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||i5;let a=e.fontSize||14,u;if(ye(a)?u=e.fontSizeRange:a=Yt(a),u){const g=a,p=De("sqrt")().domain(ar(r,g)).range(u);a=m=>p(g(m))}r.forEach(g=>{g[o[0]]=NaN,g[o[1]]=NaN,g[o[3]]=0});const l=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(gi).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[o[0]]=p.x+f,m[o[1]]=p.y+d,m[o[2]]=p.font,m[o[3]]=p.size,m[o[4]]=p.style,m[o[5]]=p.weight,m[o[6]]=p.rotate;return t.reflow(i).modifies(o)}});var mZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:cw});const yZ=e=>new Uint8Array(e),bZ=e=>new Uint16Array(e),Rf=e=>new Uint32Array(e);function vZ(){let e=8,t=[],n=Rf(0),i=Vp(0,e),r=Vp(0,e);return{data:()=>t,seen:()=>n=xZ(n,t.length),add(s){for(let o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove(s,o){const a=t.length,u=Array(a-s),l=t;let c,f,d;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=Vp(s,e,i),r=Vp(s,e))}}}function xZ(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Vp(e,t,n){const i=(t<257?yZ:t<65537?bZ:Rf)(e);return n&&i.set(n),i}function r5(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),u=r.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)s[u[d]]|=i;for(d=c;d<f;++d)s[u[d]]|=i;return o}}}function s5(){let e=Rf(0),t=[],n=0;function i(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=Rf(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=wZ(h,d),c)g=t,p=e,t=Array(c+f),e=Rf(c+f),EZ(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function s(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){let l;return u?l=u.length:(u=t,l=n),[JP(u,a[0],0,l),wh(u,a[1],0,l)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function wZ(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),tI(e,t)}function EZ(e,t,n,i,r,s,o,a,u){let l=0,c=0,f;for(f=0;l<i&&c<o;++f)t[l]<r[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=r[c],u[f]=s[c++]+e);for(;l<i;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=r[c],u[f]=s[c]+e}function fw(e){T.call(this,vZ(),e),this._indices=null,this._dims=null}fw.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};W(fw,T,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,u,l;for(;a<o;++a)u=n[a].fname,l=r[u]||(r[u]=s5()),s.push(r5(l,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=r.length,g={};let p,m,y,b,x,w,_,A,E;if(l.set(u),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(w={},b=t.mod,_=0,A=b.length;_<A;++_)w[b[_]._index]=1;for(_=0;_<h;++_)E=i[_],(!o[_]||e.modified("fields",_)||t.modified(E.fields))&&(y=E.fname,(p=g[y])||(s[y]=m=s5(),g[y]=p=m.insert(E,t.source,0)),o[_]=r5(m,_,r[_]).onAdd(p,u));for(_=0,A=a.data().length;_<A;++_)x[_]||(l[_]!==u[_]?f.push(_):w[_]&&u[_]!==c&&d.push(_));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=r.size()+i.length,f=s.length;let d=r.size(),h,g,p;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),b=r.all();for(h=0;h<f;++h)g=a[h].fname,p=u[g]||(u[g]=o[g].insert(a[h],i,d)),s[h].onAdd(p,m);for(;d<c;++d)y[d]=b,m[d]!==b&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,r[l]!==s&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=g=s[h],s[h]=a,g!==a&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)!e.modified("query",l)||(a|=i[l].one,this.incrementAll(i[l],r[l],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,b;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)b=u[m],s[b]!==n&&(a[b]=o[b],s[b]=n,i.push(b)),o[b]^=p;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=o[g],s[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=o[g],s[m]^=h,i.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=o[g],s[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=o[g],s[m]^=h,i.push(m);e.range=t.slice()}});function dw(e){T.call(this,null,e)}dw.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};W(dw,T,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)==0)return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),u=i.prev(),l=c=>a[c]&n?null:o[c];return s.filter(s.MOD,l),r&r-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});var _Z=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:fw,resolvefilter:dw});const AZ="RawCode",Ea="Literal",OZ="Property",SZ="Identifier",CZ="ArrayExpression",$Z="BinaryExpression",o5="CallExpression",kZ="ConditionalExpression",FZ="LogicalExpression",DZ="MemberExpression",jZ="ObjectExpression",MZ="UnaryExpression";function Hi(e){this.type=e}Hi.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=TZ(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function TZ(e){switch(e.type){case CZ:return e.elements;case $Z:case FZ:return[e.left,e.right];case o5:return[e.callee].concat(e.arguments);case kZ:return[e.test,e.consequent,e.alternate];case DZ:return[e.object,e.property];case jZ:return e.properties;case OZ:return[e.key,e.value];case MZ:return[e.argument];case SZ:case Ea:case AZ:default:return[]}}var Or,K,N,en,Pe,Xp=1,Lf=2,_a=3,po=4,Kp=5,Aa=6,In=7,Pf=8,NZ=9;Or={};Or[Xp]="Boolean";Or[Lf]="<end>";Or[_a]="Identifier";Or[po]="Keyword";Or[Kp]="Null";Or[Aa]="Numeric";Or[In]="Punctuator";Or[Pf]="String";Or[NZ]="RegularExpression";var RZ="ArrayExpression",LZ="BinaryExpression",PZ="CallExpression",IZ="ConditionalExpression",a5="Identifier",BZ="Literal",zZ="LogicalExpression",UZ="MemberExpression",qZ="ObjectExpression",WZ="Property",HZ="UnaryExpression",Dt="Unexpected token %0",GZ="Unexpected number",YZ="Unexpected string",VZ="Unexpected identifier",XZ="Unexpected reserved word",KZ="Unexpected end of input",hw="Invalid regular expression",gw="Invalid regular expression: missing /",u5="Octal literals are not allowed in strict mode.",QZ="Duplicate data property in object literal not allowed in strict mode",zt="ILLEGAL",If="Disabled.",JZ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ZZ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Qp(e,t){if(!e)throw new Error("ASSERT: "+t)}function cs(e){return e>=48&&e<=57}function pw(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Bf(e){return"01234567".indexOf(e)>=0}function eee(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function zf(e){return e===10||e===13||e===8232||e===8233}function Uf(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&JZ.test(String.fromCharCode(e))}function Jp(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&ZZ.test(String.fromCharCode(e))}const tee={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function l5(){for(;N<en;){const e=K.charCodeAt(N);if(eee(e)||zf(e))++N;else break}}function mw(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)N<en&&pw(K[N])?(i=K[N++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):je({},Dt,zt);return String.fromCharCode(r)}function nee(){var e,t,n,i;for(e=K[N],t=0,e==="}"&&je({},Dt,zt);N<en&&(e=K[N++],!!pw(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&je({},Dt,zt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function c5(){var e,t;for(e=K.charCodeAt(N++),t=String.fromCharCode(e),e===92&&(K.charCodeAt(N)!==117&&je({},Dt,zt),++N,e=mw("u"),(!e||e==="\\"||!Uf(e.charCodeAt(0)))&&je({},Dt,zt),t=e);N<en&&(e=K.charCodeAt(N),!!Jp(e));)++N,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),K.charCodeAt(N)!==117&&je({},Dt,zt),++N,e=mw("u"),(!e||e==="\\"||!Jp(e.charCodeAt(0)))&&je({},Dt,zt),t+=e);return t}function iee(){var e,t;for(e=N++;N<en;){if(t=K.charCodeAt(N),t===92)return N=e,c5();if(Jp(t))++N;else break}return K.slice(e,N)}function ree(){var e,t,n;return e=N,t=K.charCodeAt(N)===92?c5():iee(),t.length===1?n=_a:tee.hasOwnProperty(t)?n=po:t==="null"?n=Kp:t==="true"||t==="false"?n=Xp:n=_a,{type:n,value:t,start:e,end:N}}function yw(){var e=N,t=K.charCodeAt(N),n,i=K[N],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++N,{type:In,value:String.fromCharCode(t),start:e,end:N};default:if(n=K.charCodeAt(N+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return N+=2,{type:In,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:N};case 33:case 61:return N+=2,K.charCodeAt(N)===61&&++N,{type:In,value:K.slice(e,N),start:e,end:N}}}if(o=K.substr(N,4),o===">>>=")return N+=4,{type:In,value:o,start:e,end:N};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return N+=3,{type:In,value:s,start:e,end:N};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return N+=2,{type:In,value:r,start:e,end:N};if(r==="//"&&je({},Dt,zt),"<>=!+-*%&|^/".indexOf(i)>=0)return++N,{type:In,value:i,start:e,end:N};je({},Dt,zt)}function see(e){let t="";for(;N<en&&pw(K[N]);)t+=K[N++];return t.length===0&&je({},Dt,zt),Uf(K.charCodeAt(N))&&je({},Dt,zt),{type:Aa,value:parseInt("0x"+t,16),start:e,end:N}}function oee(e){let t="0"+K[N++];for(;N<en&&Bf(K[N]);)t+=K[N++];return(Uf(K.charCodeAt(N))||cs(K.charCodeAt(N)))&&je({},Dt,zt),{type:Aa,value:parseInt(t,8),octal:!0,start:e,end:N}}function f5(){var e,t,n;if(n=K[N],Qp(cs(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=N,e="",n!=="."){if(e=K[N++],n=K[N],e==="0"){if(n==="x"||n==="X")return++N,see(t);if(Bf(n))return oee(t);n&&cs(n.charCodeAt(0))&&je({},Dt,zt)}for(;cs(K.charCodeAt(N));)e+=K[N++];n=K[N]}if(n==="."){for(e+=K[N++];cs(K.charCodeAt(N));)e+=K[N++];n=K[N]}if(n==="e"||n==="E")if(e+=K[N++],n=K[N],(n==="+"||n==="-")&&(e+=K[N++]),cs(K.charCodeAt(N)))for(;cs(K.charCodeAt(N));)e+=K[N++];else je({},Dt,zt);return Uf(K.charCodeAt(N))&&je({},Dt,zt),{type:Aa,value:parseFloat(e),start:t,end:N}}function aee(){var e="",t,n,i,r,s=!1;for(t=K[N],Qp(t==="'"||t==='"',"String literal must starts with a quote"),n=N,++N;N<en;)if(i=K[N++],i===t){t="";break}else if(i==="\\")if(i=K[N++],!i||!zf(i.charCodeAt(0)))switch(i){case"u":case"x":K[N]==="{"?(++N,e+=nee()):e+=mw(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Bf(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),N<en&&Bf(K[N])&&(s=!0,r=r*8+"01234567".indexOf(K[N++]),"0123".indexOf(i)>=0&&N<en&&Bf(K[N])&&(r=r*8+"01234567".indexOf(K[N++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&K[N]===`
`&&++N;else{if(zf(i.charCodeAt(0)))break;e+=i}return t!==""&&je({},Dt,zt),{type:Pf,value:e,octal:s,start:n,end:N}}function uee(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";je({},hw)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{je({},hw)}try{return new RegExp(e,t)}catch{return null}}function lee(){var e,t,n,i,r;for(e=K[N],Qp(e==="/","Regular expression literal must start with a slash"),t=K[N++],n=!1,i=!1;N<en;)if(e=K[N++],t+=e,e==="\\")e=K[N++],zf(e.charCodeAt(0))&&je({},gw),t+=e;else if(zf(e.charCodeAt(0)))je({},gw);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||je({},gw),r=t.substr(1,t.length-2),{value:r,literal:t}}function cee(){var e,t,n;for(t="",n="";N<en&&(e=K[N],!!Jp(e.charCodeAt(0)));)++N,e==="\\"&&N<en?je({},Dt,zt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&je({},hw,n),{value:n,literal:t}}function fee(){var e,t,n,i;return Pe=null,l5(),e=N,t=lee(),n=cee(),i=uee(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:N}}function dee(e){return e.type===_a||e.type===po||e.type===Xp||e.type===Kp}function d5(){if(l5(),N>=en)return{type:Lf,start:N,end:N};const e=K.charCodeAt(N);return Uf(e)?ree():e===40||e===41||e===59?yw():e===39||e===34?aee():e===46?cs(K.charCodeAt(N+1))?f5():yw():cs(e)?f5():yw()}function Bn(){const e=Pe;return N=e.end,Pe=d5(),N=e.end,e}function h5(){const e=N;Pe=d5(),N=e}function hee(e){const t=new Hi(RZ);return t.elements=e,t}function g5(e,t,n){const i=new Hi(e==="||"||e==="&&"?zZ:LZ);return i.operator=e,i.left=t,i.right=n,i}function gee(e,t){const n=new Hi(PZ);return n.callee=e,n.arguments=t,n}function pee(e,t,n){const i=new Hi(IZ);return i.test=e,i.consequent=t,i.alternate=n,i}function bw(e){const t=new Hi(a5);return t.name=e,t}function qf(e){const t=new Hi(BZ);return t.value=e.value,t.raw=K.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function p5(e,t,n){const i=new Hi(UZ);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function mee(e){const t=new Hi(qZ);return t.properties=e,t}function m5(e,t,n){const i=new Hi(WZ);return i.key=t,i.value=n,i.kind=e,i}function yee(e,t){const n=new Hi(HZ);return n.operator=e,n.argument=t,n.prefix=!0,n}function je(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(Qp(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=N,n.description=r,n}function Zp(e){e.type===Lf&&je(e,KZ),e.type===Aa&&je(e,GZ),e.type===Pf&&je(e,YZ),e.type===_a&&je(e,VZ),e.type===po&&je(e,XZ),je(e,Dt,e.value)}function tn(e){const t=Bn();(t.type!==In||t.value!==e)&&Zp(t)}function Xe(e){return Pe.type===In&&Pe.value===e}function vw(e){return Pe.type===po&&Pe.value===e}function bee(){const e=[];for(N=Pe.start,tn("[");!Xe("]");)Xe(",")?(Bn(),e.push(null)):(e.push(Oa()),Xe("]")||tn(","));return Bn(),hee(e)}function y5(){N=Pe.start;const e=Bn();return e.type===Pf||e.type===Aa?(e.octal&&je(e,u5),qf(e)):bw(e.value)}function vee(){var e,t,n,i;if(N=Pe.start,e=Pe,e.type===_a)return n=y5(),tn(":"),i=Oa(),m5("init",n,i);if(e.type===Lf||e.type===In)Zp(e);else return t=y5(),tn(":"),i=Oa(),m5("init",t,i)}function xee(){var e=[],t,n,i,r={},s=String;for(N=Pe.start,tn("{");!Xe("}");)t=vee(),t.key.type===a5?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?je({},QZ):r[i]=!0,e.push(t),Xe("}")||tn(",");return tn("}"),mee(e)}function wee(){tn("(");const e=xw();return tn(")"),e}const Eee={if:1};function _ee(){var e,t,n;if(Xe("("))return wee();if(Xe("["))return bee();if(Xe("{"))return xee();if(e=Pe.type,N=Pe.start,e===_a||Eee[Pe.value])n=bw(Bn().value);else if(e===Pf||e===Aa)Pe.octal&&je(Pe,u5),n=qf(Bn());else{if(e===po)throw new Error(If);e===Xp?(t=Bn(),t.value=t.value==="true",n=qf(t)):e===Kp?(t=Bn(),t.value=null,n=qf(t)):Xe("/")||Xe("/=")?(n=qf(fee()),h5()):Zp(Bn())}return n}function Aee(){const e=[];if(tn("("),!Xe(")"))for(;N<en&&(e.push(Oa()),!Xe(")"));)tn(",");return tn(")"),e}function Oee(){N=Pe.start;const e=Bn();return dee(e)||Zp(e),bw(e.value)}function See(){return tn("."),Oee()}function Cee(){tn("[");const e=xw();return tn("]"),e}function $ee(){var e,t,n;for(e=_ee();;)if(Xe("."))n=See(),e=p5(".",e,n);else if(Xe("("))t=Aee(),e=gee(e,t);else if(Xe("["))n=Cee(),e=p5("[",e,n);else break;return e}function b5(){const e=$ee();if(Pe.type===In&&(Xe("++")||Xe("--")))throw new Error(If);return e}function e0(){var e,t;if(Pe.type!==In&&Pe.type!==po)t=b5();else{if(Xe("++")||Xe("--"))throw new Error(If);if(Xe("+")||Xe("-")||Xe("~")||Xe("!"))e=Bn(),t=e0(),t=yee(e.value,t);else{if(vw("delete")||vw("void")||vw("typeof"))throw new Error(If);t=b5()}}return t}function v5(e){let t=0;if(e.type!==In&&e.type!==po)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function kee(){var e,t,n,i,r,s,o,a,u,l;if(e=Pe,u=e0(),i=Pe,r=v5(i),r===0)return u;for(i.prec=r,Bn(),t=[e,Pe],o=e0(),s=[u,i,o];(r=v5(Pe))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=g5(a,u,o),s.push(n);i=Bn(),i.prec=r,s.push(i),t.push(Pe),n=e0(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=g5(s[l-1].value,s[l-2],n),l-=2;return n}function Oa(){var e,t,n;return e=kee(),Xe("?")&&(Bn(),t=Oa(),tn(":"),n=Oa(),e=pee(e,t,n)),e}function xw(){const e=Oa();if(Xe(","))throw new Error(If);return e}function x5(e){K=e,N=0,en=K.length,Pe=null,h5();const t=xw();if(Pe.type!==Lf)throw new Error("Unexpect token after expression.");return t}var w5={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function E5(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&L("Missing arguments to clamp function."),o.length>3&&L("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&L("Missing arguments to if function."),o.length>3&&L("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Fee(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function _5(e){e=e||{};const t=e.allowed?Ti(e.allowed):{},n=e.forbidden?Ti(e.forbidden):{},i=e.constants||w5,r=(e.functions||E5)(f),s=e.globalvar,o=e.fieldvar,a=ye(s)?s:g=>`${s}["${g}"]`;let u={},l={},c=0;function f(g){if(Se(g))return g;const p=d[g.type];return p==null&&L("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:ue(n,p)?L("Illegal identifier: "+p):ue(i,p)?i[p]:ue(t,p)?p:(u[p]=1,a(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===o&&(l[Fee(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&L("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=ue(r,p)&&r[p];return y||L("Unrecognized function: "+p),ye(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=r,h.constants=i,h}function Dee(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function jee(e){let t=e,n=e;e.length===1&&(t=(o,a)=>e(o)-a,n=Mee(e));function i(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)<0?u=c+1:l=c}return u}function r(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)>0?l=c:u=c+1}return u}function s(o,a,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=i(o,a,u,l-1);return c>u&&t(o[c-1],a)>-t(o[c],a)?c-1:c}return{left:i,center:s,right:r}}function Mee(e){return(t,n)=>Dee(e(t),n)}const ww="intersect",A5="union",Tee="vlMulti",Nee="vlPoint",O5="or",Ree="and",Lee="_vgsid_",Pee="E",Iee="R",Bee="R-E",zee="R-LE",Uee="R-RE",t0="index:unit";function S5(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],a.getter=Dn.getter||Dn(a.field),o=a.getter(e),js(o)&&(o=Gt(o)),js(i[s])&&(i[s]=Gt(i[s])),js(i[s][0])&&(i[s]=i[s].map(Gt)),a.type===Pee){if(Z(i[s])?i[s].indexOf(o)<0:o!==i[s])return!1}else if(a.type===Iee){if(!yu(o,i[s]))return!1}else if(a.type===Uee){if(!yu(o,i[s],!0,!1))return!1}else if(a.type===Bee){if(!yu(o,i[s],!1,!1))return!1}else if(a.type===zee&&!yu(o,i[s],!1,!0))return!1;return!0}function qee(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[t0]&&i[t0].value:void 0,o=n===ww,a=r.length,u=0,l,c,f,d,h;u<a;++u)if(l=r[u],s&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=S5(t,l),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=S5(t,l),o^h)return h;return a&&o}const Ew=Dn(Lee),C5=jee(Ew),Wee=C5.left,Hee=C5.right;function Gee(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[t0]&&i[t0].value:void 0,o=n===ww,a=Ew(t),u=Wee(r,a);if(u===r.length||Ew(r[u])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(Hee(r,a)-u<s.size)return!1}return!0}function Yee(e,t){return e.map(n=>pe({values:t.fields.map(i=>(i.getter||(i.getter=Dn(i.field)))(n.datum))},t))}function Vee(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},u={},l,c,f,d,h,g,p,m,y,b=s.length,x=0,w,_;x<b;++x){for(l=s[x],d=l.unit,c=l.fields,f=l.values,w=0,_=c.length;w<_;++w)h=c[w],g=o[h.field]||(o[h.field]={}),p=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),y=$5[m+"_union"],g[d]=y(p,ae(f[w]));n&&(p=a[d]||(a[d]=[]),p.push(ae(f).reduce((A,E,S)=>(A[c[S].field]=E,A),{})))}if(t=t||A5,Object.keys(o).forEach(A=>{o[A]=Object.keys(o[A]).map(E=>o[A][E]).reduce((E,S)=>E===void 0?S:$5[u[A]+"_"+t](E,S))}),s=Object.keys(a),n&&s.length){const A=i?Nee:Tee;o[A]=t===A5?{[O5]:s.reduce((E,S)=>(E.push(...a[S]),E),[])}:{[Ree]:s.map(E=>({[O5]:a[E]}))}}return o}var $5={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Gt(t[0]),i=Gt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Gt(t[0]),i=Gt(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const Xee=":",Kee="@";function _w(e,t,n,i){t[0].type!==Ea&&L("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&Ee(t).value,o="unit",a=Kee+o,u=Xee+r;s===ww&&!ue(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),ue(i,u)||(i[u]=n.getData(r).tuplesRef())}function k5(e){const t=this.context.data[e];return t?t.values.value:[]}function Qee(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Jee(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(fi).insert(t)),1}function Zee(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const Wf=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},ete=Wf("format"),F5=Wf("timeFormat"),tte=Wf("utcFormat"),nte=Wf("timeParse"),ite=Wf("utcParse"),n0=new Date(2e3,0,1);function i0(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(n0.setYear(2e3),n0.setMonth(e),n0.setDate(t),F5.call(this,n0,n))}function rte(e){return i0.call(this,e,1,"%B")}function ste(e){return i0.call(this,e,1,"%b")}function ote(e){return i0.call(this,0,2+e,"%A")}function ate(e){return i0.call(this,0,2+e,"%a")}const ute=":",lte="@",Aw="%",D5="$";function Ow(e,t,n,i){t[0].type!==Ea&&L("First argument to data functions must be a string literal.");const r=t[0].value,s=ute+r;if(!ue(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function cte(e,t,n,i){t[0].type!==Ea&&L("First argument to indata must be a string literal."),t[1].type!==Ea&&L("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=lte+s;ue(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function zn(e,t,n,i){if(t[0].type===Ea)j5(n,i,t[0].value);else for(e in n.scales)j5(n,i,e)}function j5(e,t,n){const i=Aw+n;if(!ue(t,i))try{t[i]=e.scaleRef(n)}catch{}}function fs(e,t){let n;return ye(e)?e:Se(e)?(n=t.scales[e])&&n.value:void 0}function fte(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=zn,n._range=zn,n._scale=zn;const i=r=>"_["+(r.type===Ea?ie(Aw+r.value):ie(Aw)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function Sw(e,t){return function(n,i,r){if(n){const s=fs(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const dte=Sw("area",TV),hte=Sw("bounds",PV),gte=Sw("centroid",WV);function pte(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function Cw(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function mte(){return Cw(this.context.dataflow,"warn",arguments)}function yte(){return Cw(this.context.dataflow,"info",arguments)}function bte(){return Cw(this.context.dataflow,"debug",arguments)}function $w(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function kw(e){const t=Vs(e),n=$w(t.r),i=$w(t.g),r=$w(t.b);return .2126*n+.7152*i+.0722*r}function vte(e,t){const n=kw(e),i=kw(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function xte(){const e=[].slice.call(arguments);return e.unshift({}),pe(...e)}function M5(e,t){return e===t||e!==e&&t!==t?!0:Z(e)?Z(t)&&e.length===t.length?wte(e,t):!1:fe(e)&&fe(t)?T5(e,t):!1}function wte(e,t){for(let n=0,i=e.length;n<i;++n)if(!M5(e[n],t[n]))return!1;return!0}function T5(e,t){for(const n in e)if(!M5(e[n],t[n]))return!1;return!0}function N5(e){return t=>T5(e,t)}function Ete(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],u=a.input,l=o.stamp();let c=a.changes,f,d;if(o._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(a.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{a.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?fi:Z(n)||Th(n)?n:N5(n),c.remove(f)),t&&c.insert(t),i&&(f=N5(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in s)c.modify(r,d,s[d]);return 1}function _te(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function Ate(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const R5={};function Ote(e,t){const n=R5[t]||(R5[t]=Dn(t));return Z(e)?e.map(n):n(e)}function Fw(e){return Z(e)||ArrayBuffer.isView(e)?e:null}function Dw(e){return Fw(e)||(Se(e)?e:null)}function Ste(e,...t){return Fw(e).join(...t)}function Cte(e,...t){return Dw(e).indexOf(...t)}function $te(e,...t){return Dw(e).lastIndexOf(...t)}function kte(e,...t){return Dw(e).slice(...t)}function Fte(e,t,n){return ye(n)&&L("Function argument passed to replace."),String(e).replace(t,n)}function Dte(e){return Fw(e).slice().reverse()}function jte(e,t,n){return lv(e||0,t||0,n||0)}function Mte(e,t){const n=fs(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Tte(e,t){const n=fs(e,(t||this).context);return n?n.copy():void 0}function Nte(e,t){const n=fs(e,(t||this).context);return n?n.domain():[]}function Rte(e,t,n){const i=fs(e,(n||this).context);return i?Z(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function Lte(e,t){const n=fs(e,(t||this).context);return n&&n.range?n.range():[]}function Pte(e,t,n){const i=fs(e,(n||this).context);return i?i(t):void 0}function Ite(e,t,n,i,r){e=fs(e,(r||this).context);const s=qF(t,n);let o=e.domain(),a=o[0],u=Ee(o),l=dn;return u-a?l=$F(e,a,u):e=(e.interpolator?De("sequential")().interpolator(e.interpolator()):De("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),u!==Ee(o)&&o.push(u)),o.forEach(c=>s.stop(l(c),e(c))),s}function Bte(e,t,n){const i=fs(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function zte(e){let t=null;return function(n){return n?Gc(n,t=t||Bu(e)):e}}const L5=e=>e.data;function P5(e,t){const n=k5.call(t,e);return n.root&&n.root.lookup||{}}function Ute(e,t,n){const i=P5(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(L5):void 0}function qte(e,t){const n=P5(e,this)[t];return n?n.ancestors().map(L5):void 0}const I5=()=>typeof window!="undefined"&&window||null;function Wte(){const e=I5();return e?e.screen:{}}function Hte(){const e=I5();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Gte(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Yte(e,t,n){if(!e)return[];const[i,r]=e,s=new wt().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return i3(o,s,Vte(t))}function Vte(e){let t=null;if(e){const n=ae(e.marktype),i=ae(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}const Hf={random(){return gi()},cumulativeNormal:Uh,cumulativeLogNormal:qy,cumulativeUniform:Yy,densityNormal:Py,densityLogNormal:Uy,densityUniform:Gy,quantileNormal:qh,quantileLogNormal:Wy,quantileUniform:Vy,sampleNormal:zh,sampleLogNormal:zy,sampleUniform:Hy,isArray:Z,isBoolean:R1,isDate:js,isDefined(e){return e!==void 0},isNumber:Ms,isObject:fe,isRegExp:aS,isString:Se,isTuple:Th,isValid(e){return e!=null&&e===e},toBoolean:P1,toDate:I1,toNumber:Gt,toString:B1,indexof:Cte,join:Ste,lastindexof:$te,replace:Fte,reverse:Dte,slice:kte,flush:sS,lerp:uS,merge:xte,pad:fS,peek:Ee,pluck:Ote,span:oc,inrange:yu,truncate:dS,rgb:Vs,lab:rg,hcl:sg,hsl:ng,luminance:kw,contrast:vte,sequence:Jn,format:ete,utcFormat:tte,utcParse:ite,utcOffset:JS,utcSequence:tC,timeFormat:F5,timeParse:nte,timeOffset:QS,timeSequence:eC,timeUnitSpecifier:BS,monthFormat:rte,monthAbbrevFormat:ste,dayFormat:ote,dayAbbrevFormat:ate,quarter:tS,utcquarter:nS,week:US,utcweek:HS,dayofyear:zS,utcdayofyear:WS,warn:mte,info:yte,debug:bte,extent:ar,inScope:pte,intersect:Yte,clampRange:iS,pinchDistance:_te,pinchAngle:Ate,screen:Wte,containerSize:Gte,windowSize:Hte,bandspace:jte,setdata:Jee,pathShape:zte,panLinear:QO,panLog:JO,panPow:ZO,panSymlog:eS,zoomLinear:D1,zoomLog:j1,zoomPow:bh,zoomSymlog:M1,encode:Zee,modify:Ete},Xte=["view","item","group","xy","x","y"],Kte="event.vega.",B5="this.",jw={},z5={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ie(D5+e)}]`,functions:Qte,constants:w5,visitors:jw},Mw=_5(z5);function Qte(e){const t=E5(e);Xte.forEach(n=>t[n]=Kte+n);for(const n in Hf)t[n]=B5+n;return pe(t,fte(e,Hf,jw)),t}function gt(e,t,n){return arguments.length===1?Hf[e]:(Hf[e]=t,n&&(jw[e]=n),Mw&&(Mw.functions[e]=B5+e),this)}gt("bandwidth",Mte,zn);gt("copy",Tte,zn);gt("domain",Nte,zn);gt("range",Lte,zn);gt("invert",Rte,zn);gt("scale",Pte,zn);gt("gradient",Ite,zn);gt("geoArea",dte,zn);gt("geoBounds",hte,zn);gt("geoCentroid",gte,zn);gt("geoShape",Bte,zn);gt("indata",Qee,cte);gt("data",k5,Ow);gt("treePath",Ute,Ow);gt("treeAncestors",qte,Ow);gt("vlSelectionTest",qee,_w);gt("vlSelectionIdTest",Gee,_w);gt("vlSelectionResolve",Vee,_w);gt("vlSelectionTuples",Yee);function Sr(e,t){const n={};let i;try{e=Se(e)?e:ie(e)+"",i=x5(e)}catch{L("Expression parse error: "+e)}i.visit(s=>{if(s.type!==o5)return;const o=s.callee.name,a=z5.visitors[o];a&&a(o,s.arguments,t,n)});const r=Mw(i);return r.globals.forEach(s=>{const o=D5+s;!ue(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:pe({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function Jte(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const Zte=Ti(["rule"]),U5=Ti(["group","image","rect"]);function ene(e,t){let n="";return Zte[t]||(e.x2&&(e.x?(U5[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(U5[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Tw(e){return(e+"").toLowerCase()}function tne(e){return Tw(e)==="operator"}function nne(e){return Tw(e)==="collect"}function Gf(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function ine(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var rne={operator:(e,t)=>Gf(e,["_"],t.code),parameter:(e,t)=>Gf(e,["datum","_"],t.code),event:(e,t)=>Gf(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Gf(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+ie(s)+"]";r+="$=".concat(i[s].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return r+=ene(i,n),r+="return m;",Gf(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(ie).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let u,l;return s.path?(u="a".concat(s.path),l="b".concat(s.path)):((n=n||{})["f"+o]=s,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),ine(u,l,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function sne(e){const t=this;tne(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function one(e){const t=this;if(e.params){const n=t.get(e.id);n||L("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function ane(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Z(r)?r.map(s=>q5(s,n,t)):q5(r,n,t)}return t}function q5(e,t,n){if(!e||!fe(e))return e;for(let i=0,r=W5.length,s;i<r;++i)if(s=W5[i],ue(e,s.key))return s.parse(e,t,n);return e}var W5=[{key:"$ref",parse:une},{key:"$key",parse:cne},{key:"$expr",parse:lne},{key:"$field",parse:fne},{key:"$encode",parse:hne},{key:"$compare",parse:dne},{key:"$context",parse:gne},{key:"$subflow",parse:pne},{key:"$tupleid",parse:mne}];function une(e,t){return t.get(e.$ref)||L("Operator not defined: "+e.$ref)}function lne(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=Fn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function cne(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=L1(e.$key,e.$flat,t.expr.codegen))}function fne(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Dn(e.$field,e.$name,t.expr.codegen))}function dne(e,t){const n="c:"+e.$compare+"_"+e.$order,i=ae(e.$compare).map(r=>r&&r.$tupleid?ee:r);return t.fn[n]||(t.fn[n]=T1(i,e.$order,t.expr.codegen))}function hne(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=Fn(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function gne(e,t){return t}function pne(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a.detachSubflow=()=>t.detach(o),a}}function mne(){return ee}function yne(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&L("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function bne(e){var t=this,n=fe(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||L("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const vne={skip:!0};function xne(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function wne(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],vne)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(fi).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function H5(e,t,n,i){return new G5(e,t,n,i)}function G5(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||rne,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Y5(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}G5.prototype=Y5.prototype={fork(){const e=new Y5(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),nne(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Tw(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Jte,parseOperator:sne,parseOperatorParameters:one,parseParameters:ane,parseStream:yne,parseUpdate:bne,getState:xne,setState:wne};function Ene(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),V5(t,e.description()))}function V5(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function _ne(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Nw="default";function Ane(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Nw,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,s=r?Se(r)?r:r.user:Nw,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return Se(i)||(r=i.item,i=i.user),Rw(e,i&&i!==Nw?i:r||i),r},{cursor:t})}function Rw(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function r0(e,t){var n=e._runtime.data;return ue(n,t)||L("Unrecognized data set: "+t),n[t]}function One(e,t){return arguments.length<2?r0(this,e).values.value:s0.call(this,e,ea().remove(fi).insert(t))}function s0(e,t){qC(t)||L("Second argument to changes must be a changeset.");const n=r0(this,e);return n.modified=!0,this.pulse(n.input,t)}function Sne(e,t){return s0.call(this,e,ea().insert(t))}function Cne(e,t){return s0.call(this,e,ea().remove(t))}function X5(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function K5(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function o0(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function $ne(e){var t=o0(e),n=X5(e),i=K5(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function kne(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=o0(e),o=t.changedTouches?t.changedTouches[0]:t,s=Lg(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=Fne(e,n,s),t}function Fne(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;Se(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Yt(e),item:Yt(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const Q5="view",Dne="timer",jne="window",Mne={trap:!1};function Tne(e){const t=pe({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{Z(i[s])&&(i[s]=Ti(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function J5(e,t,n,i){e._eventListeners.push({type:n,sources:ae(t),handler:i})}function Nne(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function a0(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||fe(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Rne(e,t,n){var i=this,r=new Ph(n),s=function(l,c){i.runAsync(null,()=>{e===Q5&&Nne(i,t)&&l.preventDefault(),r.receive(kne(i,l,c))})},o;if(e===Dne)a0(i,"timer",t)&&i.timer(s,t);else if(e===Q5)a0(i,"view",t)&&i.addEventListener(t,s,Mne);else if(e===jne?a0(i,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&a0(i,"selector",t)&&(o=document.querySelectorAll(e)),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);J5(i,o,t,s)}return r}function Z5(e){return e.item}function eT(e){return e.item.mark.source}function tT(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Lne(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Z5),eT,tT(e)),this.on(this.events("view","mouseout",Z5),eT,tT(t)),this}function Pne(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,s;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(s=n[i],r=s.sources.length;--r>=0;)s.sources[r].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function ri(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const Ine="vega-bind",Bne="vega-bind-name",zne="vega-bind-radio";function Une(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=N1(i.debounce,r.update))),(i.input==null&&i.element?qne:Hne)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function qne(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),J5(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(Wne(r))}}function Wne(e){return typeof Event!="undefined"?new Event(e):{type:e}}function Hne(e,t,n,i){const r=i.signal(n.signal),s=ri("div",{class:Ine}),o=n.input==="radio"?s:s.appendChild(ri("label"));o.appendChild(ri("span",{class:Bne},n.name||n.signal)),t.appendChild(s);let a=Gne;switch(n.input){case"checkbox":a=Yne;break;case"select":a=Vne;break;case"radio":a=Xne;break;case"range":a=Kne;break}a(e,o,n,r)}function Gne(e,t,n,i){const r=ri("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function Yne(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=ri("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function Vne(e,t,n,i){const r=ri("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const u={value:o};u0(o,i)&&(u.selected=!0),r.appendChild(ri("option",u,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,u=n.options.length;a<u;++a)if(u0(n.options[a],o)){r.selectedIndex=a;return}}}function Xne(e,t,n,i){const r=ri("span",{class:zne}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const u={type:"radio",name:n.signal,value:o};u0(o,i)&&(u.checked=!0);const l=ri("input",u);l.addEventListener("change",()=>e.update(o));const c=ri("label",{},(s[a]||o)+"");return c.prepend(l),r.appendChild(c),l}),e.set=o=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)u0(a[l].value,o)&&(a[l].checked=!0)}}function Kne(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Ns(s,r,100),a=ri("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const u=ri("span",{},+i);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function u0(e,t){return e===t||e+""==t+""}function nT(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,X5(e),K5(e),o0(e),r,s).background(e.background())}function Lw(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Qne(e,t,n,i){const r=new i(e.loader(),Lw(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,o0(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function Jne(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=Gg(i);e=n._el=e?Pw(n,e,!0):null,Ene(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||af,a=e?s.renderer:s.headless;return n._renderer=a?nT(n,n._renderer,e,a):null,n._handler=Qne(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=Pw(n,t,!0):e.appendChild(ri("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=Pw(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Une(n,u.element||t,u)})),n}function Pw(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(i){t=null,e.error(i)}return t}const Yf=e=>+e||0,Zne=e=>({top:e,bottom:e,left:e,right:e});function iT(e){return fe(e)?{top:Yf(e.top),bottom:Yf(e.bottom),left:Yf(e.left),right:Yf(e.right)}:Zne(Yf(e))}async function Iw(e,t,n,i){const r=Gg(t),s=r&&r.headless;return s||L("Unrecognized renderer type: "+t),await e.runAsync(),nT(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function eie(e,t){e!==oo.Canvas&&e!==oo.SVG&&e!==oo.PNG&&L("Unrecognized image type: "+e);const n=await Iw(this,e,t);return e===oo.SVG?tie(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function tie(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function nie(e,t){return(await Iw(this,oo.Canvas,e,t)).canvas()}async function iie(e){return(await Iw(this,oo.SVG,e)).svg()}function rie(e,t,n){return H5(e,Cu,Hf,n).parse(t)}function sie(e){var t=this._runtime.scales;return ue(t,e)||L("Unrecognized scale or projection: "+e),t[e].value}var rT="width",sT="height",Bw="padding",oT={skip:!0};function aT(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Bw?i.left+i.right:0)}function uT(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===Bw?i.top+i.bottom:0)}function oie(e){var t=e._signals,n=t[rT],i=t[sT],r=t[Bw];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=aT(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=uT(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function aie(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(rT,n,oT),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(sT,i,oT),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(u=>u.resize())},!1,1)}function uie(e){return this._runtime.getState(e||{data:lie,signals:cie,recurse:!0})}function lie(e,t){return t.modified&&Z(t.input.value)&&e.indexOf("_:vega:_")}function cie(e,t){return!(e==="parent"||t instanceof Cu.proxy)}function fie(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function die(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(HK(n,t))}function hie(e,t,n,i){const r=e.element();r&&r.setAttribute("title",gie(i))}function gie(e){return e==null?"":Z(e)?lT(e):fe(e)&&!js(e)?pie(e):e+""}function pie(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Z(n)?lT(n):cT(n))}).join(`
`)}function lT(e){return"["+e.map(cT).join(", ")+"]"}function cT(e){return Z(e)?"[\u2026]":fe(e)&&!js(e)?"{\u2026}":e}function fT(e,t){const n=this;if(t=t||{},Su.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=pe({},e.locale,t.locale);n.locale(DC(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||oo.Canvas,n._scenegraph=new Zv;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||hie,n._redraw=!0,n._handler=new af().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Tne(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=rie(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:pe({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=aT(n,n._width),n._viewHeight=uT(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,oie(n),_ne(n),Ane(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function l0(e,t){return ue(e._signals,t)?e._signals[t]:L("Unrecognized signal name: "+ie(t))}function dT(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function hT(e,t,n,i){let r=dT(n,i);return r||(r=Lw(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function gT(e,t,n){const i=dT(t,n);return i&&t._targets.remove(i),e}W(fT,Su,{async evaluate(e,t,n){if(await Su.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,$ne(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Mh(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&V5(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=l0(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",iT(e)):iT(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Gg(e)||L("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Su.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(l0(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:aie,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=Lw(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return hT(this,e,l0(this,e),t)},removeSignalListener(e,t){return gT(this,l0(this,e),t)},addDataListener(e,t){return hT(this,e,r0(this,e).values,t)},removeDataListener(e,t){return gT(this,r0(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=Rw(this,null);this._globalCursor=!!e,t&&Rw(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:die,events:Rne,finalize:Pne,hover:Lne,data:One,change:s0,insert:Sne,remove:Cne,scale:sie,initialize:Jne,toImageURL:eie,toCanvas:nie,toSVG:iie,getState:uie,setState:fie});const mie="view",c0="[",f0="]",pT="{",mT="}",yie=":",yT=",",bie="@",vie=">",xie=/[[\]{}]/,wie={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let bT,vT;function xT(e,t,n){return bT=t||mie,vT=n||wie,wT(e.trim()).map(zw)}function Eie(e){return vT[e]}function Vf(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function wT(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Vf(e,r,yT,c0+pT,f0+mT),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function zw(e){return e[0]==="["?_ie(e):Aie(e)}function _ie(e){const t=e.length;let n=1,i;if(n=Vf(e,n,f0,c0,f0),n===t)throw"Empty between selector: "+e;if(i=wT(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==vie)throw"Expected '>' after between selector: "+e;i=i.map(zw);const r=zw(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function Aie(e){const t={source:bT},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===mT){if(a=e.lastIndexOf(pT),a>=0){try{i=Oie(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===bie&&(r=++a),u=Vf(e,a,yie),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=Vf(e,a,c0),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Vf(e,a,f0),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==c0)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||xie.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):Eie(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Oie(e){const t=e.split(yT);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function Sie(e){return fe(e)?e:{type:e||"pad"}}const Xf=e=>+e||0,Cie=e=>({top:e,bottom:e,left:e,right:e});function $ie(e){return fe(e)?e.signal?e:{top:Xf(e.top),bottom:Xf(e.bottom),left:Xf(e.left),right:Xf(e.right)}:Cie(Xf(e))}const jt=e=>fe(e)&&!Z(e)?pe({},e):{value:e};function ET(e,t,n,i){return n!=null?(fe(n)&&!Z(n)||Z(n)&&n.length&&fe(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function Ut(e,t,n){for(const i in t)ET(e,i,t[i]);for(const i in n)ET(e,i,n[i],"update")}function ul(e,t,n){for(const i in t)n&&ue(n,i)||(e[i]=pe(e[i]||{},t[i]));return e}function ll(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const Uw="mark",qw="frame",Ww="scope",kie="axis",Fie="axis-domain",Die="axis-grid",jie="axis-label",Mie="axis-tick",Tie="axis-title",Nie="legend",Rie="legend-band",Lie="legend-entry",Pie="legend-gradient",_T="legend-label",Iie="legend-symbol",Bie="legend-title",zie="title",Uie="title-text",qie="title-subtitle";function Wie(e,t,n,i,r){const s={},o={};let a,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!ll(u,e)&&Hw(s,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===qw?r.group:n===Uw?pe({},r.mark,r[t]):null;for(u in c)l=ll(u,e)||(u==="fill"||u==="stroke")&&(ll("fill",e)||ll("stroke",e)),l||Hw(s,u,c[u]);ae(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)ll(h,e)||Hw(s,h,d[h])}),e=pe({},e);for(u in s)c=s[u],c.signal?(a=a||{})[u]=c:o[u]=c;return e.enter=pe(o,e.enter),a&&(e.update=pe(a,e.update)),e}function Hw(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const AT=e=>Se(e)?ie(e):e.signal?`(${e.signal})`:OT(e);function d0(e){if(e.gradient!=null)return Gie(e);let t=e.signal?`(${e.signal})`:e.color?Hie(e.color):e.field!=null?OT(e.field):e.value!==void 0?ie(e.value):void 0;return e.scale!=null&&(t=Yie(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${g0(e.exponent)})`),e.mult!=null&&(t+=`*${g0(e.mult)}`),e.offset!=null&&(t+=`+${g0(e.offset)}`),e.round&&(t=`round(${t})`),t}const h0=(e,t,n,i)=>`(${e}(${[t,n,i].map(d0).join(",")})+'')`;function Hie(e){return e.c?h0("hcl",e.h,e.c,e.l):e.h||e.s?h0("hsl",e.h,e.s,e.l):e.l||e.a?h0("lab",e.l,e.a,e.b):e.r||e.g||e.b?h0("rgb",e.r,e.g,e.b):null}function Gie(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ie(n));for(;t.length&&Ee(t)==null;)t.pop();return t.unshift(AT(e.gradient)),`gradient(${t.join(",")})`}function g0(e){return fe(e)?"("+d0(e)+")":e}function OT(e){return ST(fe(e)?e:{datum:e})}function ST(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):L("Invalid field reference: "+ie(e));return e.signal||(i=Se(i)?hh(i).map(ie).join("]["):ST(i)),t+"["+i+"]"}function Yie(e,t){const n=AT(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+g0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Vie(e){let t="";return e.forEach(n=>{const i=d0(n);t+=n.test?`(${n.test})?${i}:`:i}),Ee(t)===":"&&(t+="null"),t}function CT(e,t,n,i,r,s){const o={};s=s||{},s.encoders={$encode:o},e=Wie(e,t,n,i,r.config);for(const a in e)o[a]=Xie(e[a],t,s,r);return s}function Xie(e,t,n,i){const r={},s={};for(const o in e)e[o]!=null&&(r[o]=Qie(Kie(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function Kie(e){return Z(e)?Vie(e):d0(e)}function Qie(e,t,n,i){const r=Sr(e,t);return r.$fields.forEach(s=>i[s]=1),pe(n,r.$params),r.$expr}const Jie="outer",Zie=["value","update","init","react","bind"];function $T(e,t){L(e+' for "outer" push: '+ie(t))}function kT(e,t){const n=e.name;if(e.push===Jie)t.signals[n]||$T("No prior signal definition",n),Zie.forEach(i=>{e[i]!==void 0&&$T("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function Gw(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function p0(e,t,n,i){return new Gw(e,t,n,i)}function m0(e,t){return p0("operator",e,t)}function ne(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Kf(e,t){return t?{$field:e,$name:t}:{$field:e}}const Yw=Kf("key");function FT(e,t){return{$compare:e,$order:t}}function ere(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const tre="ascending",nre="descending";function ire(e){return fe(e)?(e.order===nre?"-":"+")+y0(e.op,e.field):""}function y0(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const Vw="scope",Xw="view";function _t(e){return e&&e.signal}function rre(e){return e&&e.expr}function b0(e){if(_t(e))return!0;if(fe(e)){for(const t in e)if(b0(e[t]))return!0}return!1}function Gi(e,t){return e!=null?e:t}function Sa(e){return e&&e.signal||e}const DT="timer";function Qf(e,t){return(e.merge?ore:e.stream?are:e.type?ure:L("Invalid stream specification: "+ie(e)))(e,t)}function sre(e){return e===Vw?Xw:e||Xw}function ore(e,t){const n=e.merge.map(r=>Qf(r,t)),i=Kw({merge:n},e,t);return t.addStream(i).id}function are(e,t){const n=Qf(e.stream,t),i=Kw({stream:n},e,t);return t.addStream(i).id}function ure(e,t){let n;e.type===DT?(n=t.event(DT,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(sre(e.source),e.type);const i=Kw({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function Kw(e,t,n){let i=t.between;return i&&(i.length!==2&&L('Stream "between" parameter must have 2 entries: '+ie(t)),e.between=[Qf(i[0],n),Qf(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(lre(t.marktype,t.markname,t.markrole)),t.source===Vw&&i.push("inScope(event.item)"),i.length&&(e.filter=Sr("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function lre(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const cre={code:"_.$value",ast:{type:"Identifier",value:"value"}};function fre(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||L("Signal update missing events specification."),Se(s)&&(s=xT(s,t.isSubscope()?Vw:Xw)),s=ae(s).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[hre(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),i!=null&&(o&&L("Signal encode and update are mutually exclusive."),o="encode(item(),"+ie(i)+")"),r.update=Se(o)?Sr(o,t):o.expr!=null?Sr(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:cre,$params:{$value:t.signalRef(o.signal)}}:L("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(u=>t.addUpdate(pe(dre(u,t),r)))}function dre(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Qf(e,t)}}function hre(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function gre(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?L("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Sr(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>fre(r,t,n.id))}const Be=e=>(t,n,i)=>p0(e,n,t||void 0,i),jT=Be("aggregate"),pre=Be("axisticks"),MT=Be("bound"),Yi=Be("collect"),TT=Be("compare"),mre=Be("datajoin"),NT=Be("encode"),yre=Be("expression"),bre=Be("facet"),vre=Be("field"),xre=Be("key"),wre=Be("legendentries"),Ere=Be("load"),_re=Be("mark"),Are=Be("multiextent"),Ore=Be("multivalues"),Sre=Be("overlap"),Cre=Be("params"),RT=Be("prefacet"),$re=Be("projection"),kre=Be("proxy"),Fre=Be("relay"),LT=Be("render"),Dre=Be("scale"),Ca=Be("sieve"),jre=Be("sortitems"),PT=Be("viewlayout"),Mre=Be("values");let Tre=0;const IT={min:"min",max:"max",count:"sum"};function Nre(e,t){const n=e.type||"linear";EF(n)||L("Unrecognized scale type: "+ie(n)),t.addScale(e.name,{type:n,domain:void 0})}function Rre(e,t){const n=t.getScale(e.name).params;let i;n.domain=BT(e.domain,e,t),e.range!=null&&(n.range=UT(e,t,n)),e.interpolate!=null&&Gre(e.interpolate,n),e.nice!=null&&(n.nice=Hre(e.nice)),e.bins!=null&&(n.bins=Wre(e.bins,t));for(i in e)ue(n,i)||i==="name"||(n[i]=vi(e[i],t))}function vi(e,t){return fe(e)?e.signal?t.signalRef(e.signal):L("Unsupported object: "+ie(e)):e}function v0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>vi(n,t))}function x0(e){L("Can not find data set: "+ie(e))}function BT(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&L("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Z(e)?Lre:e.fields?Ire:Pre)(e,t,n)}function Lre(e,t,n){return e.map(i=>vi(i,n))}function Pre(e,t,n){const i=n.getData(e.data);return i||x0(e.data),Iu(t.type)?i.valuesRef(n,e.field,zT(e.sort,!1)):OF(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function Ire(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=Se(o)?{data:i,field:o}:Z(o)||o.signal?Bre(o,n):o,s.push(o),s),[]);return(Iu(t.type)?zre:OF(t.type)?Ure:qre)(e,n,r)}function Bre(e,t){const n="_:vega:_"+Tre++,i=Yi({});if(Z(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+ie(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Ca({})]),{data:n,field:"data"}}function zre(e,t,n){const i=zT(e.sort,!0);let r,s;const o=n.map(l=>{const c=t.getData(l.data);return c||x0(l.data),c.countsRef(t,l.field,i)}),a={groupby:Yw,pulse:o};i&&(r=i.op||"count",s=i.field?y0(r,i.field):"count",a.ops=[IT[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(jT(a));const u=t.add(Yi({pulse:ne(r)}));return s=t.add(Mre({field:Yw,sort:t.sortRef(i),pulse:ne(u)})),ne(s)}function zT(e,t){return e&&(!e.field&&!e.op?fe(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?L("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!IT[e.op]&&L("Multiple domain scales can not be sorted using "+e.op)),e}function Ure(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||x0(r.data),s.domainRef(t,r.field)});return ne(t.add(Ore({values:i})))}function qre(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||x0(r.data),s.extentRef(t,r.field)});return ne(t.add(Are({extents:i})))}function Wre(e,t){return e.signal||Z(e)?v0(e,t):t.objectProperty(e)}function Hre(e){return fe(e)?{interval:vi(e.interval),step:vi(e.step)}:vi(e)}function Gre(e,t){t.interpolate=vi(e.type||e),e.gamma!=null&&(t.interpolateGamma=vi(e.gamma))}function UT(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(Se(r)){if(i&&ue(i,r))return e=pe({},e,{range:i[r]}),UT(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Iu(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:L("Unrecognized scale range value: "+ie(r))}else if(r.scheme){n.scheme=Z(r.scheme)?v0(r.scheme,t):vi(r.scheme,t),r.extent&&(n.schemeExtent=v0(r.extent,t)),r.count&&(n.schemeCount=vi(r.count,t));return}else if(r.step){n.rangeStep=vi(r.step,t);return}else{if(Iu(e.type)&&!Z(r))return BT(r,e,t);Z(r)||L("Unsupported range type: "+ie(r))}return r.map(s=>(Z(s)?v0:vi)(s,t))}function Yre(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=Qw(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=Qw(n[r],r,t));t.addProjection(e.name,i)}function Qw(e,t,n){return Z(e)?e.map(i=>Qw(i,t,n)):fe(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:L("Unsupported parameter object: "+ie(e)):e}const Vi="top",cl="left",fl="right",mo="bottom",qT="center",Vre="vertical",Xre="start",Kre="middle",Qre="end",Jw="index",Zw="label",Jre="offset",dl="perc",Zre="perc2",xi="value",Jf="guide-label",eE="guide-title",ese="group-title",tse="group-subtitle",WT="symbol",w0="gradient",tE="discrete",nE="size",nse="shape",ise="fill",rse="stroke",sse="strokeWidth",ose="strokeDash",ase="opacity",iE=[nE,nse,ise,rse,sse,ose,ase],Zf={name:1,style:1,interactive:1},Oe={value:0},wi={value:1},E0="group",HT="rect",rE="rule",use="symbol",$a="text";function ed(e){return e.type=E0,e.interactive=e.interactive||!1,e}function Un(e,t){const n=(i,r)=>Gi(e[i],Gi(t[i],r));return n.isVertical=i=>Vre===Gi(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Gi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Gi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Gi(e.columns,Gi(t.columns,+n.isVertical(!0))),n}function GT(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function lse(e,t,n){const i=t.config.style[n];return i&&i[e]}function _0(e,t,n){return`item.anchor === '${Xre}' ? ${e} : item.anchor === '${Qre}' ? ${t} : ${n}`}const sE=_0(ie(cl),ie(fl),ie(qT));function cse(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},fe(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function YT(e,t){return t?e?fe(e)?Object.assign({},e,{offset:YT(e.offset,t)}):{value:e,offset:t}:t:e}function si(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=ul(e.encode,t,Zf)):e.interactive=!1,e}function fse(e,t,n,i){const r=Un(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let u,l,c,f,d;s?(l=[0,1],c=[0,0],f=o,d=a):(l=[0,0],c=[1,0],f=a,d=o);const h={enter:u={opacity:Oe,x:Oe,y:Oe,width:jt(f),height:jt(d)},update:pe({},u,{opacity:wi,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Oe}};return Ut(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),si({type:HT,role:Pie,encode:h},i)}function dse(e,t,n,i,r){const s=Un(e,n),o=s.isVertical(),a=s.gradientThickness(),u=s.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:Oe,fill:{scale:t,field:xi}};g[l]={signal:h+"datum."+dl,mult:u},g[c]=Oe,g[f]={signal:h+"datum."+Zre,mult:u},g[d]=jt(a);const p={enter:g,update:pe({},g,{opacity:wi}),exit:{opacity:Oe}};return Ut(p,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),si({type:HT,role:Rie,key:xi,from:r,encode:p},i)}const hse=`datum.${dl}<=0?"${cl}":datum.${dl}>=1?"${fl}":"${qT}"`,gse=`datum.${dl}<=0?"${mo}":datum.${dl}>=1?"${Vi}":"${Kre}"`;function VT(e,t,n,i){const r=Un(e,t),s=r.isVertical(),o=jt(r.gradientThickness()),a=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:Oe},update:c={opacity:wi,text:{field:Zw}},exit:{opacity:Oe}};return Ut(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:Gi(e.labelLimit,t.gradientLabelLimit)}),s?(l.align={value:"left"},l.baseline=c.baseline={signal:gse},f="y",d="x",h="1-"):(l.align=c.align={signal:hse},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+dl,mult:a},l[d]=c[d]=o,o.offset=Gi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+Jw}:void 0,si({type:$a,role:_T,style:Jf,key:xi,from:i,encode:g,overlap:u},n)}function pse(e,t,n,i,r){const s=Un(e,t),o=n.entries,a=!!(o&&o.interactive),u=o?o.name:void 0,l=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${Jre} : datum.${nE}`,h=l?jt(l):{field:nE},g=`datum.${Jw}`,p=`max(1, ${r})`;let m,y,b,x,w;h.mult=.5,m={enter:y={opacity:Oe,x:{signal:d,mult:.5,offset:c},y:h},update:b={opacity:wi,x:y.x,y:y.y},exit:{opacity:Oe}};let _=null,A=null;e.fill||(_=t.symbolBaseFillColor,A=t.symbolBaseStrokeColor),Ut(m,{fill:s("symbolFillColor",_),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",A),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),iE.forEach($=>{e[$]&&(b[$]=y[$]={scale:e[$],field:xi})});const E=si({type:use,role:Iie,key:xi,from:f,clip:l?!0:void 0,encode:m},n.symbols),S=jt(c);S.offset=s("labelOffset"),m={enter:y={opacity:Oe,x:{signal:d,offset:S},y:h},update:b={opacity:wi,text:{field:Zw},x:y.x,y:y.y},exit:{opacity:Oe}},Ut(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const k=si({type:$a,role:_T,style:Jf,key:xi,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Oe,height:l?jt(l):Oe,opacity:Oe},exit:{opacity:Oe},update:b={opacity:wi,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(x=`ceil(item.mark.items.length / ${p})`,b.row.signal=`${g}%${x}`,b.column.signal=`floor(${g} / ${x})`,w={field:["row",g]}):(b.row.signal=`floor(${g} / ${p})`,b.column.signal=`${g} % ${p}`,w={field:g}),b.column.signal=`(${r})?${b.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:Jw}},ed({role:Ww,from:i,encode:ul(m,o,Zf),marks:[E,k],name:u,interactive:a,sort:w})}function mse(e,t){const n=Un(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const oE='item.orient === "left"',aE='item.orient === "right"',A0=`(${oE} || ${aE})`,yse=`datum.vgrad && ${A0}`,bse=_0('"top"','"bottom"','"middle"'),vse=_0('"right"','"left"','"center"'),xse=`datum.vgrad && ${aE} ? (${vse}) : (${A0} && !(datum.vgrad && ${oE})) ? "left" : ${sE}`,wse=`item._anchor || (${A0} ? "middle" : "start")`,Ese=`${yse} ? (${oE} ? -90 : 90) : 0`,_se=`${A0} ? (datum.vgrad ? (${aE} ? "bottom" : "top") : ${bse}) : "top"`;function Ase(e,t,n,i){const r=Un(e,t),s={enter:{opacity:Oe},update:{opacity:wi,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Oe}};return Ut(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:wse},angle:{signal:Ese},align:{signal:xse},baseline:{signal:_se},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),si({type:$a,role:Bie,style:eE,from:i,encode:s},n)}function Ose(e,t){let n;return fe(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+XT(e.path)+")":e.sphere&&(n="geoShape("+XT(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function XT(e){return fe(e)&&e.signal?e.signal:ie(e)}function KT(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===E0?Ww:t||Uw}function Sse(e){return{marktype:e.type,name:e.name||void 0,role:e.role||KT(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Cse(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function uE(e,t){const n=JC(e.type);n||L("Unrecognized transform type: "+ie(e.type));const i=p0(n.type.toLowerCase(),null,QT(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function QT(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=$se(o,t,n)}return i}function $se(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return kse(e,t,n);if(r===void 0){e.required&&L("Missing required "+ie(t.type)+" parameter: "+ie(e.name));return}else{if(i==="param")return Fse(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!_t(r)?r.map(s=>JT(e,s,n)):JT(e,r,n)}function JT(e,t,n){const i=e.type;if(_t(t))return eN(i)?L("Expression references can not be signals."):lE(i)?n.fieldRef(t):tN(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||lE(i);return r&&Dse(t)?n.exprRef(t.expr,t.as):r&&jse(t)?Kf(t.field,t.as):eN(i)?Sr(t,n):Mse(i)?ne(n.getData(t).values):lE(i)?Kf(t):tN(i)?n.compareRef(t):t}}function kse(e,t,n){return Se(t.from)||L('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Fse(e,t,n){const i=t[e.name];return e.array?(Z(i)||L("Expected an array of sub-parameters. Instead: "+ie(i)),i.map(r=>ZT(e,r,n))):ZT(e,i,n)}function ZT(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||L("Unsupported parameter: "+ie(t));const s=pe(QT(r,t,n),r.key);return ne(n.add(Cre(s)))}const Dse=e=>e&&e.expr,jse=e=>e&&e.field,Mse=e=>e==="data",eN=e=>e==="expr",lE=e=>e==="field",tN=e=>e==="compare";function Tse(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||L("Only group marks can be faceted."),i.field!=null?o=a=O0(i,n):(e.data?a=ne(n.getData(e.data).aggregate):(s=uE(pe({type:"aggregate",groupby:ae(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=O0(i,n),o=a=ne(n.add(s))),r=n.keyRef(i.groupby,!0))):o=ne(n.add(Yi(null,[{}]))),o||(o=O0(e,n)),{key:r,pulse:o,parent:a}}function O0(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ne(t.getData(e.data).output)}function ka(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}ka.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ne(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new ka(e,s,r,i,o)};function nN(e){return Se(e)?e:null}function iN(e,t,n){const i=y0(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function td(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),u=ire(s);let l=nN(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=s?{field:Yw,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:ne(t.output)};u&&(d.sort=e.sortRef(s)),f=e.add(p0(i,void 0,d)),o&&(t.index[r]=f),c=ne(f),l!=null&&(a[l]=c)}return c}ka.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=nN(t);let o,a,u;return s!=null&&(e=i.scope,o=r[s]),o?n&&n.field&&iN(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ne(i.output)},n&&n.field&&iN(e,u,n),a=e.add(jT(u)),o=e.add(Yi({pulse:ne(a)})),o={agg:a,ref:ne(o)},s!=null&&(r[s]=o)),o.ref},tuplesRef(){return ne(this.values)},extentRef(e,t){return td(e,this,"extent","extent",t,!1)},domainRef(e,t){return td(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return td(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return td(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return td(e,this,"indata","tupleindex",t,!0,!0)}};function Nse(e,t,n){const i=e.from.facet,r=i.name,s=O0(i,t);let o;i.name||L("Facet must have a name: "+ie(i)),i.data||L("Facet must reference a data set: "+ie(i)),i.field?o=t.add(RT({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(bre({key:t.keyRef(i.groupby),group:ne(t.proxy(n.parent)),pulse:s})):L("Facet must specify groupby or field: "+ie(i));const a=t.fork(),u=a.add(Yi()),l=a.add(Ca({pulse:ne(u)}));a.addData(r,new ka(a,u,u,l)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function Rse(e,t,n){const i=t.add(RT({pulse:n.pulse})),r=t.fork();r.add(Ca()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function rN(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,u=t.add(m0()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(f=>f==null?"null":f).join(",")+"),0)",c=Sr(l,t);u.update=c.$expr,u.params=c.$params}function S0(e,t){const n=KT(e),i=e.type===E0,r=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===Ww||n===qw,a,u,l,c,f,d,h;const g=n===Uw||o||r,p=Tse(e.from,i,t);u=t.add(mre({key:p.key||(e.key?Kf(e.key):void 0),pulse:p.pulse,clean:!i}));const m=ne(u);u=l=t.add(Yi({pulse:m})),u=t.add(_re({markdef:Sse(e),interactive:Cse(e.interactive,t),clip:Ose(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ne(u)}));const y=ne(u);u=c=t.add(NT(CT(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(A=>{const E=uE(A,t),S=E.metadata;(S.generates||S.changes)&&L("Mark transforms should not generate new data."),S.nomod||(c.params.mod=!0),E.params.pulse=ne(u),t.add(u=E)}),e.sort&&(u=t.add(jre({sort:t.compareRef(e.sort),pulse:ne(u)})));const b=ne(u);(r||o)&&(o=t.add(PT({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:b})),d=ne(o));const x=t.add(MT({mark:y,pulse:d||b}));h=ne(x),i&&(g&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(b,d||h,m),r?Nse(e,t,p):g?Rse(e,t,p):t.parse(e),t.popState(),g&&(o&&a.push(o),a.push(x))),s&&(h=Lse(s,h,t));const w=t.add(LT({pulse:h})),_=t.add(Ca({pulse:ne(w)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new ka(t,l,w,_)),e.on&&e.on.forEach(A=>{(A.insert||A.remove||A.toggle)&&L("Marks only support modify triggers."),rN(A,t,f)}))}function Lse(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:_t(s)?n.signalRef(s.signal):s,method:_t(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=_t(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return ne(n.add(Sre(o)))}function Pse(e,t){const n=t.config.legend,i=e.encode||{},r=Un(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,u=s.style,l={};let c=0,f,d,h;iE.forEach(x=>e[x]?(l[x]=e[x],c=c||e[x]):0),c||L("Missing valid scale for legend.");const g=Ise(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&r.isVertical()},m=ne(t.add(Yi(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},b=ne(t.add(wre(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===w0?(h=[fse(e,c,n,i.gradient),VT(e,n,i.labels,b)],d.count=d.count||t.signalRef(`max(2,2*floor((${Sa(r.gradientLength())})/100))`)):g===tE?h=[dse(e,c,n,i.gradient,b),VT(e,n,i.labels,b)]:(f=mse(e,n),h=[pse(e,n,i,b,Sa(f.columns))],d.size=Use(e,t,h[0].marks)),h=[ed({role:Lie,from:m,encode:y,marks:h,layout:f,interactive:a})],p.title&&h.push(Ase(e,n,i.title,m)),S0(ed({role:Nie,from:m,encode:ul(zse(r,e,n),s,Zf),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:u}),t)}function Ise(e,t){let n=e.type||WT;return!e.type&&Bse(e)===1&&(e.fill||e.stroke)&&(n=pv(t)?w0:mv(t)?tE:WT),n!==w0?n:mv(t)?tE:w0}function Bse(e){return iE.reduce((t,n)=>t+(e[n]?1:0),0)}function zse(e,t,n){const i={enter:{},update:{}};return Ut(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Use(e,t,n){const i=Sa(sN("size",e,n)),r=Sa(sN("strokeWidth",e,n)),s=Sa(qse(n[1].encode,t,Jf));return Sr(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function sN(e,t,n){return t[e]?`scale("${t[e]}",datum)`:GT(e,n[0].encode)}function qse(e,t,n){return GT("fontSize",e)||lse("fontSize",t,n)}const Wse=`item.orient==="${cl}"?-90:item.orient==="${fl}"?90:0`;function Hse(e,t){e=Se(e)?{text:e}:e;const n=Un(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,u=[],l={},c=ne(t.add(Yi(null,[l])));return u.push(Vse(e,n,Gse(e),c)),e.subtitle&&u.push(Xse(e,n,i.subtitle,c)),S0(ed({role:zie,from:c,encode:Yse(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function Gse(e){const t=e.encode;return t&&t.title||pe({name:e.name,interactive:e.interactive,style:e.style},t)}function Yse(e,t){const n={enter:{},update:{}};return Ut(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:sE},angle:{signal:Wse},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),ul(n,t,Zf)}function Vse(e,t,n,i){const r={value:0},s=e.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ut(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),si({type:$a,role:Uie,style:ese,from:i,encode:o},n)}function Xse(e,t,n,i){const r={value:0},s=e.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ut(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),si({type:$a,role:qie,style:tse,from:i,encode:o},n)}function Kse(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(uE(i,t))}),e.on&&e.on.forEach(i=>{rN(i,t,e.name)}),t.addDataPipeline(e.name,Qse(e,t,n))}function Qse(e,t,n){const i=[];let r=null,s=!1,o=!1,a,u,l,c,f;for(e.values?_t(e.values)||b0(e.format)?(i.push(oN(t,e)),i.push(r=Fa())):i.push(r=Fa({$ingest:e.values,$format:e.format})):e.url?b0(e.url)||b0(e.format)?(i.push(oN(t,e)),i.push(r=Fa())):i.push(r=Fa({$request:e.url,$format:e.format})):e.source&&(r=a=ae(e.source).map(d=>ne(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=Fa()),i.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?r=c:f.changes&&(r=null);return a&&(l=a.length-1,i[0]=Fre({derive:s,pulse:l?a:a[0]}),(s||l)&&i.splice(1,0,Fa())),r||i.push(Fa()),i.push(Ca({})),i}function Fa(e){const t=Yi({},e);return t.metadata={source:!0},t}function oN(e,t){return Ere({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const aN=e=>e===mo||e===Vi,C0=(e,t,n)=>_t(e)?toe(e.signal,t,n):e===cl||e===Vi?t:n,Mt=(e,t,n)=>_t(e)?Zse(e.signal,t,n):aN(e)?t:n,Xi=(e,t,n)=>_t(e)?eoe(e.signal,t,n):aN(e)?n:t,uN=(e,t,n)=>_t(e)?noe(e.signal,t,n):e===Vi?{value:t}:{value:n},Jse=(e,t,n)=>_t(e)?ioe(e.signal,t,n):e===fl?{value:t}:{value:n},Zse=(e,t,n)=>lN(`${e} === '${Vi}' || ${e} === '${mo}'`,t,n),eoe=(e,t,n)=>lN(`${e} !== '${Vi}' && ${e} !== '${mo}'`,t,n),toe=(e,t,n)=>cE(`${e} === '${cl}' || ${e} === '${Vi}'`,t,n),noe=(e,t,n)=>cE(`${e} === '${Vi}'`,t,n),ioe=(e,t,n)=>cE(`${e} === '${fl}'`,t,n),lN=(e,t,n)=>(t=t!=null?jt(t):t,n=n!=null?jt(n):n,cN(t)&&cN(n)?(t=t?t.signal||ie(t.value):null,n=n?n.signal||ie(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[pe({test:e},t)].concat(n||[])),cN=e=>e==null||Object.keys(e).length===1,cE=(e,t,n)=>({signal:`${e} ? (${hl(t)}) : (${hl(n)})`}),roe=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${cl}' ? (${hl(i)}) : `:"")+(n!=null?`${e} === '${mo}' ? (${hl(n)}) : `:"")+(r!=null?`${e} === '${fl}' ? (${hl(r)}) : `:"")+(t!=null?`${e} === '${Vi}' ? (${hl(t)}) : `:"")+"(null)"}),hl=e=>_t(e)?e.signal:e==null?null:ie(e),soe=(e,t)=>t===0?0:_t(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},gl=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function pl(e,t,n,i){let r;if(t&&ue(t,e))return t[e];if(ue(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[eE][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Jf][r]}return null}function fN(e){const t={};for(const n of e)if(!!n)for(const i in n)t[i]=1;return Object.keys(t)}function ooe(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,u,l;if(_t(o)){const f=fN([n.axisX,n.axisY]),d=fN([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=Mt(o,pl(l,n.axisX,r,i),pl(l,n.axisY,r,i));u={};for(l of d)u[l]=roe(o.signal,pl(l,n.axisTop,r,i),pl(l,n.axisBottom,r,i),pl(l,n.axisLeft,r,i),pl(l,n.axisRight,r,i))}else a=o===Vi||o===mo?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||u||s?pe({},r,a,u,s):r}function aoe(e,t,n,i){const r=Un(e,t),s=e.orient;let o,a;const u={enter:o={opacity:Oe},update:a={opacity:wi},exit:{opacity:Oe}};Ut(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=dN(e,0),c=dN(e,1);return o.x=a.x=Mt(s,l,Oe),o.x2=a.x2=Mt(s,c),o.y=a.y=Xi(s,l,Oe),o.y2=a.y2=Xi(s,c),si({type:rE,role:Fie,from:i,encode:u},n)}function dN(e,t){return{scale:e.scale,range:t}}function uoe(e,t,n,i,r){const s=Un(e,t),o=e.orient,a=e.gridScale,u=C0(o,1,-1),l=loe(e.offset,u);let c,f,d;const h={enter:c={opacity:Oe},update:d={opacity:wi},exit:f={opacity:Oe}};Ut(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const g={scale:e.scale,field:xi,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},p=Mt(o,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},y=a?{scale:a,range:1,mult:u,offset:l}:pe(p,{mult:u,offset:l});return c.x=d.x=Mt(o,g,m),c.y=d.y=Xi(o,g,m),c.x2=d.x2=Xi(o,y),c.y2=d.y2=Mt(o,y),f.x=Mt(o,g),f.y=Xi(o,g),si({type:rE,role:Die,key:xi,from:i,encode:h},n)}function loe(e,t){if(t!==1)if(!fe(e))e=_t(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=pe({},e);for(;n.mult!=null;)if(fe(n.mult))n=n.mult=pe({},n.mult);else return n.mult=_t(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function coe(e,t,n,i,r,s){const o=Un(e,t),a=e.orient,u=C0(a,-1,1);let l,c,f;const d={enter:l={opacity:Oe},update:f={opacity:wi},exit:c={opacity:Oe}};Ut(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=jt(r);h.mult=u;const g={scale:e.scale,field:xi,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return f.y=l.y=Mt(a,Oe,g),f.y2=l.y2=Mt(a,h),c.x=Mt(a,g),f.x=l.x=Xi(a,Oe,g),f.x2=l.x2=Xi(a,h),c.y=Xi(a,g),si({type:rE,role:Mie,key:xi,from:i,encode:d},n)}function fE(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function foe(e,t,n,i,r,s){const o=Un(e,t),a=e.orient,u=e.scale,l=C0(a,-1,1),c=Sa(o("labelFlush")),f=Sa(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let g=c===0||!!c,p;const m=jt(r);m.mult=l,m.offset=jt(o("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:xi,band:.5,offset:YT(s.offset,o("labelOffset"))},b=Mt(a,g?fE(u,c,'"left"','"right"','"center"'):{value:"center"},Jse(a,"left","right")),x=Mt(a,uN(a,"bottom","top"),g?fE(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),w=fE(u,c,`-(${f})`,f,0);g=g&&f;const _={opacity:Oe,x:Mt(a,y,m),y:Xi(a,y,m)},A={enter:_,update:p={opacity:wi,text:{field:Zw},x:_.x,y:_.y,align:b,baseline:x},exit:{opacity:Oe,x:_.x,y:_.y}};Ut(A,{dx:!d&&g?Mt(a,w):null,dy:!h&&g?Xi(a,w):null}),Ut(A,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const E=o("labelBound");let S=o("labelOverlap");return S=S||E?{separation:o("labelSeparation"),method:S,order:"datum.index",bound:E?{scale:u,orient:a,tolerance:E}:null}:void 0,p.align!==b&&(p.align=gl(p.align,b)),p.baseline!==x&&(p.baseline=gl(p.baseline,x)),si({type:$a,role:jie,style:Jf,key:xi,from:i,encode:A,overlap:S},n)}function doe(e,t,n,i){const r=Un(e,t),s=e.orient,o=C0(s,-1,1);let a,u;const l={enter:a={opacity:Oe,anchor:jt(r("titleAnchor",null)),align:{signal:sE}},update:u=pe({},a,{opacity:wi,text:jt(e.title)}),exit:{opacity:Oe}},c={signal:`lerp(range("${e.scale}"), ${_0(0,1,.5)})`};return u.x=Mt(s,c),u.y=Xi(s,c),a.angle=Mt(s,Oe,soe(o,90)),a.baseline=Mt(s,uN(s,mo,Vi),{value:mo}),u.angle=a.angle,u.baseline=a.baseline,Ut(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),hoe(r,s,l,n),l.update.align=gl(l.update.align,a.align),l.update.angle=gl(l.update.angle,a.angle),l.update.baseline=gl(l.update.baseline,a.baseline),si({type:$a,role:Tie,style:eE,from:i,encode:l},n)}function hoe(e,t,n,i){const r=(a,u)=>a!=null?(n.update[u]=gl(jt(a),n.update[u]),!1):!ll(u,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?jt(o):Mt(t,jt(o),jt(s))}function goe(e,t){const n=ooe(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,u=Un(e,n),l=cse(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ne(t.add(Yi({},[c]))),d=ne(t.add(pre({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(uoe(e,n,i.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(coe(e,n,i.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(foe(e,n,i.labels,d,g,l))),c.domain&&h.push(aoe(e,n,i.domain,f)),c.title&&h.push(doe(e,n,i.title,f)),S0(ed({role:kie,from:f,encode:ul(poe(u,e),r,Zf),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:o,style:a}),t)}function poe(e,t){const n={enter:{},update:{}};return Ut(n,{orient:e("orient"),offset:e("offset")||0,position:Gi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function hN(e,t,n){const i=ae(e.signals),r=ae(e.scales);return n||i.forEach(s=>kT(s,t)),ae(e.projections).forEach(s=>Yre(s,t)),r.forEach(s=>Nre(s,t)),ae(e.data).forEach(s=>Kse(s,t)),r.forEach(s=>Rre(s,t)),(n||i).forEach(s=>gre(s,t)),ae(e.axes).forEach(s=>goe(s,t)),ae(e.marks).forEach(s=>S0(s,t)),ae(e.legends).forEach(s=>Pse(s,t)),e.title&&Hse(e.title,t),t.parseLambdas(),t}const moe=e=>ul({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function yoe(e,t){const n=t.config,i=ne(t.root=t.add(m0())),r=boe(e,n);r.forEach(l=>kT(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(Yi()),o=t.add(NT(CT(moe(e.encode),E0,qw,e.style,t,{pulse:ne(s)}))),a=t.add(PT({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:ne(o)}));t.operators.pop(),t.pushState(ne(o),ne(a),null),hN(e,t,r),t.operators.push(a);let u=t.add(MT({mark:i,pulse:ne(a)}));return u=t.add(LT({pulse:ne(u)})),u=t.add(Ca({pulse:ne(u)})),t.addData("root",new ka(t,s,s,u)),t}function nd(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function boe(e,t){const n=o=>Gi(e[o],t[o]),i=[nd("background",n("background")),nd("autosize",Sie(n("autosize"))),nd("padding",$ie(n("padding"))),nd("width",n("width")||0),nd("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return ae(e.signals).forEach(o=>{ue(r,o.name)?o=pe(r[o.name],o):i.push(o),s[o.name]=o}),ae(t.signals).forEach(o=>{!ue(s,o.name)&&!ue(r,o.name)&&i.push(o)}),i}function gN(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function pN(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}gN.prototype=pN.prototype={parse(e){return hN(e,this)},fork(){return new pN(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof Gw?ne(e):e;return this.add(kre({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(ne(this.add(Ca({pulse:e})))),this._parent.push(t),this._lookup.push(n?ne(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Ee(this._parent)},encode(){return Ee(this._encode)},lookup(){return Ee(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Se(e))return Kf(e,t);e.signal||L("Unsupported field reference: "+ie(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=ne(this.add(vre(r)))}return i},compareRef(e){let t=!1;const n=s=>_t(s)?(t=!0,this.signalRef(s.signal)):rre(s)?(t=!0,this.exprRef(s.expr)):s,i=ae(e.field).map(n),r=ae(e.order).map(n);return t?ne(this.add(TT({fields:i,orders:r}))):FT(i,r)},keyRef(e,t){let n=!1;const i=s=>_t(s)?(n=!0,ne(r[s.signal])):s,r=this.signals;return e=ae(e).map(i),n?ne(this.add(xre({fields:e,flat:t}))):ere(e,t)},sortRef(e){if(!e)return e;const t=y0(e.op,e.field),n=e.order||tre;return n.signal?ne(this.add(TT({fields:t,orders:this.signalRef(n.signal)}))):FT(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return ue(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&L("Duplicate signal name: "+ie(e));const n=t instanceof Gw?t:this.add(m0(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||L("Unrecognized signal name: "+ie(e)),this.signals[e]},signalRef(e){return this.signals[e]?ne(this.signals[e]):(ue(this.lambdas,e)||(this.lambdas[e]=this.add(m0(null))),ne(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Sr(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!fe(e)?e:this.signalRef(e.signal||dE(e))},exprRef(e,t){const n={expr:Sr(e,this)};return t&&(n.expr.$name=t),ne(this.add(yre(n)))},addBinding(e,t){this.bindings||L("Nested signals do not support binding: "+ie(e)),this.bindings.push(pe({signal:e},t))},addScaleProj(e,t){ue(this.scales,e)&&L("Duplicate scale or projection name: "+ie(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Dre(t))},addProjection(e,t){this.addScaleProj(e,$re(t))},getScale(e){return this.scales[e]||L("Unrecognized scale name: "+ie(e)),this.scales[e]},scaleRef(e){return ne(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ue(this.data,e)&&L("Duplicate data set name: "+ie(e)),this.data[e]=t},getData(e){return this.data[e]||L("Undefined data set name: "+ie(e)),this.data[e]},addDataPipeline(e,t){return ue(this.data,e)&&L("Duplicate data set name: "+ie(e)),this.addData(e,ka.fromEntries(this,t))}};function dE(e){return(Z(e)?voe:xoe)(e)}function voe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(fe(r)?r.signal||dE(r):ie(r))}return n+"]"}function xoe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+ie(i)+":"+(fe(r)?r.signal||dE(r):ie(r));return t+"}"}function woe(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Eoe(e,t,n){return fe(e)||L("Input Vega specification must be an object."),t=gh(woe(),t,e.config),yoe(e,new gN(t,n)).toRuntime()}var _oe="vega",Aoe="5.21.0",Ooe="The Vega visualization grammar.",Soe=["vega","visualization","interaction","dataflow","library","data","d3"],Coe="BSD-3-Clause",$oe="UW Interactive Data Lab (http://idl.cs.washington.edu)",koe="build/vega-node.js",Foe="build/vega.module.js",Doe="build/vega.min.js",joe="build/vega.min.js",Moe="index.d.ts",Toe="vega/vega",Noe={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Roe={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Loe={"vega-schema":"*"},Poe="774165e29850b66ec8b79ba52a7955f1ab936ea6",Ioe={name:_oe,version:Aoe,description:Ooe,keywords:Soe,license:Coe,author:$oe,main:koe,module:Foe,unpkg:Doe,jsdelivr:joe,types:Moe,repository:Toe,scripts:Noe,dependencies:Roe,devDependencies:Loe,gitHead:Poe};pe(Cu,IU,JY,FV,pK,lQ,zJ,dJ,qJ,oZ,mZ,_Z);const Boe=Ioe.version;var zoe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Boe,Dataflow:Su,EventStream:Ph,MultiPulse:My,Operator:We,Parameters:Lh,Pulse:qs,Transform:T,changeset:ea,definition:JC,ingest:Ne,isTuple:Th,transform:ZC,transforms:Cu,tupleid:ee,interpolate:yv,interpolateColors:yg,interpolateRange:SF,quantizeInterpolator:CF,scale:De,scheme:bv,projection:f2,View:fT,defaultLocale:Sy,formatLocale:$h,locale:DC,resetDefaultLocale:IB,timeFormatLocale:Sc,expressionFunction:gt,parse:Eoe,runtimeContext:H5,codegenExpression:_5,parseExpression:x5,parseSelector:xT,Debug:WO,Error:F1,Info:qO,None:zO,Warn:UO,accessor:Fn,accessorFields:Ht,accessorName:rt,array:ae,ascending:vh,clampRange:iS,compare:T1,constant:Yt,debounce:N1,error:L,extend:pe,extent:ar,extentIndex:rS,falsy:Ds,fastmap:mu,field:Dn,flush:sS,hasOwnProperty:ue,id:ic,identity:dn,inherits:W,inrange:yu,isArray:Z,isBoolean:R1,isDate:js,isFunction:ye,isIterable:oS,isNumber:Ms,isObject:fe,isRegExp:aS,isString:Se,key:L1,lerp:uS,logger:HO,lruCache:lS,merge:cS,mergeConfig:gh,one:pu,pad:fS,panLinear:QO,panLog:JO,panPow:ZO,panSymlog:eS,peek:Ee,quarter:tS,repeat:sc,span:oc,splitAccessPath:hh,stringValue:ie,toBoolean:P1,toDate:I1,toNumber:Gt,toSet:Ti,toString:B1,truncate:dS,truthy:fi,utcquarter:nS,visitArray:Ts,writeConfig:rc,zero:Fs,zoomLinear:D1,zoomLog:j1,zoomPow:bh,zoomSymlog:M1,bandwidthNRD:Ly,bin:t$,bootstrapCI:n$,cumulativeLogNormal:qy,cumulativeNormal:Uh,cumulativeUniform:Yy,densityLogNormal:Uy,densityNormal:Py,densityUniform:Gy,dotbin:i$,quantileLogNormal:Wy,quantileNormal:qh,quantileUniform:Vy,quantiles:Ny,quartiles:Ry,get random(){return gi},randomInteger:qz,randomKDE:By,randomLCG:Uz,randomLogNormal:s$,randomMixture:o$,randomNormal:Iy,randomUniform:a$,regressionExp:l$,regressionLinear:Xy,regressionLoess:g$,regressionLog:u$,regressionPoly:f$,regressionPow:c$,regressionQuad:Ky,sampleCurve:Hh,sampleLogNormal:zy,sampleNormal:zh,sampleUniform:Hy,setRandom:Bz,DATE:Tn,DAY:Xt,DAYOFYEAR:ur,HOURS:Zn,MILLISECONDS:Ni,MINUTES:ei,MONTH:Vt,QUARTER:Mn,SECONDS:hi,TIME_UNITS:cy,WEEK:vt,YEAR:Lt,dayofyear:zS,timeBin:oC,timeFloor:VS,timeInterval:Eu,timeOffset:QS,timeSequence:eC,timeUnitSpecifier:BS,timeUnits:dy,utcFloor:XS,utcInterval:_u,utcOffset:JS,utcSequence:tC,utcdayofyear:WS,utcweek:HS,week:US,format:Fh,formats:Fy,inferType:TC,inferTypes:NC,loader:Dh,read:IC,responseType:PC,typeParsers:Cy,Bounds:wt,CanvasHandler:af,CanvasRenderer:Wg,Gradient:qF,GroupItem:_g,Handler:ro,Item:Eg,Marks:ti,RenderType:oo,Renderer:xr,ResourceLoader:kv,SVGHandler:rx,SVGRenderer:fx,SVGStringRenderer:gx,Scenegraph:Zv,boundClip:a3,boundContext:Qc,boundItem:Jv,boundMark:ED,boundStroke:ns,domChild:Rn,domClear:Ii,domCreate:io,domFind:ex,font:Ng,fontFamily:nf,fontSize:vr,intersect:i3,intersectBoxLine:qu,intersectPath:Rv,intersectPoint:Lv,intersectRule:aD,lineHeight:to,markup:cx,multiLineOffset:Xv,pathCurves:_v,pathEqual:u3,pathParse:Bu,pathRectangle:KF,pathRender:Gc,pathSymbols:XF,pathTrail:QF,point:Lg,renderModule:Gg,resetSVGClipId:ZF,resetSVGDefIds:gY,sceneEqual:mx,sceneFromJSON:AD,scenePickVisit:Fg,sceneToJSON:_D,sceneVisit:Pi,sceneZOrder:Pv,serializeXML:GD,textMetrics:br});function Uoe(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var qoe={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Woe={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},Hoe={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const Goe=Array.prototype.slice,Da=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,Goe.call(t,1))},Yoe=(e,t,n,i,r,s,o)=>new Date(e,t||0,n!=null?n:1,i||0,r||0,s||0,o||0);var Voe={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:Yoe,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Da("join",arguments)},indexof:function(){return Da("indexOf",arguments)},lastindexof:function(){return Da("lastIndexOf",arguments)},slice:function(){return Da("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Da("substring",arguments,String)},split:function(){return Da("split",arguments,String)},replace:function(){return Da("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const Xoe=["view","item","group","xy","x","y"],Koe={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:qoe[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||Voe[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Woe[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>Hoe[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function id(e,t,n,i,r,s){const o=a=>Koe[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,Xoe.forEach(a=>o.fn[a]=(...u)=>r.vega[a](...u)),o(e)}var Qoe={operator(e,t){const n=t.ast,i=e.functions;return r=>id(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>id(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>id(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>{const o=s.item&&s.item.datum;return id(n,i,r,o,s)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s=n==="group"||n==="image"||n==="rect";return(o,a)=>{const u=o.datum;let l=0,c;for(const f in i)c=id(i[f].ast,r,a,u,void 0,o),o[f]!==c&&(o[f]=c,l=1);return n!=="rule"&&Uoe(o,i,s),l}}};const Joe="vega-lite",Zoe='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',eae="5.1.1",tae=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],nae="https://vega.github.io/vega-lite/",iae="Vega-Lite is a concise high-level language for interactive visualization.",rae="build/vega-lite.js",sae="build/vega-lite.min.js",oae="build/vega-lite.min.js",aae="build/src/index",uae="build/src/index.d.ts",lae={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},cae={test:"test"},fae=["bin","build","src","vega-lite*","tsconfig.json"],dae={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},hae={type:"git",url:"https://github.com/vega/vega-lite.git"},gae="BSD-3-Clause",pae={url:"https://github.com/vega/vega-lite/issues"},mae={"@babel/core":"^7.15.0","@babel/preset-env":"^7.15.0","@babel/preset-typescript":"^7.15.0","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.4","@types/chai":"^4.2.21","@types/d3":"^7.0.0","@types/jest":"^27.0.1","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^4.29.2","@typescript-eslint/parser":"^4.29.2",ajv:"^8.6.2","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.0.1","del-cli":"^4.0.1",eslint:"^7.32.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^24.4.0","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.2.0",jest:"^27.0.6","jest-dev-server":"^5.0.3",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.3.2",puppeteer:"^10.2.0",rollup:"^2.56.3","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^12.0.0",terser:"^5.7.1","ts-jest":"^27.0.5","ts-json-schema-generator":"^0.95.0",typescript:"~4.4.2","vega-cli":"^5.20.2","vega-datasets":"~2.2.0","vega-embed":"^6.18.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},yae={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-util":"~1.16.1",yargs:"~17.1.1"},bae={vega:"^5.20.2"},vae={node:">=12"};var xae={name:Joe,author:Zoe,version:eae,collaborators:tae,homepage:nae,description:iae,main:rae,unpkg:sae,jsdelivr:oae,module:aae,types:uae,bin:lae,directories:cae,files:fae,scripts:dae,repository:hae,license:gae,bugs:pae,devDependencies:mae,dependencies:yae,peerDependencies:bae,engines:vae};function ml(e,t,n){return e.fields=t||[],e.fname=n,e}function wae(e){return e.length===1?Eae(e[0]):_ae(e)}const Eae=e=>function(t){return t[e]},_ae=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function hE(e){throw Error(e)}function ja(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||hE("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&hE("Access path missing closing bracket: "+e),i&&hE("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Aae(e,t,n){const i=ja(e);return e=i.length===1?i[0]:e,ml((n&&n.get||wae)(i),[e],t||e)}Aae("id");const Oae=ml(e=>e,[],"identity");ml(()=>0,[],"zero");ml(()=>1,[],"one");ml(()=>!0,[],"true");ml(()=>!1,[],"false");function $0(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const Sae=0,Cae=1,mN=2,$ae=3,kae=4;function Fae(e,t){let n=e||Sae;return{level(i){return arguments.length?(n=+i,this):n},error(){return n>=Cae&&$0(t||"error","ERROR",arguments),this},warn(){return n>=mN&&$0(t||"warn","WARN",arguments),this},info(){return n>=$ae&&$0(t||"log","INFO",arguments),this},debug(){return n>=kae&&$0(t||"log","DEBUG",arguments),this}}}var Q=Array.isArray;function He(e){return e===Object(e)}const yN=e=>e!=="__proto__";function bN(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=Dae(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;gE(t,i,n[i],r)}return t},{})}function gE(e,t,n,i){if(!yN(t))return;let r,s;if(He(n)&&!Q(n)){s=He(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?gE(s,r,n[r]):yN(r)&&(s[r]=n[r])}else e[t]=n}function Dae(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function at(e){return e!=null?Q(e)?e:[e]:[]}function jae(e){return typeof e=="function"}const Mae=Object.prototype.hasOwnProperty;function yl(e,t){return Mae.call(e,t)}function rd(e){return typeof e=="boolean"}function pt(e){return typeof e=="number"}function he(e){return typeof e=="string"}function Ce(e){return Q(e)?"["+e.map(Ce)+"]":He(e)||he(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Ma(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var vN={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var s;try{s=Promise}catch{s=function(){}}function o(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],b=[],x=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof g=="undefined"&&(g=1/0);function w(_,A){if(_===null)return null;if(A===0)return _;var E,S;if(typeof _!="object")return _;if(n(_,i))E=new i;else if(n(_,r))E=new r;else if(n(_,s))E=new s(function(B,H){_.then(function(X){B(w(X,A-1))},function(X){H(w(X,A-1))})});else if(o.__isArray(_))E=[];else if(o.__isRegExp(_))E=new RegExp(_.source,f(_)),_.lastIndex&&(E.lastIndex=_.lastIndex);else if(o.__isDate(_))E=new Date(_.getTime());else{if(x&&Buffer.isBuffer(_))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(_.length):E=new Buffer(_.length),_.copy(E),E;n(_,Error)?E=Object.create(_):typeof p=="undefined"?(S=Object.getPrototypeOf(_),E=Object.create(S)):(E=Object.create(p),S=p)}if(h){var k=y.indexOf(_);if(k!=-1)return b[k];y.push(_),b.push(E)}n(_,i)&&_.forEach(function(B,H){var X=w(H,A-1),ce=w(B,A-1);E.set(X,ce)}),n(_,r)&&_.forEach(function(B){var H=w(B,A-1);E.add(H)});for(var $ in _){var F;S&&(F=Object.getOwnPropertyDescriptor(S,$)),!(F&&F.set==null)&&(E[$]=w(_[$],A-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(_),$=0;$<M.length;$++){var j=M[$],I=Object.getOwnPropertyDescriptor(_,j);I&&!I.enumerable&&!m||(E[j]=w(_[j],A-1),I.enumerable||Object.defineProperty(E,j,{enumerable:!1}))}if(m)for(var D=Object.getOwnPropertyNames(_),$=0;$<D.length;$++){var P=D[$],I=Object.getOwnPropertyDescriptor(_,P);I&&I.enumerable||(E[P]=w(_[P],A-1),Object.defineProperty(E,P,{enumerable:!1}))}return E}return w(d,g)}o.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function a(d){return Object.prototype.toString.call(d)}o.__objToStr=a;function u(d){return typeof d=="object"&&a(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&a(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&a(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(vN);var Tae=vN.exports,Nae=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,s;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!=0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),i=s.length,i!==Object.keys(n).length)return!1;for(r=i;r--!=0;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=i;r--!=0;){var o=s[r];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},pE=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(s){return function(o){return function(a,u){var l={key:a,value:o[a]},c={key:u,value:o[u]};return s(l,c)}}}(t.cmp),r=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,u;if(Array.isArray(o)){for(u="[",a=0;a<o.length;a++)a&&(u+=","),u+=s(o[a])||"null";return u+"]"}if(o===null)return"null";if(r.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(o)-1,c=Object.keys(o).sort(i&&i(o));for(u="",a=0;a<c.length;a++){var f=c[a],d=s(o[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return r.splice(l,1),"{"+u+"}"}}(e)};function mE(e){return!!e.or}function yE(e){return!!e.and}function bE(e){return!!e.not}function k0(e,t){if(bE(e))k0(e.not,t);else if(yE(e))for(const n of e.and)k0(n,t);else if(mE(e))for(const n of e.or)k0(n,t);else t(e)}function bl(e,t){return bE(e)?{not:bl(e.not,t)}:yE(e)?{and:e.and.map(n=>bl(n,t))}:mE(e)?{or:e.or.map(n=>bl(n,t))}:t(e)}const Cr=Nae,ge=Tae;function vl(e,t){const n={};for(const i of t)yl(e,i)&&(n[i]=e[i]);return n}function oi(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>pE(e)).join(",")})`};const Ge=pE;function _e(e){if(pt(e))return e;const t=he(e)?e:pE(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function vE(e){return e===!1||e===null}function be(e,t){return e.includes(t)}function xl(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function xE(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function xN(e,...t){for(const n of t)Rae(e,n!=null?n:{});return e}function Rae(e,t){for(const n of z(t))gE(e,n,t[n],!0)}function $r(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function Lae(e,t){const n=z(e),i=z(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function wN(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function wE(e,t){for(const n of e)if(t.has(n))return!0;return!1}function EE(e){const t=new Set;for(const n of e){const r=ja(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function _E(e,t){return e===void 0||t===void 0?!0:wE(EE(e),EE(t))}function ze(e){return z(e).length===0}const z=Object.keys,nn=Object.values,yo=Object.entries;function sd(e){return e===!0||e===!1}function Je(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function od(e,t){return bE(e)?`!(${od(e.not,t)})`:yE(e)?`(${e.and.map(n=>od(n,t)).join(") && (")})`:mE(e)?`(${e.or.map(n=>od(n,t)).join(") || (")})`:t(e)}function F0(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&F0(e[n],t)&&delete e[n],ze(e)}function ad(e){return e.charAt(0).toUpperCase()+e.substr(1)}function AE(e,t="datum"){const n=ja(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(Ce).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function EN(e,t="datum"){return`${t}[${Ce(ja(e).join("."))}]`}function Pae(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ei(e){return`${ja(e).map(Pae).join("\\.")}`}function Ta(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function OE(e){return`${ja(e).join(".")}`}function wl(e){return e?ja(e).length:0}function mt(...e){for(const t of e)if(t!==void 0)return t}let _N=42;function AN(e){const t=++_N;return e?String(e)+t:t}function Iae(){_N=42}function ON(e){return SN(e)?e:`__${e}`}function SN(e){return e.startsWith("__")}function ud(e){if(e!==void 0)return(e%360+360)%360}function D0(e){return pt(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var ld=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const ds="row",hs="column",j0="facet",tt="x",At="y",Ki="x2",kr="y2",Fr="radius",gs="radius2",Qi="theta",ps="theta2",Dr="latitude",jr="longitude",Ji="latitude2",_i="longitude2",qn="color",Mr="fill",Tr="stroke",Wn="shape",ms="size",Na="angle",ys="opacity",bo="fillOpacity",vo="strokeOpacity",xo="strokeWidth",wo="strokeDash",cd="text",fd="order",dd="detail",M0="key",Ra="tooltip",T0="href",N0="url",R0="description",Bae={x:1,y:1,x2:1,y2:1},CN={theta:1,theta2:1,radius:1,radius2:1};function $N(e){return e in CN}const SE={longitude:1,longitude2:1,latitude:1,latitude2:1};function zae(e){switch(e){case Dr:return"y";case Ji:return"y2";case jr:return"x";case _i:return"x2"}}function Uae(e){return e in SE}const qae=z(SE),kN=Object.assign(Object.assign(Object.assign(Object.assign({},Bae),CN),SE),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function El(e){return e===qn||e===Mr||e===Tr}const FN={row:1,column:1,facet:1},Ai=z(FN),CE=Object.assign(Object.assign({},kN),FN),Wae=z(CE),Hae=ld(CE,["order","detail","tooltip"]),Gae=ld(Hae,["row","column","facet"]);function Yae(e){return!!Gae[e]}function DN(e){return!!CE[e]}const Vae=[Ki,kr,Ji,_i,ps,gs];function jN(e){return La(e)!==e}function La(e){switch(e){case Ki:return tt;case kr:return At;case Ji:return Dr;case _i:return jr;case ps:return Qi;case gs:return Fr}return e}function Eo(e){if($N(e))switch(e){case Qi:return"startAngle";case ps:return"endAngle";case Fr:return"outerRadius";case gs:return"innerRadius"}return e}function bs(e){switch(e){case tt:return Ki;case At:return kr;case Dr:return Ji;case jr:return _i;case Qi:return ps;case Fr:return gs}}function Oi(e){switch(e){case tt:case Ki:return"width";case At:case kr:return"height"}}function Xae(e){switch(e){case tt:return"xOffset";case At:return"yOffset";case Ki:return"x2Offset";case kr:return"y2Offset";case Qi:return"thetaOffset";case Fr:return"radiusOffset";case ps:return"theta2Offset";case gs:return"radius2Offset"}}const $E=ld(kN,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Kae=z($E),_o={x:1,y:1},Nr=z(_o);function Rr(e){return e in _o}const kE={theta:1,radius:1},Qae=z(kE);function L0(e){return e==="width"?tt:At}const MN=ld($E,["text","tooltip","href","url","description","detail","key","order"]),Jae=z(MN);function Zae(e){return!!$E[e]}function eue(e){switch(e){case qn:case Mr:case Tr:case ms:case Wn:case ys:case xo:case wo:return!0;case bo:case vo:case Na:return!1}}const TN=Object.assign(Object.assign(Object.assign({},_o),kE),MN),P0=z(TN);function Ao(e){return!!TN[e]}function tue(e,t){return iue(e)[t]}const NN={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},nue=ld(NN,["geoshape"]);function iue(e){switch(e){case qn:case Mr:case Tr:case R0:case dd:case M0:case Ra:case T0:case fd:case ys:case bo:case vo:case xo:case j0:case ds:case hs:return NN;case tt:case At:case Dr:case jr:return nue;case Ki:case kr:case Ji:case _i:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case ms:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case wo:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Wn:return{point:"always",geoshape:"always"};case cd:return{text:"always"};case Na:return{point:"always",square:"always",text:"always"};case N0:return{image:"always"};case Qi:return{text:"always",arc:"always"};case Fr:return{text:"always",arc:"always"};case ps:case gs:return{arc:"always"}}}function FE(e){switch(e){case tt:case At:case Qi:case Fr:case ms:case Na:case xo:case ys:case bo:case vo:case Ki:case kr:case ps:case gs:return;case j0:case ds:case hs:case Wn:case wo:case cd:case Ra:case T0:case N0:case R0:return"discrete";case qn:case Mr:case Tr:return"flexible";case Dr:case jr:case Ji:case _i:case dd:case M0:case fd:return}}const rue={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},sue={count:1,min:1,max:1};function vs(e){return!!e&&!!e.argmin}function Oo(e){return!!e&&!!e.argmax}function DE(e){return he(e)&&!!rue[e]}const oue=["count","valid","missing","distinct"];function RN(e){return he(e)&&be(oue,e)}function aue(e){return he(e)&&be(["min","max"],e)}const uue=["count","sum","distinct","valid","missing"],lue=["mean","average","median","q1","q3","min","max"],cue=Ma(lue);function LN(e){return rd(e)&&(e=rm(e,void 0)),"bin"+z(e).map(t=>I0(e[t])?Je(`_${t}_${yo(e[t])}`):Je(`_${t}_${e[t]}`)).join("")}function Ye(e){return e===!0||Pa(e)&&!e.binned}function On(e){return e==="binned"||Pa(e)&&e.binned===!0}function Pa(e){return He(e)}function I0(e){return e==null?void 0:e.param}function PN(e){switch(e){case ds:case hs:case ms:case qn:case Mr:case Tr:case xo:case ys:case bo:case vo:case Wn:return 6;case wo:return 4;default:return 10}}function hd(e){return e&&!!e.expr}function Hn(e){const t=z(e||{}),n={};for(const i of t)n[i]=ai(e[i]);return n}var fue=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function IN(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:g}=e,p=fue(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),a?{fill:a}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),s!==void 0?{angle:s}:{}),o!==void 0?{limit:o}:{}),b=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),g?{subtitlePadding:g}:{}),x=vl(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:x,nonMarkTitleProperties:y,subtitle:b}}function So(e){return he(e)||Q(e)&&he(e[0])}function re(e){return e&&!!e.signal}function Co(e){return!!e.step}function due(e){return Q(e)?!1:"fields"in e&&!("data"in e)}function hue(e){return Q(e)?!1:"fields"in e&&"data"in e}function xs(e){return Q(e)?!1:"field"in e&&"data"in e}const gue={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},pue=z(gue),mue={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},jE=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var ME=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function BN(e){const t=Q(e.condition)?e.condition.map(zN):zN(e.condition);return Object.assign(Object.assign({},ai(e)),{condition:t})}function ai(e){if(hd(e)){const{expr:t}=e,n=ME(e,["expr"]);return Object.assign({signal:t},n)}return e}function zN(e){if(hd(e)){const{expr:t}=e,n=ME(e,["expr"]);return Object.assign({signal:t},n)}return e}function Ze(e){if(hd(e)){const{expr:t}=e,n=ME(e,["expr"]);return Object.assign({signal:t},n)}return re(e)?e:e!==void 0?{value:e}:void 0}function UN(e){return re(e)?e.signal:Ce(e.value)}function ws(e){return re(e)?e.signal:e==null?null:Ce(e)}function yue(e,t,n){for(const i of n){const r=Ia(i,t.markDef,t.config);r!==void 0&&(e[i]=Ze(r))}return e}function qN(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Le(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:Ia(e,t,n,i)}function Ia(e,t,n,{vgChannel:i}={}){return mt(i?B0(e,t,n.style):void 0,B0(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function B0(e,t,n){return WN(e,qN(t),n)}function WN(e,t,n){t=at(t);let i;for(const r of t){const s=n[r];s&&s[e]!==void 0&&(i=s[e])}return i}function HN(e,t){return at(e).reduce((n,i)=>{var r;return n.field.push(G(i,t)),n.order.push((r=i.sort)!==null&&r!==void 0?r:"ascending"),n},{field:[],order:[]})}function GN(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(Cr(r,i))return;n.push(i)}),n}function YN(e,t){return Cr(e,t)||!t?e:e?[...at(e),...at(t)].join(", "):t}function VN(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((So(n)||re(n))&&(So(i)||re(i)))return{explicit:e.explicit,value:YN(n,i)};if(So(n)||re(n))return{explicit:e.explicit,value:n};if(So(i)||re(i))return{explicit:e.explicit,value:i};if(!So(n)&&!re(n)&&!So(i)&&!re(i))return{explicit:e.explicit,value:GN(n,i)};throw new Error("It should never reach here")}function TE(e){return`Invalid specification ${Ge(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const bue='Autosize "fit" only works for single views and layered views.';function XN(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function KN(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function QN(e){return e?`Dropping "fit-${e}" because spec has discrete ${Oi(e)}.`:'Dropping "fit" because spec has discrete size.'}function NE(e){return`Unknown field for ${e}. Cannot calculate view size.`}function JN(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function vue(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function xue(e){return`The "nearest" transform is not supported for ${e} marks.`}function ZN(e){return`Selection not supported for ${e} yet.`}function wue(e){return`Cannot find a selection named "${e}".`}const Eue="Scale bindings are currently only supported for scales with unbinned, continuous domains.",_ue="Legend bindings are only supported for selections over an individual field or encoding channel.";function Aue(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Oue(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Sue="The same selection must be used to override scale domains in a layered view.",Cue='Interval selections should be initialized using "x" and/or "y" keys.';function $ue(e){return`Unknown repeated value "${e}".`}function e6(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const kue="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Fue(e){return`Unrecognized parse "${e}".`}function t6(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Due="Attempt to add the same child twice.";function jue(e){return`Ignoring an invalid transform: ${Ge(e)}.`}const Mue='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function n6(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Tue(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ge(t)} is overridden by a child projection ${Ge(n)}.`}const Nue="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Rue(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ge(n)}}.`}function i6(e){return`Invalid field type "${e}".`}function Lue(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function Pue(e){return`Invalid aggregation operator "${e}".`}function r6(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function Iue(e){return`Position range does not support relative band size for ${e}.`}function RE(e,t){return`Dropping ${Ge(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Bue="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function z0(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function zue(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Uue(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function que(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Wue(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function LE(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Hue(e){return`The ${e} for range marks cannot be an expression`}function Gue(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Yue(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Vue(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Xue(e){return`Cannot use the relative band size with ${e} scale.`}function Kue(e){return`Using unaggregated domain with raw field has no effect (${Ge(e)}).`}function Que(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Jue(e){return`Unaggregated domain is currently unsupported for log scale (${Ge(e)}).`}function Zue(e){return`Cannot apply size to non-oriented mark "${e}".`}function ele(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function tle(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function s6(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function o6(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function nle(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ge(n)} and ${Ge(i)}). Using ${Ge(n)}.`}function ile(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ge(n)} and ${Ge(i)}). Using the union of the two domains.`}function rle(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function sle(e){return`Dropping sort property ${Ge(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const a6="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",ole="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",ale="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",ule="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function lle(e){return`Cannot stack "${e}" if there is already "${e}2".`}function cle(e){return`Cannot stack non-linear scale (${e}).`}function fle(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function U0(e,t){return`Invalid ${e}: ${Ge(t)}.`}function dle(e){return`Dropping day from datetime ${Ge(e)} as day cannot be combined with other units.`}function hle(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function gle(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function ple(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function u6(e){return`1D error band does not support ${e}.`}function l6(e){return`Channel ${e} is required for "binned" bin.`}function mle(e){return`Channel ${e} should not be used with "binned" bin.`}function yle(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const c6=Fae(mN);let _l=c6;function ble(e){return _l=e,_l}function vle(){return _l=c6,_l}function q(...e){_l.warn(...e)}function xle(...e){_l.debug(...e)}function Ba(e){if(e&&He(e)){for(const t of IE)if(t in e)return!0}return!1}const f6=["january","february","march","april","may","june","july","august","september","october","november","december"],wle=f6.map(e=>e.substr(0,3)),d6=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Ele=d6.map(e=>e.substr(0,3));function _le(e){if(D0(e)&&(e=+e),pt(e))return e>4&&q(U0("quarter",e)),e-1;throw new Error(U0("quarter",e))}function Ale(e){if(D0(e)&&(e=+e),pt(e))return e-1;{const t=e.toLowerCase(),n=f6.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=wle.indexOf(i);if(r!==-1)return r;throw new Error(U0("month",e))}}function Ole(e){if(D0(e)&&(e=+e),pt(e))return e%7;{const t=e.toLowerCase(),n=d6.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Ele.indexOf(i);if(r!==-1)return r;throw new Error(U0("day",e))}}function PE(e,t){const n=[];if(t&&e.day!==void 0&&z(e).length>1&&(q(dle(e)),e=ge(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?Ale(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?_le(e.quarter):e.quarter;n.push(pt(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?Ole(e.day):e.day;n.push(pt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r=="undefined"?0:r)}return n}function gd(e){const n=PE(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Sle(e){const n=PE(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Cle(e){const t=PE(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var $le=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const h6={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},IE=z(h6);function kle(e){return!!h6[e]}function BE(e){return e.startsWith("utc")}function Fle(e){return e.substr(3)}const Dle={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function zE(e){return IE.filter(t=>g6(e,t))}function g6(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function jle(e,t,{end:n}={end:!1}){const i=AE(t),r=BE(e)?"utc":"";function s(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let o;const a={};for(const u of IE)g6(e,u)&&(a[u]=s(u),o=u);return n&&(a[o]+="+1"),Sle(a)}function p6(e){if(!e)return;const t=zE(e);return`timeUnitSpecifier(${Ge(t)}, ${Ge(Dle)})`}function Mle(e,t,n){if(!e)return;const i=p6(e);return`${n||BE(e)?"utc":"time"}Format(${t}, ${i})`}function Sn(e){if(!e)return;let t;return he(e)?t={unit:e}:He(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),BE(t.unit)&&(t.utc=!0,t.unit=Fle(t.unit)),t}function Tle(e){const t=Sn(e),{utc:n}=t,i=$le(t,["utc"]);return i.unit?(n?"utc":"")+z(i).map(r=>Je(`${r==="unit"?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+z(i).map(r=>Je(`_${r}_${i[r]}`)).join("")}function Nle(e){return e==null?void 0:e.param}function UE(e){return e&&!!e.field&&e.equal!==void 0}function qE(e){return e&&!!e.field&&e.lt!==void 0}function WE(e){return e&&!!e.field&&e.lte!==void 0}function HE(e){return e&&!!e.field&&e.gt!==void 0}function GE(e){return e&&!!e.field&&e.gte!==void 0}function YE(e){if(e==null?void 0:e.field){if(Q(e.range)&&e.range.length===2)return!0;if(re(e.range))return!0}return!1}function VE(e){return e&&!!e.field&&(Q(e.oneOf)||Q(e.in))}function Rle(e){return e&&!!e.field&&e.valid!==void 0}function m6(e){return VE(e)||UE(e)||YE(e)||qE(e)||HE(e)||WE(e)||GE(e)}function Lr(e,t){return sm(e,{timeUnit:t,wrapTime:!0})}function Lle(e,t){return e.map(n=>Lr(n,t))}function y6(e,t=!0){var n;const{field:i}=e,r=(n=Sn(e.timeUnit))===null||n===void 0?void 0:n.unit,s=r?`time(${jle(r,i)})`:G(e,{expr:"datum"});if(UE(e))return`${s}===${Lr(e.equal,r)}`;if(qE(e)){const o=e.lt;return`${s}<${Lr(o,r)}`}else if(HE(e)){const o=e.gt;return`${s}>${Lr(o,r)}`}else if(WE(e)){const o=e.lte;return`${s}<=${Lr(o,r)}`}else if(GE(e)){const o=e.gte;return`${s}>=${Lr(o,r)}`}else{if(VE(e))return`indexof([${Lle(e.oneOf,r).join(",")}], ${s}) !== -1`;if(Rle(e))return XE(s,e.valid);if(YE(e)){const{range:o}=e,a=re(o)?{signal:`${o.signal}[0]`}:o[0],u=re(o)?{signal:`${o.signal}[1]`}:o[1];if(a!==null&&u!==null&&t)return"inrange("+s+", ["+Lr(a,r)+", "+Lr(u,r)+"])";const l=[];return a!==null&&l.push(`${s} >= ${Lr(a,r)}`),u!==null&&l.push(`${s} <= ${Lr(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ge(e)}`)}function XE(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Ple(e){var t;return m6(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Sn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const pd={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},za=pd.quantitative,KE=pd.ordinal,Al=pd.temporal,QE=pd.nominal,Ol=pd.geojson;function Ile(e){if(e)switch(e=e.toLowerCase(),e){case"q":case za:return"quantitative";case"t":case Al:return"temporal";case"o":case KE:return"ordinal";case"n":case QE:return"nominal";case Ol:return"geojson"}}var Ble=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Ot={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},JE={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function zle(e,t){const n=JE[e],i=JE[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const Ule={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function b6(e){return Ule[e]}const v6=["linear","log","pow","sqrt","symlog","time","utc"],qle=Ma(v6),Wle=["linear","log","pow","sqrt","symlog"],Hle=Ma(Wle);function Gle(e){return e in Hle}const Yle=["quantile","quantize","threshold"],Vle=Ma(Yle),Xle=v6.concat(["quantile","quantize","threshold","sequential","identity"]),Kle=Ma(Xle),Qle=["ordinal","bin-ordinal","point","band"],Jle=Ma(Qle);function rn(e){return e in Jle}function ui(e){return e in Kle}function Zi(e){return e in qle}function md(e){return e in Vle}const Zle={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function ece(e){return!he(e)&&!!e.name}function x6(e){return e==null?void 0:e.param}function tce(e){return e&&e.unionWith}function nce(e){return fe(e)&&"field"in e}const ice={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},rce=Ble(ice,["type","domain","range","rangeMax","rangeMin","scheme"]),sce=z(rce);function ZE(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Zi(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return Zi(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return Zi(e);case"nice":return Zi(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ui(e)&&!be(["log","time","utc","threshold","quantile"],e)}}function w6(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return El(e)?void 0:Vue(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function oce(e,t){return be([KE,QE],t)?e===void 0||rn(e):t===Al?be([Ot.TIME,Ot.UTC,void 0],e):t===za?be([Ot.LOG,Ot.POW,Ot.SQRT,Ot.SYMLOG,Ot.QUANTILE,Ot.QUANTIZE,Ot.THRESHOLD,Ot.LINEAR,void 0],e):!0}function ace(e,t){if(!Ao(e))return!1;switch(e){case tt:case At:case Qi:case Fr:return Zi(t)||be(["band","point"],t);case ms:case xo:case ys:case bo:case vo:case Na:return Zi(t)||md(t)||be(["band","point","ordinal"],t);case qn:case Mr:case Tr:return t!=="band";case wo:case Wn:return t==="ordinal"||md(t)}}const Cn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},E6=Cn.arc,q0=Cn.area,W0=Cn.bar,uce=Cn.image,H0=Cn.line,G0=Cn.point,lce=Cn.rect,Y0=Cn.rule,_6=Cn.text,e_=Cn.tick,cce=Cn.trail,t_=Cn.circle,n_=Cn.square,A6=Cn.geoshape;function $o(e){return["line","area","trail"].includes(e)}function O6(e){return["rect","bar","image","arc"].includes(e)}const S6=z(Cn);function Pr(e){return e.type}Ma(S6);const fce=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],dce=["fill","fillOpacity"],hce=[...fce,...dce],gce={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},C6=z(gce),pce={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},mce={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},yce={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},$6=z(yce);function Sl(e){return e&&e.band!=null}const bce={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},k6=5,vce={binSpacing:1,continuousBandSize:k6,timeUnitBandPosition:.5},xce={binSpacing:0,continuousBandSize:k6,timeUnitBandPosition:.5},wce={thickness:1};function Ece(e){return Pr(e)?e.type:e}function i_(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:s}=e,o=D6(e);return Y(n)&&!RN(n.aggregate)&&r&&Zi(r.get("type"))&&r.get("zero")===!1?F6({fieldDef:n,channel:t,markDef:i,ref:o,config:s}):o}function F6({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return $o(n.type)||Le("invalid",n,r)===null?i:[_ce(e,t),i]}function _ce(e,t){const n=r_(e,!0),r=La(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function r_(e,t=!0){return XE(he(e)?e:G(e,{expr:"datum"}),!t)}function Ace(e){const{datum:t}=e;return Ba(t)?gd(t):`${Ge(t)}`}function Ua(e,t,n,i){const r={};if(t&&(r.scale=t),ko(e)){const{datum:s}=e;Ba(s)?r.signal=gd(s):re(s)?r.signal=s.signal:hd(s)?r.signal=s.expr:r.value=s}else r.field=G(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function V0({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:s=.5}){const o=0<s&&s<1?"datum":void 0,a=G(t,{expr:o,suffix:r}),u=n!==void 0?G(n,{expr:o}):G(t,{suffix:"end",expr:o}),l={};if(s===0||s===1){l.scale=e;const c=s===0?a:u;l.field=c}else{const c=re(s)?`${s.signal} * ${a} + (1-${s.signal}) * ${u}`:`${s} * ${a} + ${1-s} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function D6({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(de(t)){if(Si(t)){c!=null||(c=q6({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:g,type:p}=t;if(Ye(h)||c&&g&&p===Al)return(a==null?void 0:a.impute)?Ua(t,s,{binSuffix:"mid"},{offset:u}):c?V0({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:u}):Ua(t,s,vd(t,e)?{binSuffix:"range"}:{},{offset:u});if(On(h)){if(Y(n))return V0({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});q(l6(e===tt?Ki:kr))}}const d=o==null?void 0:o.get("type");return Ua(t,s,rn(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(er(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},yd(e,d)),h)}}return jae(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function yd(e,t){return be(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:be(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Ze(t)}function qa(e){return e&&e!=="number"&&e!=="time"}function j6(e,t,n){return`${e}(${t}${n?`, ${Ge(n)}`:""})`}const Oce=" \u2013 ";function s_({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var o,a;if(qa(n))return o_({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const u=M6(e,i,r);if(kl(e)){const l=Cce(u,Y(e)?(o=Sn(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,s.timeFormat,Wa(e)&&((a=e.scale)===null||a===void 0?void 0:a.type)===Ot.UTC);return l?{signal:l}:void 0}if(t=R6(c_(e),t,s),Y(e)&&Ye(e.bin)){const l=G(e,{expr:i,binSuffix:"end"});return{signal:X0(u,l,t,n,s)}}else return t||c_(e)==="quantitative"?{signal:`${L6(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function M6(e,t,n){return Y(e)?n?`${G(e,{expr:t,suffix:"end"})}-${G(e,{expr:t,suffix:"start"})}`:G(e,{expr:t}):Ace(e)}function o_({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o!=null||(o=M6(e,i,r)),Y(e)&&Ye(e.bin)){const a=G(e,{expr:i,binSuffix:"end"});return{signal:X0(o,a,t,n,s)}}return{signal:j6(n,o,t)}}function T6(e,t,n,i,r,s){var o;if(!qa(i)){if(kl(e)){const a=Y(e)?(o=Sn(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return Sce(n,a,r,s)}return R6(t,n,r)}}function N6(e,t,n){if(e&&(re(e)||e==="number"||e==="time"))return e;if(kl(t)&&n!=="time"&&n!=="utc")return"time"}function R6(e,t,n){if(he(t))return t;if(e===za)return n.numberFormat}function Sce(e,t,n,i){return e||(t?{signal:p6(t)}:i?void 0:n.timeFormat)}function L6(e,t){return`format(${e}, "${t||""}")`}function P6(e,t,n,i){var r;return qa(n)?j6(n,e,t):L6(e,(r=he(t)?t:void 0)!==null&&r!==void 0?r:i.numberFormat)}function X0(e,t,n,i,r){const s=P6(e,n,i,r),o=P6(t,n,i,r);return`${XE(e,!1)} ? "null" : ${s} + "${Oce}" + ${o}`}function Cce(e,t,n,i,r){return!t||n?(n=he(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):Mle(t,e,r)}const K0="min",$ce={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function I6(e){return e in $ce}function B6(e){return!!e&&!!e.encoding}function Ir(e){return!!e&&(e.op==="count"||!!e.field)}function z6(e){return!!e&&Q(e)}function bd(e){return"row"in e||"column"in e}function a_(e){return!!e&&"header"in e}function Q0(e){return"facet"in e}var u_=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function kce(e){return e.param}function Fce(e){return e&&!he(e)&&"repeat"in e}function U6(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function l_(e){return"sort"in e}function q6({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(de(e)&&e.bandPosition!==void 0)return e.bandPosition;if(Y(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return O6(n.type)?0:Ia("timeUnitBandPosition",n,i);if(Ye(s))return .5}}function W6({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){var a,u,l;const c=Oi(e),f=Le(o?"size":c,i,r,{vgChannel:c});if(f!==void 0)return f;if(Y(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:Ia("timeUnitBandSize",i,r)};if(Ye(h)&&!rn(s))return{band:1}}if(O6(i.type))return s?rn(s)?((a=r[i.type])===null||a===void 0?void 0:a.discreteBandSize)||{band:1}:(u=r[i.type])===null||u===void 0?void 0:u.continuousBandSize:(l=r[i.type])===null||l===void 0?void 0:l.discreteBandSize}function H6(e,t,n,i){return Ye(e.bin)||e.timeUnit&&Si(e)&&e.type==="temporal"?q6({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function J0(e){return e&&"condition"in e}function Z0(e){const t=e&&e.condition;return!!t&&!Q(t)&&Y(t)}function em(e){const t=e&&e.condition;return!!t&&!Q(t)&&de(t)}function Dce(e){const t=e&&e.condition;return!!t&&(Q(t)||er(t))}function Y(e){return e&&(!!e.field||e.aggregate==="count")}function c_(e){return e&&e.type}function ko(e){return e&&"datum"in e}function Br(e){return Si(e)&&!tm(e)||f_(e)}function f_(e){return ko(e)&&pt(e.datum)}function de(e){return Y(e)||ko(e)}function Si(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function er(e){return e&&"value"in e&&"value"in e}function Wa(e){return e&&("scale"in e||"sort"in e)}function d_(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function G6(e){return e&&"legend"in e}function Y6(e){return e&&("format"in e||"formatType"in e)}function jce(e){return oi(e,["legend","axis","header","scale"])}function Mce(e){return"op"in e}function G(e,t={}){var n,i,r;let s=e.field;const o=t.prefix;let a=t.suffix,u="";if(Nce(e))s=ON("count");else{let l;if(!t.nofn)if(Mce(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Ye(c)?(l=LN(c),a=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((i=t.suffix)!==null&&i!==void 0?i:"")):f?Oo(f)?(u=`["${s}"]`,s=`argmax_${f.argmax}`):vs(f)?(u=`["${s}"]`,s=`argmin_${f.argmin}`):l=String(f):d&&(l=Tle(d),a=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((r=t.suffix)!==null&&r!==void 0?r:""))}l&&(s=s?`${l}_${s}`:l)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?OE(s):t.expr?EN(s,t.expr)+u:Ei(s)+u}function tm(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Y(e)&&!!e.bin;case"temporal":return!1}throw new Error(i6(e.type))}function Tce(e){var t;return Wa(e)&&md((t=e.scale)===null||t===void 0?void 0:t.type)}function Nce(e){return e.aggregate==="count"}function Rce(e,t){var n;const{field:i,bin:r,timeUnit:s,aggregate:o}=e;if(o==="count")return t.countTitle;if(Ye(r))return`${i} (binned)`;if(s){const a=(n=Sn(s))===null||n===void 0?void 0:n.unit;if(a)return`${i} (${zE(a).join("-")})`}else if(o)return Oo(o)?`${i} for max ${o.argmax}`:vs(o)?`${i} for min ${o.argmin}`:`${ad(o)} of ${i}`;return i}function Lce(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Oo(t))return`${r} for argmax(${t.argmax})`;if(vs(t))return`${r} for argmin(${t.argmin})`;const s=Sn(i),o=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||Ye(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}const V6=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Lce(e);default:return Rce(e,t)}};let X6=V6;function K6(e){X6=e}function Pce(){K6(V6)}function Cl(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,s;const o=(r=h_(e))===null||r===void 0?void 0:r.title;if(!Y(e))return o;const a=e,u=i?g_(a,t):void 0;return n?mt(o,a.title,u):(s=o!=null?o:a.title)!==null&&s!==void 0?s:u}function h_(e){if(d_(e)&&e.axis)return e.axis;if(G6(e)&&e.legend)return e.legend;if(a_(e)&&e.header)return e.header}function g_(e,t){return X6(e,t)}function nm(e){var t;if(Y6(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=h_(e))!==null&&t!==void 0?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function Ice(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(l_(e)&&Q(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:s}=e;if(s)return"temporal";if(r||i&&!Oo(i)&&!vs(i))return"quantitative";if(Wa(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(JE[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function zr(e){if(Y(e))return e;if(Z0(e))return e.condition}function St(e){if(de(e))return e;if(em(e))return e.condition}function Q6(e,t,n,i={}){if(he(e)||pt(e)||rd(e)){const r=he(e)?"string":pt(e)?"number":"boolean";return q(Rue(t,r,e)),{value:e}}return de(e)?im(e,t,n,i):em(e)?Object.assign(Object.assign({},e),{condition:im(e.condition,t,n,i)}):e}function im(e,t,n,i){if(Y6(e)){const{format:r,formatType:s}=e,o=u_(e,["format","formatType"]);if(qa(s)&&!n.customFormatTypes)return q(n6(t)),im(o,t,n,i)}else{const r=d_(e)?"axis":G6(e)?"legend":a_(e)?"header":null;if(r&&e[r]){const s=e[r],{format:o,formatType:a}=s,u=u_(s,["format","formatType"]);if(qa(a)&&!n.customFormatTypes)return q(n6(t)),im(Object.assign(Object.assign({},e),{[r]:u}),t,n,i)}}return Y(e)?p_(e,t,i):Bce(e)}function Bce(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=pt(n)?"quantitative":he(n)?"nominal":Ba(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function p_(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a=Object.assign({},e);if(!n&&i&&!DE(i)&&!Oo(i)&&!vs(i)&&(q(Pue(i)),delete a.aggregate),r&&(a.timeUnit=Sn(r)),o&&(a.field=`${o}`),Ye(s)&&(a.bin=rm(s,t)),On(s)&&!Rr(t)&&q(mle(t)),Si(a)){const{type:u}=a,l=Ile(u);u!==l&&(a.type=l),u!=="quantitative"&&RN(i)&&(q(Lue(u,i)),a.type="quantitative")}else if(!jN(t)){const u=Ice(a,t);a.type=u}if(Si(a)){const{compatible:u,warning:l}=zce(a,t)||{};u===!1&&q(l)}if(l_(a)&&he(a.sort)){const{sort:u}=a;if(I6(u))return Object.assign(Object.assign({},a),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&I6(l))return Object.assign(Object.assign({},a),{sort:{encoding:l,order:"descending"}})}if(a_(a)){const{header:u}=a;if(u){const{orient:l}=u,c=u_(u,["orient"]);if(l)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return a}function rm(e,t){return rd(e)?{maxbins:PN(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:PN(t)}):e}const $l={compatible:!0};function zce(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ds:case hs:case j0:return tm(e)?$l:{compatible:!1,warning:Uue(t)};case tt:case At:case qn:case Mr:case Tr:case cd:case dd:case M0:case Ra:case T0:case N0:case Na:case Qi:case Fr:case R0:return $l;case jr:case _i:case Dr:case Ji:return n!==za?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:$l;case ys:case bo:case vo:case xo:case ms:case ps:case gs:case Ki:case kr:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:$l;case Wn:case wo:return!tm(e)&&!Tce(e)?{compatible:!1,warning:que(t)}:$l;case fd:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:$l}}function kl(e){const{formatType:t}=nm(e);return t==="time"||!t&&Uce(e)}function Uce(e){return e&&(e.type==="temporal"||Y(e)&&!!e.timeUnit)}function sm(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var s;const o=t&&((s=Sn(t))===null||s===void 0?void 0:s.unit);let a=o||n==="temporal",u;return hd(e)?u=e.expr:re(e)?u=e.signal:Ba(e)?(a=!0,u=gd(e)):(he(e)||pt(e))&&a&&(u=`datetime(${Ge(e)})`,kle(o)&&(pt(e)&&e<1e4||he(e)&&isNaN(Date.parse(e)))&&(u=gd({[o]:e}))),u?i&&a?`time(${u})`:u:r?void 0:Ge(e)}function J6(e,t){const{type:n}=e;return t.map(i=>{const r=sm(i,{timeUnit:Y(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function vd(e,t){return Ye(e.bin)?Ao(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const Z6={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function xd(e){return e&&e.condition}const eR=["domain","grid","labels","ticks","title"],qce={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},tR={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Wce=Object.assign(Object.assign({},tR),{style:1,labelExpr:1,encoding:1});function nR(e){return!!Wce[e]}const Hce={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},iR=z(Hce);function Es(e){return"mark"in e}class om{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Es(t)?Ece(t.mark)===this.name:!1}}var Gce=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Ha(e,t){const n=e&&e[t];return n?Q(n)?xl(n,i=>!!i.field):Y(n)||Z0(n):!1}function m_(e){return xl(Wae,t=>{if(Ha(e,t)){const n=e[t];if(Q(n))return xl(n,i=>!!i.aggregate);{const i=zr(n);return i&&!!i.aggregate}}return!1})}function rR(e,t){const n=[],i=[],r=[],s=[],o={};return y_(e,(a,u)=>{if(Y(a)){const{field:l,aggregate:c,bin:f,timeUnit:d}=a,h=Gce(a,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=h_(a),p=g==null?void 0:g.title;let m=G(a,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:Cl(a,t,{allowDisabling:!0})}),h),{field:m});if(c){let b;if(Oo(c)?(b="argmax",m=G({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):vs(c)?(b="argmin",m=G({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(b=c),b){const x={op:b,as:m};l&&(x.field=l),s.push(x)}}else if(n.push(m),Si(a)&&Ye(f)){if(i.push({bin:f,field:l,as:m}),n.push(G(a,{binSuffix:"end"})),vd(a,u)&&n.push(G(a,{binSuffix:"range"})),Rr(u)){const b={field:`${m}_end`};o[`${u}2`]=b}y.bin="binned",jN(u)||(y.type=za)}else if(d){r.push({timeUnit:d,field:l,as:m});const b=Si(a)&&a.type!==Al&&"time";b&&(u===cd||u===Ra?y.formatType=b:Zae(u)?y.legend=Object.assign({formatType:b},y.legend):Rr(u)&&(y.axis=Object.assign({formatType:b},y.axis)))}o[u]=y}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function Yce(e,t,n){const i=tue(t,n);if(i){if(i==="binned"){const r=e[t===Ki?tt:At];return!!(Y(r)&&Y(e[t])&&On(r.bin))}}else return!1;return!0}function Vce(e,t,n,i){return z(e).reduce((r,s)=>{if(!DN(s))return q(zue(s)),r;const o=e[s];if(s==="angle"&&t==="arc"&&!e.theta&&(q(Nue),s=Qi),!Yce(e,s,t))return q(z0(s,t)),r;if(s===ms&&t==="line"){const a=zr(e[s]);if(a==null?void 0:a.aggregate)return q(Bue),r}if(s===qn&&(n?"fill"in e:"stroke"in e))return q(r6("encoding",{fill:"fill"in e,stroke:"stroke"in e})),r;if(s===dd||s===fd&&!Q(o)&&!er(o)||s===Ra&&Q(o))o&&(r[s]=at(o).reduce((a,u)=>(Y(u)?a.push(p_(u,s)):q(RE(u,s)),a),[]));else{if(s===Ra&&o===null)r[s]=null;else if(!Y(o)&&!ko(o)&&!er(o)&&!J0(o)&&!re(o))return q(RE(o,s)),r;r[s]=Q6(o,s,i)}return r},{})}function am(e,t){const n={};for(const i of z(e)){const r=Q6(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Xce(e){const t=[];for(const n of z(e))if(Ha(e,n)){const i=e[n],r=at(i);for(const s of r)Y(s)?t.push(s):Z0(s)&&t.push(s.condition)}return t}function y_(e,t,n){if(!!e)for(const i of z(e)){const r=e[i];if(Q(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function Kce(e,t,n,i){return e?z(e).reduce((r,s)=>{const o=e[s];return Q(o)?o.reduce((a,u)=>t.call(i,a,u,s),r):t.call(i,r,o,s)},n):n}function sR(e,t){return z(t).reduce((n,i)=>{switch(i){case tt:case At:case T0:case R0:case N0:case Ki:case kr:case Qi:case ps:case Fr:case gs:case Dr:case jr:case Ji:case _i:case cd:case Wn:case Na:case Ra:return n;case fd:if(e==="line"||e==="trail")return n;case dd:case M0:{const r=t[i];if(Q(r)||Y(r))for(const s of at(r))s.aggregate||n.push(G(s,{}));return n}case ms:if(e==="trail")return n;case qn:case Mr:case Tr:case ys:case bo:case vo:case wo:case xo:{const r=zr(t[i]);return r&&!r.aggregate&&n.push(G(r,{})),n}}},[])}var oR=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Qce(e){const{tooltip:t}=e,n=oR(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(Q(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return Q(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function b_(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const u=i?` of ${v_(t)}`:"";return{field:o+t.field,type:t.type,title:re(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),s=Xce(n).map(jce);return{tooltip:[...r,...$r(s,_e)]}}function v_(e){const{title:t,field:n}=e;return mt(t,n)}function x_(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=v_(n);return aR(e,a,r,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),s!==void 0?{scale:s}:{}),o!==void 0?{axis:o}:{})},he(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function aR(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),s?{color:s}:{}),o?{opacity:o}:{}),Pr(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),rd(e[t])?{}:e[t])})]:[]}function uR(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[`${r}2`],a=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:um(s,n),continuousAxisChannelDef2:um(o,n),continuousAxisChannelDefError:um(a,n),continuousAxisChannelDefError2:um(u,n),continuousAxis:r}}function um(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,i=oR(e,["aggregate"]);return n!==t&&q(ple(n,t)),i}else return e}function lR(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Pr(n)&&n.orient)return n.orient;if(Br(r)){if(Br(s)){const o=Y(r)&&r.aggregate,a=Y(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return kl(s)&&!kl(r)?"horizontal":"vertical"}return"horizontal"}else{if(Br(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var lm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const cm="boxplot",Jce=["box","median","outliers","rule","ticks"],Zce=new om(cm,fR);function cR(e){return pt(e)?"tukey":e}function fR(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:am(e.encoding,t)});const{mark:r,encoding:s,params:o,projection:a}=e,u=lm(e,["mark","encoding","params","projection"]),l=Pr(r)?r:{type:r};o&&q(ZN("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Le("size",l,t),d=cR(c),{bins:h,timeUnits:g,transform:p,continuousAxisChannelDef:m,continuousAxis:y,groupby:b,aggregate:x,encodingWithoutContinuousAxis:w,ticksOrient:_,boxOrient:A,customTooltipWithoutAggregatedField:E}=efe(e,c,t),{color:S,size:k}=w,$=lm(w,["color","size"]),F=ct=>x_(l,y,m,ct,t.boxplot),M=F($),j=F(w),I=F(Object.assign(Object.assign({},$),k?{size:k}:{})),D=b_([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,w),P={type:"tick",color:"black",opacity:1,orient:_,invalid:null,aria:!1},B=d==="min-max"?D:b_([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,w),H=[...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:B}),...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:B}),...M({partName:"ticks",mark:P,positionPrefix:"lower_whisker",extraEncoding:B}),...M({partName:"ticks",mark:P,positionPrefix:"upper_whisker",extraEncoding:B})],X=[...d!=="tukey"?H:[],...j({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:A,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:D}),...I({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},He(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:_,aria:!1}),positionPrefix:"mid_box",extraEncoding:D})];if(d==="min-max")return Object.assign(Object.assign({},u),{transform:((i=u.transform)!==null&&i!==void 0?i:[]).concat(p),layer:X});const ce=`datum["lower_box_${m.field}"]`,Te=`datum["upper_box_${m.field}"]`,$e=`(${Te} - ${ce})`,nt=`${ce} - ${c} * ${$e}`,qe=`${Te} + ${c} * ${$e}`,lt=`datum["${m.field}"]`,ln={joinaggregate:dR(m.field),groupby:b},ki={transform:[{filter:`(${nt} <= ${lt}) && (${lt} <= ${qe})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...x],groupby:b}],layer:H},ci=lm($,["tooltip"]),{scale:V,axis:le}=m,me=v_(m),U=oi(le,["title"]),ht=aR(l,"outliers",t.boxplot,{transform:[{filter:`(${lt} < ${nt}) || (${lt} > ${qe})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},me!==void 0?{title:me}:{}),V!==void 0?{scale:V}:{}),ze(U)?{}:{axis:U})},ci),S?{color:S}:{}),E?{tooltip:E}:{})})[0];let we;const bt=[...h,...g,ln];return ht?we={transform:bt,layer:[ht,ki]}:(we=ki,we.transform.unshift(...bt)),Object.assign(Object.assign({},u),{layer:[we,{transform:p,layer:X}]})}function dR(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function efe(e,t,n){const i=lR(e,cm),{continuousAxisChannelDef:r,continuousAxis:s}=uR(e,i,cm),o=r.field,a=cR(t),u=[...dR(o),{op:"median",field:o,as:`mid_box_${o}`},{op:"min",field:o,as:(a==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(a==="min-max"?"upper_whisker_":"max_")+o}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:`iqr_${o}`},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:`upper_whisker_${o}`},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:`lower_whisker_${o}`}],c=e.encoding,f=s;c[f];const d=lm(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=Qce(d),{bins:p,timeUnits:m,aggregate:y,groupby:b,encoding:x}=rR(g,n),w=i==="vertical"?"horizontal":"vertical",_=i,A=[...p,...m,{aggregate:[...y,...u],groupby:b},...l];return{bins:p,timeUnits:m,transform:A,groupby:b,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:_,customTooltipWithoutAggregatedField:h}}var hR=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const w_="errorbar",tfe=["ticks","rule"],nfe=new om(w_,gR);function gR(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:am(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=pR(e,w_,t);delete s.size;const c=x_(a,r,i,s,t.errorbar),f=a.thickness,d=a.size,h=Object.assign(Object.assign({type:"tick",orient:o,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),g=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function ife(e,t){const{encoding:n}=e;if(rfe(n))return{orient:lR(e,t),inputType:"raw"};const i=sfe(n),r=ofe(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(de(a)&&de(u))throw new Error(`${t} cannot have both x2 and y2`);if(de(a)){if(Br(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(de(u)){if(Br(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(de(u)&&!de(a))throw new Error(`${t} cannot have xError2 without xError`);if(de(c)&&!de(l))throw new Error(`${t} cannot have yError2 without yError`);if(de(a)&&de(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(de(a)){if(Br(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(de(l)){if(Br(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function rfe(e){return(de(e.x)||de(e.y))&&!de(e.x2)&&!de(e.y2)&&!de(e.xError)&&!de(e.xError2)&&!de(e.yError)&&!de(e.yError2)}function sfe(e){return de(e.x2)||de(e.y2)}function ofe(e){return de(e.xError)||de(e.xError2)||de(e.yError)||de(e.yError2)}function pR(e,t,n){var i;const{mark:r,encoding:s,params:o,projection:a}=e,u=hR(e,["mark","encoding","params","projection"]),l=Pr(r)?r:{type:r};o&&q(ZN(t));const{orient:c,inputType:f}=ife(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=uR(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:b,tooltipSummary:x,tooltipTitleWithFieldName:w}=afe(l,d,h,g,p,f,t,n),_=s,A=m;_[A];const E=m==="x"?"x2":"y2";_[E];const S=m==="x"?"xError":"yError";_[S];const k=m==="x"?"xError2":"yError2";_[k];const $=hR(_,[typeof A=="symbol"?A:A+"",typeof E=="symbol"?E:E+"",typeof S=="symbol"?S:S+"",typeof k=="symbol"?k:k+""]),{bins:F,timeUnits:M,aggregate:j,groupby:I,encoding:D}=rR($,n),P=[...j,...y],B=f!=="raw"?[]:I,H=b_(x,d,D,w);return{transform:[...(i=u.transform)!==null&&i!==void 0?i:[],...F,...M,...P.length===0?[]:[{aggregate:P,groupby:B}],...b],groupby:B,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:D,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:H}}function afe(e,t,n,i,r,s,o,a){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&q(gle(h,g,o)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:ad(h)},{fieldPrefix:"upper_",titlePrefix:mR(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:mR(h,g,"-")}],d=!0;else{let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:p,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Cl({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Cl({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Cl({field:c,aggregate:p,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&q(hle(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Ta(Ta(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function mR(e,t,n){return`${ad(e)} ${n} ${t}`}const E_="errorband",ufe=["band","borders"],lfe=new om(E_,yR);function yR(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:am(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=pR(e,E_,t),l=o,c=x_(l,r,i,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),g),{aria:!1})):l.interpolate?q(u6("interpolate")):l.tension&&q(u6("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const bR={};function __(e,t,n){const i=new om(e,t);bR[e]={normalizer:i,parts:n}}function cfe(){return z(bR)}__(cm,fR,Jce);__(w_,gR,tfe);__(E_,yR,ufe);const ffe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],vR={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},xR={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},dfe=z(vR),hfe=z(xR),gfe={header:1,headerRow:1,headerColumn:1,headerFacet:1},wR=z(gfe),ER=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],pfe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},mfe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},wd="_vgsid_",yfe={point:{on:"click",fields:[wd],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function A_(e){return!!e&&(e==="legend"||!!e.legend)}function O_(e){return A_(e)&&He(e)}function S_(e){return!!e.select}var bfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function _R(e){const t=[];for(const n of e||[]){if(S_(n))continue;const{expr:i,bind:r}=n,s=bfe(n,["expr","bind"]);if(r&&i){const o=Object.assign(Object.assign({},s),{bind:r,init:i});t.push(o)}else{const o=Object.assign(Object.assign(Object.assign({},s),i?{update:i}:{}),r?{bind:r}:{});t.push(o)}}return t}function vfe(e){return fm(e)||$_(e)||C_(e)}function C_(e){return"concat"in e}function fm(e){return"vconcat"in e}function $_(e){return"hconcat"in e}function Ur(e){return He(e)&&e.step!==void 0}function AR(e){return e.view||e.width||e.height}const OR=20,xfe={align:1,bounds:1,center:1,columns:1,spacing:1},wfe=z(xfe);function Efe(e,t,n){var i,r;const s=n[t],o={},{spacing:a,columns:u}=s;a!==void 0&&(o.spacing=a),u!==void 0&&(Q0(e)&&!bd(e.facet)||C_(e))&&(o.columns=u),fm(e)&&(o.columns=1);for(const l of wfe)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=pt(c)?c:{row:(i=c.row)!==null&&i!==void 0?i:a,column:(r=c.column)!==null&&r!==void 0?r:a}}else o[l]=e[l];return o}var _fe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function k_(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function dm(e,t){const n=Ed(e,t);return Ur(n)?n.step:SR}function Ed(e,t){var n;const i=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return mt(i,{step:e.step})}const SR=20,Afe={continuousWidth:200,continuousHeight:200,step:SR},Ofe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Afe,mark:mce,arc:{},area:{},bar:vce,circle:{},geoshape:{},image:{},line:{},point:{},rect:xce,rule:{color:"black"},square:{},text:{color:"black"},tick:wce,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:Zle,projection:{},legend:pfe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:yfe,style:{},title:{},facet:{spacing:OR},concat:{spacing:OR}},_s=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],CR={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},$R={blue:_s[0],orange:_s[1],red:_s[2],teal:_s[3],green:_s[4],yellow:_s[5],purple:_s[6],pink:_s[7],brown:_s[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Sfe(e={}){return{signals:[{name:"color",value:He(e)?Object.assign(Object.assign({},$R),e):$R}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Cfe(e){return{signals:[{name:"fontSize",value:He(e)?Object.assign(Object.assign({},CR),e):CR}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function $fe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function kR(e){const t=z(e||{}),n={};for(const i of t){const r=e[i];n[i]=xd(r)?BN(r):ai(r)}return n}function kfe(e){const t=z(e),n={};for(const i of t)n[i]=kR(e[i]);return n}const Ffe=[...$6,...iR,...wR,"background","padding","legend","lineBreak","scale","style","title","view"];function FR(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,s=_fe(e,["color","font","fontSize","selection"]),o=bN({},ge(Ofe),n?$fe(n):{},t?Sfe(t):{},i?Cfe(i):{},s||{});r&&rc(o,"selection",r,!0);const a=oi(o,Ffe);for(const u of["background","lineBreak","padding"])o[u]&&(a[u]=ai(o[u]));for(const u of $6)o[u]&&(a[u]=Hn(o[u]));for(const u of iR)o[u]&&(a[u]=kR(o[u]));for(const u of wR)o[u]&&(a[u]=Hn(o[u]));return o.legend&&(a.legend=Hn(o.legend)),o.scale&&(a.scale=Hn(o.scale)),o.style&&(a.style=kfe(o.style)),o.title&&(a.title=Hn(o.title)),o.view&&(a.view=Hn(o.view)),a}const Dfe=["view",...S6],jfe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Mfe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},pce);function Tfe(e){e=ge(e);for(const t of jfe)delete e[t];if(e.axis)for(const t in e.axis)xd(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of ffe)delete e.legend[t];if(e.mark){for(const t of C6)delete e.mark[t];e.mark.tooltip&&He(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(_R(e.params)),delete e.params);for(const t of Dfe){for(const i of C6)delete e[t][i];const n=Mfe[t];if(n)for(const i of n)delete e[t][i];Rfe(e,t)}for(const t of cfe())delete e[t];Nfe(e);for(const t in e)He(e[t])&&ze(e[t])&&delete e[t];return ze(e)?void 0:e}function Nfe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=IN(e.title);ze(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),ze(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),ze(i)?delete e.title:e.title=i}function Rfe(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const s=Object.assign(Object.assign({},r),e.style[n!=null?n:t]);ze(s)||(e.style[n!=null?n:t]=s),i||delete e[t]}function hm(e){return"layer"in e}function Lfe(e){return"repeat"in e}function Pfe(e){return!Q(e.repeat)&&e.repeat.layer}var Ife=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class F_{map(t,n){return Q0(t)?this.mapFacet(t,n):Lfe(t)?this.mapRepeat(t,n):$_(t)?this.mapHConcat(t,n):fm(t)?this.mapVConcat(t,n):C_(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(hm(t))return this.mapLayer(t,n);if(Es(t))return this.mapUnit(t,n);throw new Error(TE(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=Ife(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Bfe={zero:1,center:1,normalize:1};function zfe(e){return e in Bfe}const Ufe=new Set([E6,W0,q0,Y0,G0,t_,n_,H0,_6,e_]),qfe=new Set([W0,q0,E6]);function Fl(e){return Y(e)&&c_(e)==="quantitative"&&!e.bin}function DR(e,t){var n,i;const r=t==="x"?"y":"radius",s=e[t],o=e[r];if(Y(s)&&Y(o))if(Fl(s)&&Fl(o)){if(s.stack)return t;if(o.stack)return r;const a=Y(s)&&!!s.aggregate,u=Y(o)&&!!o.aggregate;if(a!==u)return a?t:r;{const l=(n=s.scale)===null||n===void 0?void 0:n.type,c=(i=o.scale)===null||i===void 0?void 0:i.type;if(l&&l!=="linear")return r;if(c&&c!=="linear")return t}}else{if(Fl(s))return t;if(Fl(o))return r}else{if(Fl(s))return t;if(Fl(o))return r}}function Wfe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function jR(e,t,n={}){var i,r;const s=Pr(e)?e.type:e;if(!Ufe.has(s))return null;const o=DR(t,"x")||DR(t,"theta");if(!o)return null;const a=t[o],u=Y(a)?G(a,{}):void 0;let l=Wfe(o),c=t[l],f=Y(c)?G(c,{}):void 0;f===u&&(f=void 0,c=void 0,l=void 0);const d=Kae.reduce((g,p)=>{if(p!=="tooltip"&&Ha(t,p)){const m=t[p];for(const y of at(m)){const b=zr(y);if(b.aggregate)continue;const x=G(b,{});(!x||x!==f)&&g.push({channel:p,fieldDef:b})}}return g},[]);let h;if(a.stack!==void 0?rd(a.stack)?h=a.stack?"zero":null:h=a.stack:qfe.has(s)&&(h="zero"),!h||!zfe(h)||m_(t)&&d.length===0)return null;if(((i=a==null?void 0:a.scale)===null||i===void 0?void 0:i.type)&&((r=a==null?void 0:a.scale)===null||r===void 0?void 0:r.type)!==Ot.LINEAR){if(n.disallowNonLinearStack)return null;q(cle(a.scale.type))}return de(t[bs(o)])?(a.stack!==void 0&&q(lle(o)),null):(Y(a)&&a.aggregate&&!be(uue,a.aggregate)&&q(fle(a.aggregate)),{groupbyChannel:c?l:void 0,groupbyField:f,fieldChannel:o,impute:a.impute===null?!1:$o(s),stackBy:d,offset:h})}var MR=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Hfe(e){const t=MR(e,["point","line"]);return z(t).length>1?t:t.type}function Gfe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:oi(e[t],["point","line"])}));return e}function D_(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?He(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?He(t.point)?t.point:{}:void 0}function TR(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Yfe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Es(t)){const{mark:i,encoding:r}=t,s=Pr(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!D_(s,n[s.type],r);case"area":return!!D_(s,n[s.type],r)||!!TR(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,encoding:u}=t,l=MR(t,["params","projection","mark","encoding"]),c=am(u,r),f=Pr(a)?a:{type:a},d=D_(f,r[f.type],c),h=f.type==="area"&&TR(f,r[f.type]),g=[Object.assign(Object.assign({},s?{params:s}:{}),{mark:Hfe(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:oi(c,["shape"])})],p=jR(f,c);let m=c;if(p){const{fieldChannel:y,offset:b}=p;m=Object.assign(Object.assign({},c),{[y]:Object.assign(Object.assign({},c[y]),b?{stack:b}:{})})}return h&&g.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},vl(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&g.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},vl(f,["clip","tooltip"])),d),encoding:m})),i(Object.assign(Object.assign({},l),{layer:g}),Object.assign(Object.assign({},n),{config:Gfe(r)}))}}var Vfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Xfe(e,t){return t?bd(e)?PR(e,t):NR(e,t):e}function j_(e,t){return t?PR(e,t):e}function M_(e,t,n){const i=t[e];if(Fce(i)){if(i.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[i.repeat]});q($ue(i.repeat));return}return t}function NR(e,t){if(e=M_("field",e,t),e!==void 0){if(e===null)return null;if(l_(e)&&Ir(e.sort)){const n=M_("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function RR(e,t){if(Y(e))return NR(e,t);{const n=M_("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function LR(e,t){if(de(e)){const n=RR(e,t);if(n)return n;if(J0(e))return{condition:e.condition}}else{if(em(e)){const n=RR(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):Vfe(e,["condition"])}return e}}function PR(e,t){const n={};for(const i in e)if(yl(e,i)){const r=e[i];if(Q(r))n[i]=r.map(s=>LR(s,t)).filter(s=>s);else{const s=LR(r,t);s!==void 0&&(n[i]=s)}}return n}class Kfe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Es(t)){const{encoding:n,mark:i}=t;if(i==="line"||Pr(i)&&i.type==="line")for(const r of Vae){const s=La(r),o=n[s];if(n[r]&&(Y(o)&&!On(o.bin)||ko(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return q(Gue(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:He(s)?Object.assign(Object.assign({},s),{type:"rule"}):"rule"}),n)}}var Fo=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Qfe extends F_{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[Zce,nfe,lfe,new Yfe,new Kfe]}map(t,n){if(Es(t)){const i=Ha(t.encoding,ds),r=Ha(t.encoding,hs),s=Ha(t.encoding,j0);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=j_(t.encoding,n.repeater),o=Object.assign(Object.assign({},t),s?{encoding:s}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(o,n.config))return u.run(o,n,a);return o}mapRepeat(t,n){return Pfe(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,s=Fo(t,["repeat","spec"]),{row:o,column:a,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:u},spec:r}}),n):Object.assign(Object.assign({},s),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(r.name||"")+c}child__layer_${Je(f)}`,g=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:s,data:o}=t,a=Fo(t,["repeat","spec","data"]);!Q(r)&&t.columns&&(t=oi(t,["columns"]),q(e6("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!Q(r)&&r.row||[l?l.row:null],d=!Q(r)&&r.column||[l?l.column:null],h=Q(r)&&r||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const b={repeat:p,row:m,column:y,layer:l.layer},x=(s.name||"")+c+"child__"+(Q(r)?`${Je(p)}`:(r.row?`row_${Je(m)}`:"")+(r.column?`column_${Je(y)}`:"")),w=this.map(s,Object.assign(Object.assign({},n),{repeater:b,repeaterPrefix:x}));w.name=x,u.push(oi(w,["data"]))}const g=Q(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(i=s.data)!==null&&i!==void 0?i:o,align:"all"},a),{columns:g,concat:u})}mapFacet(t,n){const{facet:i}=t;return bd(i)&&t.columns&&(t=oi(t,["columns"]),q(e6("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,u=BR({parentProjection:o,projection:r}),l=IR({parentEncoding:s,encoding:j_(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:a})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:s,facet:o}=i,a=Fo(i,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h,encoding:g}=t,p=Fo(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:r,column:s,facet:o},n),b=j_(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:b}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:s,facet:o}=t;if(r||s){o&&q(Wue([...r?[ds]:[],...s?[hs]:[]]));const a={},u={};for(const l of[ds,hs]){const c=t[l];if(c){const f=Fo(c,["align","center","spacing","columns"]);a[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&((i=u[d])!==null&&i!==void 0||(u[d]={}),u[d][l]=c[d])}}return{facetMapping:a,layout:u}}else{const{align:a,center:u,spacing:l,columns:c}=o,f=Fo(o,["align","center","spacing","columns"]);return{facetMapping:Xfe(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,s=Fo(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,u=Fo(t,["encoding","projection"]),l=Object.assign(Object.assign({},s),{parentEncoding:IR({parentEncoding:i,encoding:o,layer:!0}),parentProjection:BR({parentProjection:r,projection:a})});return super.mapLayer(u,l)}}function IR({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...z(e),...z(t)]);for(const s of r){const o=t[s],a=e[s];if(de(o)){const u=Object.assign(Object.assign({},a),o);i[s]=u}else em(o)?i[s]=Object.assign(Object.assign({},o),{condition:Object.assign(Object.assign({},a),o.condition)}):o||o===null?i[s]=o:(n||er(a)||re(a)||de(a)||Q(a))&&(i[s]=a)}}else i=t;return!i||ze(i)?void 0:i}function BR(e){const{parentProjection:t,projection:n}=e;return t&&n&&q(Tue({parentProjection:t,projection:n})),n!=null?n:t}function T_(e){return"filter"in e}function Jfe(e){return(e==null?void 0:e.stop)!==void 0}function zR(e){return"lookup"in e}function Zfe(e){return"data"in e}function ede(e){return"param"in e}function tde(e){return"pivot"in e}function nde(e){return"density"in e}function ide(e){return"quantile"in e}function rde(e){return"regression"in e}function sde(e){return"loess"in e}function ode(e){return"sample"in e}function ade(e){return"window"in e}function ude(e){return"joinaggregate"in e}function lde(e){return"flatten"in e}function cde(e){return"calculate"in e}function UR(e){return"bin"in e}function fde(e){return"impute"in e}function dde(e){return"timeUnit"in e}function hde(e){return"aggregate"in e}function gde(e){return"stack"in e}function pde(e){return"fold"in e}function mde(e){return e.map(t=>T_(t)?{filter:bl(t.filter,Ple)}:t)}var Do=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class yde extends F_{map(t,n){var i,r;return(i=n.emptySelections)!==null&&i!==void 0||(n.emptySelections={}),(r=n.selectionPredicates)!==null&&r!==void 0||(n.selectionPredicates={}),t=qR(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=qR(t,n),t.encoding){const i={};for(const[r,s]of yo(t.encoding))i[r]=WR(s,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,s=Do(i,["selection"]);return r?Object.assign(Object.assign({},s),{params:yo(r).map(([o,a])=>{var u;const l=a,{init:c,bind:f,empty:d}=l,h=Do(l,["init","bind","empty"]);h.type==="single"?(h.type="point",h.toggle=!1):h.type==="multi"&&(h.type="point"),n.emptySelections[o]=d!=="none";for(const g of nn((u=n.selectionPredicates[o])!==null&&u!==void 0?u:{}))g.empty=d!=="none";return{name:o,value:c,select:h,bind:f}})}):t}}function qR(e,t){const{transform:n}=e,i=Do(e,["transform"]);if(n){const r=n.map(s=>{if(T_(s))return{filter:N_(s,t)};if(UR(s)&&Pa(s.bin))return Object.assign(Object.assign({},s),{bin:HR(s.bin)});if(zR(s)){const o=s.from,{selection:a}=o,u=Do(o,["selection"]);return a?Object.assign(Object.assign({},s),{from:Object.assign({param:a},u)}):s}return s});return Object.assign(Object.assign({},i),{transform:r})}return e}function WR(e,t){var n,i;const r=ge(e);if(Y(r)&&Pa(r.bin)&&(r.bin=HR(r.bin)),Wa(r)&&((i=(n=r.scale)===null||n===void 0?void 0:n.domain)===null||i===void 0?void 0:i.selection)){const s=r.scale.domain,{selection:o}=s,a=Do(s,["selection"]);r.scale.domain=Object.assign(Object.assign({},a),o?{param:o}:{})}if(J0(r))if(Z(r.condition))r.condition=r.condition.map(s=>{const{selection:o,param:a,test:u}=s,l=Do(s,["selection","param","test"]);return a?s:Object.assign(Object.assign({},l),{test:N_(s,t)})});else{const s=WR(r.condition,t),{selection:o,param:a,test:u}=s,l=Do(s,["selection","param","test"]);r.condition=a?r.condition:Object.assign(Object.assign({},l),{test:N_(r.condition,t)})}return r}function HR(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,i=Do(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function N_(e,t){const n=i=>bl(i,r=>{var s,o,a;const u=(s=t.emptySelections[r])!==null&&s!==void 0?s:!0,l={param:r,empty:u};return(o=(a=t.selectionPredicates)[r])!==null&&o!==void 0||(a[r]=[]),t.selectionPredicates[r].push(l),l});return e.selection?n(e.selection):bl(e.test||e.filter,i=>i.selection?n(i.selection):i)}class R_ extends F_{map(t,n){var i;const r=(i=n.selections)!==null&&i!==void 0?i:[];if(t.params&&!Es(t)){const s=[];for(const o of t.params)S_(o)?r.push(o):s.push(o);t.params=s}return n.selections=r,super.map(t,GR(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const s=((i=n.path)!==null&&i!==void 0?i:[]).concat(t.name),o=[];for(const a of r)if(!a.views||!a.views.length)o.push(a);else for(const u of a.views)(Se(u)&&(u===t.name||s.indexOf(u)>=0)||Z(u)&&u.map(l=>s.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&o.push(a);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=R_.prototype[e];R_.prototype[e]=function(n,i){return t.call(this,n,GR(n,i))}}function GR(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function YR(e,t){t===void 0&&(t=FR(e.config));const n=wde(e,t),{width:i,height:r}=e,s=Ede(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const bde=new Qfe,vde=new yde,xde=new R_;function wde(e,t={}){const n={config:t};return xde.map(bde.map(vde.map(e,n),n),n)}function VR(e){return he(e)?{type:e}:e!=null?e:{}}function Ede(e,t,n){let{width:i,height:r}=t;const s=Es(e)||hm(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(q(XN("width")),i=void 0),r=="container"&&(q(XN("height")),r=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?VR(n.autosize):{}),VR(e.autosize));if(a.type==="fit"&&!s&&(q(bue),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&q(KN("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&q(KN("height")),!Cr(a,{type:"pad"}))return a}function _de(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Ade(e){return e?`fit-${L0(e)}`:"fit"}const Ode=["background","padding"];function XR(e,t){const n={};for(const i of Ode)e&&e[i]!==void 0&&(n[i]=ai(e[i]));return t&&(n.params=e.params),n}class As{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new As(ge(this.explicit),ge(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return mt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of z(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function Os(e){return{explicit:!0,value:e}}function li(e){return{explicit:!1,value:e}}function KR(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:gm(t,n,i,r)}}function gm(e,t,n,i){return e.explicit&&t.explicit&&q(nle(n,i,e.value,t.value)),e}function jo(e,t,n,i,r=gm){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Cr(e.value,t.value)?e:r(e,t,n,i)}class Sde extends As{constructor(t={},n={},i=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Dl(e){return"url"in e}function _d(e){return"values"in e}function QR(e){return"name"in e&&!Dl(e)&&!_d(e)&&!Mo(e)}function Mo(e){return e&&(JR(e)||ZR(e)||L_(e))}function JR(e){return"sequence"in e}function ZR(e){return"sphere"in e}function L_(e){return"graticule"in e}var Ve;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(Ve||(Ve={}));const Cde="view",pm="[",mm="]",e8="{",t8="}",$de=":",n8=",",kde="@",Fde=">",Dde=/[[\]{}]/,jde={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let i8,r8;function jl(e,t,n){return i8=t||Cde,r8=n||jde,s8(e.trim()).map(P_)}function Mde(e){return r8[e]}function Ad(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function s8(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Ad(e,r,n8,pm+e8,mm+t8),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function P_(e){return e[0]==="["?Tde(e):Nde(e)}function Tde(e){const t=e.length;let n=1,i;if(n=Ad(e,n,mm,pm,mm),n===t)throw"Empty between selector: "+e;if(i=s8(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Fde)throw"Expected '>' after between selector: "+e;i=i.map(P_);const r=P_(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function Nde(e){const t={source:i8},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===t8){if(a=e.lastIndexOf(e8),a>=0){try{i=Rde(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===kde&&(r=++a),u=Ad(e,a,$de),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=Ad(e,a,pm),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Ad(e,a,mm),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==pm)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||Dde.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):Mde(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Rde(e){const t=e.split(n8);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}var Lde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Ml(e,t=!0,n=Oae){if(Q(e)){const i=e.map(r=>Ml(r,t,n));return t?`[${i.join(", ")}]`:i}else if(Ba(e))return n(t?gd(e):Cle(e));return t?n(Ge(e)):e}function Pde(e,t){var n;for(const i of nn((n=e.component.selection)!==null&&n!==void 0?n:{})){const r=i.name;let s=`${r}${Ro}, ${i.resolve==="global"?"true":`{unit: ${Rl(e)}}`}`;for(const o of wm)!o.defined(i)||(o.signals&&(t=o.signals(e,i,t)),o.modifyExpr&&(s=o.modifyExpr(e,i,s)));t.push({name:r+yhe,on:[{events:{signal:i.name+Ro},update:`modify(${Ce(i.name+Ga)}, ${s})`}]})}return I_(t)}function Ide(e,t){if(e.component.selection&&z(e.component.selection).length){const n=Ce(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:jl("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return I_(t)}function Bde(e,t){var n;let i=!1;for(const r of nn((n=e.component.selection)!==null&&n!==void 0?n:{})){const s=r.name,o=Ce(s+Ga);if(t.filter(u=>u.name===s).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${$8}(${o}, ${Ce(u)}${l}`})}i=!0;for(const u of wm)u.defined(r)&&u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))}return i&&t.filter(s=>s.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),I_(t)}function zde(e,t){var n;const i=[...t];for(const r of nn((n=e.component.selection)!==null&&n!==void 0?n:{})){const s={name:r.name+Ga};if(r.init){const a=r.project.items.map(u=>Lde(u,["signals"]));s.values=r.init.map(u=>({unit:Rl(e,{escape:!1}),fields:a,values:Ml(u,!1)}))}i.filter(a=>a.name===r.name+Ga).length||i.push(s)}return i}function o8(e,t){var n;for(const i of nn((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const r of wm)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function Ude(e,t){for(const n of e.children)yt(n)&&(t=o8(n,t));return t}function qde(e,t,n,i){const r=G8(e,t.param,t);return{signal:ui(n.get("type"))&&Q(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function I_(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class Ue{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){q(Due);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class $n extends Ue{constructor(t,n,i,r){super(t,n);this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${AN()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var a8=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class qr extends Ue{constructor(t,n){super(t);this.formula=n}clone(){return new qr(null,ge(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s)=>{const{field:o,timeUnit:a}=s;if(a){const u=G(s,{forAs:!0});r[_e({as:u,field:o,timeUnit:a})]={as:u,field:o,timeUnit:a}}return r},{});return ze(i)?null:new qr(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,s=a8(i,["timeUnit"]),o=Sn(r),a=Object.assign(Object.assign({},s),{timeUnit:o});return new qr(t,{[_e(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of yo(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(nn(this.formula).map(t=>t.as))}dependentFields(){return new Set(nn(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${_e(this.formula)}`}assemble(){const t=[];for(const n of nn(this.formula)){const{field:i,as:r,timeUnit:s}=n,o=Sn(s),{unit:a,utc:u}=o,l=a8(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Ei(i),type:"timeunit"},a?{units:zE(a)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return t}}var Wde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Od="_tuple_fields";class Hde{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const Gde={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,s=(i=t.project)!==null&&i!==void 0?i:t.project=new Hde,o={},a={},u=new Set,l=(p,m)=>{const y=m==="visual"?p.channel:p.field;let b=Je(`${r}_${y}`);for(let x=1;u.has(b);x++)b=Je(`${r}_${y}_${x}`);return u.add(b),{[m]:b}},c=t.type,f=e.config.selection[c],d=n.value!==void 0?at(n.value):null;let{fields:h,encodings:g}=He(n.select)?n.select:{};if(!h&&!g&&d){for(const p of d)if(!!He(p))for(const m of z(p))Yae(m)?(g||(g=[])).push(m):c==="interval"?(q(Cue),g=f.encodings):(h||(h=[])).push(m)}!h&&!g&&(g=f.encodings,"fields"in f&&(h=f.fields));for(const p of g!=null?g:[]){const m=e.fieldDef(p);if(m){let y=m.field;if(m.aggregate){q(vue(p,m.aggregate));continue}else if(!y){q(JN(p));continue}if(m.timeUnit){y=e.vgField(p);const b={timeUnit:m.timeUnit,as:y,field:m.field};a[_e(b)]=b}if(!o[y]){let b="E";if(c==="interval"){const w=e.getScaleComponent(p).get("type");ui(w)&&(b="R")}else m.bin&&(b="R-RE");const x={field:y,channel:p,type:b};x.signals=Object.assign(Object.assign({},l(x,"data")),l(x,"visual")),s.items.push(o[y]=x),s.hasField[y]=s.hasChannel[p]=o[y]}}else q(JN(p))}for(const p of h!=null?h:[]){if(s.hasField[p])continue;const m={type:"E",field:p};m.signals=Object.assign({},l(m,"data")),s.items.push(m),s.hasField[p]=m}d&&(t.init=d.map(p=>s.items.map(m=>He(p)?p[m.channel]!==void 0?p[m.channel]:p[m.field]:p))),ze(a)||(s.timeUnit=new qr(null,a))},signals:(e,t,n)=>{const i=t.name+Od;return n.filter(s=>s.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(s=>{const o=Wde(s,["signals","hasLegend"]);return o.field=Ei(o.field),o})})}},To={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Ao(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(!s||!ui(o)){q(Eue);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||z_(e)||i.length===0)return n;const r=n.filter(o=>o.name===t.name)[0];let s=r.update;if(s.indexOf($8)>=0)r.update=`{${i.map(o=>`${Ce(Ei(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${Ce(Ei(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!z_(e))for(const i of t.scales){const r=n.filter(s=>s.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function B_(e,t){return`domain(${Ce(e.scaleName(t))})`}function z_(e){var t;return e.parent&&ql(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:z_(e.parent.parent))}var Yde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Tl="_brush",U_="_scale_trigger",Vde={defined:e=>e.type==="interval",signals:(e,t,n)=>{const i=t.name,r=i+Od,s=To.defined(t),o=t.init?t.init[0]:null,a=[],u=[];if(t.translate&&!s){const c=`!event.item || event.item.mark.name !== ${Ce(i+Tl)}`;u8(t,(f,d)=>{var h,g;const p=at((h=(g=d.between[0]).filter)!==null&&h!==void 0?h:g.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==tt&&d!==At){q("Interval selections only support x and y encoding channels.");return}const h=o?o[f]:null,g=Xde(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=Ce(e.scaleName(d)),b=e.getScaleComponent(d).get("type"),x=ui(b)?"+":"";n.push(...g),a.push(p),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${x}invert(${y}, ${m})[0] === ${x}${p}[0] && ${x}invert(${y}, ${m})[1] === ${x}${p}[1]))`})}),!s&&u.length&&n.push({name:i+U_,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${i+U_} : {}`}]});const l=`unit: ${Rl(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+Ro},o?{init:`{${l}: ${Ml(o)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r&&r.signals.visual,a=s&&s.signals.visual,u=`data(${Ce(t.name+Ga)})`;if(To.defined(t)||!r&&!s)return n;const l={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of z(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Rl(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=Yde(c,["fill","fillOpacity","cursor"]),p=z(g).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(b=>b).join(" && "),value:g[y]},{value:null}],m),{});return[{name:`${i+Tl}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:i+Tl,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function Xde(e,t,n,i){const r=n.channel,s=n.signals.visual,o=n.signals.data,a=To.defined(t),u=Ce(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(r===tt?"width":"height").signal,h=`${r}(unit)`,g=u8(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${s}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+U_},update:ui(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},i?{init:Ml(i,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:o},i?{init:Ml(i)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${u}, ${s})`}]})]}function u8(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(q(`${i} is not an ordered event stream for interval selections.`),n),[])}const Kde={defined:e=>e.type==="point",signals:(e,t,n)=>{var i;const r=t.name,s=r+Od,o=t.project,a="(item().isVoronoi ? datum.datum : datum)",u=o.items.map(h=>{const g=e.fieldDef(h.channel);return(g==null?void 0:g.bin)?`[${a}[${Ce(e.vgField(h.channel,{}))}], ${a}[${Ce(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${a}[${Ce(h.field)}]`}).join(", "),l=`unit: ${Rl(e)}, fields: ${s}, values`,c=t.events,f=nn((i=e.component.selection)!==null&&i!==void 0?i:{}).reduce((h,g)=>g.type==="interval"?h.concat(g.name+Tl):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && "),d="datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"");return n.concat([{name:r+Ro,on:c?[{events:c,update:`${d} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Nl(e,t,n,i){const r=J0(t)&&t.condition,s=i(t);if(r){const a=at(r).map(u=>{const l=i(u);if(kce(u)){const{param:c,empty:f}=u,d=H8(e,{param:c,empty:f});return Object.assign({test:d},l)}else{const c=$m(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...a,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function q_(e,t="text"){const n=e.encoding[t];return Nl(e,n,t,i=>ym(i,e.config))}function ym(e,t,n="datum"){if(e){if(er(e))return Ze(e.value);if(de(e)){const{format:i,formatType:r}=nm(e);return s_({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function l8(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(Q(o))return{tooltip:f8({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Nl(e,o,"tooltip",u=>{const l=ym(u,r,a);if(l)return l;if(u===null)return;let c=Le("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),he(c))return{value:c};if(He(c))return re(c)?c:c.content==="encoding"?f8(n,s,r,t):{signal:a}})}}function c8(e,t,n,{reactiveGeom:i}={}){const r={},s=i?"datum.datum":"datum",o=[];function a(l,c){const f=La(c),d=Si(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=d.title||g_(d,n),g=at(h).join(", ");let p;if(Rr(c)){const m=c==="x"?"x2":"y2",y=zr(e[m]);if(On(d.bin)&&y){const b=G(d,{expr:s}),x=G(y,{expr:s}),{format:w,formatType:_}=nm(d);p=X0(b,x,w,_,n),r[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:b,formatType:x}=nm(d);p=s_({fieldOrDatumDef:d,format:b,formatType:x,expr:s,config:n,normalizeStack:!0}).signal}}p!=null||(p=ym(d,n,s).signal),o.push({channel:c,key:g,value:p})}y_(e,(l,c)=>{Y(l)?a(l,c):Z0(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!r[l]&&!u[c]&&(u[c]=f);return u}function f8(e,t,n,{reactiveGeom:i}={}){const r=c8(e,t,n,{reactiveGeom:i}),s=yo(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function Qde(e){const{markDef:t,config:n}=e,i=Le("aria",t,n);return i===!1?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),Jde(e)),Zde(e))}function Jde(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Le("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in mue?{}:{ariaRoleDescription:{value:t}}}function Zde(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Nl(e,s,"description",u=>ym(u,e.config));const o=Le("description",n,i);if(o!=null)return{description:Ze(o)};if(i.aria===!1)return{};const a=c8(t,r,i);if(!ze(a))return{description:{signal:yo(a).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Tt(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u!=null||(u=Le(e,i,s,{vgChannel:o,ignoreVgConfig:!0})),u!==void 0&&(a=Ze(u)));const l=r[e];return Nl(t,l,o!=null?o:e,c=>D6({channel:e,channelDef:c,markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function d8(e,t={filled:void 0}){var n,i,r,s;const{markDef:o,encoding:a,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Le("filled",o,u),f=be(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(r=(i=Le(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&i!==void 0?i:u.mark[c===!0&&"color"])!==null&&r!==void 0?r:f,h=(s=Le(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&s!==void 0?s:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:Ze(d)}:{}),h?{stroke:Ze(h)}:{});return o.color&&(c?o.fill:o.stroke)&&q(r6("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},p),Tt("color",e,{vgChannel:g,defaultValue:c?d:h})),Tt("fill",e,{defaultValue:a.fill?d:void 0})),Tt("stroke",e,{defaultValue:a.stroke?h:void 0}))}function ehe(e){const{encoding:t,mark:n}=e,i=t.order;return!$o(n)&&er(i)?Nl(e,i,"zindex",r=>Ze(r.value)):{}}function Sd(e,t){const n=Xae(e),i=t[n];if(i)return i}function sn(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,u=r[e],l=r[bs(e)],c=t.scaleName(e),f=t.getScaleComponent(e),d=Sd(e,s),h=W_({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&Rr(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:the({channel:e,channelDef:u,channel2Def:l,markDef:s,config:o,scaleName:c,scale:f,stack:a,offset:d,defaultRef:h});return g?{[i||e]:g}:void 0}function the(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(de(n)&&r&&t===r.fieldChannel){if(Y(n)){let a=n.bandPosition;if(a===void 0&&o.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return V0({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Ua(n,i,{suffix:"end"},{offset:s})}return i_(e)}function W_({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=La(n),u=Eo(n),l=Le(n,s,o,{vgChannel:u});if(l!==void 0)return yd(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!be([Ot.LOG,Ot.TIME,Ot.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Oi(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const nhe={left:"x",center:"xc",right:"x2"},ihe={top:"y",middle:"yc",bottom:"y2"};function h8(e,t,n,i="middle"){if(e==="radius"||e==="theta")return Eo(e);const r=e==="x"?"align":"baseline",s=Le(r,t,n);let o;return re(s)?(q(Hue(r)),o=void 0):o=s,e==="x"?nhe[o||(i==="top"?"left":"center")]:ihe[o||i]}function bm(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?g8(e,t,{defaultPos:n,defaultPos2:i}):sn(e,t,{defaultPos:n})}function g8(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=bs(e),a=Oi(e),u=rhe(t,i,o),l=u[a]?h8(e,r,s):Eo(e);return Object.assign(Object.assign({},sn(e,t,{defaultPos:n,vgChannel:l})),u)}function rhe(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,u=La(n),l=Oi(n),c=Eo(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),g=n in i||n in s?Sd(n,e.markDef):Sd(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=Oi(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const p=she({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:a,scaleName:d,scale:h,stack:o,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:vm(n,s)||vm(n,{[n]:B0(n,s,a.style),[l]:B0(l,s,a.style)})||vm(n,a[r])||vm(n,a.mark)||{[c]:W_({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function she({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l}){return de(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Ua(t,s,{suffix:"start"},{offset:u}):i_({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:u,defaultRef:l})}function vm(e,t){const n=Oi(e),i=Eo(e);if(t[i]!==void 0)return{[i]:yd(e,t[i])};if(t[e]!==void 0)return{[i]:yd(e,t[e])};if(t[n]){const r=t[n];if(Sl(r))q(Iue(n));else return{[n]:yd(e,r)}}}function No(e,t,n){var i,r,s,o;const{config:a,encoding:u,markDef:l}=e,c=bs(t),f=Oi(t),d=u[t],h=u[c],g=e.getScaleComponent(t),p=g?g.get("type"):void 0,m=e.scaleName(t),y=l.orient,b=(r=(i=u[f])!==null&&i!==void 0?i:u.size)!==null&&r!==void 0?r:Le("size",l,a,{vgChannel:f}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(Y(d)&&(Ye(d.bin)||On(d.bin)||d.timeUnit&&!h)&&!(b&&!Sl(b))&&!rn(p)){const w=W6({channel:t,fieldDef:d,markDef:l,config:a,scaleType:p}),_=(s=e.component.axes[t])===null||s===void 0?void 0:s[0],A=(o=_==null?void 0:_.get("translate"))!==null&&o!==void 0?o:.5;return uhe({fieldDef:d,fieldDef2:h,channel:t,markDef:l,scaleName:m,bandSize:w,axisTranslate:A,spacing:Rr(t)?Le("binSpacing",l,a):void 0,reverse:g.get("reverse"),config:a})}else return(de(d)&&rn(p)||x)&&!h?ahe(d,t,e):g8(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function ohe(e,t,n,i,r){if(Sl(r))if(n){const o=n.get("type");if(o==="band")return{scale:t,band:r.band};r.band!==1&&(q(Xue(o)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(re(r))return r;if(r)return{value:r}}if(n){const o=n.get("range");if(Co(o)&&pt(o.step))return{value:o.step-2}}return{value:dm(i.view,e)-2}}function ahe(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=Oi(t),f=bs(t),d=a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let h;(r.size||i.size)&&(d?h=Tt("size",n,{vgChannel:c,defaultRef:Ze(i.size)}):q(Zue(i.type)));const g=W6({channel:t,fieldDef:e,markDef:i,config:s,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:d});h=h||{[c]:ohe(c,u,l,s,g)};const p=(l==null?void 0:l.get("type"))!=="band"||!("band"in h[c])?"middle":"top",m=h8(t,i,s,p),y=m==="xc"||m==="yc",b=Sd(t,i),x=i_({channel:t,channelDef:e,markDef:i,config:s,scaleName:u,scale:l,stack:o,offset:b,defaultRef:W_({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:y?.5:re(g)?{signal:`(1-${g})/2`}:Sl(g)?(1-g.band)/2:0});if(c)return Object.assign({[m]:x},h);{const w=Eo(f),_=h[c],A=b?Object.assign(Object.assign({},_),{offset:b}):_;return{[m]:x,[w]:Q(x)?[x[0],Object.assign(Object.assign({},x[1]),{offset:A})]:Object.assign(Object.assign({},x),{offset:A})}}}function Cd(e,t,n,i,r){if($N(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(re(n)||re(r)||re(i)){const o=ws(n),a=ws(r),u=ws(i),l=u?`${u} + `:"",c=o?`(${o} ? -1 : 1) * `:"",f=a?`(${a} + ${s})`:s;return{signal:l+c+f}}else return r=r||0,i+(n?-r-s:+r+s)}function uhe({fieldDef:e,fieldDef2:t,channel:n,bandSize:i,scaleName:r,markDef:s,spacing:o=0,axisTranslate:a,reverse:u,config:l}){const c=bs(n),f=Eo(n),d=Eo(c),h=Sd(n,s),g=re(i)?{signal:`(1-${i.signal})/2`}:Sl(i)?(1-i.band)/2:.5;if(Ye(e.bin)||e.timeUnit)return{[d]:p8({channel:n,fieldDef:e,scaleName:r,markDef:s,bandPosition:g,offset:Cd(c,o,u,a,h),config:l}),[f]:p8({channel:n,fieldDef:e,scaleName:r,markDef:s,bandPosition:re(g)?{signal:`1-${g.signal}`}:1-g,offset:Cd(n,o,u,a,h),config:l})};if(On(e.bin)){const p=Ua(e,r,{},{offset:Cd(c,o,u,a,h)});if(Y(t))return{[d]:p,[f]:Ua(t,r,{},{offset:Cd(n,o,u,a,h)})};if(Pa(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${r}", ${G(e,{expr:"datum"})} + ${e.bin.step})`,offset:Cd(n,o,u,a,h)}}}q(l6(c))}function p8({channel:e,fieldDef:t,scaleName:n,markDef:i,bandPosition:r,offset:s,config:o}){const a=V0({scaleName:n,fieldOrDatumDef:t,bandPosition:r,offset:s});return F6({fieldDef:t,channel:e,markDef:i,ref:a,config:o})}const lhe=new Set(["aria","width","height"]);function Ci(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?d8(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},che(e.markDef,t)),m8(e,"fill",n)),m8(e,"stroke",i)),Tt("opacity",e)),Tt("fillOpacity",e)),Tt("strokeOpacity",e)),Tt("strokeWidth",e)),Tt("strokeDash",e)),ehe(e)),l8(e)),q_(e,"href")),Qde(e))}function m8(e,t,n){const{config:i,mark:r,markDef:s}=e;if(Le("invalid",s,i)==="hide"&&n&&!$o(r)){const a=fhe(e,{invalid:!0,channels:P0});if(a)return{[t]:[{test:a,value:null},...at(n)]}}return n?{[t]:n}:{}}function che(e,t){return pue.reduce((n,i)=>(!lhe.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=Ze(e[i])),n),{})}function fhe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&ui(u)&&(s[l]=!0)}return s},{}),r=z(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>r_(o,t)).join(` ${s} `)}}function H_(e){const{config:t,markDef:n}=e;if(Le("invalid",n,t)){const r=dhe(e,{channels:Nr});if(r)return{defined:{signal:r}}}return{}}function dhe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&ui(u)&&(s[l]=!0)}return s},{}),r=z(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>r_(o,t)).join(` ${s} `)}}function y8(e,t){if(t!==void 0)return{[e]:Ze(t)}}const G_="voronoi",b8={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(G_)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if($o(s))return q(xue(s)),n;const o={name:e.getName(G_),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},l8(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?a=c:d.indexOf(G_)>=0&&(u=!0)}),u||n.splice(a+1,0,o),n}},v8={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!A_(e.bind),parse:(e,t,n)=>k8(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=b8.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var c,f;const d=Je(`${i}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:Ml(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${Ce(u.field)}] : null`}]:[],bind:(f=(c=s[u.field])!==null&&c!==void 0?c:s[u.channel])!==null&&f!==void 0?f:s}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.filter(l=>l.name===i+Ro)[0],o=i+Od,a=r.items.map(l=>Je(`${i}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},xm="_toggle",x8={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+xm,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Ro,i=t.name+xm;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Rl(e)}}, `)+`${i} ? ${n} : null`}},hhe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=he(t.clear)?jl(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(v8.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===Je(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+Ro);i(r,"null"),x8.defined(t)&&(r=n.findIndex(s=>s.name===t.name+xm),i(r,"false"))}return n}},w8={defined:e=>{const t=e.resolve==="global"&&e.bind&&A_(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==wd;return t&&!n&&q(_ue),t&&n},parse:(e,t,n)=>{var i;const r=ge(n);if(r.select=he(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),k8(t,r),fe(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=at((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.includes(a)||u.filter.push(a)}const s=O_(t.bind)?t.bind.legend:"click",o=he(s)?jl(s,"view"):at(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=O_(t.bind)&&t.bind.legend,s=o=>a=>{const u=ge(a);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${Je(o.field)}_legend`,u=`${i}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(d=>d.name===i+Ro),o=i+Od,a=r.items.filter(d=>d.hasLegend).map(d=>Je(`${i}_${Je(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(d=>d.name===i+xm),f=O_(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function ghe(e,t,n){var i,r,s,o;const a=(i=e.fieldDef(t))===null||i===void 0?void 0:i.field;for(const u of nn((r=e.component.selection)!==null&&r!==void 0?r:{})){const l=(s=u.project.hasField[a])!==null&&s!==void 0?s:u.project.hasChannel[t];if(l&&w8.defined(u)){const c=(o=n.get("selections"))!==null&&o!==void 0?o:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const E8="_translate_anchor",_8="_translate_delta",phe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=To.defined(t),s=i+E8,{x:o,y:a}=t.project.hasChannel;let u=jl(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Tl,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?`, extent_x: ${r?B_(e,tt):`slice(${o.signals.visual})`}`:"")+(a!==void 0?`, extent_y: ${r?B_(e,At):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+_8,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&A8(e,t,o,"width",n),a!==void 0&&A8(e,t,a,"height",n),n}};function A8(e,t,n,i,r){var s,o;const a=t.name,u=a+E8,l=a+_8,c=n.channel,f=To.defined(t),d=r.filter(E=>E.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,g=e.getScaleComponent(c),p=g.get("type"),m=g.get("reverse"),y=f?c===tt?m?"":"-":m?"-":"":"",b=`${u}.extent_${c}`,x=`${y}${l}.${c} / ${f?`${h}`:`span(${b})`}`,w=f?p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear":"panLinear",_=f?p==="pow"?`, ${(s=g.get("exponent"))!==null&&s!==void 0?s:1}`:p==="symlog"?`, ${(o=g.get("constant"))!==null&&o!==void 0?o:1}`:"":"",A=`${w}(${b}, ${x}${_})`;d.on.push({events:{signal:l},update:f?A:`clampRange(${A}, 0, ${h})`})}const O8="_zoom_anchor",S8="_zoom_delta",mhe={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=To.defined(t),s=i+S8,{x:o,y:a}=t.project.hasChannel,u=Ce(e.scaleName(tt)),l=Ce(e.scaleName(At));let c=jl(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Tl,f))),n.push({name:i+O8,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&C8(e,t,o,"width",n),a!==void 0&&C8(e,t,a,"height",n),n}};function C8(e,t,n,i,r){var s,o;const a=t.name,u=n.channel,l=To.defined(t),c=r.filter(w=>w.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d.get("type"),g=l?B_(e,u):c.name,p=a+S8,m=`${a}${O8}.${u}`,y=l?h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear",b=l?h==="pow"?`, ${(s=d.get("exponent"))!==null&&s!==void 0?s:1}`:h==="symlog"?`, ${(o=d.get("constant"))!==null&&o!==void 0?o:1}`:"":"",x=`${y}(${g}, ${m}, ${p}${b})`;c.on.push({events:{signal:p},update:l?x:`clampRange(${x}, 0, ${f})`})}const Ga="_store",Ro="_tuple",yhe="_modify",$8="vlSelectionResolve",wm=[Kde,Vde,Gde,x8,v8,To,w8,hhe,phe,mhe,b8];function bhe(e){let t=e.parent;for(;t&&!rr(t);)t=t.parent;return t}function Rl(e,{escape:t}={escape:!0}){let n=t?Ce(e.name):e.name;const i=bhe(e);if(i){const{facet:r}=i;for(const s of Ai)r[s]&&(n+=` + '__facet_${s}_' + (facet[${Ce(i.vgField(s))}])`)}return n}function Y_(e){var t;return nn((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===wd),!1)}function k8(e,t){(Se(t.select)||!t.select.on)&&delete e.events,(Se(t.select)||!t.select.clear)&&delete e.clear,(Se(t.select)||!t.select.toggle)&&delete e.toggle}const vhe="RawCode",xhe="Literal",whe="Property",Ehe="Identifier",_he="ArrayExpression",Ahe="BinaryExpression",Ohe="CallExpression",She="ConditionalExpression",Che="LogicalExpression",$he="MemberExpression",khe="ObjectExpression",Fhe="UnaryExpression";function tr(e){this.type=e}tr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Dhe(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Dhe(e){switch(e.type){case _he:return e.elements;case Ahe:case Che:return[e.left,e.right];case Ohe:return[e.callee].concat(e.arguments);case She:return[e.test,e.consequent,e.alternate];case $he:return[e.object,e.property];case khe:return e.properties;case whe:return[e.key,e.value];case Fhe:return[e.argument];case Ehe:case xhe:case vhe:default:return[]}}var Wr,J,R,on,Ie,Em=1,$d=2,Ya=3,Lo=4,_m=5,Va=6,Gn=7,kd=8,jhe=9;Wr={};Wr[Em]="Boolean";Wr[$d]="<end>";Wr[Ya]="Identifier";Wr[Lo]="Keyword";Wr[_m]="Null";Wr[Va]="Numeric";Wr[Gn]="Punctuator";Wr[kd]="String";Wr[jhe]="RegularExpression";var Mhe="ArrayExpression",The="BinaryExpression",Nhe="CallExpression",Rhe="ConditionalExpression",F8="Identifier",Lhe="Literal",Phe="LogicalExpression",Ihe="MemberExpression",Bhe="ObjectExpression",zhe="Property",Uhe="UnaryExpression",Nt="Unexpected token %0",qhe="Unexpected number",Whe="Unexpected string",Hhe="Unexpected identifier",Ghe="Unexpected reserved word",Yhe="Unexpected end of input",V_="Invalid regular expression",X_="Invalid regular expression: missing /",D8="Octal literals are not allowed in strict mode.",Vhe="Duplicate data property in object literal not allowed in strict mode",qt="ILLEGAL",Fd="Disabled.",Xhe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Khe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Am(e,t){if(!e)throw new Error("ASSERT: "+t)}function Ss(e){return e>=48&&e<=57}function K_(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Dd(e){return"01234567".indexOf(e)>=0}function Qhe(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function jd(e){return e===10||e===13||e===8232||e===8233}function Md(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Xhe.test(String.fromCharCode(e))}function Om(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Khe.test(String.fromCharCode(e))}const Jhe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function j8(){for(;R<on;){const e=J.charCodeAt(R);if(Qhe(e)||jd(e))++R;else break}}function Q_(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)R<on&&K_(J[R])?(i=J[R++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Me({},Nt,qt);return String.fromCharCode(r)}function Zhe(){var e,t,n,i;for(e=J[R],t=0,e==="}"&&Me({},Nt,qt);R<on&&(e=J[R++],!!K_(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Me({},Nt,qt),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function M8(){var e,t;for(e=J.charCodeAt(R++),t=String.fromCharCode(e),e===92&&(J.charCodeAt(R)!==117&&Me({},Nt,qt),++R,e=Q_("u"),(!e||e==="\\"||!Md(e.charCodeAt(0)))&&Me({},Nt,qt),t=e);R<on&&(e=J.charCodeAt(R),!!Om(e));)++R,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),J.charCodeAt(R)!==117&&Me({},Nt,qt),++R,e=Q_("u"),(!e||e==="\\"||!Om(e.charCodeAt(0)))&&Me({},Nt,qt),t+=e);return t}function ege(){var e,t;for(e=R++;R<on;){if(t=J.charCodeAt(R),t===92)return R=e,M8();if(Om(t))++R;else break}return J.slice(e,R)}function tge(){var e,t,n;return e=R,t=J.charCodeAt(R)===92?M8():ege(),t.length===1?n=Ya:Jhe.hasOwnProperty(t)?n=Lo:t==="null"?n=_m:t==="true"||t==="false"?n=Em:n=Ya,{type:n,value:t,start:e,end:R}}function J_(){var e=R,t=J.charCodeAt(R),n,i=J[R],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++R,{type:Gn,value:String.fromCharCode(t),start:e,end:R};default:if(n=J.charCodeAt(R+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return R+=2,{type:Gn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:R};case 33:case 61:return R+=2,J.charCodeAt(R)===61&&++R,{type:Gn,value:J.slice(e,R),start:e,end:R}}}if(o=J.substr(R,4),o===">>>=")return R+=4,{type:Gn,value:o,start:e,end:R};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return R+=3,{type:Gn,value:s,start:e,end:R};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return R+=2,{type:Gn,value:r,start:e,end:R};if(r==="//"&&Me({},Nt,qt),"<>=!+-*%&|^/".indexOf(i)>=0)return++R,{type:Gn,value:i,start:e,end:R};Me({},Nt,qt)}function nge(e){let t="";for(;R<on&&K_(J[R]);)t+=J[R++];return t.length===0&&Me({},Nt,qt),Md(J.charCodeAt(R))&&Me({},Nt,qt),{type:Va,value:parseInt("0x"+t,16),start:e,end:R}}function ige(e){let t="0"+J[R++];for(;R<on&&Dd(J[R]);)t+=J[R++];return(Md(J.charCodeAt(R))||Ss(J.charCodeAt(R)))&&Me({},Nt,qt),{type:Va,value:parseInt(t,8),octal:!0,start:e,end:R}}function T8(){var e,t,n;if(n=J[R],Am(Ss(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=R,e="",n!=="."){if(e=J[R++],n=J[R],e==="0"){if(n==="x"||n==="X")return++R,nge(t);if(Dd(n))return ige(t);n&&Ss(n.charCodeAt(0))&&Me({},Nt,qt)}for(;Ss(J.charCodeAt(R));)e+=J[R++];n=J[R]}if(n==="."){for(e+=J[R++];Ss(J.charCodeAt(R));)e+=J[R++];n=J[R]}if(n==="e"||n==="E")if(e+=J[R++],n=J[R],(n==="+"||n==="-")&&(e+=J[R++]),Ss(J.charCodeAt(R)))for(;Ss(J.charCodeAt(R));)e+=J[R++];else Me({},Nt,qt);return Md(J.charCodeAt(R))&&Me({},Nt,qt),{type:Va,value:parseFloat(e),start:t,end:R}}function rge(){var e="",t,n,i,r,s=!1;for(t=J[R],Am(t==="'"||t==='"',"String literal must starts with a quote"),n=R,++R;R<on;)if(i=J[R++],i===t){t="";break}else if(i==="\\")if(i=J[R++],!i||!jd(i.charCodeAt(0)))switch(i){case"u":case"x":J[R]==="{"?(++R,e+=Zhe()):e+=Q_(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Dd(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),R<on&&Dd(J[R])&&(s=!0,r=r*8+"01234567".indexOf(J[R++]),"0123".indexOf(i)>=0&&R<on&&Dd(J[R])&&(r=r*8+"01234567".indexOf(J[R++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&J[R]===`
`&&++R;else{if(jd(i.charCodeAt(0)))break;e+=i}return t!==""&&Me({},Nt,qt),{type:kd,value:e,octal:s,start:n,end:R}}function sge(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Me({},V_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Me({},V_)}try{return new RegExp(e,t)}catch{return null}}function oge(){var e,t,n,i,r;for(e=J[R],Am(e==="/","Regular expression literal must start with a slash"),t=J[R++],n=!1,i=!1;R<on;)if(e=J[R++],t+=e,e==="\\")e=J[R++],jd(e.charCodeAt(0))&&Me({},X_),t+=e;else if(jd(e.charCodeAt(0)))Me({},X_);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Me({},X_),r=t.substr(1,t.length-2),{value:r,literal:t}}function age(){var e,t,n;for(t="",n="";R<on&&(e=J[R],!!Om(e.charCodeAt(0)));)++R,e==="\\"&&R<on?Me({},Nt,qt):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Me({},V_,n),{value:n,literal:t}}function uge(){var e,t,n,i;return Ie=null,j8(),e=R,t=oge(),n=age(),i=sge(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:R}}function lge(e){return e.type===Ya||e.type===Lo||e.type===Em||e.type===_m}function N8(){if(j8(),R>=on)return{type:$d,start:R,end:R};const e=J.charCodeAt(R);return Md(e)?tge():e===40||e===41||e===59?J_():e===39||e===34?rge():e===46?Ss(J.charCodeAt(R+1))?T8():J_():Ss(e)?T8():J_()}function Yn(){const e=Ie;return R=e.end,Ie=N8(),R=e.end,e}function R8(){const e=R;Ie=N8(),R=e}function cge(e){const t=new tr(Mhe);return t.elements=e,t}function L8(e,t,n){const i=new tr(e==="||"||e==="&&"?Phe:The);return i.operator=e,i.left=t,i.right=n,i}function fge(e,t){const n=new tr(Nhe);return n.callee=e,n.arguments=t,n}function dge(e,t,n){const i=new tr(Rhe);return i.test=e,i.consequent=t,i.alternate=n,i}function Z_(e){const t=new tr(F8);return t.name=e,t}function Td(e){const t=new tr(Lhe);return t.value=e.value,t.raw=J.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function P8(e,t,n){const i=new tr(Ihe);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function hge(e){const t=new tr(Bhe);return t.properties=e,t}function I8(e,t,n){const i=new tr(zhe);return i.key=t,i.value=n,i.kind=e,i}function gge(e,t){const n=new tr(Uhe);return n.operator=e,n.argument=t,n.prefix=!0,n}function Me(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(Am(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=R,n.description=r,n}function Sm(e){e.type===$d&&Me(e,Yhe),e.type===Va&&Me(e,qhe),e.type===kd&&Me(e,Whe),e.type===Ya&&Me(e,Hhe),e.type===Lo&&Me(e,Ghe),Me(e,Nt,e.value)}function an(e){const t=Yn();(t.type!==Gn||t.value!==e)&&Sm(t)}function Ke(e){return Ie.type===Gn&&Ie.value===e}function eA(e){return Ie.type===Lo&&Ie.value===e}function pge(){const e=[];for(R=Ie.start,an("[");!Ke("]");)Ke(",")?(Yn(),e.push(null)):(e.push(Xa()),Ke("]")||an(","));return Yn(),cge(e)}function B8(){R=Ie.start;const e=Yn();return e.type===kd||e.type===Va?(e.octal&&Me(e,D8),Td(e)):Z_(e.value)}function mge(){var e,t,n,i;if(R=Ie.start,e=Ie,e.type===Ya)return n=B8(),an(":"),i=Xa(),I8("init",n,i);if(e.type===$d||e.type===Gn)Sm(e);else return t=B8(),an(":"),i=Xa(),I8("init",t,i)}function yge(){var e=[],t,n,i,r={},s=String;for(R=Ie.start,an("{");!Ke("}");)t=mge(),t.key.type===F8?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Me({},Vhe):r[i]=!0,e.push(t),Ke("}")||an(",");return an("}"),hge(e)}function bge(){an("(");const e=tA();return an(")"),e}const vge={if:1};function xge(){var e,t,n;if(Ke("("))return bge();if(Ke("["))return pge();if(Ke("{"))return yge();if(e=Ie.type,R=Ie.start,e===Ya||vge[Ie.value])n=Z_(Yn().value);else if(e===kd||e===Va)Ie.octal&&Me(Ie,D8),n=Td(Yn());else{if(e===Lo)throw new Error(Fd);e===Em?(t=Yn(),t.value=t.value==="true",n=Td(t)):e===_m?(t=Yn(),t.value=null,n=Td(t)):Ke("/")||Ke("/=")?(n=Td(uge()),R8()):Sm(Yn())}return n}function wge(){const e=[];if(an("("),!Ke(")"))for(;R<on&&(e.push(Xa()),!Ke(")"));)an(",");return an(")"),e}function Ege(){R=Ie.start;const e=Yn();return lge(e)||Sm(e),Z_(e.value)}function _ge(){return an("."),Ege()}function Age(){an("[");const e=tA();return an("]"),e}function Oge(){var e,t,n;for(e=xge();;)if(Ke("."))n=_ge(),e=P8(".",e,n);else if(Ke("("))t=wge(),e=fge(e,t);else if(Ke("["))n=Age(),e=P8("[",e,n);else break;return e}function z8(){const e=Oge();if(Ie.type===Gn&&(Ke("++")||Ke("--")))throw new Error(Fd);return e}function Cm(){var e,t;if(Ie.type!==Gn&&Ie.type!==Lo)t=z8();else{if(Ke("++")||Ke("--"))throw new Error(Fd);if(Ke("+")||Ke("-")||Ke("~")||Ke("!"))e=Yn(),t=Cm(),t=gge(e.value,t);else{if(eA("delete")||eA("void")||eA("typeof"))throw new Error(Fd);t=z8()}}return t}function U8(e){let t=0;if(e.type!==Gn&&e.type!==Lo)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Sge(){var e,t,n,i,r,s,o,a,u,l;if(e=Ie,u=Cm(),i=Ie,r=U8(i),r===0)return u;for(i.prec=r,Yn(),t=[e,Ie],o=Cm(),s=[u,i,o];(r=U8(Ie))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=L8(a,u,o),s.push(n);i=Yn(),i.prec=r,s.push(i),t.push(Ie),n=Cm(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=L8(s[l-1].value,s[l-2],n),l-=2;return n}function Xa(){var e,t,n;return e=Sge(),Ke("?")&&(Yn(),t=Xa(),an(":"),n=Xa(),e=dge(e,t,n)),e}function tA(){const e=Xa();if(Ke(","))throw new Error(Fd);return e}function Cge(e){J=e,R=0,on=J.length,Ie=null,R8();const t=tA();if(Ie.type!==$d)throw new Error("Unexpect token after expression.");return t}function nA(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...nA(e.object)),t.push(...nA(e.property))),t)}function q8(e){return e.object.type==="MemberExpression"?q8(e.object):e.object.name==="datum"}function W8(e){const t=Cge(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&q8(i)&&n.add(nA(i).slice(1).join("."))}),n}class Ll extends Ue{constructor(t,n,i){super(t);this.model=n,this.filter=i,this.expr=$m(this.model,this.filter,this),this._dependentFields=W8(this.expr)}clone(){return new Ll(null,this.model,ge(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function $ge(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const s of t){const o=Je(s.name),a=s.select,u=he(a)?a:a.type,l=He(a)?ge(a):{type:u},c=r[u];for(const d in c)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(l[d]===void 0||l[d]===!0)&&(l[d]=(n=c[d])!==null&&n!==void 0?n:l[d]));const f=i[o]=Object.assign(Object.assign({},l),{name:o,type:u,init:s.value,bind:s.bind,events:he(l.on)?jl(l.on,"scope"):at(ge(l.on))});for(const d of wm)d.defined(f)&&d.parse&&d.parse(e,f,s)}return i}function H8(e,t,n,i="datum"){const r=he(t)?t:t.param,s=Je(r),o=Ce(s+Ga);let a;try{a=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(a.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=a.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${o}, ${i}${a.resolve==="global"?")":`, ${Ce(a.resolve)})`}`,l=`length(data(${o}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function G8(e,t,n){const i=Je(t),r=n.encoding;let s=n.field,o;try{o=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=o.project.items[0].field,o.project.items.length>1&&q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Ce(s)}.`);else if(r&&!s){const a=o.project.items.filter(u=>u.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,q((a.length?"Multiple ":"No ")+`matching ${Ce(r)} encoding found for selection ${Ce(n.param)}. Using "field": ${Ce(s)}.`)):s=a[0].field}return`${o.name}[${Ce(Ei(s))}]`}function kge(e,t){var n;for(const[i,r]of yo((n=e.component.selection)!==null&&n!==void 0?n:{})){const s=e.getName(`lookup_${i}`);e.component.data.outputNodes[s]=r.materialized=new $n(new Ll(t,e,{param:i}),s,Ve.Lookup,e.component.data.outputNodeRefCounts)}}function $m(e,t,n){return od(t,i=>he(i)?i:Nle(i)?H8(e,i,n):y6(i))}var km=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Fge(e,t){if(!!e)return Q(e)&&!So(e)?e.map(n=>g_(n,t)).join(", "):e}function iA(e,t,n,i){var r,s,o,a,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(s=(a=e.encode)[t])!==null&&s!==void 0||(a[t]={}),(o=(u=e.encode[t]).update)!==null&&o!==void 0||(u.update={}),e.encode[t].update[n]=i}function Nd(e,t,n,i={header:!1}){var r,s;const o=e.combine(),{disable:a,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=km(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const g in h){const p=qce[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(xd(m)){const{condition:y}=m,b=km(m,["condition"]),x=at(y),w=Z6[g];if(w){const{vgProp:_,part:A}=w,E=[...x.map(S=>{const{test:k}=S,$=km(S,["test"]);return Object.assign({test:$m(null,k)},$)}),b];iA(h,A,_,E),delete h[g]}else if(w===null){const _={signal:x.map(A=>{const{test:E}=A,S=km(A,["test"]);return`${$m(null,E)} ? ${UN(S)} : `}).join("")+UN(b)};h[g]=_}}else if(re(m)){const y=Z6[g];if(y){const{vgProp:b,part:x}=y;iA(h,x,b,m),delete h[g]}}be(["labelAlign","labelBaseline"],g)&&h[g]===null&&delete h[g]}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),ze(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:mt(d,0)})}else{if(!i.header&&e.mainExtracted)return;if(c!==void 0){let p=c;((s=(r=h.encode)===null||r===void 0?void 0:r.labels)===null||s===void 0?void 0:s.update)&&re(h.encode.labels.update.text)&&(p=Ta(c,"datum.label",h.encode.labels.update.text.signal)),iA(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of eR)e.hasAxisPart(p)||delete h.encode[p];ze(h.encode)&&delete h.encode}const g=Fge(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:mt(d,0)})}}}function Y8(e){const{axes:t}=e.component,n=[];for(const i of Nr)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function Dge(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Nd(r,"grid",t)),...i.map(r=>Nd(r,"grid",t)),...n.map(r=>Nd(r,"main",t)),...i.map(r=>Nd(r,"main",t))].filter(r=>r)}function V8(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...z(o),...z(a)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${s}" ? ${ws(o[c])} : ${ws(a[c])}`};return l}return t[r]})])}function jge(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:Gle(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=re(n)?"axisOrient":`axis${ad(n)}`,a=[...r,...r.map(l=>s+l.substr(4))],u=["axis",o,s];return{vlOnlyAxisConfig:V8(a,i,e,n),vgAxisConfig:V8(u,i,e,n),axisConfigStyle:Mge([...u,...a],i)}}function Mge(e,t){var n;const i=[{}];for(const r of e){let s=(n=t[r])===null||n===void 0?void 0:n.style;if(s){s=at(s);for(const o of s)i.push(t.style[o])}}return Object.assign.apply(null,i)}function rA(e,t,n,i={}){var r;const s=WN(e,n,t);if(s!==void 0)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((r=i[o])===null||r===void 0?void 0:r[e])!==void 0)return{configFrom:o,configValue:i[o][e]};return{}}const X8={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return T6(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return N6(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(i=t.grid)!==null&&i!==void 0?i:Tge(n,e)},gridScale:({model:e,channel:t})=>Nge(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||Q8(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||K8(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!==null&&i!==void 0?i:Lge(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!==null&&i!==void 0?i:Pge(t.type,n,Y(t)&&!!t.timeUnit,Y(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var s;const o=e==="x"?"width":e==="y"?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:Bge({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=J8(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return GN(r?[U6(r)]:[],Y(o)?[U6(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>zge(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!==null&&i!==void 0?i:Uge(n,t)}};function Tge(e,t){return!rn(e)&&Y(t)&&!Ye(t==null?void 0:t.bin)&&!On(t==null?void 0:t.bin)}function Nge(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Rge(e,t,n,i,r){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return re(s)?s:ud(s);{const{configValue:o}=rA("labelAngle",i,t==null?void 0:t.style,r);return o!==void 0?ud(o):n===tt&&be([QE,KE],e.type)&&!(Y(e)&&e.timeUnit)?270:void 0}}function sA(e){return`(((${e.signal} % 360) + 360) % 360)`}function K8(e,t,n,i){if(e!==void 0)if(n==="x"){if(re(e)){const r=sA(e),s=re(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(re(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(re(e)){const r=sA(e),s=re(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(re(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function Q8(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(re(e)){const o=sA(e),a=re(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(re(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function Lge(e,t){if(t==="x"&&be(["quantitative","temporal"],e))return!0}function Pge(e,t,n,i){if(n&&!He(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function Ige(e){return e==="x"?"bottom":"left"}function Bge({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!rn(t)&&t!=="log"){if(Y(e)){if(Ye(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&be(["month","hours","day","quarter"],(r=Sn(e.timeUnit))===null||r===void 0?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function J8(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return YN(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function zge(e,t){const n=e.values;if(Q(n))return J6(t,n);if(re(n))return n}function Uge(e,t){return e==="rect"&&tm(t)?1:0}class Pl extends Ue{constructor(t,n){super(t);this.transform=n,this._dependentFields=W8(this.transform.calculate)}clone(){return new Pl(null,ge(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(!!Wa(i)&&z6(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,u=a.map((l,c)=>`${y6({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new Pl(t,{calculate:u,as:Il(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${_e(this.transform)}`}}function Il(e,t,n){return G(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function Fm(e,t){return be(["top","bottom"],t)?"column":be(["left","right"],t)||e==="row"?"row":"column"}function Bl(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return mt((t||{})[e],r[e],n.header[e])}function Dm(e,t,n,i){const r={};for(const s of e){const o=Bl(s,t||{},n,i);o!==void 0&&(r[s]=o)}return r}const oA=["row","column"],aA=["header","footer"];function qge(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=Dm(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=Fm(t,a),l=ud(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),e4(l,u)),Z8(u,l,s)),t4(i,r,t,dfe,vR))}}function Z8(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=Q8(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function e4(e,t){const n=K8(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Wge(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of aA)if(n[r])for(const s of n[r]){const o=Gge(e,t,r,n,s);o!=null&&i.push(o)}return i}function Hge(e,t){var n;const{sort:i}=e;return Ir(i)?{field:G(i,{expr:"datum"}),order:(n=i.order)!==null&&n!==void 0?n:"ascending"}:Q(i)?{field:Il(e,t,{expr:"datum"}),order:"ascending"}:{field:G(e,{expr:"datum"}),order:i!=null?i:"ascending"}}function uA(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:u}=Dm(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=s_({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Fm(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Ta(Ta(u,"datum.label",l),"datum.value",G(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),e4(s,c)),Z8(c,s,o)),t4(n,e,t,hfe,xR))}function Gge(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:f}=Dm(["labelOrient"],o.header,a,t);(t==="row"&&!be(["top","bottom"],f)||t==="column"&&!be(["left","right"],f))&&(s=uA(o,t,a))}const u=rr(e)&&!bd(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(s||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:Hge(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const Yge={column:{start:0,end:1},row:{start:1,end:0}};function Vge(e,t){return Yge[t][e]}function Xge(e,t){const n={};for(const i of Ai){const r=e[i];if(r==null?void 0:r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=Dm(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=Fm(i,o),u=Vge(s,a);u!==void 0&&(n[a]=u)}}return ze(n)?void 0:n}function t4(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=Bl(o,t==null?void 0:t.header,e,n);a!==void 0&&(s[r[o]]=a)}return s}function lA(e){return[...jm(e,"width"),...jm(e,"height"),...jm(e,"childWidth"),...jm(e,"childHeight")]}function jm(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(rn(o)&&Co(a)){const u=e.scaleName(n);return rr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[n4(u,a)]:[n4(u,a),{name:r,update:i4(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=k_(e.config.view,s?"width":"height"),u=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function n4(e,t){return{name:`${e}_step`,value:t.step}}function i4(e,t,n){const i=t.get("type"),r=t.get("padding"),s=mt(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${ws(o)}, ${ws(s)}) * ${e}_step`}function r4(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function s4(e,t){return z(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),Nl(t,r,i,s=>Ze(s.value)))},{})}function o4(e,t){if(rr(t))return e==="theta"?"independent":"shared";if(ql(t))return"shared";if(OA(t))return Rr(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function cA(e,t){const n=e.scale[t],i=Rr(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&q(rle(t)),"independent"):e[i][t]||"shared"}const Kge=Object.assign(Object.assign({},mfe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),a4=z(Kge);class Qge extends As{}const u4={symbols:Jge,gradient:Zge,labels:epe,entries:tpe};function Jge(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){var o,a,u,l,c,f,d,h;if(s!=="symbol")return;const{markDef:g,encoding:p,config:m,mark:y}=n,b=g.filled&&y!=="trail";let x=Object.assign(Object.assign({},yue({},n,hce)),d8(n,{filled:b}));const w=(o=r.get("symbolOpacity"))!==null&&o!==void 0?o:m.legend.symbolOpacity,_=(a=r.get("symbolFillColor"))!==null&&a!==void 0?a:m.legend.symbolFillColor,A=(u=r.get("symbolStrokeColor"))!==null&&u!==void 0?u:m.legend.symbolStrokeColor,E=w===void 0?(l=l4(p.opacity))!==null&&l!==void 0?l:g.opacity:void 0;if(x.fill){if(i==="fill"||b&&i===qn)delete x.fill;else if(x.fill.field)_?delete x.fill:(x.fill=Ze((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),x.fillOpacity=Ze(E!=null?E:1));else if(Q(x.fill)){const S=(h=(d=fA((f=p.fill)!==null&&f!==void 0?f:p.color))!==null&&d!==void 0?d:g.fill)!==null&&h!==void 0?h:b&&g.color;S&&(x.fill=Ze(S))}}if(x.stroke){if(i==="stroke"||!b&&i===qn)delete x.stroke;else if(x.stroke.field||A)delete x.stroke;else if(Q(x.stroke)){const S=mt(fA(p.stroke||p.color),g.stroke,b?g.color:void 0);S&&(x.stroke={value:S})}}if(i!==ys){const S=Y(t)&&f4(n,r,t);S?x.opacity=[Object.assign({test:S},Ze(E!=null?E:1)),Ze(m.legend.unselectedOpacity)]:E&&(x.opacity=Ze(E))}return x=Object.assign(Object.assign({},x),e),ze(x)?void 0:x}function Zge(e,{model:t,legendType:n,legendCmpt:i}){var r;if(n!=="gradient")return;const{config:s,markDef:o,encoding:a}=t;let u={};const c=((r=i.get("gradientOpacity"))!==null&&r!==void 0?r:s.legend.gradientOpacity)===void 0?l4(a.opacity)||o.opacity:void 0;return c&&(u.opacity=Ze(c)),u=Object.assign(Object.assign({},u),e),ze(u)?void 0:u}function epe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=Y(t)?f4(n,r,t):void 0,u=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s,f=qa(c)?o_({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return ze(d)?void 0:d}function tpe(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function l4(e){return c4(e,(t,n)=>Math.max(t,n.value))}function fA(e){return c4(e,(t,n)=>mt(t,n.value))}function c4(e,t){if(Dce(e))return at(e.condition).reduce(t,e.value);if(er(e))return e.value}function f4(e,t,n){const i=t.get("selections");if(!(i==null?void 0:i.length))return;const r=Ce(n.field);return i.map(s=>`(!length(data(${Ce(Je(s)+Ga)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const d4={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return T6(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return N6(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return(n=(t=i.gradientLength)!==null&&t!==void 0?t:r.gradientLength)!==null&&n!==void 0?n:upe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!==null&&i!==void 0?i:t.labelOverlap)!==null&&r!==void 0?r:lpe(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!==null&&r!==void 0?r:ipe(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Cl(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(El(n)&&Zi(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>npe(t,e)};function npe(e,t){const n=e.values;if(Q(n))return J6(t,n);if(re(n))return n}function ipe(e,t,n,i){var r;if(t!=="shape"){const s=(r=fA(n))!==null&&r!==void 0?r:i;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function rpe(e){const{legend:t}=e;return mt(t.type,spe(e))}function spe({channel:e,timeUnit:t,scaleType:n}){if(El(e)){if(be(["quarter","month","day"],t))return"symbol";if(Zi(n))return"gradient"}return"symbol"}function ope({legendConfig:e,legendType:t,orient:n,legend:i}){var r,s;return(s=(r=i.direction)!==null&&r!==void 0?r:e[t?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:ape(n,t)}function ape(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function upe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(Zi(r))return n==="horizontal"?i==="top"||i==="bottom"?h4(t,"width",o,s):o:h4(t,"height",u,a)}function h4(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function lpe(e){if(be(["quantile","threshold","log","symlog"],e))return"greedy"}function g4(e){const t=yt(e)?cpe(e):gpe(e);return e.component.legends=t,t}function cpe(e){const{encoding:t}=e,n={};for(const i of[qn,...ER]){const r=St(t[i]);!r||!e.getScaleComponent(i)||i===Wn&&Y(r)&&r.type===Ol||(n[i]=hpe(e,i))}return n}function fpe(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function dpe(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function hpe(e,t){var n,i,r;let s=e.legend(t);const{markDef:o,encoding:a,config:u}=e,l=u.legend,c=new Qge({},fpe(e,t));ghe(e,t,c);const f=s!==void 0?!s:l.disable;if(c.set("disable",f,s!==void 0),f)return c;s=s||{};const d=e.getScaleComponent(t).get("type"),h=St(a[t]),g=Y(h)?(n=Sn(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=s.orient||u.legend.orient||"right",m=rpe({legend:s,channel:t,timeUnit:g,scaleType:d}),y=ope({legend:s,legendType:m,orient:p,legendConfig:l}),b={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const E of a4){if(m==="gradient"&&E.startsWith("symbol")||m==="symbol"&&E.startsWith("gradient"))continue;const S=E in d4?d4[E](b):s[E];if(S!==void 0){const k=dpe(S,E,s,e.fieldDef(t));(k||u.legend[E]===void 0)&&c.set(E,S,k)}}const x=(i=s==null?void 0:s.encoding)!==null&&i!==void 0?i:{},w=c.get("selections"),_={},A={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const E of["labels","legend","title","symbols","gradient","entries"]){const S=s4((r=x[E])!==null&&r!==void 0?r:{},e),k=E in u4?u4[E](S,A):S;k!==void 0&&!ze(k)&&(_[E]=Object.assign(Object.assign(Object.assign({},(w==null?void 0:w.length)&&Y(h)?{name:`${Je(h.field)}_legend_${E}`}:{}),(w==null?void 0:w.length)?{interactive:!!w}:{}),{update:k}))}return ze(_)||c.set("encode",_,!!(s==null?void 0:s.encoding)),c}function gpe(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){g4(i);for(const r of z(i.component.legends))n.legend[r]=cA(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=p4(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of z(t))for(const r of e.children)!r.component.legends[i]||n.legend[i]==="shared"&&delete r.component.legends[i];return t}function p4(e,t){var n,i,r,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let u=!1;for(const l of a4){const c=jo(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return ppe(f,d);case"title":return VN(f,d);case"type":return u=!0,li("symbol")}return gm(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((i=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||i===void 0?void 0:i.gradient)&&F0(e.implicit,["encode","gradient"]),((s=(r=e.explicit)===null||r===void 0?void 0:r.encode)===null||s===void 0?void 0:s.gradient)&&F0(e.explicit,["encode","gradient"])),e}function ppe(e,t){return t.value==="circle"?t:e}var mpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function ype(e,t,n,i){var r,s,o,a,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(s=(a=e.encode)[t])!==null&&s!==void 0||(a[t]={}),(o=(u=e.encode[t]).update)!==null&&o!==void 0||(u.update={}),e.encode[t].update[n]=i}function m4(e){const t=e.component.legends,n={};for(const r of z(t)){const s=e.getScaleComponent(r),o=Ge(s.get("domains"));if(n[o])for(const a of n[o])p4(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return nn(n).flat().map(r=>bpe(r,e.config)).filter(r=>r!==void 0)}function bpe(e,t){var n,i,r;const s=e.combine(),{disable:o,labelExpr:a,selections:u}=s,l=mpe(s,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of ER)l[f]&&delete c[f]}if(l.title||delete l.title,a!==void 0){let c=a;((r=(i=l.encode)===null||i===void 0?void 0:i.labels)===null||r===void 0?void 0:r.update)&&re(l.encode.labels.update.text)&&(c=Ta(a,"datum.label",l.encode.labels.update.text.signal)),ype(l,"labels","text",{signal:c})}return l}}function vpe(e){return ql(e)||OA(e)?xpe(e):y4(e)}function xpe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),y4(e))}function y4(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const u=re(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return be(o,u)||o.push(u),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}else return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const wpe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class b4 extends As{constructor(t,n,i,r){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function v4(e){e.component.projection=yt(e)?Epe(e):Ope(e)}function Epe(e){var t;if(e.hasProjection){const n=Hn(e.specifiedProjection),i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?_pe(e):void 0,o=new b4(e.projectionName(!0),Object.assign(Object.assign({},(t=Hn(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),r,s);return o.get("type")||o.set("type","equalEarth",!1),o}}function _pe(e){const t=[],{encoding:n}=e;for(const i of[[jr,Dr],[_i,Ji]])(St(n[i[0]])||St(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Wn)&&e.typedFieldDef(Wn).type===Ol&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(Ve.Main)),t}function Ape(e,t){const n=xE(wpe,r=>!!(!yl(e.explicit,r)&&!yl(t.explicit,r)||yl(e.explicit,r)&&yl(t.explicit,r)&&Cr(e.get(r),t.get(r))));if(Cr(e.size,t.size)){if(n)return e;if(Cr(e.explicit,{}))return t;if(Cr(t.explicit,{}))return e}return null}function Ope(e){if(e.children.length===0)return;let t;for(const i of e.children)v4(i);const n=xE(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=Ape(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new b4(i,t.specifiedProjection,t.size,ge(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}var Spe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Cpe(e,t,n,i){var r,s;if(vd(t,n)){const o=yt(e)?(s=(r=e.axis(n))!==null&&r!==void 0?r:e.legend(n))!==null&&s!==void 0?s:{}:{},a=G(t,{expr:"datum"}),u=G(t,{expr:"datum",binSuffix:"end"});return{formulaAs:G(t,{binSuffix:"range",forAs:!0}),formula:X0(a,u,o.format,o.formatType,i)}}return{}}function x4(e,t){return`${LN(e)}_${t}`}function $pe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function dA(e,t,n){var i;const r=(i=rm(n,void 0))!==null&&i!==void 0?i:{},s=x4(r,t);return e.getName(`${s}_bins`)}function kpe(e){return"as"in e}function w4(e,t,n){let i,r;kpe(e)?i=he(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[G(e,{forAs:!0}),G(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},rm(t,void 0)),o=x4(s,e.field),{signal:a,extentSignal:u}=$pe(n,o);if(I0(s.extent)){const c=s.extent;r=G8(n,c.param,c),delete s.extent}const l=Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[i]},a?{signal:a}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:o,binComponent:l}}class Hr extends Ue{constructor(t,n){super(t);this.bins=n}clone(){return new Hr(null,ge(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Si(s)&&Ye(s.bin)){const{key:a,binComponent:u}=w4(s,s.bin,n);r[a]=Object.assign(Object.assign(Object.assign({},u),r[a]),Cpe(n,s,o,n.config))}return r},{});return ze(i)?null:new Hr(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=w4(n,n.bin,i);return new Hr(t,{[r]:s})}merge(t,n){for(const i of z(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=$r([...this.bins[i].as,...t.bins[i].as],_e)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(nn(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(nn(this.bins).map(t=>t.field))}hash(){return`Bin ${_e(this.bins)}`}assemble(){return nn(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,s=t.bin,{extent:o}=s,a=Spe(s,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Ei(t.field),as:i,signal:t.signal},I0(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:Ei(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:G({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function Fpe(e,t,n,i){var r;const s=yt(i)?i.encoding[bs(t)]:void 0;if(Si(n)&&yt(i)&&H6(n,s,i.markDef,i.config))e.add(G(n,{})),e.add(G(n,{suffix:"end"})),n.bin&&vd(n,t)&&e.add(G(n,{binSuffix:"range"}));else if(Uae(t)){const o=zae(t);e.add(i.getName(o))}else e.add(G(n));return Wa(n)&&nce((r=n.scale)===null||r===void 0?void 0:r.range)&&e.add(n.scale.range.field),e}function Dpe(e,t){var n;for(const i of z(t)){const r=t[i];for(const s of z(r))i in e?e[i][s]=new Set([...(n=e[i][s])!==null&&n!==void 0?n:[],...r[s]]):e[i]={[s]:r[s]}}}class nr extends Ue{constructor(t,n,i){super(t);this.dimensions=n,this.measures=i}clone(){return new nr(null,new Set(this.dimensions),ge(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")(u=r["*"])!==null&&u!==void 0||(r["*"]={}),r["*"].count=new Set([G(o,{forAs:!0})]);else{if(vs(d)||Oo(d)){const g=vs(d)?"argmin":"argmax",p=d[g];(l=r[p])!==null&&l!==void 0||(r[p]={}),r[p][g]=new Set([G({op:g,field:p},{forAs:!0})])}else(c=r[h])!==null&&c!==void 0||(r[h]={}),r[h][d]=new Set([G(o,{forAs:!0})]);Ao(a)&&n.scaleDomain(a)==="unaggregated"&&((f=r[h])!==null&&f!==void 0||(r[h]={}),r[h].min=new Set([G({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([G({field:h,aggregate:"max"},{forAs:!0})]))}else Fpe(s,a,o,n)}),s.size+z(r).length===0)?null:new nr(t,s,r)}static makeFromTransform(t,n){var i,r,s;const o=new Set,a={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((i=a["*"])!==null&&i!==void 0||(a["*"]={}),a["*"].count=new Set([f||G(u,{forAs:!0})])):((r=a[c])!==null&&r!==void 0||(a[c]={}),a[c][l]=new Set([f||G(u,{forAs:!0})])))}for(const u of(s=n.groupby)!==null&&s!==void 0?s:[])o.add(u);return o.size+z(a).length===0?null:new nr(t,o,a)}merge(t){return wN(this.dimensions,t.dimensions)?(Dpe(this.measures,t.measures),!0):(xle("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...z(this.measures)])}producedFields(){const t=new Set;for(const n of z(this.measures))for(const i of z(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${_e({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of z(this.measures))for(const o of z(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:Ei(s));return{type:"aggregate",groupby:[...this.dimensions].map(Ei),ops:t,fields:n,as:i}}}class zl extends Ue{constructor(t,n,i,r){super(t);this.model=n,this.name=i,this.data=r;for(const s of Ai){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[G(o),...Ye(a)?[G(o,{binSuffix:"end"})]:[]]},Ir(u)?{sortField:u}:Q(u)?{sortIndexField:Il(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Ai)this[n]&&(t+=` ${n.charAt(0)}:${_e(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Ai)((t=this[i])===null||t===void 0?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Ai)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Nr){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(rn(r)&&Co(s)){const o=Tm(this.childModel,n),a=EA(o);a?t[n]=a:q(NE(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=K0,field:f}=u;s.push(f),o.push(c),a.push(G(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of oA){for(const f of aA){const d=(n=s[c]&&s[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((i=h.axes)===null||i===void 0?void 0:i.length)>0){a[c]=!0;break}}if(a[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=a;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const i=[];let r=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:u}=this;if(o&&a&&(s.x||s.y)){r=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=s.x)!==null&&t!==void 0?t:[],(n=s.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[hs,ds])this[l]&&i.push(this.assembleRowColumnHeaderData(l,r,s));if(u){const l=this.assembleFacetHeaderData(s);l&&i.push(...l)}return i}}function E4(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function jpe(e,t){const n=AE(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=E4(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=E4(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return q(Fue(t)),null}function Mpe(e){const t={};return k0(e.filter,n=>{var i;if(m6(n)){let r=null;UE(n)?r=ai(n.equal):WE(n)?r=ai(n.lte):qE(n)?r=ai(n.lt):HE(n)?r=ai(n.gt):GE(n)?r=ai(n.gte):YE(n)?r=n.range[0]:VE(n)&&(r=((i=n.oneOf)!==null&&i!==void 0?i:n.in)[0]),r&&(Ba(r)?t[n.field]="date":pt(r)?t[n.field]="number":he(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function Tpe(e){const t={};function n(i){kl(i)?t[i.field]="date":i.type==="quantitative"&&aue(i.aggregate)?t[i.field]="number":wl(i.field)>1?i.field in t||(t[i.field]="flatten"):Wa(i)&&Ir(i.sort)&&wl(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((yt(e)||rr(e))&&e.forEachFieldDef((i,r)=>{if(Si(i))n(i);else{const s=La(r),o=e.fieldDef(s);n(Object.assign(Object.assign({},i),{type:o.type}))}}),yt(e)){const{mark:i,markDef:r,encoding:s}=e;if($o(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];Y(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function Npe(e){const t={};if(yt(e)&&e.component.selection)for(const n of z(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&wl(r.field)>1&&(t[r.field]="flatten")}return t}class un extends Ue{constructor(t,n){super(t);this._parse=n}clone(){return new un(null,ge(this._parse))}hash(){return`Parse ${_e(this._parse)}`}static makeExplicit(t,n,i){var r;let s={};const o=n.data;return!Mo(o)&&((r=o==null?void 0:o.format)===null||r===void 0?void 0:r.parse)&&(s=o.format.parse),this.makeWithAncestors(t,s,{},i)}static makeWithAncestors(t,n,i,r){for(const a of z(i)){const u=r.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===i[a]||u.value==="derived"||i[a]==="flatten"?delete i[a]:q(t6(a,i[a],u.value)))}for(const a of z(n)){const u=r.get(a);u!==void 0&&(u===n[a]?delete n[a]:q(t6(a,n[a],u)))}const s=new As(n,i);r.copyAll(s);const o={};for(const a of z(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return z(o).length===0||r.parseNothing?null:new un(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of z(this._parse)){const i=this._parse[n];wl(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(z(this._parse))}dependentFields(){return new Set(z(this._parse))}assembleTransforms(t=!1){return z(this._parse).filter(n=>t?wl(n)>1:!0).map(n=>{const i=jpe(n,this._parse[n]);return i?{type:"formula",expr:i,as:OE(n)}:null}).filter(n=>n!==null)}}class Po extends Ue{clone(){return new Po(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([wd])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:wd}}}class Rd extends Ue{constructor(t,n){super(t);this.params=n}clone(){return new Rd(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${_e(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Ld extends Ue{constructor(t,n){super(t);this.params=n}clone(){return new Ld(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${_e(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class Ka extends Ue{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(Mo(t)||(n=t.format?Object.assign({},oi(t.format,["parse"])):{}),_d(t))this._data={values:t.values};else if(Dl(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];be(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else ZR(t)?this._data={values:[{type:"Sphere"}]}:(QR(t)||Mo(t))&&(this._data={});this._generator=Mo(t),t.name&&(this._name=t.name),n&&!ze(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var _4=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},Rpe=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},Pd;function hA(e){return e instanceof Ka||e instanceof Rd||e instanceof Ld}class gA{constructor(){Pd.set(this,void 0),_4(this,Pd,!1,"f")}setModified(){_4(this,Pd,!0,"f")}get modifiedFlag(){return Rpe(this,Pd,"f")}}Pd=new WeakMap;class Qa extends gA{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class pA extends gA{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class Lpe extends pA{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of z(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class Ppe extends pA{constructor(t){super();this.requiresSelectionId=t&&Y_(t)}run(t){t instanceof Po&&(this.requiresSelectionId&&(hA(t.parent)||t.parent instanceof nr||t.parent instanceof un)||(this.setModified(),t.remove()))}}class Ipe extends gA{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof qr&&(i=t.producedFields(),wE(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class Bpe extends pA{constructor(){super()}run(t){t instanceof $n&&!t.isRequired()&&(this.setModified(),t.remove())}}class zpe extends Qa{run(t){if(!hA(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof un)if(t instanceof un)this.setModified(),t.merge(n);else{if(_E(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class Upe extends Qa{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof un);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const u of z(a))u in r?r[u]!==a[u]&&s.add(u):r[u]=a[u]}for(const o of s)delete r[o];if(!ze(r)){this.setModified();const o=new un(t,r);for(const a of n){if(a instanceof un)for(const u of z(r))delete a.parse[u];t.removeChild(a),a.parent=o,a instanceof un&&z(a.parse).length===0&&a.remove()}}}}}class qpe extends Qa{run(t){t instanceof $n||t.numChildren()>0||t instanceof zl||t instanceof Ka||(this.setModified(),t.remove())}}class Wpe extends Qa{run(t){const n=t.children.filter(r=>r instanceof qr),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class Hpe extends Qa{run(t){const n=t.children.filter(r=>r instanceof nr),i={};for(const r of n){const s=_e(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of z(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class Gpe extends Qa{constructor(t){super();this.model=t}run(t){const n=!(hA(t)||t instanceof Ll||t instanceof un||t instanceof Po),i=[],r=[];for(const s of t.children)s instanceof Hr&&(n&&!_E(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof Hr?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class Ype extends Qa{run(t){const n=[...t.children];if(!xl(n,o=>o instanceof $n)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof $n){let a=o;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof $n)a=u;else break}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class Ja extends Ue{constructor(t,n){super(t);this.transform=n}clone(){return new Ja(null,ge(this.transform))}addDimensions(t){this.transform.groupby=$r(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`JoinAggregateTransform ${_e(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function Vpe(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=G(i);return r&&t.push(r),t},[])}function Xpe(e){return Q(e)&&e.every(t=>he(t))&&e.length>1}class Cs extends Ue{constructor(t,n){super(t);this._stack=n}clone(){return new Cs(null,ge(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(mt(f.order,"ascending"));const l={field:a,order:u};let c;return Xpe(s)?c=s:he(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Cs(t,{stackField:i,groupby:r,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannel:s,fieldChannel:o,offset:a,impute:u}=i;let l;if(s){const h=r[s];l=zr(h)}const c=Vpe(n),f=n.encoding.order;let d;return Q(f)||Y(f)?d=HN(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Cs(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${_e(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:i}=this._stack;return t?t.bin?n?[G(t,{binSuffix:"mid"})]:[G(t,{}),G(t,{binSuffix:"end"})]:[G(t)]:i!=null?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:i,stackField:r,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;if(u&&i){const{bandPosition:c=.5,bin:f}=i;f&&t.push({type:"formula",expr:`${c}*`+G(i,{expr:"datum"})+`+${1-c}*`+G(i,{expr:"datum",binSuffix:"end"}),as:G(i,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...s,...n],key:G(i,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:l,offset:a}),t}}class Ul extends Ue{constructor(t,n){super(t);this.transform=n}clone(){return new Ul(null,ge(this.transform))}addDimensions(t){this.transform.groupby=$r(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(i.add,i),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:G(t)}hash(){return`WindowTransform ${_e(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],s=[];for(const d of this.transform.window)i.push(d.op),r.push(this.getDefaultName(d)),s.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&i.every(d=>DE(d)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},a!==void 0?{groupby:a}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:r,ops:i,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),a!==void 0?{groupby:a}:{}),o!==void 0?{frame:o}:{})}}function Kpe(e){function t(n){if(!(n instanceof zl)){const i=n.clone();if(i instanceof $n){const r=yA+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof nr||i instanceof Cs||i instanceof Ul||i instanceof Ja)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function mA(e){if(e instanceof zl)if(e.numChildren()===1&&!(e.children[0]instanceof $n)){const t=e.children[0];(t instanceof nr||t instanceof Cs||t instanceof Ul||t instanceof Ja)&&t.addDimensions(e.fields),t.swapWithParent(),mA(e)}else{const t=e.model.component.data.main;A4(t);const n=Kpe(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(mA)}function A4(e){if(e instanceof $n&&e.type===Ve.Main&&e.numChildren()===1){const t=e.children[0];t instanceof zl||(t.swapWithParent(),A4(e))}}const yA="scale_",Mm=5;function bA(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!bA(t.children))return!1}return!0}function ir(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function O4(e,t,n){let i=e.sources,r=!1;return r=ir(new Bpe,i)||r,r=ir(new Ppe(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=ir(new qpe,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=ir(new zpe,i)||r,r=ir(new Gpe(t),i)||r,r=ir(new Ipe,i)||r,r=ir(new Upe,i)||r,r=ir(new Hpe,i)||r,r=ir(new Wpe,i)||r,r=ir(new Lpe,i)||r,r=ir(new Ype,i)||r),e.sources=i,r}function Qpe(e,t){bA(e.sources);let n=0,i=0;for(let r=0;r<Mm&&O4(e,t,!0);r++)n++;e.sources.map(mA);for(let r=0;r<Mm&&O4(e,t,!1);r++)i++;bA(e.sources),Math.max(n,i)===Mm&&q(`Maximum optimization runs(${Mm}) reached.`)}class Vn{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Vn(()=>t(n))}}var Jpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function S4(e){yt(e)?Zpe(e):e0e(e)}function Zpe(e){const t=e.component.scales;for(const n of z(t)){const i=n0e(e,n);if(t[n].setWithExplicit("domains",i),r0e(e,n),e.component.data.isFaceted){let s=e;for(;!rr(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)xs(a)&&(a.data=yA+a.data.replace(yA,""))}}}function e0e(e){for(const n of e.children)S4(n);const t=e.component.scales;for(const n of z(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=jo(i,o.getWithExplicit("domains"),"domains","scale",wA);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&q(Sue),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function t0e(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=C4(t,n);if(!r){q(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=C4(t,n);if(r)return"unaggregated"}return e}function n0e(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=t0e(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),t==="x"&&St(i.x2)?St(i.x)?jo(Io(n,r,e,"x"),Io(n,r,e,"x2"),"domain","scale",wA):Io(n,r,e,"x2"):t==="y"&&St(i.y2)?St(i.y)?jo(Io(n,r,e,"y"),Io(n,r,e,"y2"),"domain","scale",wA):Io(n,r,e,"y2"):Io(n,r,e,t)}function i0e(e,t,n){return e.map(i=>({signal:`{data: ${sm(i,{timeUnit:n,type:t})}}`}))}function vA(e,t,n){var i;const r=(i=Sn(n))===null||i===void 0?void 0:i.unit;return t==="temporal"||r?i0e(e,t,r):[e]}function Io(e,t,n,i){const{encoding:r}=n,s=St(r[i]),{type:o}=s,a=s.timeUnit;if(tce(t)){const f=Io(e,void 0,n,i),d=vA(t.unionWith,o,a);return Os([...f.value,...d])}else{if(re(t))return Os([t]);if(t&&t!=="unaggregated"&&!x6(t))return Os(vA(t,o,a))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return li([[0,1]]);const f=n.requestDataName(Ve.Main);return li([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=Ao(i)&&Y(s)?s0e(n,i,e):void 0;if(ko(s)){const f=vA([s.datum],o,a);return li(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(Ve.Main),{field:d}=s;return li([{data:f,field:G({field:d,aggregate:"min"})},{data:f,field:G({field:d,aggregate:"max"})}])}else if(Ye(c.bin)){if(rn(e))return li(e==="bin-ordinal"?[]:[{data:sd(l)?n.requestDataName(Ve.Main):n.requestDataName(Ve.Raw),field:n.vgField(i,vd(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!He(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(Ye(f)){const d=dA(n,c.field,f);return li([new Vn(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return li([{data:n.requestDataName(Ve.Main),field:n.vgField(i,{})}])}}else if(c.timeUnit&&be(["time","utc"],e)&&H6(c,yt(n)?n.encoding[bs(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(Ve.Main);return li([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return li(l?[{data:sd(l)?n.requestDataName(Ve.Main):n.requestDataName(Ve.Raw),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(Ve.Main),field:n.vgField(i)}])}function xA(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":K0},i?{field:Ei(i)}:{}),r?{order:r}:{})}function r0e(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,s=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=x6(r)&&r,a=Pa(s)&&I0(s.extent)&&s.extent;(o||a)&&i.set("selectionExtent",o!=null?o:a,!0)}function s0e(e,t,n){if(!rn(n))return;const i=e.fieldDef(t),r=i.sort;if(z6(r))return{op:"min",field:Il(i,t),order:"ascending"};const{stack:s}=e,o=s?[...s.groupbyField?[s.groupbyField]:[],...s.stackBy.map(a=>a.fieldDef.field)]:void 0;if(Ir(r)){const a=s&&!be(o,r.field);return xA(r,a)}else if(B6(r)){const{encoding:a,order:u}=r,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=s&&!be(o,f);if(vs(c)||Oo(c))return xA({field:G(l),order:u},d);if(DE(c)||!c)return xA({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(be(["ascending",void 0],r))return!0}}function C4(e,t){const{aggregate:n,type:i}=e;return n?he(n)&&!cue[n]?{valid:!1,reason:Que(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:Jue(e)}:{valid:!0}:{valid:!1,reason:Kue(e)}}function wA(e,t,n,i){return e.explicit&&t.explicit&&q(ile(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function o0e(e){const t=$r(e.map(o=>xs(o)?Jpe(o,["sort"]):o),_e),n=$r(e.map(o=>{if(xs(o)){const a=o.sort;return a!==void 0&&!sd(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),_e);if(t.length===0)return;if(t.length===1){const o=e[0];if(xs(o)&&n.length>0){let a=n[0];if(n.length>1)q(a6),a=!0;else if(He(a)&&"field"in a){const u=a.field;o.field===u&&(a=a.order?{order:a.order}:!0)}return Object.assign(Object.assign({},o),{sort:a})}return o}const i=$r(n.map(o=>sd(o)||!("op"in o)||he(o.op)&&o.op in sue?o:(q(sle(o)),!0)),_e);let r;i.length===1?r=i[0]:i.length>1&&(q(a6),r=!0);const s=$r(e.map(o=>xs(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(a=>a.field)},r?{sort:r}:{}):Object.assign({fields:t},r?{sort:r}:{})}function EA(e){if(xs(e)&&he(e.field))return e.field;if(due(e)){let t;for(const n of e.fields)if(xs(n)&&he(n.field)){if(!t)t=n.field;else if(t!==n.field)return q(ole),t}return q(ale),t}else if(hue(e)){q(ule);const t=e.fields[0];return he(t)?t:void 0}}function Tm(e,t){const i=e.component.scales[t].get("domains").map(r=>(xs(r)&&(r.data=e.lookupDataSource(r.data)),r));return o0e(i)}var a0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function $4(e){return ql(e)||OA(e)?e.children.reduce((t,n)=>t.concat($4(n)),k4(e)):k4(e)}function k4(e){return z(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:u,range:l,reverse:c}=r,f=a0e(r,["name","type","selectionExtent","domains","range","reverse"]),d=u0e(r.range,s,n,e),h=Tm(e,n),g=a?qde(e,a,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},h?{domain:h}:{}),g?{domainRaw:g}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function u0e(e,t,n,i){if(Rr(n)){if(Co(e))return{step:{signal:`${t}_step`}}}else if(He(e)&&xs(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}class F4 extends As{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:xl(this.get("domains"),t=>Q(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const l0e=["range","scheme"];function D4(e){return e==="x"?"width":e==="y"?"height":void 0}function c0e(e){const t=e.component.scales;for(const n of P0){const i=t[n];if(!i)continue;const r=f0e(n,e);i.setWithExplicit("range",r)}}function j4(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:i,field:r}=n,s=D4(t),o=e.getName(s);if(He(i)&&i.binned&&i.step!==void 0)return new Vn(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${u})`});if(Ye(i)){const a=dA(e,r,i);return new Vn(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(o)} / (${l})`})}}}function f0e(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const l of l0e)if(n[l]!==void 0){const c=ZE(s,l),f=w6(e,l);if(!c)q(s6(s,l,e));else if(f)q(f);else switch(l){case"range":{const d=n.range;if(Q(d)){if(Rr(e))return Os(d.map(h=>{if(h==="width"||h==="height"){const g=t.getName(h),p=t.getSignalName.bind(t);return Vn.fromName(p,g)}return h}))}else if(He(d))return Os({data:t.requestDataName(Ve.Main),field:d.field,sort:{op:"min",field:t.vgField(e)}});return Os(d)}case"scheme":return Os(d0e(n[l]))}}if(e===tt||e===At){const l=e===tt?"width":"height",c=i[l];if(Ur(c)){if(rn(s))return Os({step:c.step});q(o6(l))}}const{rangeMin:o,rangeMax:a}=n,u=h0e(e,t);return(o!==void 0||a!==void 0)&&ZE(s,"rangeMin")&&Q(u)&&u.length===2?Os([o!=null?o:u[0],a!=null?a:u[1]]):li(u)}function d0e(e){return ece(e)?Object.assign({scheme:e.name},oi(e,["name"])):{scheme:e}}function h0e(e,t){const{size:n,config:i,mark:r,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=St(s[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case tt:case At:{if(be(["point","band"],l)){if(e===tt&&!n.width){const g=Ed(i.view,"width");if(Ur(g))return g}else if(e===At&&!n.height){const g=Ed(i.view,"height");if(Ur(g))return g}}const d=D4(e),h=t.getName(d);return e===At&&ui(l)?[Vn.fromName(o,h),0]:[0,Vn.fromName(o,h)]}case ms:{const d=t.component.scales[e].get("zero"),h=M4(r,d,i),g=m0e(r,n,t,i);return md(l)?p0e(h,g,g0e(l,i,c,e)):[h,g]}case Qi:return[0,Math.PI*2];case Na:return[0,360];case Fr:return[0,new Vn(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case xo:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case wo:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Wn:return"symbol";case qn:case Mr:case Tr:return l==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case ys:case bo:case vo:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function g0e(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&Q(n)?n.length+1:(q(yle(i)),3)}}function p0e(e,t,n){const i=()=>{const r=ws(t),s=ws(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return re(t)?new Vn(i):{signal:i()}}function M4(e,t,n){if(t)return re(t)?{signal:`${t.signal} ? 0 : ${M4(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(z0("size",e))}const T4=.95;function m0e(e,t,n,i){const r={x:j4(n,"x"),y:j4(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=N4(t,r,i.view);return pt(s)?s-1:new Vn(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=N4(t,r,i.view);return pt(s)?Math.pow(T4*s,2):new Vn(()=>`pow(${T4} * ${s.signal}, 2)`)}}throw new Error(z0("size",e))}function N4(e,t,n){const i=Ur(e.width)?e.width.step:dm(n,"width"),r=Ur(e.height)?e.height.step:dm(n,"height");return t.x||t.y?new Vn(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function R4(e,t){yt(e)?y0e(e,t):I4(e,t)}function y0e(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of z(n)){const u=o[a],l=n[a],c=e.getScaleComponent(a),f=St(r[a]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=ZE(h,t),y=w6(a,t);if(d!==void 0&&(m?y&&q(y):q(s6(h,t,a))),m&&y===void 0)if(d!==void 0){const b=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":Ba(u[t])||x==="temporal"||b?l.set(t,{signal:sm(u[t],{type:x,timeUnit:b})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const b=t in L4?L4[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,markDef:s,config:i}):i.scale[t];b!==void 0&&l.set(t,b,!1)}}}const L4={bins:({model:e,fieldOrDatumDef:t})=>Y(t)?b0e(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>v0e(e,t.type),nice:({scaleType:e,channel:t,domain:n,fieldOrDatumDef:i})=>x0e(e,t,n,i),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>w0e(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>E0e(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:s})=>_0e(e,t,n,i.type,r,s.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=Y(e)?e.sort:void 0;return A0e(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>O0e(e,t,n,i,r)};function P4(e){yt(e)?c0e(e):I4(e,"range")}function I4(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?P4(i):R4(i,t);for(const i of z(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=jo(r,a,t,"scale",KR((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function b0e(e,t){const n=t.bin;if(Ye(n)){const i=dA(e,t.field,n);return new Vn(()=>e.getSignalName(i))}else if(On(n)&&Pa(n)&&n.step!==void 0)return{step:n.step}}function v0e(e,t){if(be([qn,Mr,Tr],e)&&t!=="nominal")return"hcl"}function x0e(e,t,n,i){var r;if(!(((r=zr(i))===null||r===void 0?void 0:r.bin)||Q(n)||be([Ot.TIME,Ot.UTC],e)))return t in _o?!0:void 0}function w0e(e,t,n,i,r,s){if(e in _o){if(Zi(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(Y(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===Ot.POINT)return n.pointPadding}}function E0e(e,t,n,i){if(e===void 0&&t in _o){const{bandPaddingInner:r,barBandPaddingInner:s,rectBandPaddingInner:o}=i;return mt(r,n==="bar"?s:o)}}function _0e(e,t,n,i,r,s){if(e===void 0&&t in _o&&n===Ot.BAND){const{bandPaddingOuter:o}=s;return mt(o,re(r)?{signal:`${r.signal}/2`}:r/2)}}function A0e(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return ui(e)&&t==="descending"?re(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(ui(e)&&t==="descending")return!0}function O0e(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&ui(r)){if(Q(n)){const o=n[0],a=n[n.length-1];if(o<=0&&a>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!md(r))return!0;if(!(Y(t)&&t.bin)&&be([...Nr,...Qae],e)){const{orient:o,type:a}=i;return!(be(["bar","area","line","trail"],a)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function S0e(e,t,n,i){const r=C0e(t,n,i),{type:s}=e;return Ao(t)?s!==void 0?ace(t,s)?Y(n)&&!oce(s,n.type)?(q(tle(s,r)),r):s:(q(ele(t,s,r)),r):r:null}function C0e(e,t,n){var i;switch(t.type){case"nominal":case"ordinal":{if(El(e)||FE(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&q(LE(e,"ordinal")),"ordinal";if(e in _o){if(be(["rect","bar","image","rule"],n.type))return"band"}else if(n.type==="arc"&&e in kE)return"band";const r=n[Oi(e)];return Sl(r)||d_(t)&&((i=t.axis)===null||i===void 0?void 0:i.tickBand)?"band":"point"}case"temporal":return El(e)?"time":FE(e)==="discrete"?(q(LE(e,"temporal")),"ordinal"):Y(t)&&t.timeUnit&&Sn(t.timeUnit).utc?"utc":"time";case"quantitative":return El(e)?Y(t)&&Ye(t.bin)?"bin-ordinal":"linear":FE(e)==="discrete"?(q(LE(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(i6(t.type))}function $0e(e,{ignoreRange:t}={}){B4(e),S4(e);for(const n of sce)R4(e,n);t||P4(e)}function B4(e){yt(e)?e.component.scales=k0e(e):e.component.scales=D0e(e)}function k0e(e){const{encoding:t,mark:n,markDef:i}=e;return P0.reduce((r,s)=>{const o=St(t[s]);if(o&&n===A6&&s===Wn&&o.type===Ol)return r;let a=o&&o.scale;if(o&&a!==null&&a!==!1){a!=null||(a={});const u=S0e(a,s,o,i);r[s]=new F4(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}return r},{})}const F0e=KR((e,t)=>b6(e)-b6(t));function D0e(e){var t,n;const i=e.component.scales={},r={},s=e.component.resolve;for(const o of e.children){B4(o);for(const a of z(o.component.scales))if((t=(n=s.scale)[a])!==null&&t!==void 0||(n[a]=o4(a,e)),s.scale[a]==="shared"){const u=r[a],l=o.component.scales[a].getWithExplicit("type");u?zle(u.value,l.value)?r[a]=jo(u,l,"type","scale",F0e):(s.scale[a]="independent",delete r[a]):r[a]=l}}for(const o of z(r)){const a=e.scaleName(o,!0),u=r[o];i[o]=new F4(a,u);for(const l of e.children){const c=l.component.scales[o];c&&(l.renameScale(c.get("name"),a),c.merged=!0)}}return i}var _A=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class AA{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function yt(e){return(e==null?void 0:e.type)==="unit"}function rr(e){return(e==null?void 0:e.type)==="facet"}function OA(e){return(e==null?void 0:e.type)==="concat"}function ql(e){return(e==null?void 0:e.type)==="layer"}class SA{constructor(t,n,i,r,s,o,a){var u,l;this.type=n,this.parent=i,this.config=s,this.correctDataNames=c=>{var f,d,h;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((h=(d=c.from)===null||d===void 0?void 0:d.facet)===null||h===void 0?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=s,this.view=Hn(a),this.name=(u=t.name)!==null&&u!==void 0?u:r,this.title=So(t.title)?{text:t.title}:t.title?Hn(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new AA,this.projectionNameMap=i?i.projectionNameMap:new AA,this.signalNameMap=i?i.signalNameMap:new AA,this.data=t.data,this.description=t.description,this.transforms=mde((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Efe(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:Q0(t)||i&&i.component.data.isFaceted&&t.data===void 0},layoutSize:new As,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?ge(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){$0e(this)}parseProjection(){v4(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){g4(this)}assembleEncodeFromView(t){const n=_A(t,["style"]),i={};for(const r of z(n)){const s=n[r];s!==void 0&&(i[r]=Ze(s))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Ze(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):ze(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=_A(t,["spacing"]),{component:r,config:s}=this,o=Xge(r.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Ai)t[i].title&&n.push(qge(this,i));for(const i of oA)n=n.concat(Wge(this,i));return n}assembleAxes(){return Dge(this.component.axes,this.config)}assembleLegends(){return m4(this)}assembleProjections(){return vpe(this)}assembleTitle(){var t,n,i;const r=(t=this.title)!==null&&t!==void 0?t:{},{encoding:s}=r,o=_A(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},IN(this.config.title).nonMarkTitleProperties),o),s?{encode:{update:s}}:{});if(a.text)return be(["unit","layer"],this.type)?be(["middle",void 0],a.anchor)&&((n=a.frame)!==null&&n!==void 0||(a.frame="group")):(i=a.anchor)!==null&&i!==void 0||(a.anchor="start"),ze(a)?void 0:a}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||rr(this.parent)?$4(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return Je((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Ve[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(rr(this.parent)){const n=r4(t),i=L0(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(rn(s)&&Co(o)){const a=r.get("name"),u=Tm(this,i),l=EA(u);if(l){const c=G({aggregate:"distinct",field:l},{expr:"datum"});return{signal:i4(a,r,c)}}else return q(NE(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(DN(t)&&Ao(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(wue(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(i=>i.hasOrientSignalRef()))}}class z4 extends SA{vgField(t,n={}){const i=this.fieldDef(t);if(!!i)return G(i,n)}reduceFieldDef(t,n){return Kce(this.getMapping(),(i,r,s)=>{const o=zr(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){y_(this.getMapping(),(i,r)=>{const s=zr(i);s&&t(s,r)},n)}}var j0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Nm extends Ue{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"value",(s=o[1])!==null&&s!==void 0?s:"density"]}clone(){return new Nm(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=j0e(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class Id extends Ue{constructor(t,n){super(t);this.filter=n}clone(){return new Id(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:s}=n;if(Le("invalid",s,i)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=Ao(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");ui(d)&&l.aggregate!=="count"&&!$o(r)&&(u[l.field]=l)}return u},{});return z(a).length?new Id(t,a):null}dependentFields(){return new Set(z(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${_e(this.filter)}`}assemble(){const t=z(this.filter).reduce((n,i)=>{const r=this.filter[i],s=G(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):r.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Rm extends Ue{constructor(t,n){super(t);this.transform=n,this.transform=ge(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>{var a;return(a=r[o])!==null&&a!==void 0?a:s})}clone(){return new Rm(this.parent,ge(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${_e(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Lm extends Ue{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"key",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new Lm(null,ge(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${_e(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Wl extends Ue{constructor(t,n,i,r){super(t);this.fields=n,this.geojson=i,this.signal=r}clone(){return new Wl(null,ge(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[jr,Dr],[_i,Ji]]){const s=r.map(o=>{const a=St(n.encoding[o]);return Y(a)?a.field:ko(a)?{expr:`${a.datum}`}:er(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Wl(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(Wn)){const r=n.typedFieldDef(Wn);r.type===Ol&&(t=new Wl(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(he);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${_e(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class Bd extends Ue{constructor(t,n,i,r){super(t);this.projection=n,this.fields=i,this.as=r}clone(){return new Bd(null,this.projection,ge(this.fields),ge(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[jr,Dr],[_i,Ji]]){const r=i.map(o=>{const a=St(n.encoding[o]);return Y(a)?a.field:ko(a)?{expr:`${a.datum}`}:er(a)?{expr:`${a.value}`}:void 0}),s=i[0]===_i?"2":"";(r[0]||r[1])&&(t=new Bd(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(he))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${_e(this.fields)} ${_e(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Za extends Ue{constructor(t,n){super(t);this.transform=n}clone(){return new Za(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Za(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(Y(r)&&Y(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=sR(n.mark,i);return new Za(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${_e(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:Jfe(i)?this.processSequence(i):i}:{}),{method:"value"}),s?{groupby:s}:{}),{value:!r||r==="value"?o:null});if(r&&r!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var M0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Pm extends Ue{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:n.on,(s=o[1])!==null&&s!==void 0?s:n.loess]}clone(){return new Pm(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=M0e(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class zd extends Ue{constructor(t,n,i){super(t);this.transform=n,this.secondary=i}clone(){return new zd(null,ge(this.transform),this.secondary)}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(Zfe(o)){let u=H4(o.data,s);u||(u=new Ka(o.data),s.push(u));const l=n.getName(`lookup_${r}`);a=new $n(u,l,Ve.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(ede(o)){const u=o.param;i=Object.assign({as:u},i);let l;try{l=n.getSelectionComponent(Je(u),u)}catch{throw new Error(Aue(u))}if(a=l.materialized,!a)throw new Error(Oue(u))}return new zd(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?at(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${_e({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:at(this.transform.as)}:{});else{let n=this.transform.as;he(n)||(q(Mue),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var T0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Im extends Ue{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:"prob",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new Im(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=T0e(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}var N0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Bm extends Ue{constructor(t,n){var i,r,s;super(t);this.transform=n,this.transform=ge(n);const o=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=o[0])!==null&&r!==void 0?r:n.on,(s=o[1])!==null&&s!==void 0?s:n.regression]}clone(){return new Bm(null,ge(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${_e(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=N0e(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class zm extends Ue{constructor(t,n){super(t);this.transform=n}clone(){return new zm(null,ge(this.transform))}addDimensions(t){var n;this.transform.groupby=$r(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${_e(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),s!==void 0?{op:s}:{}),i!==void 0?{groupby:i}:{})}}class Um extends Ue{constructor(t,n){super(t);this.transform=n}clone(){return new Um(null,ge(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${_e(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function U4(e){let t=0;function n(i,r){var s;if(i instanceof Ka&&!i.isGenerator&&!Dl(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof un&&(i.parent instanceof Ka&&!r.source?(r.format=Object.assign(Object.assign({},(s=r.format)!==null&&s!==void 0?s:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof zl){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Rd||i instanceof Ld||i instanceof Id||i instanceof Ll||i instanceof Pl||i instanceof Bd||i instanceof nr||i instanceof zd||i instanceof Ul||i instanceof Ja||i instanceof Lm||i instanceof Rm||i instanceof Nm||i instanceof Pm||i instanceof Im||i instanceof Bm||i instanceof Po||i instanceof Um||i instanceof zm)&&r.transform.push(i.assemble()),(i instanceof Hr||i instanceof qr||i instanceof Za||i instanceof Cs||i instanceof Wl)&&r.transform.push(...i.assemble()),i instanceof $n&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof $n?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof $n&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const a of i.children)n(a,{name:null,source:o,transform:[]});break}}}return n}function R0e(e){const t=[],n=U4(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function L0e(e,t){var n,i;const r=[],s=U4(r);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();s(u,l)}for(const u of r)u.transform.length===0&&delete u.transform;let a=0;for(const[u,l]of r.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&r.splice(a++,0,r.splice(u,1)[0]);for(const u of r)for(const l of(i=u.transform)!==null&&i!==void 0?i:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function P0e(e){return e==="top"||e==="left"||re(e)?"header":"footer"}function I0e(e){for(const t of Ai)B0e(e,t);W4(e,"x"),W4(e,"y")}function B0e(e,t){var n;const{facet:i,config:r,child:s,component:o}=e;if(e.channelHasField(t)){const a=i[t],u=Bl("title",null,r,t);let l=Cl(a,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});s.component.layoutHeaders[t].title&&(l=Q(l)?l.join(", "):l,l+=` / ${s.component.layoutHeaders[t].title}`,s.component.layoutHeaders[t].title=null);const c=Bl("labelOrient",a.header,r,t),f=a.header!==null?mt((n=a.header)===null||n===void 0?void 0:n.labels,r.header.labels,!0):!1,d=be(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:a.header!==null?l:null,facetFieldDef:a,[d]:t==="facet"?[]:[q4(e,t,f)]}}}function q4(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function W4(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:s}=e.component;if(s.axis[t]=cA(s,t),s.axis[t]==="shared"){const o=t==="x"?"column":"row",a=r[o];for(const u of i.component.axes[t]){const l=P0e(u.get("orient"));(n=a[l])!==null&&n!==void 0||(a[l]=[q4(e,o,!1)]);const c=Nd(u,"main",e.config,{header:!0});c&&a[l][0].axes.push(c),u.mainExtracted=!0}}}}function z0e(e){CA(e),qm(e,"width"),qm(e,"height")}function U0e(e){CA(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";qm(e,t),qm(e,n)}function CA(e){for(const t of e.children)t.parseLayoutSize()}function qm(e,t){var n;const i=r4(t),r=L0(i),s=e.component.resolve,o=e.component.layoutSize;let a;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(i),c=(n=s.scale[r])!==null&&n!==void 0?n:o4(r,e);if(c==="independent"&&l.value==="step"){a=void 0;break}if(a){if(c==="independent"&&a.value!==l.value){a=void 0;break}a=jo(a,l,i,"")}else a=l}if(a){for(const u of e.children)e.renameSignal(u.getName(i),e.getName(t)),u.component.layoutSize.set(i,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function q0e(e){const{size:t,component:n}=e;for(const i of Nr){const r=Oi(i);if(t[r]){const s=t[r];n.layoutSize.set(r,Ur(s)?"step":s,!0)}else{const s=W0e(e,r);n.layoutSize.set(r,s,!1)}}}function W0e(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if(rn(s)){const a=Ed(i.view,t);return Co(o)||Ur(a)?"step":a}else return k_(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return k_(i.view,t);{const s=Ed(i.view,t);return Ur(s)?s.step:s}}}function $A(e,t,n){return G(t,Object.assign({suffix:`by_${G(e)}`},n!=null?n:{}))}class Ud extends z4{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve);this.child=MA(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!bd(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=z(t),i={};for(const r of n){if(![ds,hs].includes(r)){q(z0(r,"facet"));break}const s=t[r];if(s.field===void 0){q(RE(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=p_(t,n);return i.header?i.header=Hn(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Wm(this),this.child.parseData()}parseLayoutSize(){CA(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),I0e(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const s of Ai)for(const o of aA){const a=this.component.layoutHeaders[s],u=a[o],{facetFieldDef:l}=a;if(l){const c=Bl("titleOrient",l.header,this.config,s);if(["right","bottom"].includes(c)){const f=Fm(s,c);(t=r.titleAnchor)!==null&&t!==void 0||(r.titleAnchor={}),r.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=s==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";s!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=r[f])!==null&&n!==void 0||(r[f]={}),r[f][s]=.5),a.title&&((i=r.offset)!==null&&i!==void 0||(r.offset={}),r.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Ud))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Ud?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:G(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Ud){if(this.child.channelHasField("column")){const r=G(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Nr){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(rn(o)&&Co(a)){const u=Tm(this.child,r),l=EA(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):q(NE(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Ai){const f=this.facet[c];if(f){u.push(G(f));const{bin:d,sort:h}=f;if(Ye(d)&&u.push(G(f,{binSuffix:"end"})),Ir(h)){const{field:g,op:p=K0}=h,m=$A(f,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(g),o.push(p),a.push(m))}else if(Q(h)){const g=Il(f,c);s.push(g),o.push("max"),a.push(g)}}}const l=!!i&&!!r;return Object.assign({name:t,data:n,groupby:u},l||s.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Ir(i.sort)?[$A(i,i.sort,{expr:"datum"})]:Q(i.sort)?[Il(i,t,{expr:"datum"})]:[G(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Ir(r)?r.order:!Q(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return uA(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const s of oA)if(n[s]){const o=Bl("labelOrient",(t=n[s])===null||t===void 0?void 0:t.header,i,s);if(r[s].includes(o))return uA(n[s],s,i)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=R0e(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ai.map(u=>this.facetSortFields(u)).flat(),order:Ai.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(Ide(this,[])))]}getMapping(){return this.facet}}function H0e(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Ir(s.sort)){const{field:o,op:a=K0}=s.sort;e=r=new Ja(e,{joinaggregate:[{op:a,field:o,as:$A(s,s.sort,{forAs:!0})}],groupby:[G(s)]})}return r}return null}function H4(e,t){var n,i,r,s;for(const o of t){const a=o.data;if(e.name&&o.hasName()&&e.name!==o.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(i=a.format)===null||i===void 0?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)===null||r===void 0?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(s=a.format)===null||s===void 0?void 0:s.mesh;if(!((u||f)&&u!==f)){if(_d(e)&&_d(a)){if(Cr(e.values,a.values))return o}else if(Dl(e)&&Dl(a)){if(e.url===a.url)return o}else if(QR(e)&&e.name===o.dataName)return o}}return null}function G0e(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Ka({values:[]});return t.push(i),i}const n=H4(e.data,t);if(n)return Mo(e.data)||(n.data.format=xN({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Ka(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Y0e(e,t,n){var i,r;let s=0;for(const o of t.transforms){let a,u;if(cde(o))u=e=new Pl(e,o),a="derived";else if(T_(o)){const l=Mpe(o);u=e=(i=un.makeWithAncestors(e,{},l,n))!==null&&i!==void 0?i:e,e=new Ll(e,t,o.filter)}else if(UR(o))u=e=Hr.makeFromTransform(e,o,t),a="number";else if(dde(o))a="date",n.getWithExplicit(o.field).value===void 0&&(e=new un(e,{[o.field]:a}),n.set(o.field,a,!1)),u=e=qr.makeFromTransform(e,o);else if(hde(o))u=e=nr.makeFromTransform(e,o),a="number",Y_(t)&&(e=new Po(e));else if(zR(o))u=e=zd.make(e,t,o,s++),a="derived";else if(ade(o))u=e=new Ul(e,o),a="number";else if(ude(o))u=e=new Ja(e,o),a="number";else if(gde(o))u=e=Cs.makeFromTransform(e,o),a="derived";else if(pde(o))u=e=new Lm(e,o),a="derived";else if(lde(o))u=e=new Rm(e,o),a="derived";else if(tde(o))u=e=new zm(e,o),a="derived";else if(ode(o))e=new Um(e,o);else if(fde(o))u=e=Za.makeFromTransform(e,o),a="derived";else if(nde(o))u=e=new Nm(e,o),a="derived";else if(ide(o))u=e=new Im(e,o),a="derived";else if(rde(o))u=e=new Bm(e,o),a="derived";else if(sde(o))u=e=new Pm(e,o),a="derived";else{q(jue(o));continue}if(u&&a!==void 0)for(const l of(r=u.producedFields())!==null&&r!==void 0?r:[])n.set(l,a,!1)}return e}function Wm(e){var t,n,i,r,s,o,a,u,l,c;let f=G0e(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.data,m=!(g&&(Mo(g)||Dl(g)||_d(g)))&&e.parent?e.parent.component.data.ancestorParse.clone():new Sde;Mo(g)?(JR(g)?f=new Ld(f,g.sequence):L_(g)&&(f=new Rd(f,g.graticule)),m.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=un.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new Po(f);const y=e.parent&&ql(e.parent);(yt(e)||rr(e))&&y&&(f=(i=Hr.makeFromEncoding(f,e))!==null&&i!==void 0?i:f),e.transforms.length>0&&(f=Y0e(f,e,m));const b=Npe(e),x=Tpe(e);f=(r=un.makeWithAncestors(f,{},Object.assign(Object.assign({},b),x),m))!==null&&r!==void 0?r:f,yt(e)&&(f=Wl.parseAll(f,e),f=Bd.parseAll(f,e)),(yt(e)||rr(e))&&(y||(f=(s=Hr.makeFromEncoding(f,e))!==null&&s!==void 0?s:f),f=(o=qr.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=Pl.parseAllForSortIndex(f,e));const w=e.getDataName(Ve.Raw),_=new $n(f,w,Ve.Raw,h);if(d[w]=_,f=_,yt(e)){const k=nr.makeFromEncoding(f,e);k&&(f=k,Y_(e)&&(f=new Po(f))),f=(a=Za.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=(u=Cs.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}yt(e)&&(f=(l=Id.make(f,e))!==null&&l!==void 0?l:f);const A=e.getDataName(Ve.Main),E=new $n(f,A,Ve.Main,h);d[A]=E,f=E,yt(e)&&kge(e,E);let S=null;if(rr(e)){const k=e.getName("facet");f=(c=H0e(f,e.facet))!==null&&c!==void 0?c:f,S=new zl(f,e,k,E.getSource()),d[k]=S}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:_,main:E,facetRoot:S,ancestorParse:m})}class V0e extends SA{constructor(t,n,i,r){var s,o,a,u;super(t,"concat",n,i,r,t.resolve);(((o=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||u===void 0?void 0:u.y)==="shared")&&q(kue),this.children=this.getChildren(t).map((l,c)=>MA(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=Wm(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return fm(t)?t.vconcat:$_(t)?t.hconcat:t.concat}parseLayoutSize(){U0e(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=lA(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function X0e(e){return e===!1||e===null}const K0e=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},tR),{labelExpr:1,encode:1}),G4=z(K0e);class kA extends As{constructor(t={},n={},i=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new kA(ge(this.explicit),ge(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!X0e(this.get(t))}hasOrientSignalRef(){return re(this.explicit.orient)}}function Q0e(e,t,n){var i;const{encoding:r,config:s}=e,o=(i=St(r[t]))!==null&&i!==void 0?i:St(r[bs(t)]),a=e.axis(t)||{},{format:u,formatType:l}=a;return qa(l)?Object.assign({text:o_({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:s})},n):n}function J0e(e){return Nr.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[sme(n,e)]),t),{})}const Z0e={bottom:"top",top:"bottom",left:"right",right:"left"};function eme(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of z(s.component.axes))i.axis[o]=cA(e.component.resolve,o),i.axis[o]==="shared"&&(n[o]=tme(n[o],s.component.axes[o]),n[o]||(i.axis[o]="independent",delete n[o]))}for(const s of Nr){for(const o of e.children)if(!!o.component.axes[s]){if(i.axis[s]==="independent"){n[s]=((t=n[s])!==null&&t!==void 0?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:u,explicit:l}=a.getWithExplicit("orient");if(!re(u)){if(r[u]>0&&!l){const c=Z0e[u];r[u]>r[c]&&a.set("orient",c,!1)}r[u]++}}}delete o.component.axes[s]}if(i.axis[s]==="independent"&&n[s]&&n[s].length>1)for(const o of n[s])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function tme(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=nme(r,s)}}}else return t.map(n=>n.clone());return e}function nme(e,t){for(const n of G4){const i=jo(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return VN(r,s);case"gridScale":return{explicit:r.explicit,value:mt(r.value,s.value)}}return gm(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function ime(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(re(n.labelAngle)?n.labelAngle:ud(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===J8(i,r))return!0}return e===n[t]}const rme=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function sme(e,t){var n,i,r;let s=t.axis(e);const o=new kA,a=St(t.encoding[e]),{mark:u,config:l}=t,c=(s==null?void 0:s.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((i=l.axis)===null||i===void 0?void 0:i.orient)||Ige(e),f=t.getScaleComponent(e).get("type"),d=jge(e,f,c,t.config),h=s!==void 0?!s:rA("disable",l.style,s==null?void 0:s.style,d).configValue;if(o.set("disable",h,s!==void 0),h)return o;s=s||{};const g=Rge(a,s,e,l.style,d),p={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const b of G4){const x=b in X8?X8[b](p):nR(b)?s[b]:void 0,w=x!==void 0,_=ime(x,b,s,t,e);if(w&&_)o.set(b,x,_);else{const{configValue:A=void 0,configFrom:E=void 0}=nR(b)&&b!=="values"?rA(b,l.style,s.style,d):{},S=A!==void 0;w&&!S?o.set(b,x,_):(E!=="vgAxisConfig"||rme.has(b)&&S||xd(A)||re(A))&&o.set(b,A,!1)}}const m=(r=s.encoding)!==null&&r!==void 0?r:{},y=eR.reduce((b,x)=>{var w;if(!o.hasAxisPart(x))return b;const _=s4((w=m[x])!==null&&w!==void 0?w:{},t),A=x==="labels"?Q0e(t,e,_):_;return A!==void 0&&!ze(A)&&(b[x]={update:A}),b},{});return ze(y)||o.set("encode",y,!!s.encoding||s.labelAngle!==void 0),o}function ome({encoding:e,size:t}){for(const n of Nr){const i=Oi(n);Ur(t[i])&&Br(e[n])&&(delete t[i],q(o6(i)))}return t}function ame(e,t,n){const i=Hn(e),r=Le("orient",i,n);if(i.orient=fme(i.type,t,r),r!==void 0&&r!==i.orient&&q(Yue(i.orient,r)),i.type==="bar"&&i.orient){const a=Le("cornerRadiusEnd",i,n);if(a!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:bce[i.orient];for(const l of u)i[l]=a;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Le("opacity",i,n)===void 0&&(i.opacity=lme(i.type,t)),Le("cursor",i,n)===void 0&&(i.cursor=ume(i,t,n)),i}function ume(e,t,n){return t.href||e.href||Le("href",e,n)?"pointer":e.cursor}function lme(e,t){if(be([G0,e_,t_,n_],e)&&!m_(t))return .7}function cme(e,t,{graticule:n}){if(n)return!1;const i=Ia("filled",e,t),r=e.type;return mt(i,r!==G0&&r!==H0&&r!==Y0)}function fme(e,t,n){switch(e){case G0:case t_:case n_:case _6:case lce:case uce:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case W0:if(Y(i)&&(On(i.bin)||Y(r)&&r.aggregate&&!i.aggregate))return"vertical";if(Y(r)&&(On(r.bin)||Y(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(Y(i)&&i.type===za&&!Ye(i.bin)||f_(i)))return"horizontal";if(!o&&(Y(r)&&r.type===za&&!Ye(r.bin)||f_(r)))return"vertical"}case Y0:if(s&&!(Y(i)&&On(i.bin))&&o&&!(Y(r)&&On(r.bin)))return;case q0:if(o)return Y(r)&&On(r.bin)?"horizontal":"vertical";if(s)return Y(i)&&On(i.bin)?"vertical":"horizontal";if(e===Y0){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case H0:case e_:{const a=Br(i),u=Br(r);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u){const l=i,c=r,f=l.type===Al,d=c.type===Al;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const dme={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),No(e,"radius","arc")),No(e,"theta","arc"))},hme={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),bm("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),bm("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),H_(e))},gme={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),No(e,"x","bar")),No(e,"y","bar"))},pme={vgMark:"shape",encodeEntry:e=>Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&Y(n)&&n.type===Ol?{field:G(n,{expr:"datum"})}:{})]}},mme={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),No(e,"x","image")),No(e,"y","image")),q_(e,"url"))},yme={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Tt("size",e,{vgChannel:"strokeWidth"})),H_(e))},bme={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Tt("size",e)),H_(e))};function FA(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),Tt("size",e)),Tt("angle",e)),vme(e,n,t))}function vme(e,t,n){return n?{shape:{value:n}}:Tt("shape",e)}const xme={vgMark:"symbol",encodeEntry:e=>FA(e)},wme={vgMark:"symbol",encodeEntry:e=>FA(e,"circle")},Eme={vgMark:"symbol",encodeEntry:e=>FA(e,"square")},_me={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),No(e,"x","rect")),No(e,"y","rect"))},Ame={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),bm("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),bm("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Tt("size",e,{vgChannel:"strokeWidth"}))}},Ome={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),sn("x",e,{defaultPos:"mid"})),sn("y",e,{defaultPos:"mid"})),q_(e)),Tt("size",e,{vgChannel:"fontSize"})),Tt("angle",e)),y8("align",Sme(e.markDef,n,t))),y8("baseline",Cme(e.markDef,n,t))),sn("radius",e,{defaultPos:null})),sn("theta",e,{defaultPos:null}))}};function Sme(e,t,n){if(Le("align",e,n)===void 0)return"center"}function Cme(e,t,n){if(Le("baseline",e,n)===void 0)return"middle"}const $me={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",s=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ci(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),sn("x",e,{defaultPos:"mid",vgChannel:"xc"})),sn("y",e,{defaultPos:"mid",vgChannel:"yc"})),Tt("size",e,{defaultValue:kme(e),vgChannel:r})),{[s]:Ze(Le("thickness",n,t))})}};function kme(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,s=r==="horizontal"?"width":"height",o=e.getScaleComponent(r==="horizontal"?"x":"y"),a=(t=Le("size",i,n,{vgChannel:s}))!==null&&t!==void 0?t:n.tick.bandSize;if(a!==void 0)return a;{const u=o?o.get("range"):void 0;return u&&Co(u)&&pt(u.step)?u.step*3/4:dm(n.view,s)*3/4}}const Hm={arc:dme,area:hme,bar:gme,circle:wme,geoshape:pme,image:mme,line:yme,point:xme,rect:_me,rule:Ame,square:Eme,text:Ome,tick:$me,trail:bme};function Fme(e){if(be([H0,q0,cce],e.mark)){const t=sR(e.mark,e.encoding);if(t.length>0)return Dme(e,t)}else if(e.mark===W0){const t=jE.some(n=>Le(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return jme(e)}return DA(e)}const Y4="faceted_path_";function Dme(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Y4+e.requestDataName(Ve.Main),data:e.requestDataName(Ve.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:DA(e,{fromPrefix:Y4})}]}const V4="stack_group_";function jme(e){const[t]=DA(e,{fromPrefix:V4}),n=e.scaleName(e.stack.fieldChannel),i=(l={})=>e.vgField(e.stack.fieldChannel,l),r=(l,c)=>{const f=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let s,o;e.stack.fieldChannel==="x"?(s=Object.assign(Object.assign({},vl(t.encode.update,["y","yc","y2","height",...jE])),{x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},oi(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(s=Object.assign(Object.assign({},vl(t.encode.update,["x","xc","x2","width"])),{y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},oi(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of jE){const c=Ia(l,e.markDef,e.config);t.encode.update[l]?(s[l]=t.encode.update[l],delete t.encode.update[l]):c&&(s[l]=Ze(c)),c&&(t.encode.update[l]={value:0})}const a=[];if(e.stack.groupbyChannel){const l=e.fieldDef(e.stack.groupbyChannel),c=G(l);c&&a.push(c),((l==null?void 0:l.bin)||(l==null?void 0:l.timeUnit))&&a.push(G(l,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return Object.assign(Object.assign({},l),{[c]:t.encode.update[c]});{const f=Ia(c,e.markDef,e.config);return f!==void 0?Object.assign(Object.assign({},l),{[c]:Ze(f)}):l}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Ve.Main),name:V4+e.requestDataName(Ve.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:o},marks:[t]}]}]}function Mme(e){var t;const{encoding:n,stack:i,mark:r,markDef:s,config:o}=e,a=n.order;if(!(!Q(a)&&er(a)&&vE(a.value)||!a&&vE(Le("order",s,o)))){if((Q(a)||Y(a))&&!i)return HN(a,{expr:"datum"});if($o(r)){const u=s.orient==="horizontal"?"y":"x",l=n[u];if(Y(l)){const c=l.sort;if(Q(c))return{field:G(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(Ir(c))return{field:G({aggregate:m_(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(B6(c)){const f=e.fieldDef(c.encoding);return{field:G(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:G(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function DA(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=mt(i.clip,Tme(e),Nme(e)),a=qN(i),u=r.key,l=Mme(e),c=Rme(e),f=Le("aria",i,s),d=Hm[n].postEncodingTransform?Hm[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Hm[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(Ve.Main)},encode:{update:Hm[n].encodeEntry(e)}}),d?{transform:d}:{})]}function Tme(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function Nme(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Rme(e){if(!e.component.selection)return null;const t=z(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=z(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class X4 extends z4{constructor(t,n,i,r={},s){var o;super(t,"unit",n,i,s,void 0,AR(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=Pr(t.mark)?Object.assign({},t.mark):{type:t.mark},u=a.type;a.filled===void 0&&(a.filled=cme(a,s,{graticule:t.data&&L_(t.data)}));const l=this.encoding=Vce(t.encoding||{},u,a.filled,s);this.markDef=ame(a,l,s),this.size=ome({encoding:l,size:AR(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=jR(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((o=t.params)!==null&&o!==void 0?o:[]).filter(c=>S_(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===A6,i=t&&qae.some(r=>de(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return P0.reduce((i,r)=>{var s;const o=St(n[r]);return o&&(i[r]=this.initScale((s=o.scale)!==null&&s!==void 0?s:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Hn(t);return Q(n)&&(r.domain=n.map(ai)),Q(i)&&(r.range=i.map(ai)),r}initAxes(t){return Nr.reduce((n,i)=>{const r=t[i];if(de(r)||i===tt&&de(t.x2)||i===At&&de(t.y2)){const s=de(r)?r.axis:void 0;n[i]=s&&this.initAxis(Object.assign({},s))}return n},{})}initAxis(t){const n=z(t),i={};for(const r of n){const s=t[r];i[r]=xd(s)?BN(s):ai(s)}return i}initLegends(t){return Jae.reduce((n,i)=>{const r=St(t[i]);if(r&&eue(i)){const s=r.legend;n[i]=s&&Hn(s)}return n},{})}parseData(){this.component.data=Wm(this)}parseLayoutSize(){q0e(this)}parseSelections(){this.component.selection=$ge(this,this.selection)}parseMarkGroup(){this.component.mark=Fme(this)}parseAxesAndHeaders(){this.component.axes=J0e(this)}assembleSelectionTopLevelSignals(t){return Bde(this,t)}assembleSignals(){return[...Y8(this),...Pde(this,[])]}assembleSelectionData(t){return zde(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return lA(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!ql(this.parent))&&(n=o8(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Ha(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return zr(n)}typedFieldDef(t){const n=this.fieldDef(t);return Si(n)?n:null}}class jA extends SA{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,u)=>{if(hm(a))return new jA(a,this,this.getName(`layer_${u}`),o,s);if(Es(a))return new X4(a,this,this.getName(`layer_${u}`),o,s);throw new Error(TE(a))})}parseData(){this.component.data=Wm(this);for(const t of this.children)t.parseData()}parseLayoutSize(){z0e(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of z(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){eme(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),Y8(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),lA(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of at(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Ude(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),m4(this))}}function MA(e,t,n,i,r){if(Q0(e))return new Ud(e,t,n,r);if(hm(e))return new jA(e,t,n,i,r);if(Es(e))return new X4(e,t,n,i,r);if(vfe(e))return new V0e(e,t,n,r);throw new Error(TE(e))}var Lme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Pme(e,t={}){t.logger&&ble(t.logger),t.fieldTitle&&K6(t.fieldTitle);try{const n=FR(bN(t.config,e.config)),i=YR(e,n),r=MA(i,null,"",void 0,n);return r.parse(),Qpe(r.component.data,r),{spec:Bme(r,Ime(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&vle(),t.fieldTitle&&Pce()}}function Ime(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):he(t)&&(t={type:t}),r&&s&&_de(t.type)){if(r==="step"&&s==="step")q(QN()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";q(QN(L0(o)));const a=o==="width"?"height":"width";t.type=Ade(a)}}return Object.assign(Object.assign(Object.assign({},z(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),XR(n,!1)),XR(e,!0))}function Bme(e,t,n={},i){const r=e.config?Tfe(e.config):void 0,s=[].concat(e.assembleSelectionData([]),L0e(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f}=t,d=Lme(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),a?{title:a}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),..._R(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const zme=xae.version;var Ume=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:zme,compile:Pme,normalize:YR,deepEqual:Cr,duplicate:ge,pick:vl,omit:oi,stringify:Ge,hash:_e,isNullOrFalse:vE,contains:be,some:xl,every:xE,mergeDeep:xN,unique:$r,isEqual:Lae,setEqual:wN,hasIntersection:wE,prefixGenerator:EE,fieldIntersection:_E,isEmpty:ze,keys:z,vals:nn,entries:yo,isBoolean:sd,varName:Je,logicalExpr:od,deleteNestedProperty:F0,titleCase:ad,accessPathWithDatum:AE,flatAccessWithDatum:EN,replacePathInField:Ei,replaceAll:Ta,removePathFromField:OE,accessPathDepth:wl,getFirstDefined:mt,uniqueId:AN,resetIdCounter:Iae,internalField:ON,isInternalField:SN,normalizeAngle:ud,isNumeric:D0});function K4(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var qme="vega-themes",Wme="2.10.0",Hme="Themes for stylized Vega and Vega-Lite visualizations.",Gme=["vega","vega-lite","themes","style"],Yme="BSD-3-Clause",Vme={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Xme=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Kme="build/vega-themes.js",Qme="build/vega-themes.module.js",Jme="build/vega-themes.min.js",Zme="build/vega-themes.min.js",e1e="build/vega-themes.module.d.ts",t1e={type:"git",url:"https://github.com/vega/vega-themes.git"},n1e=["src","build"],i1e={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},r1e={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},s1e={vega:"*","vega-lite":"*"},o1e={name:qme,version:Wme,description:Hme,keywords:Gme,license:Yme,author:Vme,contributors:Xme,main:Kme,module:Qme,unpkg:Jme,jsdelivr:Zme,types:e1e,repository:t1e,files:n1e,scripts:i1e,devDependencies:r1e,peerDependencies:s1e};const Hl="#fff",a1e="#888",u1e={background:"#333",title:{color:Hl,subtitleColor:Hl},style:{"guide-label":{fill:Hl},"guide-title":{fill:Hl}},axis:{domainColor:Hl,gridColor:a1e,tickColor:Hl}},eu="#4572a7",l1e={background:"#fff",arc:{fill:eu},area:{fill:eu},line:{stroke:eu,strokeWidth:2},path:{stroke:eu},rect:{fill:eu},shape:{stroke:eu},symbol:{fill:eu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},tu="#30a2da",TA="#cbcbcb",c1e="#999",f1e="#333",Q4="#f0f0f0",J4="#333",d1e={arc:{fill:tu},area:{fill:tu},axis:{domainColor:TA,grid:!0,gridColor:TA,gridWidth:1,labelColor:c1e,labelFontSize:10,titleColor:f1e,tickColor:TA,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Q4,group:{fill:Q4},legend:{labelColor:J4,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:J4,titleFontSize:14,titlePadding:10},line:{stroke:tu,strokeWidth:2},path:{stroke:tu,strokeWidth:.5},rect:{fill:tu},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:tu},bar:{binSpacing:2,fill:tu,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},nu="#000",h1e={group:{fill:"#e5e5e5"},arc:{fill:nu},area:{fill:nu},line:{stroke:nu},path:{stroke:nu},rect:{fill:nu},shape:{stroke:nu},symbol:{fill:nu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},g1e=22,p1e="normal",Z4="Benton Gothic, sans-serif",e9=11.5,m1e="normal",iu="#82c6df",NA="Benton Gothic Bold, sans-serif",t9="normal",n9=13,qd={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},y1e={background:"#ffffff",title:{anchor:"start",color:"#000000",font:NA,fontSize:g1e,fontWeight:p1e},arc:{fill:iu},area:{fill:iu},line:{stroke:iu,strokeWidth:2},path:{stroke:iu},rect:{fill:iu},shape:{stroke:iu},symbol:{fill:iu,size:30},axis:{labelFont:Z4,labelFontSize:e9,labelFontWeight:m1e,titleFont:NA,titleFontSize:n9,titleFontWeight:t9},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Z4,labelFontSize:e9,symbolType:"square",titleFont:NA,titleFontSize:n9,titleFontWeight:t9},range:{category:qd["category-6"],diverging:qd["fireandice-6"],heatmap:qd["fire-7"],ordinal:qd["fire-7"],ramp:qd["fire-7"]}},ru="#ab5787",Gm="#979797",b1e={background:"#f9f9f9",arc:{fill:ru},area:{fill:ru},line:{stroke:ru},path:{stroke:ru},rect:{fill:ru},shape:{stroke:ru},symbol:{fill:ru,size:30},axis:{domainColor:Gm,domainWidth:.5,gridWidth:.2,labelColor:Gm,tickColor:Gm,tickWidth:.2,titleColor:Gm},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},su="#3e5c69",v1e={background:"#fff",arc:{fill:su},area:{fill:su},line:{stroke:su},path:{stroke:su},rect:{fill:su},shape:{stroke:su},symbol:{fill:su},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},$i="#1696d2",i9="#000000",x1e="#FFFFFF",Ym="Lato",RA="Lato",w1e="Lato",E1e="#DEDDDD",_1e=18,Wd={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},A1e={background:x1e,title:{anchor:"start",fontSize:_1e,font:Ym},axisX:{domain:!0,domainColor:i9,domainWidth:1,grid:!1,labelFontSize:12,labelFont:RA,labelAngle:0,tickColor:i9,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Ym},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:E1e,gridWidth:1,labelFontSize:12,labelFont:RA,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Ym,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:RA,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Ym,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Wd["six-groups-cat-1"],diverging:Wd["diverging-colors"],heatmap:Wd["diverging-colors"],ordinal:Wd["six-groups-seq"],ramp:Wd["shades-blue"]},area:{fill:$i},rect:{fill:$i},line:{color:$i,stroke:$i,strokeWidth:5},trail:{color:$i,stroke:$i,strokeWidth:0,size:1},path:{stroke:$i,strokeWidth:.5},point:{filled:!0},text:{font:w1e,color:$i,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:$i,stroke:null}},arc:{fill:$i},shape:{stroke:$i},symbol:{fill:$i,size:30}},ou="#3366CC",r9="#ccc",Vm="Arial, sans-serif",O1e={arc:{fill:ou},area:{fill:ou},path:{stroke:ou},rect:{fill:ou},shape:{stroke:ou},symbol:{stroke:ou},circle:{fill:ou},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Vm,fontSize:12},"guide-title":{font:Vm,fontSize:12},"group-title":{font:Vm,fontSize:12}},title:{font:Vm,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:r9,tickColor:r9,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},S1e=o1e.version;var C1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:u1e,excel:l1e,fivethirtyeight:d1e,ggplot2:h1e,googlecharts:O1e,latimes:y1e,quartz:b1e,urbaninstitute:A1e,version:S1e,vox:v1e});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function $1e(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function k1e(e,t,n){if(Z(e))return`[${e.map(i=>t(Se(i)?i:s9(i,n))).join(", ")}]`;if(fe(e)){let i="";const r=e,{title:s,image:o}=r,a=$1e(r,["title","image"]);s&&(i+=`<h2>${t(s)}</h2>`),o&&(i+=`<img src="${t(o)}">`);const u=Object.keys(a);if(u.length>0){i+="<table>";for(const l of u){let c=a[l];c!==void 0&&(fe(c)&&(c=s9(c,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function F1e(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function s9(e,t){return JSON.stringify(e,F1e(t))}var D1e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const o9="vg-tooltip-element",j1e={offsetX:10,offsetY:10,id:o9,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:M1e,maxDepth:2,formatTooltip:k1e};function M1e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function T1e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return D1e.toString().replace(o9,e)}function N1e(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let s=e.clientY+i;return s+t.height>window.innerHeight&&(s=+e.clientY-i-t.height),{x:r,y:s}}class R1e{constructor(t){this.options=Object.assign(Object.assign({},j1e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=T1e(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var s;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((s=document.fullscreenElement)!==null&&s!==void 0?s:document.body).appendChild(this.el),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:a,y:u}=N1e(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${a}px`)}}function L1e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a9(e,t,n,i,r,s,o){try{var a=e[s](o),u=a.value}catch(l){n(l);return}a.done?t(u):Promise.resolve(u).then(i,r)}function Xm(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(u){a9(s,i,r,o,a,"next",u)}function a(u){a9(s,i,r,o,a,"throw",u)}o(void 0)})}}var u9=Object.prototype,au=u9.hasOwnProperty,Gr,LA=typeof Symbol=="function"?Symbol:{},Km=LA.iterator||"@@iterator",P1e=LA.asyncIterator||"@@asyncIterator",Qm=LA.toStringTag||"@@toStringTag";function l9(e,t,n,i){var r=t&&t.prototype instanceof IA?t:IA,s=Object.create(r.prototype),o=new qA(i||[]);return s._invoke=q1e(e,n,o),s}function PA(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var c9="suspendedStart",I1e="suspendedYield",f9="executing",Jm="completed",sr={};function IA(){}function Zm(){}function Gl(){}var BA={};BA[Km]=function(){return this};var zA=Object.getPrototypeOf,e1=zA&&zA(zA(WA([])));e1&&e1!==u9&&au.call(e1,Km)&&(BA=e1);var Yl=Gl.prototype=IA.prototype=Object.create(BA);Zm.prototype=Yl.constructor=Gl;Gl.constructor=Zm;Gl[Qm]=Zm.displayName="GeneratorFunction";function d9(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function h9(e){var t=typeof e=="function"&&e.constructor;return t?t===Zm||(t.displayName||t.name)==="GeneratorFunction":!1}function B1e(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,Gl):(e.__proto__=Gl,Qm in e||(e[Qm]="GeneratorFunction")),e.prototype=Object.create(Yl),e}function z1e(e){return{__await:e}}function t1(e,t){function n(s,o,a,u){var l=PA(e[s],e,o);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&au.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,a,u)},function(d){n("throw",d,a,u)}):t.resolve(f).then(function(d){c.value=d,a(c)},function(d){return n("throw",d,a,u)})}}var i;function r(s,o){function a(){return new t(function(u,l){n(s,o,u,l)})}return i=i?i.then(a,a):a()}this._invoke=r}d9(t1.prototype);t1.prototype[P1e]=function(){return this};function U1e(e,t,n,i,r){r===void 0&&(r=Promise);var s=new t1(l9(e,t,n,i),r);return h9(t)?s:s.next().then(function(o){return o.done?o.value:s.next()})}function q1e(e,t,n){var i=c9;return function(s,o){if(i===f9)throw new Error("Generator is already running");if(i===Jm){if(s==="throw")throw o;return p9()}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var u=g9(a,n);if(u){if(u===sr)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===c9)throw i=Jm,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);i=f9;var l=PA(e,t,n);if(l.type==="normal"){if(i=n.done?Jm:I1e,l.arg===sr)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(i=Jm,n.method="throw",n.arg=l.arg)}}}function g9(e,t){var n=e.iterator[t.method];if(n===Gr){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=Gr,g9(e,t),t.method==="throw"))return sr;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return sr}var i=PA(n,e.iterator,t.arg);if(i.type==="throw")return t.method="throw",t.arg=i.arg,t.delegate=null,sr;var r=i.arg;if(!r)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,sr;if(r.done)t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=Gr);else return r;return t.delegate=null,sr}d9(Yl);Yl[Qm]="Generator";Yl[Km]=function(){return this};Yl.toString=function(){return"[object Generator]"};function W1e(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function UA(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function qA(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W1e,this),this.reset(!0)}function H1e(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}}function WA(e){if(e){var t=e[Km];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(au.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=Gr,r.done=!0,r};return i.next=i}}return{next:p9}}function p9(){return{value:Gr,done:!0}}qA.prototype={constructor:qA,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=Gr,this.done=!1,this.delegate=null,this.method="next",this.arg=Gr,this.tryEntries.forEach(UA),!t)for(var n in this)n.charAt(0)==="t"&&au.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=Gr)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(l,c){return o.type="throw",o.arg=t,n.next=l,c&&(n.method="next",n.arg=Gr),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if(s.tryLoc==="root")return i("end");if(s.tryLoc<=this.prev){var a=au.call(s,"catchLoc"),u=au.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else if(u){if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&au.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&(t==="break"||t==="continue")&&s.tryLoc<=n&&n<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=n,s?(this.method="next",this.next=s.finallyLoc,sr):this.complete(o)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),sr},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),UA(i),sr}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if(r.type==="throw"){var s=r.arg;UA(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:WA(t),resultName:n,nextLoc:i},this.method==="next"&&(this.arg=Gr),sr}};var Bo={wrap:l9,isGeneratorFunction:h9,AsyncIterator:t1,mark:B1e,awrap:z1e,async:U1e,keys:H1e,values:WA};function G1e(e,t,n){var i=e.open(t),r=1e4,s=250,o=new URL(t),a=o.origin,u=~~(r/s);function l(f){f.source===i&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(i.postMessage(n,a),setTimeout(c,s),u-=1)}setTimeout(c,s)}var Y1e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper.fit-x {
    width: 100%; }
  .vega-embed .chart-wrapper.fit-y {
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function m9(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];V1e(e,o)}return e}function V1e(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];rc(e,r,t[r],!0)}}var HA;function y9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function zo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y9(Object(n),!0).forEach(function(i){L1e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y9(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var Uo=zoe,Hd=Ume,n1=typeof window!="undefined"?window:void 0;Hd===void 0&&n1!==null&&n1!==void 0&&(HA=n1.vl)!==null&&HA!==void 0&&HA.compile&&(Hd=n1.vl);var X1e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},K1e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Gd={vega:"Vega","vega-lite":"Vega-Lite"},i1={vega:Uo.version,"vega-lite":Hd?Hd.version:"not available"},Q1e={vega:e=>e,"vega-lite":(e,t)=>Hd.compile(e,{config:t}).spec},J1e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Z1e="chart-wrapper";function eye(e){return typeof e=="function"}function b9(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),s="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(r+e+s),o.document.title="".concat(Gd[i]," JSON Source")}function tye(e,t){if(e.$schema){var n=K4(e.$schema);if(t&&t!==n.library){var i;console.warn("The given visualization spec is written in ".concat(Gd[n.library],", but mode argument sets ").concat((i=Gd[t])!==null&&i!==void 0?i:t,"."))}var r=n.library;return IO.satisfies(i1[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(Gd[r]," ").concat(n.version,", but the current version of ").concat(Gd[r]," is v").concat(i1[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function nye(e){return!!(e&&"load"in e)}function v9(e){return nye(e)?e:Uo.loader(e)}function x9(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function mye(e,t){return GA.apply(this,arguments)}function GA(){return GA=Xm(Bo.mark(function e(t,n){var i,r,s,o,a,u,l,c,f,d,h=arguments;return Bo.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(s=h.length>2&&h[2]!==void 0?h[2]:{},!Se(n)){p.next=10;break}return a=v9(s.loader),p.t0=JSON,p.next=6,a.load(n);case 6:p.t1=p.sent,o=p.t0.parse.call(p.t0,p.t1),p.next=11;break;case 10:o=n;case 11:return u=x9(o).loader,(!a||u)&&(a=v9((l=s.loader)!==null&&l!==void 0?l:u)),p.next=15,w9(x9(o),a);case 15:return c=p.sent,p.next=18,w9(s,a);case 18:return f=p.sent,d=zo(zo({},m9(f,c)),{},{config:gh((i=f.config)!==null&&i!==void 0?i:{},(r=c.config)!==null&&r!==void 0?r:{})}),p.next=22,rye(t,o,d,a);case 22:return p.abrupt("return",p.sent);case 23:case"end":return p.stop()}},e)})),GA.apply(this,arguments)}function w9(e,t){return YA.apply(this,arguments)}function YA(){return YA=Xm(Bo.mark(function e(t,n){var i,r,s;return Bo.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!Se(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=(i=t.config)!==null&&i!==void 0?i:{};case 9:if(r=a.t0,!Se(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return s=a.t3,a.abrupt("return",zo(zo(zo({},t),s?{patch:s}:{}),r?{config:r}:{}));case 21:case"end":return a.stop()}},e)})),YA.apply(this,arguments)}function iye(e){var t=e.getRootNode?e.getRootNode():document;if(t instanceof ShadowRoot)return{root:t,rootContainer:t};var n;return{root:document,rootContainer:(n=document.head)!==null&&n!==void 0?n:document.body}}function rye(e,t){return VA.apply(this,arguments)}function VA(){return VA=Xm(Bo.mark(function e(t,n){var i,r,s,o,a,u,l,c,f,d,h,g,p,m,y,b,x,w,_,A,E,S,k,$,F,M,j,I,D,P,B,H,X,ce,Te,$e,nt,qe,lt,ln,ki,ci,V,le,me,U,ht,we,bt,ct=arguments;return Bo.wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:if(bt=function(){$e&&document.removeEventListener("click",$e),P.finalize()},c=ct.length>2&&ct[2]!==void 0?ct[2]:{},f=ct.length>3?ct[3]:void 0,d=c.theme?gh(C1e[c.theme],(i=c.config)!==null&&i!==void 0?i:{}):c.config,h=R1(c.actions)?c.actions:m9({},X1e,(r=c.actions)!==null&&r!==void 0?r:{}),g=zo(zo({},K1e),c.i18n),p=(s=c.renderer)!==null&&s!==void 0?s:"canvas",m=(o=c.logLevel)!==null&&o!==void 0?o:Uo.Warn,y=(a=c.downloadFileName)!==null&&a!==void 0?a:"visualization",b=typeof t=="string"?document.querySelector(t):t,b){Yr.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(x="vega-embed-style",w=iye(b),_=w.root,A=w.rootContainer,_.getElementById(x)||(E=document.createElement("style"),E.id=x,E.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?Y1e.toString():c.defaultStyle,A.appendChild(E))),S=tye(n,c.mode),k=Q1e[S](n,d),S==="vega-lite"&&k.$schema&&($=K4(k.$schema),IO.satisfies(i1.vega,"^".concat($.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat($.version,", but current version is v").concat(i1.vega,"."))),b.classList.add("vega-embed"),h&&b.classList.add("has-actions"),b.innerHTML="",F=b,h&&(M=document.createElement("div"),M.classList.add(Z1e),b.appendChild(M),F=M),j=c.patch,j&&(j instanceof Function?k=j(k):k=Jd(k,j,!0,!1).newDocument),c.formatLocale&&Uo.formatLocale(c.formatLocale),c.timeFormatLocale&&Uo.timeFormatLocale(c.timeFormatLocale),I=c.ast,D=Uo.parse(k,S==="vega-lite"?{}:d,{ast:I}),P=new(c.viewClass||Uo.View)(D,zo({loader:f,logLevel:m,renderer:p},I?{expr:(u=(l=Uo.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:Qoe}:{})),P.addSignalListener("autosize",(or,kn)=>{var Kn=kn.type;Kn=="fit-x"?(F.classList.add("fit-x"),F.classList.remove("fit-y")):Kn=="fit-y"?(F.classList.remove("fit-x"),F.classList.add("fit-y")):Kn=="fit"?F.classList.add("fit-x","fit-y"):F.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(eye(c.tooltip)?B=c.tooltip:B=new R1e(c.tooltip===!0?{}:c.tooltip).call,P.tooltip(B)),H=c.hover,H===void 0&&(H=S==="vega"),H&&(X=typeof H=="boolean"?{}:H,ce=X.hoverSet,Te=X.updateSet,P.hover(ce,Te)),c&&(c.width!=null&&P.width(c.width),c.height!=null&&P.height(c.height),c.padding!=null&&P.padding(c.padding)),Yr.next=36,P.initialize(F,c.bind).runAsync();case 36:if(h!==!1){if(nt=b,c.defaultStyle!==!1&&(qe=document.createElement("details"),qe.title=g.CLICK_TO_VIEW_ACTIONS,b.append(qe),nt=qe,lt=document.createElement("summary"),lt.innerHTML=J1e,qe.append(lt),$e=or=>{qe.contains(or.target)||qe.removeAttribute("open")},document.addEventListener("click",$e)),ln=document.createElement("div"),nt.append(ln),ln.classList.add("vega-actions"),h===!0||h.export!==!1)for(ki=function(){var kn=V[ci];if(h===!0||h.export===!0||h.export[kn]){var Kn=g["".concat(kn.toUpperCase(),"_ACTION")],cu=document.createElement("a");cu.text=Kn,cu.href="#",cu.target="_blank",cu.download="".concat(y,".").concat(kn),cu.addEventListener("mousedown",function(){var D9=Xm(Bo.mark(function nO(j9){var iO;return Bo.wrap(function(Xl){for(;;)switch(Xl.prev=Xl.next){case 0:return j9.preventDefault(),Xl.next=3,P.toImageURL(kn,c.scaleFactor);case 3:iO=Xl.sent,this.href=iO;case 5:case"end":return Xl.stop()}},nO,this)}));return function(nO){return D9.apply(this,arguments)}}()),ln.append(cu)}},ci=0,V=["svg","png"];ci<V.length;ci++)ki();(h===!0||h.source!==!1)&&(le=document.createElement("a"),le.text=g.SOURCE_ACTION,le.href="#",le.addEventListener("click",function(or){var kn,Kn;b9(h1(n),(kn=c.sourceHeader)!==null&&kn!==void 0?kn:"",(Kn=c.sourceFooter)!==null&&Kn!==void 0?Kn:"",S),or.preventDefault()}),ln.append(le)),S==="vega-lite"&&(h===!0||h.compiled!==!1)&&(me=document.createElement("a"),me.text=g.COMPILED_ACTION,me.href="#",me.addEventListener("click",function(or){var kn,Kn;b9(h1(k),(kn=c.sourceHeader)!==null&&kn!==void 0?kn:"",(Kn=c.sourceFooter)!==null&&Kn!==void 0?Kn:"","vega"),or.preventDefault()}),ln.append(me)),(h===!0||h.editor!==!1)&&(ht=(U=c.editorUrl)!==null&&U!==void 0?U:"https://vega.github.io/editor/",we=document.createElement("a"),we.text=g.EDITOR_ACTION,we.href="#",we.addEventListener("click",function(or){G1e(window,ht,{config:d,mode:S,renderer:p,spec:h1(n)}),or.preventDefault()}),ln.append(we))}return Yr.abrupt("return",{view:P,spec:n,vgSpec:k,finalize:bt});case 38:case"end":return Yr.stop()}},e)})),VA.apply(this,arguments)}const Xn=Symbol("data"),E9=Symbol("context");class Yd{toObject(){return A9(this)}}class sye{constructor(t){this[Xn]=t}toObject(){return Object.assign({},...r1(this[Xn]))}}function _9(e,...t){return t.length===1&&Array.isArray(t[0])?e[Xn]=t[0]:t.forEach(n=>{Object.assign(e[Xn],s1(n)&&n[Xn]||n)}),e}function uu(e){return Array.isArray(e)?[].concat(...e):e}function C(e,t){return e[Xn][t]}function v(e,t,n){e[Xn][t]=oye(n)}function XA(...e){return Object.assign(Object.create(Object.getPrototypeOf(e[0])),...e)}function O(e){return XA(e,{[Xn]:Object.assign({},e[Xn])})}function Vd(e,t){e[Xn]=t||{}}function Xd(e,t){const n={[E9]:t};return lu(e)?e.map(i=>XA(i,n)):XA(e,n)}function r1(e){return e&&e.toObject?e.toObject(e[E9]||0):A9(e)}function A9(e){if(lu(e))return e.map(t=>r1(t));if(s1(e)){const t=e[Xn]||e;return lu(t)?r1(t):Object.keys(t).reduce((n,i)=>(n[i]=r1(t[i]),n),{})}else return e}function Vl(e){return{[Xn]:e,toObject:()=>e}}function oye(e){return s1(e)&&!e[Xn]?{[Xn]:e||{}}:e}function ut(e,...t){const n=[].concat(...t);return new sye(e?Xd(n,e):n)}const lu=Array.isArray;function KA(e){return s1(e)&&typeof e[Symbol.iterator]=="function"}function s1(e){return e===Object(e)&&!lu(e)}function Kd(e){return typeof e=="string"}var aye,O9,S9;function C9(...e){const t=Object.assign({},S9);return t.view=Object.assign({},S9.view,...e),t.view.spec&&(t.spec=t.view.spec,delete t.view.spec),t}function uye(){return typeof document=="undefined"?void 0:document.createElement("div")}function QA(e){return Object.assign({$schema:"https://vega.github.io/schema/vega-lite/v5.json"},e.toObject())}function $9(e,t){throw Error('Vega / Vega-Lite not registered. Use the "register" method.')}async function JA(e){e=C9({container:e&&e.container||uye()},e);const t=await $9(this,e).runAsync(),n=t.container()||{};return n.value=t,n}function ZA(e){return $9(this,C9(e))}function eO(){return QA(this)}function tO(e){return JSON.stringify(QA(this),null,e)}class lye extends Yd{constructor(...t){super();Vd(this),t[0]!==void 0&&v(this,"repeat",t[0]),t[1]!==void 0&&v(this,"spec",t[1])}align(t){if(arguments.length){const n=O(this);return v(n,"align",t),n}else return C(this,"align")}autosize(t){if(arguments.length){const n=O(this);return v(n,"autosize",t),n}else return C(this,"autosize")}background(t){if(arguments.length){const n=O(this);return v(n,"background",t),n}else return C(this,"background")}bounds(t){if(arguments.length){const n=O(this);return v(n,"bounds",t),n}else return C(this,"bounds")}center(t){if(arguments.length){const n=O(this);return v(n,"center",t),n}else return C(this,"center")}columns(t){if(arguments.length){const n=O(this);return v(n,"columns",t),n}else return C(this,"columns")}config(t){if(arguments.length){const n=O(this);return v(n,"config",t),n}else return C(this,"config")}datasets(t){if(arguments.length){const n=O(this);return v(n,"datasets",t),n}else return C(this,"datasets")}description(t){if(arguments.length){const n=O(this);return v(n,"description",t),n}else return C(this,"description")}name(t){if(arguments.length){const n=O(this);return v(n,"name",t),n}else return C(this,"name")}padding(t){if(arguments.length){const n=O(this);return v(n,"padding",t),n}else return C(this,"padding")}resolve(t){if(arguments.length){const n=O(this);return v(n,"resolve",t),n}else return C(this,"resolve")}spacing(t){if(arguments.length){const n=O(this);return v(n,"spacing",t),n}else return C(this,"spacing")}spec(t){if(arguments.length){const n=O(this);return v(n,"spec",t),n}else return C(this,"spec")}title(t){if(arguments.length){const n=O(this);return v(n,"title",t),n}else return C(this,"title")}usermeta(t){if(arguments.length){const n=O(this);return v(n,"usermeta",t),n}else return C(this,"usermeta")}data(t){if(arguments.length){const n=O(this);return t=lu(t)?{values:Vl(t)}:KA(t)?{values:Vl(t)}:Kd(t)?{url:t}:t,v(n,"data",t),n}else return C(this,"data")}params(...t){if(arguments.length){const n=O(this);return t=uu(t),t=Xd(t,1),v(n,"params",t),n}else return C(this,"params")}transform(...t){if(arguments.length){const n=O(this);return t=uu(t),v(n,"transform",t),n}else return C(this,"transform")}facet(...t){return t=t.slice(0,1),F9(...t).spec(this)}render(...t){return JA.apply(this,t)}toView(...t){return ZA.apply(this,t)}toSpec(...t){return eO.apply(this,t)}toString(...t){return tO.apply(this,t)}}function k9(...e){return new lye(...e)}class cye extends Yd{constructor(...t){super();Vd(this),t[0]!==void 0&&v(this,"facet",t[0]),t[1]!==void 0&&v(this,"spec",t[1])}align(t){if(arguments.length){const n=O(this);return v(n,"align",t),n}else return C(this,"align")}autosize(t){if(arguments.length){const n=O(this);return v(n,"autosize",t),n}else return C(this,"autosize")}background(t){if(arguments.length){const n=O(this);return v(n,"background",t),n}else return C(this,"background")}bounds(t){if(arguments.length){const n=O(this);return v(n,"bounds",t),n}else return C(this,"bounds")}center(t){if(arguments.length){const n=O(this);return v(n,"center",t),n}else return C(this,"center")}columns(t){if(arguments.length){const n=O(this);return v(n,"columns",t),n}else return C(this,"columns")}config(t){if(arguments.length){const n=O(this);return v(n,"config",t),n}else return C(this,"config")}datasets(t){if(arguments.length){const n=O(this);return v(n,"datasets",t),n}else return C(this,"datasets")}description(t){if(arguments.length){const n=O(this);return v(n,"description",t),n}else return C(this,"description")}name(t){if(arguments.length){const n=O(this);return v(n,"name",t),n}else return C(this,"name")}padding(t){if(arguments.length){const n=O(this);return v(n,"padding",t),n}else return C(this,"padding")}resolve(t){if(arguments.length){const n=O(this);return v(n,"resolve",t),n}else return C(this,"resolve")}spacing(t){if(arguments.length){const n=O(this);return v(n,"spacing",t),n}else return C(this,"spacing")}spec(t){if(arguments.length){const n=O(this);return v(n,"spec",t),n}else return C(this,"spec")}title(t){if(arguments.length){const n=O(this);return v(n,"title",t),n}else return C(this,"title")}usermeta(t){if(arguments.length){const n=O(this);return v(n,"usermeta",t),n}else return C(this,"usermeta")}data(t){if(arguments.length){const n=O(this);return t=lu(t)?{values:Vl(t)}:KA(t)?{values:Vl(t)}:Kd(t)?{url:t}:t,v(n,"data",t),n}else return C(this,"data")}params(...t){if(arguments.length){const n=O(this);return t=uu(t),t=Xd(t,1),v(n,"params",t),n}else return C(this,"params")}transform(...t){if(arguments.length){const n=O(this);return t=uu(t),v(n,"transform",t),n}else return C(this,"transform")}repeat(...t){return t=t.slice(0,1),k9(...t).spec(this)}render(...t){return JA.apply(this,t)}toView(...t){return ZA.apply(this,t)}toSpec(...t){return eO.apply(this,t)}toString(...t){return tO.apply(this,t)}}function F9(...e){return new cye(...e)}class fye extends Yd{constructor(...t){super();Vd(this),t=t.map(n=>Kd(n)?{type:n}:n),v(this,"mark",ut(0,C(this,"mark"),t))}align(t){if(arguments.length){const n=O(this);return v(n,"align",t),n}else return C(this,"align")}autosize(t){if(arguments.length){const n=O(this);return v(n,"autosize",t),n}else return C(this,"autosize")}background(t){if(arguments.length){const n=O(this);return v(n,"background",t),n}else return C(this,"background")}bounds(t){if(arguments.length){const n=O(this);return v(n,"bounds",t),n}else return C(this,"bounds")}center(t){if(arguments.length){const n=O(this);return v(n,"center",t),n}else return C(this,"center")}config(t){if(arguments.length){const n=O(this);return v(n,"config",t),n}else return C(this,"config")}datasets(t){if(arguments.length){const n=O(this);return v(n,"datasets",t),n}else return C(this,"datasets")}description(t){if(arguments.length){const n=O(this);return v(n,"description",t),n}else return C(this,"description")}height(t){if(arguments.length){const n=O(this);return v(n,"height",t),n}else return C(this,"height")}name(t){if(arguments.length){const n=O(this);return v(n,"name",t),n}else return C(this,"name")}padding(t){if(arguments.length){const n=O(this);return v(n,"padding",t),n}else return C(this,"padding")}resolve(t){if(arguments.length){const n=O(this);return v(n,"resolve",t),n}else return C(this,"resolve")}spacing(t){if(arguments.length){const n=O(this);return v(n,"spacing",t),n}else return C(this,"spacing")}title(t){if(arguments.length){const n=O(this);return v(n,"title",t),n}else return C(this,"title")}usermeta(t){if(arguments.length){const n=O(this);return v(n,"usermeta",t),n}else return C(this,"usermeta")}view(t){if(arguments.length){const n=O(this);return v(n,"view",t),n}else return C(this,"view")}width(t){if(arguments.length){const n=O(this);return v(n,"width",t),n}else return C(this,"width")}mark(...t){if(arguments.length){t=t.map(i=>Kd(i)?{type:i}:i);const n=O(this);return v(n,"mark",ut(0,t)),n}else return C(this,"mark")}select(...t){if(arguments.length){const n=O(this);return t=uu(t),t=Xd(t,1),v(n,"params",t),n}else return C(this,"params")}project(t){if(arguments.length){const n=O(this);return v(n,"projection",t),n}else return C(this,"projection")}encode(...t){if(t.length===1&&Array.isArray(t[0])&&(t=t[0]),t.length){const n=C(this,"encoding"),i=O(this);return n&&(t=[n].concat(t)),v(i,"encoding",ut(1,t)),i}else return C(this,"encoding")}data(t){if(arguments.length){const n=O(this);return t=lu(t)?{values:Vl(t)}:KA(t)?{values:Vl(t)}:Kd(t)?{url:t}:t,v(n,"data",t),n}else return C(this,"data")}params(...t){if(arguments.length){const n=O(this);return t=uu(t),t=Xd(t,1),v(n,"params",t),n}else return C(this,"params")}transform(...t){if(arguments.length){const n=O(this);return t=uu(t),v(n,"transform",t),n}else return C(this,"transform")}markArc(...t){t=[{type:"arc"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markArea(...t){t=[{type:"area"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markBar(...t){t=[{type:"bar"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markBoxplot(...t){t=[{type:"boxplot"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markCircle(...t){t=[{type:"circle"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markErrorband(...t){t=[{type:"errorband"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markErrorbar(...t){t=[{type:"errorbar"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markGeoshape(...t){t=[{type:"geoshape"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markImage(...t){t=[{type:"image"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markLine(...t){t=[{type:"line"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markPoint(...t){t=[{type:"point"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markRect(...t){t=[{type:"rect"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markRule(...t){t=[{type:"rule"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markSquare(...t){t=[{type:"square"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markText(...t){t=[{type:"text"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markTick(...t){t=[{type:"tick"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}markTrail(...t){t=[{type:"trail"}].concat(t);const n=O(this);return v(n,"mark",ut(0,t)),n}facet(...t){return t=t.slice(0,1),F9(...t).spec(this)}repeat(...t){return t=t.slice(0,1),k9(...t).spec(this)}render(...t){return JA.apply(this,t)}toView(...t){return ZA.apply(this,t)}toSpec(...t){return eO.apply(this,t)}toString(...t){return tO.apply(this,t)}}function dye(...e){return new fye(...e)}function yye(...e){return dye({type:"bar"},...e)}class hye extends Yd{constructor(...t){super();Vd(this),_9(this,...t)}aggregate(t){if(arguments.length){const n=O(this);return v(n,"aggregate",t),n}else return C(this,"aggregate")}axis(t){if(arguments.length){const n=O(this);return v(n,"axis",t),n}else return C(this,"axis")}bandPosition(t){if(arguments.length){const n=O(this);return v(n,"bandPosition",t),n}else return C(this,"bandPosition")}bin(t){if(arguments.length){const n=O(this);return v(n,"bin",t),n}else return C(this,"bin")}field(t){if(arguments.length){const n=O(this);return v(n,"field",t),n}else return C(this,"field")}impute(t){if(arguments.length){const n=O(this);return v(n,"impute",t),n}else return C(this,"impute")}scale(t){if(arguments.length){const n=O(this);return v(n,"scale",t),n}else return C(this,"scale")}sort(t){if(arguments.length){const n=O(this);return v(n,"sort",t),n}else return C(this,"sort")}stack(t){if(arguments.length){const n=O(this);return v(n,"stack",t),n}else return C(this,"stack")}timeUnit(t){if(arguments.length){const n=O(this);return v(n,"timeUnit",t),n}else return C(this,"timeUnit")}title(t){if(arguments.length){const n=O(this);return v(n,"title",t),n}else return C(this,"title")}type(t){if(arguments.length){const n=O(this);return v(n,"type",t),n}else return C(this,"type")}datum(t){if(arguments.length){const n=O(this);return v(n,"datum",t),n}else return C(this,"datum")}value(t){if(arguments.length){const n=O(this);return v(n,"value",t),n}else return C(this,"value")}fieldN(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","nominal"),n}else return C(this,"field")}fieldO(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","ordinal"),n}else return C(this,"field")}fieldQ(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),n}else return C(this,"field")}fieldT(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),n}else return C(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=C(this,"condition")||[],i=O(this);return t=[].concat(n,ut(0,t)),v(i,"condition",t.length>1?t:t[0]),i}else return C(this,"condition")}count(){const t=O(this);return v(t,"type","quantitative"),v(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","valid"),n}else return C(this,"field")}missing(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","missing"),n}else return C(this,"field")}distinct(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","distinct"),n}else return C(this,"field")}sum(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","sum"),n}else return C(this,"field")}mean(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","mean"),n}else return C(this,"field")}product(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","product"),n}else return C(this,"field")}average(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","average"),n}else return C(this,"field")}variance(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","variance"),n}else return C(this,"field")}variancep(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","variancep"),n}else return C(this,"field")}stdev(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","stdev"),n}else return C(this,"field")}stdevp(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","stdevp"),n}else return C(this,"field")}stderr(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","stderr"),n}else return C(this,"field")}median(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","median"),n}else return C(this,"field")}q1(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","q1"),n}else return C(this,"field")}q3(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","q3"),n}else return C(this,"field")}ci0(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","ci0"),n}else return C(this,"field")}ci1(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","ci1"),n}else return C(this,"field")}min(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","min"),n}else return C(this,"field")}max(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","max"),n}else return C(this,"field")}argmin(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","argmin"),n}else return C(this,"field")}argmax(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","argmax"),n}else return C(this,"field")}year(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","year"),n}else return C(this,"field")}quarter(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","quarter"),n}else return C(this,"field")}month(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","month"),n}else return C(this,"field")}day(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","day"),n}else return C(this,"field")}date(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","date"),n}else return C(this,"field")}hours(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","hours"),n}else return C(this,"field")}minutes(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","minutes"),n}else return C(this,"field")}seconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","seconds"),n}else return C(this,"field")}milliseconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","milliseconds"),n}else return C(this,"field")}yearmonth(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonth"),n}else return C(this,"field")}timeYQ(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearquarter"),n}else return C(this,"field")}timeYQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearquartermonth"),n}else return C(this,"field")}timeYM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonth"),n}else return C(this,"field")}timeYMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdate"),n}else return C(this,"field")}timeYMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdatehours"),n}else return C(this,"field")}timeYMDHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdatehoursminutes"),n}else return C(this,"field")}timeYMDHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return C(this,"field")}timeQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","quartermonth"),n}else return C(this,"field")}timeMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","monthdate"),n}else return C(this,"field")}timeMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","monthdatehours"),n}else return C(this,"field")}timeHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","hoursminutes"),n}else return C(this,"field")}timeHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","hoursminutesseconds"),n}else return C(this,"field")}timeMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","minutesseconds"),n}else return C(this,"field")}timeSMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","secondsmilliseconds"),n}else return C(this,"field")}utcyear(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyear"),n}else return C(this,"field")}utcquarter(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcquarter"),n}else return C(this,"field")}utcmonth(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmonth"),n}else return C(this,"field")}utcday(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcday"),n}else return C(this,"field")}utcdate(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcdate"),n}else return C(this,"field")}utchours(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utchours"),n}else return C(this,"field")}utcminutes(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcminutes"),n}else return C(this,"field")}utcseconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcseconds"),n}else return C(this,"field")}utcmilliseconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmilliseconds"),n}else return C(this,"field")}utcyearmonth(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonth"),n}else return C(this,"field")}utcYQ(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearquarter"),n}else return C(this,"field")}utcYQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearquartermonth"),n}else return C(this,"field")}utcYM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonth"),n}else return C(this,"field")}utcYMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdate"),n}else return C(this,"field")}utcYMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdatehours"),n}else return C(this,"field")}utcYMDHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return C(this,"field")}utcYMDHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return C(this,"field")}utcQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcquartermonth"),n}else return C(this,"field")}utcMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmonthdate"),n}else return C(this,"field")}utcMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmonthdatehours"),n}else return C(this,"field")}utcHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utchoursminutes"),n}else return C(this,"field")}utcHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utchoursminutesseconds"),n}else return C(this,"field")}utcMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcminutesseconds"),n}else return C(this,"field")}utcSMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcsecondsmilliseconds"),n}else return C(this,"field")}toObject(t){return t?{x:super.toObject()}:super.toObject()}}function bye(...e){return new hye(...e)}class gye extends Yd{constructor(...t){super();Vd(this),_9(this,...t)}aggregate(t){if(arguments.length){const n=O(this);return v(n,"aggregate",t),n}else return C(this,"aggregate")}axis(t){if(arguments.length){const n=O(this);return v(n,"axis",t),n}else return C(this,"axis")}bandPosition(t){if(arguments.length){const n=O(this);return v(n,"bandPosition",t),n}else return C(this,"bandPosition")}bin(t){if(arguments.length){const n=O(this);return v(n,"bin",t),n}else return C(this,"bin")}field(t){if(arguments.length){const n=O(this);return v(n,"field",t),n}else return C(this,"field")}impute(t){if(arguments.length){const n=O(this);return v(n,"impute",t),n}else return C(this,"impute")}scale(t){if(arguments.length){const n=O(this);return v(n,"scale",t),n}else return C(this,"scale")}sort(t){if(arguments.length){const n=O(this);return v(n,"sort",t),n}else return C(this,"sort")}stack(t){if(arguments.length){const n=O(this);return v(n,"stack",t),n}else return C(this,"stack")}timeUnit(t){if(arguments.length){const n=O(this);return v(n,"timeUnit",t),n}else return C(this,"timeUnit")}title(t){if(arguments.length){const n=O(this);return v(n,"title",t),n}else return C(this,"title")}type(t){if(arguments.length){const n=O(this);return v(n,"type",t),n}else return C(this,"type")}datum(t){if(arguments.length){const n=O(this);return v(n,"datum",t),n}else return C(this,"datum")}value(t){if(arguments.length){const n=O(this);return v(n,"value",t),n}else return C(this,"value")}fieldN(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","nominal"),n}else return C(this,"field")}fieldO(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","ordinal"),n}else return C(this,"field")}fieldQ(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),n}else return C(this,"field")}fieldT(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),n}else return C(this,"field")}if(...t){if(t.length&&(t[0]={test:t[0]}),arguments.length){const n=C(this,"condition")||[],i=O(this);return t=[].concat(n,ut(0,t)),v(i,"condition",t.length>1?t:t[0]),i}else return C(this,"condition")}count(){const t=O(this);return v(t,"type","quantitative"),v(t,"aggregate","count"),t}valid(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","valid"),n}else return C(this,"field")}missing(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","missing"),n}else return C(this,"field")}distinct(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","distinct"),n}else return C(this,"field")}sum(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","sum"),n}else return C(this,"field")}mean(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","mean"),n}else return C(this,"field")}product(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","product"),n}else return C(this,"field")}average(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","average"),n}else return C(this,"field")}variance(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","variance"),n}else return C(this,"field")}variancep(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","variancep"),n}else return C(this,"field")}stdev(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","stdev"),n}else return C(this,"field")}stdevp(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","stdevp"),n}else return C(this,"field")}stderr(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","stderr"),n}else return C(this,"field")}median(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","median"),n}else return C(this,"field")}q1(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","q1"),n}else return C(this,"field")}q3(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","q3"),n}else return C(this,"field")}ci0(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","ci0"),n}else return C(this,"field")}ci1(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","ci1"),n}else return C(this,"field")}min(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","min"),n}else return C(this,"field")}max(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","max"),n}else return C(this,"field")}argmin(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","argmin"),n}else return C(this,"field")}argmax(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","quantitative"),v(n,"aggregate","argmax"),n}else return C(this,"field")}year(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","year"),n}else return C(this,"field")}quarter(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","quarter"),n}else return C(this,"field")}month(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","month"),n}else return C(this,"field")}day(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","day"),n}else return C(this,"field")}date(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","date"),n}else return C(this,"field")}hours(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","hours"),n}else return C(this,"field")}minutes(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","minutes"),n}else return C(this,"field")}seconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","seconds"),n}else return C(this,"field")}milliseconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","milliseconds"),n}else return C(this,"field")}yearmonth(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonth"),n}else return C(this,"field")}timeYQ(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearquarter"),n}else return C(this,"field")}timeYQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearquartermonth"),n}else return C(this,"field")}timeYM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonth"),n}else return C(this,"field")}timeYMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdate"),n}else return C(this,"field")}timeYMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdatehours"),n}else return C(this,"field")}timeYMDHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdatehoursminutes"),n}else return C(this,"field")}timeYMDHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","yearmonthdatehoursminutesseconds"),n}else return C(this,"field")}timeQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","quartermonth"),n}else return C(this,"field")}timeMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","monthdate"),n}else return C(this,"field")}timeMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","monthdatehours"),n}else return C(this,"field")}timeHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","hoursminutes"),n}else return C(this,"field")}timeHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","hoursminutesseconds"),n}else return C(this,"field")}timeMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","minutesseconds"),n}else return C(this,"field")}timeSMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","secondsmilliseconds"),n}else return C(this,"field")}utcyear(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyear"),n}else return C(this,"field")}utcquarter(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcquarter"),n}else return C(this,"field")}utcmonth(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmonth"),n}else return C(this,"field")}utcday(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcday"),n}else return C(this,"field")}utcdate(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcdate"),n}else return C(this,"field")}utchours(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utchours"),n}else return C(this,"field")}utcminutes(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcminutes"),n}else return C(this,"field")}utcseconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcseconds"),n}else return C(this,"field")}utcmilliseconds(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmilliseconds"),n}else return C(this,"field")}utcyearmonth(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonth"),n}else return C(this,"field")}utcYQ(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearquarter"),n}else return C(this,"field")}utcYQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearquartermonth"),n}else return C(this,"field")}utcYM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonth"),n}else return C(this,"field")}utcYMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdate"),n}else return C(this,"field")}utcYMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdatehours"),n}else return C(this,"field")}utcYMDHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdatehoursminutes"),n}else return C(this,"field")}utcYMDHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcyearmonthdatehoursminutesseconds"),n}else return C(this,"field")}utcQM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcquartermonth"),n}else return C(this,"field")}utcMD(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmonthdate"),n}else return C(this,"field")}utcMDH(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcmonthdatehours"),n}else return C(this,"field")}utcHM(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utchoursminutes"),n}else return C(this,"field")}utcHMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utchoursminutesseconds"),n}else return C(this,"field")}utcMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcminutesseconds"),n}else return C(this,"field")}utcSMS(t){if(arguments.length){const n=O(this);return v(n,"field",t),v(n,"type","temporal"),v(n,"timeUnit","utcsecondsmilliseconds"),n}else return C(this,"field")}toObject(t){return t?{y:super.toObject()}:super.toObject()}}function vye(...e){return new gye(...e)}export{mye as e,yye as m,bye as x,vye as y};
